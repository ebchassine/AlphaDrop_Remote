Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 43
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_43_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
total_loss: 71359.90829467773, total_len: 7744
total_loss: 75768.94100952148, total_len: 8224
Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 43
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_43_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
total_loss: 71359.90829467773, total_len: 7744
total_loss: 75768.94100952148, total_len: 8224
total_loss: 67822.15325927734, total_len: 7360
| Start of training | test loss  9.21 | test bpc 10028.13019
| epoch   1 step      200 |    200 batches | lr 0.000125 | ms/batch 37.75 | loss  7.06 | ppl  1159.955
total_loss: 45588.91313171387, total_len: 7360
total_loss: 50541.31629943848, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   1 at step      200 | time:  8.78s | valid loss  6.19 | valid ppl   489.873
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   2 step      400 |    158 batches | lr 0.000125 | ms/batch 37.78 | loss  6.08 | ppl   437.723
total_loss: 42798.68684387207, total_len: 7360
total_loss: 47431.84178161621, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   2 at step      400 | time:  6.10s | valid loss  5.82 | valid ppl   335.304
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   3 step      600 |    116 batches | lr 0.000125 | ms/batch 37.93 | loss  5.81 | ppl   332.825
total_loss: 41539.92329406738, total_len: 7360
total_loss: 46035.34941101074, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   3 at step      600 | time:  6.07s | valid loss  5.64 | valid ppl   282.594
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   4 step      800 |     74 batches | lr 0.000125 | ms/batch 36.37 | loss  5.66 | ppl   287.903
total_loss: 40586.601821899414, total_len: 7360
total_loss: 44937.60200500488, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   4 at step      800 | time:  6.06s | valid loss  5.51 | valid ppl   248.262
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1000 |     32 batches | lr 0.000125 | ms/batch 37.82 | loss  5.53 | ppl   252.785
total_loss: 39996.476135253906, total_len: 7360
total_loss: 44282.756103515625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1000 | time:  6.28s | valid loss  5.43 | valid ppl   229.133
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1200 |    232 batches | lr 0.000125 | ms/batch 36.81 | loss  5.44 | ppl   230.258
total_loss: 39452.238845825195, total_len: 7360
total_loss: 43692.17353820801, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1200 | time:  6.24s | valid loss  5.36 | valid ppl   212.801
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   6 step     1400 |    190 batches | lr 0.000125 | ms/batch 38.57 | loss  5.37 | ppl   214.390
total_loss: 39049.358001708984, total_len: 7360
total_loss: 43203.99723815918, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1400 | time:  6.28s | valid loss  5.31 | valid ppl   201.466
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   7 step     1600 |    148 batches | lr 0.000125 | ms/batch 37.79 | loss  5.30 | ppl   200.656
total_loss: 38604.33546447754, total_len: 7360
total_loss: 42711.4440612793, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   8 at step     1600 | time:  7.72s | valid loss  5.25 | valid ppl   189.645
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   8 step     1800 |    106 batches | lr 0.000124 | ms/batch 43.58 | loss  5.25 | ppl   190.654
total_loss: 38301.708267211914, total_len: 7360
total_loss: 42372.746032714844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   9 at step     1800 | time:  6.20s | valid loss  5.20 | valid ppl   182.005
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   9 step     2000 |     64 batches | lr 0.000124 | ms/batch 37.01 | loss  5.20 | ppl   181.353
total_loss: 37993.45053100586, total_len: 7360
total_loss: 42019.19320678711, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2000 | time:  6.27s | valid loss  5.16 | valid ppl   174.540
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2200 |     22 batches | lr 0.000124 | ms/batch 36.43 | loss  5.14 | ppl   170.354
total_loss: 37703.89515686035, total_len: 7360
total_loss: 41682.508224487305, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2200 | time:  6.04s | valid loss  5.12 | valid ppl   167.807
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2400 |    222 batches | lr 0.000124 | ms/batch 37.33 | loss  5.10 | ppl   163.236
total_loss: 37489.04066467285, total_len: 7360
total_loss: 41459.196517944336, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  12 at step     2400 | time:  6.11s | valid loss  5.09 | valid ppl   162.979
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  11 step     2600 |    180 batches | lr 0.000124 | ms/batch 38.15 | loss  5.05 | ppl   156.095
total_loss: 37183.572525024414, total_len: 7360
total_loss: 41101.295669555664, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  13 at step     2600 | time:  6.22s | valid loss  5.05 | valid ppl   156.353
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  12 step     2800 |    138 batches | lr 0.000123 | ms/batch 37.40 | loss  5.01 | ppl   150.045
total_loss: 36953.217628479004, total_len: 7360
total_loss: 40844.52798461914, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  14 at step     2800 | time:  6.37s | valid loss  5.02 | valid ppl   151.535
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  13 step     3000 |     96 batches | lr 0.000123 | ms/batch 39.27 | loss  4.98 | ppl   145.609
total_loss: 36665.92135620117, total_len: 7360
total_loss: 40518.91879272461, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3000 | time:  6.22s | valid loss  4.98 | valid ppl   145.734
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  14 step     3200 |     54 batches | lr 0.000123 | ms/batch 36.94 | loss  4.92 | ppl   137.643
total_loss: 36271.644706726074, total_len: 7360
total_loss: 40097.420471191406, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  16 at step     3200 | time:  6.28s | valid loss  4.93 | valid ppl   138.132
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3400 |     12 batches | lr 0.000123 | ms/batch 37.18 | loss  4.86 | ppl   129.533
total_loss: 35910.54421234131, total_len: 7360
total_loss: 39710.806732177734, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  17 at step     3400 | time:  6.18s | valid loss  4.88 | valid ppl   131.519
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3600 |    212 batches | lr 0.000123 | ms/batch 36.58 | loss  4.81 | ppl   122.865
total_loss: 35519.23058319092, total_len: 7360
total_loss: 39267.95121765137, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  18 at step     3600 | time:  6.06s | valid loss  4.83 | valid ppl   124.709
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  16 step     3800 |    170 batches | lr 0.000122 | ms/batch 36.21 | loss  4.75 | ppl   116.070
total_loss: 35175.82508087158, total_len: 7360
total_loss: 38888.43665313721, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  19 at step     3800 | time:  6.02s | valid loss  4.78 | valid ppl   119.024
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  17 step     4000 |    128 batches | lr 0.000122 | ms/batch 37.27 | loss  4.70 | ppl   110.307
total_loss: 34851.373306274414, total_len: 7360
total_loss: 38500.97826385498, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  20 at step     4000 | time:  6.30s | valid loss  4.74 | valid ppl   113.891
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  18 step     4200 |     86 batches | lr 0.000122 | ms/batch 36.44 | loss  4.67 | ppl   106.533
total_loss: 34491.40286254883, total_len: 7360
total_loss: 38086.17398071289, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  21 at step     4200 | time:  6.14s | valid loss  4.69 | valid ppl   108.455
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  19 step     4400 |     44 batches | lr 0.000121 | ms/batch 34.09 | loss  4.60 | ppl    99.260
total_loss: 34156.943687438965, total_len: 7360
total_loss: 37724.587089538574, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  22 at step     4400 | time:  6.05s | valid loss  4.64 | valid ppl   103.636
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4600 |      2 batches | lr 0.000121 | ms/batch 36.40 | loss  4.54 | ppl    94.144
total_loss: 33833.614402770996, total_len: 7360
total_loss: 37372.48149871826, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  23 at step     4600 | time:  6.15s | valid loss  4.60 | valid ppl    99.182
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4800 |    202 batches | lr 0.000121 | ms/batch 37.39 | loss  4.50 | ppl    90.128
total_loss: 33564.15612792969, total_len: 7360
total_loss: 37078.00608062744, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  24 at step     4800 | time:  6.42s | valid loss  4.56 | valid ppl    95.617
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  21 step     5000 |    160 batches | lr 0.00012 | ms/batch 37.70 | loss  4.46 | ppl    86.111
total_loss: 33336.7374420166, total_len: 7360
total_loss: 36810.75704193115, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  25 at step     5000 | time:  6.32s | valid loss  4.53 | valid ppl    92.707
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  22 step     5200 |    118 batches | lr 0.00012 | ms/batch 39.92 | loss  4.41 | ppl    82.553
total_loss: 33129.304458618164, total_len: 7360
total_loss: 36557.49631500244, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  26 at step     5200 | time:  6.28s | valid loss  4.50 | valid ppl    90.131
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  23 step     5400 |     76 batches | lr 0.000119 | ms/batch 37.17 | loss  4.39 | ppl    80.693
total_loss: 32858.94519042969, total_len: 7360
total_loss: 36263.68702697754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  27 at step     5400 | time:  6.23s | valid loss  4.46 | valid ppl    86.880
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5600 |     34 batches | lr 0.000119 | ms/batch 37.13 | loss  4.33 | ppl    76.152
total_loss: 32673.359329223633, total_len: 7360
total_loss: 36078.265228271484, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  28 at step     5600 | time:  6.17s | valid loss  4.44 | valid ppl    84.717
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5800 |    234 batches | lr 0.000119 | ms/batch 36.91 | loss  4.29 | ppl    73.312
total_loss: 32476.720848083496, total_len: 7360
total_loss: 35845.192390441895, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  29 at step     5800 | time:  6.20s | valid loss  4.41 | valid ppl    82.483
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  25 step     6000 |    192 batches | lr 0.000118 | ms/batch 37.45 | loss  4.26 | ppl    71.057
total_loss: 32328.05825805664, total_len: 7360
total_loss: 35692.1513671875, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  30 at step     6000 | time:  6.30s | valid loss  4.39 | valid ppl    80.834
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  26 step     6200 |    150 batches | lr 0.000118 | ms/batch 36.93 | loss  4.23 | ppl    68.762
total_loss: 32185.934768676758, total_len: 7360
total_loss: 35519.76927947998, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  31 at step     6200 | time:  6.15s | valid loss  4.37 | valid ppl    79.288
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  27 step     6400 |    108 batches | lr 0.000117 | ms/batch 36.63 | loss  4.21 | ppl    67.474
total_loss: 32148.94019317627, total_len: 7360
total_loss: 35457.80260467529, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  32 at step     6400 | time:  6.15s | valid loss  4.37 | valid ppl    78.891
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  28 step     6600 |     66 batches | lr 0.000117 | ms/batch 37.28 | loss  4.19 | ppl    65.908
total_loss: 31981.258224487305, total_len: 7360
total_loss: 35281.28993225098, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  33 at step     6600 | time:  6.52s | valid loss  4.35 | valid ppl    77.114
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     6800 |     24 batches | lr 0.000116 | ms/batch 38.23 | loss  4.15 | ppl    63.166
total_loss: 31837.3211517334, total_len: 7360
total_loss: 35131.940086364746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  34 at step     6800 | time:  6.10s | valid loss  4.33 | valid ppl    75.620
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     7000 |    224 batches | lr 0.000116 | ms/batch 37.01 | loss  4.12 | ppl    61.706
total_loss: 31731.274185180664, total_len: 7360
total_loss: 35010.70700073242, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  35 at step     7000 | time:  6.20s | valid loss  4.31 | valid ppl    74.538
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  30 step     7200 |    182 batches | lr 0.000115 | ms/batch 38.34 | loss  4.10 | ppl    60.286
total_loss: 31636.812294006348, total_len: 7360
total_loss: 34895.171142578125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  36 at step     7200 | time:  6.14s | valid loss  4.30 | valid ppl    73.588
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  31 step     7400 |    140 batches | lr 0.000115 | ms/batch 35.58 | loss  4.08 | ppl    59.179
total_loss: 31586.052337646484, total_len: 7360
total_loss: 34823.96130371094, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  37 at step     7400 | time:  5.92s | valid loss  4.29 | valid ppl    73.082
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  32 step     7600 |     98 batches | lr 0.000114 | ms/batch 35.59 | loss  4.07 | ppl    58.661
total_loss: 31495.51287841797, total_len: 7360
total_loss: 34731.79772186279, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  38 at step     7600 | time:  6.03s | valid loss  4.28 | valid ppl    72.189
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  33 step     7800 |     56 batches | lr 0.000114 | ms/batch 36.20 | loss  4.05 | ppl    57.225
total_loss: 31388.402946472168, total_len: 7360
total_loss: 34619.706062316895, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  39 at step     7800 | time:  6.09s | valid loss  4.26 | valid ppl    71.146
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8000 |     14 batches | lr 0.000113 | ms/batch 36.67 | loss  4.02 | ppl    55.507
total_loss: 31312.882263183594, total_len: 7360
total_loss: 34540.12488555908, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  40 at step     8000 | time:  6.13s | valid loss  4.25 | valid ppl    70.419
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8200 |    214 batches | lr 0.000112 | ms/batch 36.83 | loss  4.00 | ppl    54.681
total_loss: 31270.03468322754, total_len: 7360
total_loss: 34477.093978881836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  41 at step     8200 | time:  6.08s | valid loss  4.25 | valid ppl    70.011
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  35 step     8400 |    172 batches | lr 0.000112 | ms/batch 36.72 | loss  3.98 | ppl    53.660
total_loss: 31226.002799987793, total_len: 7360
total_loss: 34426.998931884766, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  42 at step     8400 | time:  6.06s | valid loss  4.24 | valid ppl    69.593
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  36 step     8600 |    130 batches | lr 0.000111 | ms/batch 36.93 | loss  3.97 | ppl    52.900
total_loss: 31178.923652648926, total_len: 7360
total_loss: 34350.419174194336, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  43 at step     8600 | time:  6.15s | valid loss  4.24 | valid ppl    69.149
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  37 step     8800 |     88 batches | lr 0.000111 | ms/batch 36.25 | loss  3.97 | ppl    52.931
total_loss: 31130.95362854004, total_len: 7360
total_loss: 34294.91051483154, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  44 at step     8800 | time:  6.05s | valid loss  4.23 | valid ppl    68.700
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  38 step     9000 |     46 batches | lr 0.00011 | ms/batch 35.83 | loss  3.94 | ppl    51.217
total_loss: 31003.454078674316, total_len: 7360
total_loss: 34170.9719543457, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  45 at step     9000 | time:  6.09s | valid loss  4.21 | valid ppl    67.520
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9200 |      4 batches | lr 0.000109 | ms/batch 36.94 | loss  3.91 | ppl    50.117
total_loss: 31013.98631286621, total_len: 7360
total_loss: 34176.78134918213, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  46 at step     9200 | time:  6.42s | valid loss  4.21 | valid ppl    67.617
----------------------------------------------------------------------------------------------------
| epoch  39 step     9400 |    204 batches | lr 0.000109 | ms/batch 32.35 | loss  3.90 | ppl    49.583
total_loss: 30933.738960266113, total_len: 7360
total_loss: 34101.385498046875, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  47 at step     9400 | time:  6.09s | valid loss  4.20 | valid ppl    66.884
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  40 step     9600 |    162 batches | lr 0.000108 | ms/batch 37.12 | loss  3.89 | ppl    48.913
total_loss: 30889.25234222412, total_len: 7360
total_loss: 34037.763832092285, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  48 at step     9600 | time:  6.15s | valid loss  4.20 | valid ppl    66.481
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  41 step     9800 |    120 batches | lr 0.000107 | ms/batch 36.51 | loss  3.88 | ppl    48.263
total_loss: 30910.5611038208, total_len: 7360
total_loss: 34036.10549163818, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  49 at step     9800 | time:  6.09s | valid loss  4.20 | valid ppl    66.673
----------------------------------------------------------------------------------------------------
| epoch  42 step    10000 |     78 batches | lr 0.000107 | ms/batch 30.38 | loss  3.88 | ppl    48.535
total_loss: 30760.530891418457, total_len: 7360
total_loss: 33878.054512023926, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  50 at step    10000 | time:  6.09s | valid loss  4.18 | valid ppl    65.328
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10200 |     36 batches | lr 0.000106 | ms/batch 36.82 | loss  3.85 | ppl    46.929
total_loss: 30765.437286376953, total_len: 7360
total_loss: 33886.40773773193, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  51 at step    10200 | time:  6.18s | valid loss  4.18 | valid ppl    65.372
----------------------------------------------------------------------------------------------------
| epoch  43 step    10400 |    236 batches | lr 0.000105 | ms/batch 30.41 | loss  3.83 | ppl    46.135
total_loss: 30734.560592651367, total_len: 7360
total_loss: 33842.892517089844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  52 at step    10400 | time:  6.02s | valid loss  4.18 | valid ppl    65.098
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  44 step    10600 |    194 batches | lr 0.000105 | ms/batch 34.42 | loss  3.82 | ppl    45.786
total_loss: 30661.542587280273, total_len: 7360
total_loss: 33764.90062713623, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  53 at step    10600 | time:  6.11s | valid loss  4.17 | valid ppl    64.455
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  45 step    10800 |    152 batches | lr 0.000104 | ms/batch 37.56 | loss  3.81 | ppl    45.115
total_loss: 30578.328773498535, total_len: 7360
total_loss: 33657.24314880371, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  54 at step    10800 | time:  6.43s | valid loss  4.15 | valid ppl    63.731
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  46 step    11000 |    110 batches | lr 0.000103 | ms/batch 38.59 | loss  3.81 | ppl    44.987
total_loss: 30585.23760986328, total_len: 7360
total_loss: 33639.5338973999, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  55 at step    11000 | time:  6.49s | valid loss  4.16 | valid ppl    63.790
----------------------------------------------------------------------------------------------------
| epoch  47 step    11200 |     68 batches | lr 0.000102 | ms/batch 32.07 | loss  3.80 | ppl    44.692
total_loss: 30503.094467163086, total_len: 7360
total_loss: 33567.21854400635, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  56 at step    11200 | time:  6.40s | valid loss  4.14 | valid ppl    63.082
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11400 |     26 batches | lr 0.000102 | ms/batch 38.39 | loss  3.77 | ppl    43.389
total_loss: 30487.33115386963, total_len: 7360
total_loss: 33541.49146270752, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  57 at step    11400 | time:  6.66s | valid loss  4.14 | valid ppl    62.947
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11600 |    226 batches | lr 0.000101 | ms/batch 38.88 | loss  3.76 | ppl    42.899
total_loss: 30422.063369750977, total_len: 7360
total_loss: 33460.75622558594, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  58 at step    11600 | time:  6.32s | valid loss  4.13 | valid ppl    62.392
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  49 step    11800 |    184 batches | lr 0.0001 | ms/batch 37.31 | loss  3.75 | ppl    42.425
total_loss: 30351.61280822754, total_len: 7360
total_loss: 33378.58972167969, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  59 at step    11800 | time:  6.34s | valid loss  4.12 | valid ppl    61.797
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  50 step    12000 |    142 batches | lr 9.92e-05 | ms/batch 38.55 | loss  3.74 | ppl    42.122
total_loss: 30335.797073364258, total_len: 7360
total_loss: 33352.602478027344, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  60 at step    12000 | time:  6.34s | valid loss  4.12 | valid ppl    61.665
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  51 step    12200 |    100 batches | lr 9.84e-05 | ms/batch 38.09 | loss  3.74 | ppl    42.092
total_loss: 30279.6314163208, total_len: 7360
total_loss: 33278.07363128662, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  61 at step    12200 | time:  6.41s | valid loss  4.11 | valid ppl    61.196
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  52 step    12400 |     58 batches | lr 9.76e-05 | ms/batch 37.64 | loss  3.72 | ppl    41.455
total_loss: 30246.35157775879, total_len: 7360
total_loss: 33251.51078796387, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  62 at step    12400 | time:  6.33s | valid loss  4.11 | valid ppl    60.920
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12600 |     16 batches | lr 9.68e-05 | ms/batch 37.66 | loss  3.70 | ppl    40.601
total_loss: 30210.482078552246, total_len: 7360
total_loss: 33199.857482910156, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  63 at step    12600 | time:  6.40s | valid loss  4.10 | valid ppl    60.624
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12800 |    216 batches | lr 9.6e-05 | ms/batch 37.69 | loss  3.69 | ppl    40.137
total_loss: 30160.788276672363, total_len: 7360
total_loss: 33157.95146179199, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  64 at step    12800 | time:  6.28s | valid loss  4.10 | valid ppl    60.216
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  54 step    13000 |    174 batches | lr 9.52e-05 | ms/batch 37.53 | loss  3.68 | ppl    39.812
total_loss: 30123.49461364746, total_len: 7360
total_loss: 33113.63561248779, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  65 at step    13000 | time:  6.35s | valid loss  4.09 | valid ppl    59.911
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  55 step    13200 |    132 batches | lr 9.43e-05 | ms/batch 36.17 | loss  3.68 | ppl    39.519
total_loss: 30114.508140563965, total_len: 7360
total_loss: 33112.572929382324, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  66 at step    13200 | time:  6.19s | valid loss  4.09 | valid ppl    59.838
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  56 step    13400 |     90 batches | lr 9.35e-05 | ms/batch 36.89 | loss  3.68 | ppl    39.758
total_loss: 30029.94574737549, total_len: 7360
total_loss: 33003.86883544922, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  67 at step    13400 | time:  6.14s | valid loss  4.08 | valid ppl    59.155
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  57 step    13600 |     48 batches | lr 9.26e-05 | ms/batch 35.87 | loss  3.66 | ppl    38.870
total_loss: 29951.767951965332, total_len: 7360
total_loss: 32925.899589538574, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  68 at step    13600 | time:  6.08s | valid loss  4.07 | valid ppl    58.530
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    13800 |      6 batches | lr 9.17e-05 | ms/batch 36.47 | loss  3.64 | ppl    38.258
total_loss: 29956.734504699707, total_len: 7360
total_loss: 32930.34900665283, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  69 at step    13800 | time:  6.31s | valid loss  4.07 | valid ppl    58.569
----------------------------------------------------------------------------------------------------
| epoch  58 step    14000 |    206 batches | lr 9.09e-05 | ms/batch 31.42 | loss  3.64 | ppl    37.960
total_loss: 29932.15623474121, total_len: 7360
total_loss: 32913.53589630127, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  70 at step    14000 | time:  6.21s | valid loss  4.07 | valid ppl    58.374
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  59 step    14200 |    164 batches | lr 9e-05 | ms/batch 38.13 | loss  3.63 | ppl    37.616
total_loss: 29923.61743927002, total_len: 7360
total_loss: 32894.7400970459, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  71 at step    14200 | time:  6.26s | valid loss  4.07 | valid ppl    58.306
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  60 step    14400 |    122 batches | lr 8.91e-05 | ms/batch 37.32 | loss  3.62 | ppl    37.344
total_loss: 29929.146949768066, total_len: 7360
total_loss: 32886.61826324463, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  72 at step    14400 | time:  6.34s | valid loss  4.07 | valid ppl    58.350
----------------------------------------------------------------------------------------------------
| epoch  61 step    14600 |     80 batches | lr 8.82e-05 | ms/batch 31.38 | loss  3.63 | ppl    37.681
total_loss: 29859.42498779297, total_len: 7360
total_loss: 32799.98197174072, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  73 at step    14600 | time:  6.21s | valid loss  4.06 | valid ppl    57.800
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    14800 |     38 batches | lr 8.73e-05 | ms/batch 36.02 | loss  3.60 | ppl    36.593
total_loss: 29786.09984588623, total_len: 7360
total_loss: 32747.05908203125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  74 at step    14800 | time:  6.19s | valid loss  4.05 | valid ppl    57.227
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    15000 |    238 batches | lr 8.64e-05 | ms/batch 36.33 | loss  3.59 | ppl    36.312
total_loss: 29851.412269592285, total_len: 7360
total_loss: 32792.39333343506, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  75 at step    15000 | time:  6.00s | valid loss  4.06 | valid ppl    57.737
----------------------------------------------------------------------------------------------------
| epoch  63 step    15200 |    196 batches | lr 8.55e-05 | ms/batch 29.37 | loss  3.59 | ppl    36.054
total_loss: 29788.771492004395, total_len: 7360
total_loss: 32733.22597503662, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  76 at step    15200 | time:  5.86s | valid loss  4.05 | valid ppl    57.248
----------------------------------------------------------------------------------------------------
| epoch  64 step    15400 |    154 batches | lr 8.46e-05 | ms/batch 29.56 | loss  3.58 | ppl    35.714
total_loss: 29741.33000946045, total_len: 7360
total_loss: 32662.78028869629, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  77 at step    15400 | time:  5.89s | valid loss  4.04 | valid ppl    56.880
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  65 step    15600 |    112 batches | lr 8.37e-05 | ms/batch 35.94 | loss  3.57 | ppl    35.664
total_loss: 29719.611221313477, total_len: 7360
total_loss: 32622.471557617188, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  78 at step    15600 | time:  6.03s | valid loss  4.04 | valid ppl    56.712
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  66 step    15800 |     70 batches | lr 8.27e-05 | ms/batch 36.64 | loss  3.58 | ppl    35.787
total_loss: 29690.89729309082, total_len: 7360
total_loss: 32608.926879882812, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  79 at step    15800 | time:  6.18s | valid loss  4.03 | valid ppl    56.491
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16000 |     28 batches | lr 8.18e-05 | ms/batch 36.76 | loss  3.55 | ppl    34.841
total_loss: 29646.67519378662, total_len: 7360
total_loss: 32570.540252685547, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  80 at step    16000 | time:  6.20s | valid loss  4.03 | valid ppl    56.153
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16200 |    228 batches | lr 8.09e-05 | ms/batch 37.36 | loss  3.54 | ppl    34.567
total_loss: 29630.320487976074, total_len: 7360
total_loss: 32527.285751342773, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  81 at step    16200 | time:  6.44s | valid loss  4.03 | valid ppl    56.028
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  68 step    16400 |    186 batches | lr 7.99e-05 | ms/batch 36.85 | loss  3.54 | ppl    34.393
total_loss: 29587.41690826416, total_len: 7360
total_loss: 32498.453170776367, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  82 at step    16400 | time:  6.08s | valid loss  4.02 | valid ppl    55.703
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  69 step    16600 |    144 batches | lr 7.9e-05 | ms/batch 35.93 | loss  3.53 | ppl    34.216
total_loss: 29543.98557281494, total_len: 7360
total_loss: 32449.81147003174, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  83 at step    16600 | time:  6.06s | valid loss  4.01 | valid ppl    55.375
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  70 step    16800 |    102 batches | lr 7.8e-05 | ms/batch 34.91 | loss  3.54 | ppl    34.340
total_loss: 29531.240356445312, total_len: 7360
total_loss: 32425.568565368652, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  84 at step    16800 | time:  6.01s | valid loss  4.01 | valid ppl    55.279
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  71 step    17000 |     60 batches | lr 7.71e-05 | ms/batch 35.62 | loss  3.53 | ppl    34.039
total_loss: 29537.270790100098, total_len: 7360
total_loss: 32446.955192565918, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  85 at step    17000 | time:  6.00s | valid loss  4.01 | valid ppl    55.325
----------------------------------------------------------------------------------------------------
| epoch  72 step    17200 |     18 batches | lr 7.61e-05 | ms/batch 30.01 | loss  3.51 | ppl    33.397
total_loss: 29493.56285095215, total_len: 7360
total_loss: 32387.926300048828, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  86 at step    17200 | time:  6.00s | valid loss  4.01 | valid ppl    54.997
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17400 |    218 batches | lr 7.52e-05 | ms/batch 35.28 | loss  3.50 | ppl    33.218
total_loss: 29480.134048461914, total_len: 7360
total_loss: 32373.11513519287, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  87 at step    17400 | time:  6.03s | valid loss  4.01 | valid ppl    54.897
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  73 step    17600 |    176 batches | lr 7.42e-05 | ms/batch 35.86 | loss  3.49 | ppl    32.941
total_loss: 29454.425903320312, total_len: 7360
total_loss: 32347.5580368042, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  88 at step    17600 | time:  6.04s | valid loss  4.00 | valid ppl    54.705
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  74 step    17800 |    134 batches | lr 7.32e-05 | ms/batch 36.20 | loss  3.49 | ppl    32.867
total_loss: 29466.003440856934, total_len: 7360
total_loss: 32348.536338806152, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  89 at step    17800 | time:  6.03s | valid loss  4.00 | valid ppl    54.791
----------------------------------------------------------------------------------------------------
| epoch  75 step    18000 |     92 batches | lr 7.23e-05 | ms/batch 29.92 | loss  3.50 | ppl    33.065
total_loss: 29408.991928100586, total_len: 7360
total_loss: 32270.734573364258, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  90 at step    18000 | time:  5.99s | valid loss  4.00 | valid ppl    54.369
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  76 step    18200 |     50 batches | lr 7.13e-05 | ms/batch 35.62 | loss  3.48 | ppl    32.523
total_loss: 29366.14419555664, total_len: 7360
total_loss: 32255.24085998535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  91 at step    18200 | time:  6.01s | valid loss  3.99 | valid ppl    54.053
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  77 step    18400 |      8 batches | lr 7.03e-05 | ms/batch 35.98 | loss  3.47 | ppl    32.158
total_loss: 29377.52024078369, total_len: 7360
total_loss: 32255.12516784668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  92 at step    18400 | time:  6.02s | valid loss  3.99 | valid ppl    54.137
----------------------------------------------------------------------------------------------------
| epoch  77 step    18600 |    208 batches | lr 6.94e-05 | ms/batch 29.82 | loss  3.47 | ppl    31.984
total_loss: 29350.958526611328, total_len: 7360
total_loss: 32239.193283081055, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  93 at step    18600 | time:  7.17s | valid loss  3.99 | valid ppl    53.942
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  78 step    18800 |    166 batches | lr 6.84e-05 | ms/batch 36.02 | loss  3.46 | ppl    31.790
total_loss: 29340.96752166748, total_len: 7360
total_loss: 32212.20613861084, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  94 at step    18800 | time:  6.03s | valid loss  3.99 | valid ppl    53.868
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  79 step    19000 |    124 batches | lr 6.74e-05 | ms/batch 35.71 | loss  3.46 | ppl    31.691
total_loss: 29358.69065093994, total_len: 7360
total_loss: 32206.110549926758, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  95 at step    19000 | time:  6.01s | valid loss  3.99 | valid ppl    53.998
----------------------------------------------------------------------------------------------------
| epoch  80 step    19200 |     82 batches | lr 6.64e-05 | ms/batch 29.92 | loss  3.47 | ppl    32.113
total_loss: 29292.290466308594, total_len: 7360
total_loss: 32150.318588256836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  96 at step    19200 | time:  5.99s | valid loss  3.98 | valid ppl    53.513
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19400 |     40 batches | lr 6.54e-05 | ms/batch 35.61 | loss  3.44 | ppl    31.218
total_loss: 29234.31906890869, total_len: 7360
total_loss: 32093.063789367676, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  97 at step    19400 | time:  6.01s | valid loss  3.97 | valid ppl    53.093
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19600 |    240 batches | lr 6.45e-05 | ms/batch 35.56 | loss  3.44 | ppl    31.035
total_loss: 29255.130294799805, total_len: 7360
total_loss: 32097.763053894043, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  98 at step    19600 | time:  6.02s | valid loss  3.97 | valid ppl    53.244
----------------------------------------------------------------------------------------------------
| epoch  82 step    19800 |    198 batches | lr 6.35e-05 | ms/batch 29.92 | loss  3.43 | ppl    30.984
total_loss: 29248.49543762207, total_len: 7360
total_loss: 32109.945190429688, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  99 at step    19800 | time:  5.98s | valid loss  3.97 | valid ppl    53.196
----------------------------------------------------------------------------------------------------
| epoch  83 step    20000 |    156 batches | lr 6.25e-05 | ms/batch 29.92 | loss  3.42 | ppl    30.684
total_loss: 29255.737426757812, total_len: 7360
total_loss: 32093.89715576172, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 100 at step    20000 | time:  5.98s | valid loss  3.97 | valid ppl    53.248
----------------------------------------------------------------------------------------------------
| epoch  84 step    20200 |    114 batches | lr 6.15e-05 | ms/batch 29.97 | loss  3.43 | ppl    30.781
total_loss: 29244.228309631348, total_len: 7360
total_loss: 32068.91259765625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 101 at step    20200 | time:  5.97s | valid loss  3.97 | valid ppl    53.165
----------------------------------------------------------------------------------------------------
| epoch  85 step    20400 |     72 batches | lr 6.05e-05 | ms/batch 29.84 | loss  3.44 | ppl    31.074
total_loss: 29182.65061187744, total_len: 7360
total_loss: 32024.50904083252, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 102 at step    20400 | time:  5.98s | valid loss  3.97 | valid ppl    52.722
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  86 step    20600 |     30 batches | lr 5.96e-05 | ms/batch 35.83 | loss  3.41 | ppl    30.225
total_loss: 29197.640655517578, total_len: 7360
total_loss: 32039.192489624023, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 103 at step    20600 | time:  6.05s | valid loss  3.97 | valid ppl    52.830
----------------------------------------------------------------------------------------------------
| epoch  86 step    20800 |    230 batches | lr 5.86e-05 | ms/batch 30.27 | loss  3.40 | ppl    30.078
total_loss: 29212.232833862305, total_len: 7360
total_loss: 32050.33113861084, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 104 at step    20800 | time:  6.04s | valid loss  3.97 | valid ppl    52.934
----------------------------------------------------------------------------------------------------
| epoch  87 step    21000 |    188 batches | lr 5.76e-05 | ms/batch 30.03 | loss  3.40 | ppl    29.975
total_loss: 29131.475006103516, total_len: 7360
total_loss: 31963.527946472168, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 105 at step    21000 | time:  5.99s | valid loss  3.96 | valid ppl    52.357
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  88 step    21200 |    146 batches | lr 5.66e-05 | ms/batch 35.43 | loss  3.40 | ppl    29.933
total_loss: 29146.44386291504, total_len: 7360
total_loss: 31979.513648986816, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 106 at step    21200 | time:  6.03s | valid loss  3.96 | valid ppl    52.463
----------------------------------------------------------------------------------------------------
| epoch  89 step    21400 |    104 batches | lr 5.56e-05 | ms/batch 29.93 | loss  3.41 | ppl    30.131
total_loss: 29145.967399597168, total_len: 7360
total_loss: 31966.22085571289, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 107 at step    21400 | time:  6.00s | valid loss  3.96 | valid ppl    52.460
----------------------------------------------------------------------------------------------------
| epoch  90 step    21600 |     62 batches | lr 5.47e-05 | ms/batch 29.99 | loss  3.40 | ppl    30.005
total_loss: 29105.835273742676, total_len: 7360
total_loss: 31947.61545562744, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 108 at step    21600 | time:  5.98s | valid loss  3.95 | valid ppl    52.175
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  91 step    21800 |     20 batches | lr 5.37e-05 | ms/batch 35.42 | loss  3.38 | ppl    29.466
total_loss: 29106.226196289062, total_len: 7360
total_loss: 31940.040245056152, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 109 at step    21800 | time:  6.08s | valid loss  3.95 | valid ppl    52.177
----------------------------------------------------------------------------------------------------
| epoch  91 step    22000 |    220 batches | lr 5.27e-05 | ms/batch 31.85 | loss  3.38 | ppl    29.365
total_loss: 29099.482040405273, total_len: 7360
total_loss: 31917.537338256836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 110 at step    22000 | time:  6.69s | valid loss  3.95 | valid ppl    52.130
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  92 step    22200 |    178 batches | lr 5.18e-05 | ms/batch 41.12 | loss  3.38 | ppl    29.317
total_loss: 29099.750717163086, total_len: 7360
total_loss: 31931.02907562256, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 111 at step    22200 | time:  7.04s | valid loss  3.95 | valid ppl    52.132
----------------------------------------------------------------------------------------------------
| epoch  93 step    22400 |    136 batches | lr 5.08e-05 | ms/batch 33.80 | loss  3.37 | ppl    29.142
total_loss: 29124.465995788574, total_len: 7360
total_loss: 31957.250381469727, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 112 at step    22400 | time:  6.77s | valid loss  3.96 | valid ppl    52.307
----------------------------------------------------------------------------------------------------
| epoch  94 step    22600 |     94 batches | lr 4.98e-05 | ms/batch 35.30 | loss  3.39 | ppl    29.600
total_loss: 29065.847328186035, total_len: 7360
total_loss: 31873.794006347656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 113 at step    22600 | time:  7.06s | valid loss  3.95 | valid ppl    51.892
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  95 step    22800 |     52 batches | lr 4.89e-05 | ms/batch 40.49 | loss  3.37 | ppl    29.145
total_loss: 29037.22585296631, total_len: 7360
total_loss: 31867.657066345215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 114 at step    22800 | time:  6.98s | valid loss  3.95 | valid ppl    51.691
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  96 step    23000 |     10 batches | lr 4.79e-05 | ms/batch 41.17 | loss  3.36 | ppl    28.776
total_loss: 29042.726921081543, total_len: 7360
total_loss: 31872.22551727295, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 115 at step    23000 | time:  7.09s | valid loss  3.95 | valid ppl    51.729
----------------------------------------------------------------------------------------------------
| epoch  96 step    23200 |    210 batches | lr 4.7e-05 | ms/batch 34.98 | loss  3.36 | ppl    28.691
total_loss: 29006.3324508667, total_len: 7360
total_loss: 31827.985122680664, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 116 at step    23200 | time:  6.98s | valid loss  3.94 | valid ppl    51.474
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  97 step    23400 |    168 batches | lr 4.6e-05 | ms/batch 40.58 | loss  3.35 | ppl    28.564
total_loss: 29030.089164733887, total_len: 7360
total_loss: 31856.260223388672, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 117 at step    23400 | time:  6.92s | valid loss  3.94 | valid ppl    51.640
----------------------------------------------------------------------------------------------------
| epoch  98 step    23600 |    126 batches | lr 4.51e-05 | ms/batch 34.74 | loss  3.35 | ppl    28.598
total_loss: 29074.680114746094, total_len: 7360
total_loss: 31895.362602233887, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 118 at step    23600 | time:  6.92s | valid loss  3.95 | valid ppl    51.954
----------------------------------------------------------------------------------------------------
| epoch  99 step    23800 |     84 batches | lr 4.41e-05 | ms/batch 35.26 | loss  3.37 | ppl    28.968
total_loss: 28996.17148590088, total_len: 7360
total_loss: 31808.161407470703, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 119 at step    23800 | time:  7.06s | valid loss  3.94 | valid ppl    51.403
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 100 step    24000 |     42 batches | lr 4.32e-05 | ms/batch 40.39 | loss  3.35 | ppl    28.402
total_loss: 29003.64585876465, total_len: 7360
total_loss: 31824.350494384766, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 120 at step    24000 | time:  6.94s | valid loss  3.94 | valid ppl    51.455
----------------------------------------------------------------------------------------------------
| epoch 100 step    24200 |    242 batches | lr 4.23e-05 | ms/batch 34.89 | loss  3.34 | ppl    28.186
total_loss: 29028.924644470215, total_len: 7360
total_loss: 31852.979667663574, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 121 at step    24200 | time:  6.97s | valid loss  3.94 | valid ppl    51.632
----------------------------------------------------------------------------------------------------
| epoch 101 step    24400 |    200 batches | lr 4.13e-05 | ms/batch 34.76 | loss  3.34 | ppl    28.216
total_loss: 29022.67594909668, total_len: 7360
total_loss: 31850.23777770996, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 122 at step    24400 | time:  6.86s | valid loss  3.94 | valid ppl    51.588
----------------------------------------------------------------------------------------------------
| epoch 102 step    24600 |    158 batches | lr 4.04e-05 | ms/batch 34.40 | loss  3.33 | ppl    28.048
total_loss: 29003.730003356934, total_len: 7360
total_loss: 31818.742881774902, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 123 at step    24600 | time:  6.97s | valid loss  3.94 | valid ppl    51.456
----------------------------------------------------------------------------------------------------
| epoch 103 step    24800 |    116 batches | lr 3.95e-05 | ms/batch 34.42 | loss  3.34 | ppl    28.125
total_loss: 29006.99836730957, total_len: 7360
total_loss: 31800.693618774414, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 124 at step    24800 | time:  6.89s | valid loss  3.94 | valid ppl    51.479
----------------------------------------------------------------------------------------------------
| epoch 104 step    25000 |     74 batches | lr 3.86e-05 | ms/batch 33.79 | loss  3.35 | ppl    28.469
total_loss: 28991.58568572998, total_len: 7360
total_loss: 31797.721855163574, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 125 at step    25000 | time:  6.45s | valid loss  3.94 | valid ppl    51.371
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 105 step    25200 |     32 batches | lr 3.77e-05 | ms/batch 34.67 | loss  3.33 | ppl    27.818
total_loss: 29002.177459716797, total_len: 7360
total_loss: 31822.73003387451, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 126 at step    25200 | time:  5.85s | valid loss  3.94 | valid ppl    51.445
----------------------------------------------------------------------------------------------------
| epoch 105 step    25400 |    232 batches | lr 3.68e-05 | ms/batch 29.24 | loss  3.32 | ppl    27.684
total_loss: 28975.965141296387, total_len: 7360
total_loss: 31786.36518096924, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 127 at step    25400 | time:  5.84s | valid loss  3.94 | valid ppl    51.262
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 106 step    25600 |    190 batches | lr 3.59e-05 | ms/batch 35.47 | loss  3.32 | ppl    27.681
total_loss: 28982.959434509277, total_len: 7360
total_loss: 31794.41618347168, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 128 at step    25600 | time:  5.88s | valid loss  3.94 | valid ppl    51.311
----------------------------------------------------------------------------------------------------
| epoch 107 step    25800 |    148 batches | lr 3.5e-05 | ms/batch 29.11 | loss  3.32 | ppl    27.586
total_loss: 28997.66986846924, total_len: 7360
total_loss: 31811.221855163574, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 129 at step    25800 | time:  5.82s | valid loss  3.94 | valid ppl    51.414
----------------------------------------------------------------------------------------------------
| epoch 108 step    26000 |    106 batches | lr 3.41e-05 | ms/batch 29.60 | loss  3.33 | ppl    27.838
total_loss: 28960.22437286377, total_len: 7360
total_loss: 31761.395362854004, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 130 at step    26000 | time:  5.93s | valid loss  3.93 | valid ppl    51.153
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 109 step    26200 |     64 batches | lr 3.33e-05 | ms/batch 34.96 | loss  3.33 | ppl    27.817
total_loss: 28917.71314239502, total_len: 7360
total_loss: 31725.879905700684, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 131 at step    26200 | time:  5.86s | valid loss  3.93 | valid ppl    50.858
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 110 step    26400 |     22 batches | lr 3.24e-05 | ms/batch 34.73 | loss  3.31 | ppl    27.402
total_loss: 28980.202934265137, total_len: 7360
total_loss: 31797.28074645996, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 132 at step    26400 | time:  5.85s | valid loss  3.94 | valid ppl    51.292
----------------------------------------------------------------------------------------------------
| epoch 110 step    26600 |    222 batches | lr 3.15e-05 | ms/batch 29.17 | loss  3.31 | ppl    27.400
total_loss: 28943.250038146973, total_len: 7360
total_loss: 31745.110107421875, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 133 at step    26600 | time:  5.83s | valid loss  3.93 | valid ppl    51.035
----------------------------------------------------------------------------------------------------
| epoch 111 step    26800 |    180 batches | lr 3.07e-05 | ms/batch 29.09 | loss  3.30 | ppl    27.181
total_loss: 28960.709953308105, total_len: 7360
total_loss: 31751.371131896973, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 134 at step    26800 | time:  5.82s | valid loss  3.93 | valid ppl    51.156
----------------------------------------------------------------------------------------------------
| epoch 112 step    27000 |    138 batches | lr 2.98e-05 | ms/batch 29.13 | loss  3.30 | ppl    27.214
total_loss: 28984.421981811523, total_len: 7360
total_loss: 31775.103050231934, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 135 at step    27000 | time:  5.82s | valid loss  3.94 | valid ppl    51.321
----------------------------------------------------------------------------------------------------
| epoch 113 step    27200 |     96 batches | lr 2.9e-05 | ms/batch 29.10 | loss  3.32 | ppl    27.588
total_loss: 28903.901832580566, total_len: 7360
total_loss: 31694.029983520508, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 136 at step    27200 | time:  5.82s | valid loss  3.93 | valid ppl    50.763
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 114 step    27400 |     54 batches | lr 2.82e-05 | ms/batch 35.51 | loss  3.31 | ppl    27.299
total_loss: 28891.83528137207, total_len: 7360
total_loss: 31691.076568603516, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 137 at step    27400 | time:  5.87s | valid loss  3.93 | valid ppl    50.679
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 115 step    27600 |     12 batches | lr 2.74e-05 | ms/batch 34.97 | loss  3.30 | ppl    26.983
total_loss: 28925.114616394043, total_len: 7360
total_loss: 31718.854499816895, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 138 at step    27600 | time:  5.86s | valid loss  3.93 | valid ppl    50.909
----------------------------------------------------------------------------------------------------
| epoch 115 step    27800 |    212 batches | lr 2.66e-05 | ms/batch 29.09 | loss  3.30 | ppl    26.989
total_loss: 28924.076873779297, total_len: 7360
total_loss: 31720.53702545166, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 139 at step    27800 | time:  5.82s | valid loss  3.93 | valid ppl    50.902
----------------------------------------------------------------------------------------------------
| epoch 116 step    28000 |    170 batches | lr 2.58e-05 | ms/batch 29.12 | loss  3.29 | ppl    26.834
total_loss: 28918.74673461914, total_len: 7360
total_loss: 31714.118934631348, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 140 at step    28000 | time:  5.81s | valid loss  3.93 | valid ppl    50.865
----------------------------------------------------------------------------------------------------
| epoch 117 step    28200 |    128 batches | lr 2.5e-05 | ms/batch 29.20 | loss  3.29 | ppl    26.925
total_loss: 28954.32583618164, total_len: 7360
total_loss: 31747.081970214844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 141 at step    28200 | time:  5.90s | valid loss  3.93 | valid ppl    51.112
----------------------------------------------------------------------------------------------------
| epoch 118 step    28400 |     86 batches | lr 2.42e-05 | ms/batch 29.41 | loss  3.31 | ppl    27.271
total_loss: 28878.751373291016, total_len: 7360
total_loss: 31663.16558074951, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 142 at step    28400 | time:  5.83s | valid loss  3.92 | valid ppl    50.589
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 119 step    28600 |     44 batches | lr 2.34e-05 | ms/batch 35.51 | loss  3.29 | ppl    26.831
total_loss: 28898.00675201416, total_len: 7360
total_loss: 31695.356353759766, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 143 at step    28600 | time:  5.89s | valid loss  3.93 | valid ppl    50.722
----------------------------------------------------------------------------------------------------
| epoch 120 step    28800 |      2 batches | lr 2.27e-05 | ms/batch 29.19 | loss  3.28 | ppl    26.691
total_loss: 28909.62099456787, total_len: 7360
total_loss: 31700.448455810547, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 144 at step    28800 | time:  5.85s | valid loss  3.93 | valid ppl    50.802
----------------------------------------------------------------------------------------------------
| epoch 120 step    29000 |    202 batches | lr 2.19e-05 | ms/batch 29.30 | loss  3.29 | ppl    26.718
total_loss: 28908.78254699707, total_len: 7360
total_loss: 31703.676383972168, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 145 at step    29000 | time:  5.84s | valid loss  3.93 | valid ppl    50.796
----------------------------------------------------------------------------------------------------
| epoch 121 step    29200 |    160 batches | lr 2.12e-05 | ms/batch 30.25 | loss  3.28 | ppl    26.585
total_loss: 28911.194343566895, total_len: 7360
total_loss: 31697.896018981934, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 146 at step    29200 | time:  6.07s | valid loss  3.93 | valid ppl    50.813
----------------------------------------------------------------------------------------------------
| epoch 122 step    29400 |    118 batches | lr 2.04e-05 | ms/batch 30.32 | loss  3.29 | ppl    26.712
total_loss: 28907.914222717285, total_len: 7360
total_loss: 31695.863471984863, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 147 at step    29400 | time:  6.04s | valid loss  3.93 | valid ppl    50.790
----------------------------------------------------------------------------------------------------
| epoch 123 step    29600 |     76 batches | lr 1.97e-05 | ms/batch 30.25 | loss  3.30 | ppl    27.043
total_loss: 28869.551429748535, total_len: 7360
total_loss: 31659.08501434326, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 148 at step    29600 | time:  6.04s | valid loss  3.92 | valid ppl    50.526
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 124 step    29800 |     34 batches | lr 1.9e-05 | ms/batch 35.77 | loss  3.28 | ppl    26.476
total_loss: 28901.44635772705, total_len: 7360
total_loss: 31697.31346130371, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 149 at step    29800 | time:  6.02s | valid loss  3.93 | valid ppl    50.746
----------------------------------------------------------------------------------------------------
| epoch 124 step    30000 |    234 batches | lr 1.83e-05 | ms/batch 29.99 | loss  3.27 | ppl    26.440
total_loss: 28897.680183410645, total_len: 7360
total_loss: 31689.807388305664, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 150 at step    30000 | time:  6.00s | valid loss  3.93 | valid ppl    50.720
----------------------------------------------------------------------------------------------------
| epoch 125 step    30200 |    192 batches | lr 1.76e-05 | ms/batch 30.43 | loss  3.27 | ppl    26.440
total_loss: 28876.07381439209, total_len: 7360
total_loss: 31662.715118408203, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 151 at step    30200 | time:  6.14s | valid loss  3.92 | valid ppl    50.571
----------------------------------------------------------------------------------------------------
| epoch 126 step    30400 |    150 batches | lr 1.69e-05 | ms/batch 31.23 | loss  3.27 | ppl    26.429
total_loss: 28904.194702148438, total_len: 7360
total_loss: 31699.01929473877, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 152 at step    30400 | time:  6.47s | valid loss  3.93 | valid ppl    50.765
----------------------------------------------------------------------------------------------------
| epoch 127 step    30600 |    108 batches | lr 1.63e-05 | ms/batch 35.12 | loss  3.28 | ppl    26.661
total_loss: 28883.83599090576, total_len: 7360
total_loss: 31670.61887359619, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 153 at step    30600 | time:  7.06s | valid loss  3.92 | valid ppl    50.624
----------------------------------------------------------------------------------------------------
| epoch 128 step    30800 |     66 batches | lr 1.56e-05 | ms/batch 34.89 | loss  3.28 | ppl    26.655
total_loss: 28864.693977355957, total_len: 7360
total_loss: 31653.75032043457, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 154 at step    30800 | time:  6.97s | valid loss  3.92 | valid ppl    50.493
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 129 step    31000 |     24 batches | lr 1.5e-05 | ms/batch 40.44 | loss  3.27 | ppl    26.232
total_loss: 28871.768836975098, total_len: 7360
total_loss: 31657.72996520996, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 155 at step    31000 | time:  6.96s | valid loss  3.92 | valid ppl    50.541
----------------------------------------------------------------------------------------------------
| epoch 129 step    31200 |    224 batches | lr 1.43e-05 | ms/batch 34.93 | loss  3.27 | ppl    26.265
total_loss: 28878.533798217773, total_len: 7360
total_loss: 31662.6990814209, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 156 at step    31200 | time:  6.99s | valid loss  3.92 | valid ppl    50.588
----------------------------------------------------------------------------------------------------
| epoch 130 step    31400 |    182 batches | lr 1.37e-05 | ms/batch 34.07 | loss  3.27 | ppl    26.239
total_loss: 28876.854461669922, total_len: 7360
total_loss: 31658.07689666748, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 157 at step    31400 | time:  6.82s | valid loss  3.92 | valid ppl    50.576
----------------------------------------------------------------------------------------------------
| epoch 131 step    31600 |    140 batches | lr 1.31e-05 | ms/batch 34.73 | loss  3.27 | ppl    26.231
total_loss: 28904.52451324463, total_len: 7360
total_loss: 31697.01170349121, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 158 at step    31600 | time:  6.96s | valid loss  3.93 | valid ppl    50.767
----------------------------------------------------------------------------------------------------
| epoch 132 step    31800 |     98 batches | lr 1.25e-05 | ms/batch 34.95 | loss  3.28 | ppl    26.599
total_loss: 28865.94278717041, total_len: 7360
total_loss: 31650.13296508789, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 159 at step    31800 | time:  6.98s | valid loss  3.92 | valid ppl    50.502
----------------------------------------------------------------------------------------------------
| epoch 133 step    32000 |     56 batches | lr 1.19e-05 | ms/batch 33.97 | loss  3.27 | ppl    26.400
total_loss: 28850.155700683594, total_len: 7360
total_loss: 31634.307502746582, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 160 at step    32000 | time:  6.80s | valid loss  3.92 | valid ppl    50.393
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 134 step    32200 |     14 batches | lr 1.14e-05 | ms/batch 43.22 | loss  3.26 | ppl    26.109
total_loss: 28875.231201171875, total_len: 7360
total_loss: 31661.315368652344, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 161 at step    32200 | time:  7.50s | valid loss  3.92 | valid ppl    50.565
----------------------------------------------------------------------------------------------------
| epoch 134 step    32400 |    214 batches | lr 1.08e-05 | ms/batch 36.34 | loss  3.26 | ppl    26.167
total_loss: 28863.763885498047, total_len: 7360
total_loss: 31650.69376373291, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 162 at step    32400 | time:  7.26s | valid loss  3.92 | valid ppl    50.487
----------------------------------------------------------------------------------------------------
| epoch 135 step    32600 |    172 batches | lr 1.03e-05 | ms/batch 34.77 | loss  3.26 | ppl    26.036
total_loss: 28869.324127197266, total_len: 7360
total_loss: 31658.925582885742, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 163 at step    32600 | time:  6.95s | valid loss  3.92 | valid ppl    50.525
----------------------------------------------------------------------------------------------------
| epoch 136 step    32800 |    130 batches | lr 9.73e-06 | ms/batch 35.79 | loss  3.26 | ppl    26.167
total_loss: 28899.959999084473, total_len: 7360
total_loss: 31692.10524749756, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 164 at step    32800 | time:  7.04s | valid loss  3.93 | valid ppl    50.735
----------------------------------------------------------------------------------------------------
| epoch 137 step    33000 |     88 batches | lr 9.21e-06 | ms/batch 34.72 | loss  3.28 | ppl    26.507
total_loss: 28853.651748657227, total_len: 7360
total_loss: 31634.380264282227, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 165 at step    33000 | time:  7.06s | valid loss  3.92 | valid ppl    50.417
----------------------------------------------------------------------------------------------------
| epoch 138 step    33200 |     46 batches | lr 8.7e-06 | ms/batch 36.50 | loss  3.26 | ppl    26.076
total_loss: 28860.849365234375, total_len: 7360
total_loss: 31647.035194396973, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 166 at step    33200 | time:  8.41s | valid loss  3.92 | valid ppl    50.467
----------------------------------------------------------------------------------------------------
| epoch 139 step    33400 |      4 batches | lr 8.21e-06 | ms/batch 31.78 | loss  3.26 | ppl    26.019
total_loss: 28867.222610473633, total_len: 7360
total_loss: 31651.86065673828, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 167 at step    33400 | time:  6.00s | valid loss  3.92 | valid ppl    50.510
----------------------------------------------------------------------------------------------------
| epoch 139 step    33600 |    204 batches | lr 7.73e-06 | ms/batch 29.78 | loss  3.26 | ppl    25.995
total_loss: 28864.06157684326, total_len: 7360
total_loss: 31650.58851623535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 168 at step    33600 | time:  5.97s | valid loss  3.92 | valid ppl    50.489
----------------------------------------------------------------------------------------------------
| epoch 140 step    33800 |    162 batches | lr 7.26e-06 | ms/batch 30.11 | loss  3.26 | ppl    26.025
total_loss: 28862.051528930664, total_len: 7360
total_loss: 31646.365142822266, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 169 at step    33800 | time:  6.01s | valid loss  3.92 | valid ppl    50.475
----------------------------------------------------------------------------------------------------
| epoch 141 step    34000 |    120 batches | lr 6.81e-06 | ms/batch 29.56 | loss  3.26 | ppl    26.015
total_loss: 28847.787017822266, total_len: 7360
total_loss: 31628.18253326416, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 170 at step    34000 | time:  5.90s | valid loss  3.92 | valid ppl    50.377
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 142 step    34200 |     78 batches | lr 6.37e-06 | ms/batch 34.24 | loss  3.28 | ppl    26.445
total_loss: 28850.987075805664, total_len: 7360
total_loss: 31635.18765258789, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 171 at step    34200 | time:  5.79s | valid loss  3.92 | valid ppl    50.399
----------------------------------------------------------------------------------------------------
| epoch 143 step    34400 |     36 batches | lr 5.95e-06 | ms/batch 28.93 | loss  3.25 | ppl    25.915
total_loss: 28861.971992492676, total_len: 7360
total_loss: 31647.663345336914, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 172 at step    34400 | time:  5.79s | valid loss  3.92 | valid ppl    50.474
----------------------------------------------------------------------------------------------------
| epoch 143 step    34600 |    236 batches | lr 5.54e-06 | ms/batch 28.95 | loss  3.25 | ppl    25.876
total_loss: 28862.98690032959, total_len: 7360
total_loss: 31648.419548034668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 173 at step    34600 | time:  5.78s | valid loss  3.92 | valid ppl    50.481
----------------------------------------------------------------------------------------------------
| epoch 144 step    34800 |    194 batches | lr 5.14e-06 | ms/batch 30.31 | loss  3.26 | ppl    25.929
total_loss: 28865.362449645996, total_len: 7360
total_loss: 31647.160972595215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 174 at step    34800 | time:  6.06s | valid loss  3.92 | valid ppl    50.498
----------------------------------------------------------------------------------------------------
| epoch 145 step    35000 |    152 batches | lr 4.76e-06 | ms/batch 30.11 | loss  3.26 | ppl    25.924
total_loss: 28866.94721221924, total_len: 7360
total_loss: 31653.621269226074, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 175 at step    35000 | time:  6.01s | valid loss  3.92 | valid ppl    50.508
----------------------------------------------------------------------------------------------------
| epoch 146 step    35200 |    110 batches | lr 4.39e-06 | ms/batch 30.09 | loss  3.26 | ppl    26.015
total_loss: 28846.148323059082, total_len: 7360
total_loss: 31626.73065185547, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 176 at step    35200 | time:  6.02s | valid loss  3.92 | valid ppl    50.366
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 147 step    35400 |     68 batches | lr 4.03e-06 | ms/batch 35.68 | loss  3.27 | ppl    26.254
total_loss: 28844.906784057617, total_len: 7360
total_loss: 31631.577323913574, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 177 at step    35400 | time:  6.01s | valid loss  3.92 | valid ppl    50.357
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 148 step    35600 |     26 batches | lr 3.69e-06 | ms/batch 35.87 | loss  3.25 | ppl    25.839
total_loss: 28861.224655151367, total_len: 7360
total_loss: 31647.829444885254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 178 at step    35600 | time:  6.01s | valid loss  3.92 | valid ppl    50.469
----------------------------------------------------------------------------------------------------
| epoch 148 step    35800 |    226 batches | lr 3.37e-06 | ms/batch 29.81 | loss  3.25 | ppl    25.814
total_loss: 28859.54389190674, total_len: 7360
total_loss: 31643.65940093994, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 179 at step    35800 | time:  5.97s | valid loss  3.92 | valid ppl    50.458
----------------------------------------------------------------------------------------------------
| epoch 149 step    36000 |    184 batches | lr 3.06e-06 | ms/batch 29.92 | loss  3.25 | ppl    25.785
total_loss: 28857.76732635498, total_len: 7360
total_loss: 31640.668418884277, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 180 at step    36000 | time:  5.99s | valid loss  3.92 | valid ppl    50.445
----------------------------------------------------------------------------------------------------
| epoch 150 step    36200 |    142 batches | lr 2.76e-06 | ms/batch 29.95 | loss  3.26 | ppl    25.954
total_loss: 28855.08455657959, total_len: 7360
total_loss: 31640.713287353516, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 181 at step    36200 | time:  6.07s | valid loss  3.92 | valid ppl    50.427
----------------------------------------------------------------------------------------------------
| epoch 151 step    36400 |    100 batches | lr 2.48e-06 | ms/batch 29.93 | loss  3.26 | ppl    26.100
total_loss: 28847.023468017578, total_len: 7360
total_loss: 31630.449058532715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 182 at step    36400 | time:  5.98s | valid loss  3.92 | valid ppl    50.372
----------------------------------------------------------------------------------------------------
| epoch 152 step    36600 |     58 batches | lr 2.22e-06 | ms/batch 29.83 | loss  3.26 | ppl    26.121
total_loss: 28846.365692138672, total_len: 7360
total_loss: 31632.368782043457, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 183 at step    36600 | time:  5.96s | valid loss  3.92 | valid ppl    50.367
----------------------------------------------------------------------------------------------------
| epoch 153 step    36800 |     16 batches | lr 1.96e-06 | ms/batch 29.78 | loss  3.25 | ppl    25.752
total_loss: 28854.05852508545, total_len: 7360
total_loss: 31638.85498046875, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 184 at step    36800 | time:  5.97s | valid loss  3.92 | valid ppl    50.420
----------------------------------------------------------------------------------------------------
| epoch 153 step    37000 |    216 batches | lr 1.73e-06 | ms/batch 29.85 | loss  3.25 | ppl    25.833
total_loss: 28849.045448303223, total_len: 7360
total_loss: 31632.84380340576, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 185 at step    37000 | time:  5.96s | valid loss  3.92 | valid ppl    50.386
----------------------------------------------------------------------------------------------------
| epoch 154 step    37200 |    174 batches | lr 1.51e-06 | ms/batch 29.83 | loss  3.25 | ppl    25.734
total_loss: 28853.839614868164, total_len: 7360
total_loss: 31638.196395874023, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 186 at step    37200 | time:  5.96s | valid loss  3.92 | valid ppl    50.419
----------------------------------------------------------------------------------------------------
| epoch 155 step    37400 |    132 batches | lr 1.3e-06 | ms/batch 29.84 | loss  3.25 | ppl    25.787
total_loss: 28848.73314666748, total_len: 7360
total_loss: 31632.35482788086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 187 at step    37400 | time:  5.96s | valid loss  3.92 | valid ppl    50.384
----------------------------------------------------------------------------------------------------
| epoch 156 step    37600 |     90 batches | lr 1.11e-06 | ms/batch 29.79 | loss  3.27 | ppl    26.267
total_loss: 28847.267219543457, total_len: 7360
total_loss: 31630.049240112305, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 188 at step    37600 | time:  5.95s | valid loss  3.92 | valid ppl    50.374
----------------------------------------------------------------------------------------------------
| epoch 157 step    37800 |     48 batches | lr 9.31e-07 | ms/batch 29.87 | loss  3.25 | ppl    25.864
total_loss: 28853.827743530273, total_len: 7360
total_loss: 31637.056640625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 189 at step    37800 | time:  5.98s | valid loss  3.92 | valid ppl    50.418
----------------------------------------------------------------------------------------------------
| epoch 158 step    38000 |      6 batches | lr 7.69e-07 | ms/batch 30.06 | loss  3.25 | ppl    25.720
total_loss: 28846.836166381836, total_len: 7360
total_loss: 31629.724617004395, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 190 at step    38000 | time:  6.00s | valid loss  3.92 | valid ppl    50.371
----------------------------------------------------------------------------------------------------
| epoch 158 step    38200 |    206 batches | lr 6.24e-07 | ms/batch 30.05 | loss  3.25 | ppl    25.768
total_loss: 28847.02544403076, total_len: 7360
total_loss: 31630.23528289795, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 191 at step    38200 | time:  6.01s | valid loss  3.92 | valid ppl    50.372
----------------------------------------------------------------------------------------------------
| epoch 159 step    38400 |    164 batches | lr 4.93e-07 | ms/batch 30.08 | loss  3.25 | ppl    25.817
total_loss: 28849.124183654785, total_len: 7360
total_loss: 31632.36920928955, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 192 at step    38400 | time:  6.07s | valid loss  3.92 | valid ppl    50.386
----------------------------------------------------------------------------------------------------
| epoch 160 step    38600 |    122 batches | lr 3.77e-07 | ms/batch 30.37 | loss  3.25 | ppl    25.823
total_loss: 28846.08098602295, total_len: 7360
total_loss: 31628.412307739258, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 193 at step    38600 | time:  6.09s | valid loss  3.92 | valid ppl    50.365
----------------------------------------------------------------------------------------------------
| epoch 161 step    38800 |     80 batches | lr 2.77e-07 | ms/batch 30.45 | loss  3.27 | ppl    26.296
total_loss: 28848.045875549316, total_len: 7360
total_loss: 31631.0435256958, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 194 at step    38800 | time:  6.02s | valid loss  3.92 | valid ppl    50.379
----------------------------------------------------------------------------------------------------
| epoch 162 step    39000 |     38 batches | lr 1.93e-07 | ms/batch 30.22 | loss  3.25 | ppl    25.691
total_loss: 28849.142448425293, total_len: 7360
total_loss: 31632.099166870117, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 195 at step    39000 | time:  6.03s | valid loss  3.92 | valid ppl    50.386
----------------------------------------------------------------------------------------------------
| epoch 162 step    39200 |    238 batches | lr 1.23e-07 | ms/batch 32.73 | loss  3.25 | ppl    25.720
total_loss: 28849.193504333496, total_len: 7360
total_loss: 31632.386810302734, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 196 at step    39200 | time:  6.85s | valid loss  3.92 | valid ppl    50.387
----------------------------------------------------------------------------------------------------
| epoch 163 step    39400 |    196 batches | lr 6.94e-08 | ms/batch 34.48 | loss  3.25 | ppl    25.768
total_loss: 28848.910888671875, total_len: 7360
total_loss: 31632.1199798584, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 197 at step    39400 | time:  6.91s | valid loss  3.92 | valid ppl    50.385
----------------------------------------------------------------------------------------------------
| epoch 164 step    39600 |    154 batches | lr 3.08e-08 | ms/batch 35.45 | loss  3.25 | ppl    25.724
total_loss: 28848.54035949707, total_len: 7360
total_loss: 31631.69229888916, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 198 at step    39600 | time:  6.88s | valid loss  3.92 | valid ppl    50.382
----------------------------------------------------------------------------------------------------
| epoch 165 step    39800 |    112 batches | lr 7.71e-09 | ms/batch 34.44 | loss  3.26 | ppl    25.926
total_loss: 28848.283432006836, total_len: 7360
total_loss: 31631.38027191162, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 199 at step    39800 | time:  7.11s | valid loss  3.92 | valid ppl    50.380
----------------------------------------------------------------------------------------------------
| epoch 166 step    40000 |     70 batches | lr 0 | ms/batch 35.21 | loss  3.27 | ppl    26.183
total_loss: 28848.33115386963, total_len: 7360
total_loss: 31631.439094543457, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 200 at step    40000 | time:  7.04s | valid loss  3.92 | valid ppl    50.381
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
End of training
total_loss: 31631.577323913574, total_len: 8224
====================================================================================================
| End of training | test loss  3.85 | test ppl    46.817
====================================================================================================
