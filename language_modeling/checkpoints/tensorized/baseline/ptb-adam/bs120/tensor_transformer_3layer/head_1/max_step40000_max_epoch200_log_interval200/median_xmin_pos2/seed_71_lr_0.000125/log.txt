Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 71
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_71_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
total_loss: 71305.38400268555, total_len: 7744
total_loss: 75733.5317993164, total_len: 8224
total_loss: 67787.81530761719, total_len: 7360
| Start of training | test loss  9.21 | test bpc 9985.04594
| epoch   1 step      200 |    200 batches | lr 0.000125 | ms/batch 40.42 | loss  7.05 | ppl  1151.995
total_loss: 45562.351150512695, total_len: 7360
total_loss: 50539.71376037598, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   1 at step      200 | time:  9.49s | valid loss  6.19 | valid ppl   488.108
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   2 step      400 |    158 batches | lr 0.000125 | ms/batch 39.25 | loss  6.08 | ppl   435.028
total_loss: 42755.67807006836, total_len: 7360
total_loss: 47375.191177368164, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   2 at step      400 | time:  6.75s | valid loss  5.81 | valid ppl   333.351
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   3 step      600 |    116 batches | lr 0.000125 | ms/batch 38.57 | loss  5.80 | ppl   329.189
total_loss: 41353.83596801758, total_len: 7360
total_loss: 45794.00099182129, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   3 at step      600 | time:  6.77s | valid loss  5.62 | valid ppl   275.539
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   4 step      800 |     74 batches | lr 0.000125 | ms/batch 41.20 | loss  5.65 | ppl   283.580
total_loss: 40524.57647705078, total_len: 7360
total_loss: 44834.937728881836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   4 at step      800 | time:  7.23s | valid loss  5.51 | valid ppl   246.178
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1000 |     32 batches | lr 0.000125 | ms/batch 40.72 | loss  5.52 | ppl   249.912
total_loss: 39924.97303771973, total_len: 7360
total_loss: 44157.593185424805, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1000 | time:  6.64s | valid loss  5.42 | valid ppl   226.918
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1200 |    232 batches | lr 0.000125 | ms/batch 36.76 | loss  5.43 | ppl   227.884
total_loss: 39440.73085021973, total_len: 7360
total_loss: 43641.316482543945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1200 | time:  6.20s | valid loss  5.36 | valid ppl   212.469
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   6 step     1400 |    190 batches | lr 0.000125 | ms/batch 36.77 | loss  5.36 | ppl   212.312
total_loss: 39022.14125061035, total_len: 7360
total_loss: 43146.14389038086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1400 | time:  6.22s | valid loss  5.30 | valid ppl   200.722
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   7 step     1600 |    148 batches | lr 0.000125 | ms/batch 37.46 | loss  5.29 | ppl   198.815
total_loss: 38648.93908691406, total_len: 7360
total_loss: 42737.298751831055, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   8 at step     1600 | time:  6.37s | valid loss  5.25 | valid ppl   190.798
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   8 step     1800 |    106 batches | lr 0.000124 | ms/batch 36.95 | loss  5.24 | ppl   188.909
total_loss: 38278.81700134277, total_len: 7360
total_loss: 42307.20149230957, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   9 at step     1800 | time:  6.24s | valid loss  5.20 | valid ppl   181.440
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   9 step     2000 |     64 batches | lr 0.000124 | ms/batch 36.77 | loss  5.18 | ppl   178.573
total_loss: 37888.13185119629, total_len: 7360
total_loss: 41879.925552368164, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2000 | time:  6.17s | valid loss  5.15 | valid ppl   172.060
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2200 |     22 batches | lr 0.000124 | ms/batch 37.47 | loss  5.11 | ppl   166.310
total_loss: 37517.77072143555, total_len: 7360
total_loss: 41471.90673828125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2200 | time:  6.39s | valid loss  5.10 | valid ppl   163.616
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2400 |    222 batches | lr 0.000124 | ms/batch 37.48 | loss  5.06 | ppl   157.870
total_loss: 37160.479553222656, total_len: 7360
total_loss: 41088.50750732422, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  12 at step     2400 | time:  6.37s | valid loss  5.05 | valid ppl   155.863
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  11 step     2600 |    180 batches | lr 0.000124 | ms/batch 37.23 | loss  5.01 | ppl   149.411
total_loss: 36807.47261047363, total_len: 7360
total_loss: 40687.10073852539, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  13 at step     2600 | time:  6.33s | valid loss  5.00 | valid ppl   148.564
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  12 step     2800 |    138 batches | lr 0.000123 | ms/batch 37.84 | loss  4.95 | ppl   141.798
total_loss: 36478.39981842041, total_len: 7360
total_loss: 40311.25059509277, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  14 at step     2800 | time:  6.34s | valid loss  4.96 | valid ppl   142.068
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  13 step     3000 |     96 batches | lr 0.000123 | ms/batch 36.96 | loss  4.92 | ppl   136.351
total_loss: 36106.16110992432, total_len: 7360
total_loss: 39900.2223815918, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3000 | time:  6.18s | valid loss  4.91 | valid ppl   135.061
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  14 step     3200 |     54 batches | lr 0.000123 | ms/batch 37.19 | loss  4.85 | ppl   127.838
total_loss: 35768.729568481445, total_len: 7360
total_loss: 39520.30114746094, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  16 at step     3200 | time:  6.33s | valid loss  4.86 | valid ppl   129.009
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3400 |     12 batches | lr 0.000123 | ms/batch 37.27 | loss  4.79 | ppl   120.369
total_loss: 35388.12815093994, total_len: 7360
total_loss: 39095.468002319336, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  17 at step     3400 | time:  6.37s | valid loss  4.81 | valid ppl   122.507
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3600 |    212 batches | lr 0.000123 | ms/batch 37.67 | loss  4.74 | ppl   114.230
total_loss: 35041.67392730713, total_len: 7360
total_loss: 38708.10684967041, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  18 at step     3600 | time:  6.39s | valid loss  4.76 | valid ppl   116.874
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  16 step     3800 |    170 batches | lr 0.000122 | ms/batch 37.07 | loss  4.68 | ppl   107.955
total_loss: 34670.867012023926, total_len: 7360
total_loss: 38296.71910858154, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  19 at step     3800 | time:  6.30s | valid loss  4.71 | valid ppl   111.132
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  17 step     4000 |    128 batches | lr 0.000122 | ms/batch 38.10 | loss  4.63 | ppl   102.652
total_loss: 34441.63433074951, total_len: 7360
total_loss: 38044.89872741699, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  20 at step     4000 | time:  6.44s | valid loss  4.68 | valid ppl   107.724
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  18 step     4200 |     86 batches | lr 0.000122 | ms/batch 37.62 | loss  4.60 | ppl    99.574
total_loss: 34086.022468566895, total_len: 7360
total_loss: 37640.693298339844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  21 at step     4200 | time:  6.39s | valid loss  4.63 | valid ppl   102.643
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  19 step     4400 |     44 batches | lr 0.000121 | ms/batch 37.47 | loss  4.54 | ppl    93.459
total_loss: 33803.74239349365, total_len: 7360
total_loss: 37327.255615234375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  22 at step     4400 | time:  7.54s | valid loss  4.59 | valid ppl    98.780
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4600 |      2 batches | lr 0.000121 | ms/batch 38.83 | loss  4.49 | ppl    89.182
total_loss: 33550.14311981201, total_len: 7360
total_loss: 37066.44216918945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  23 at step     4600 | time:  6.39s | valid loss  4.56 | valid ppl    95.435
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4800 |    202 batches | lr 0.000121 | ms/batch 37.61 | loss  4.45 | ppl    85.846
total_loss: 33379.251304626465, total_len: 7360
total_loss: 36886.77533721924, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  24 at step     4800 | time:  6.40s | valid loss  4.54 | valid ppl    93.244
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  21 step     5000 |    160 batches | lr 0.00012 | ms/batch 37.74 | loss  4.42 | ppl    82.738
total_loss: 33181.14273071289, total_len: 7360
total_loss: 36662.850646972656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  25 at step     5000 | time:  6.37s | valid loss  4.51 | valid ppl    90.768
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  22 step     5200 |    118 batches | lr 0.00012 | ms/batch 37.90 | loss  4.38 | ppl    79.909
total_loss: 32973.455253601074, total_len: 7360
total_loss: 36415.81368255615, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  26 at step     5200 | time:  6.43s | valid loss  4.48 | valid ppl    88.243
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  23 step     5400 |     76 batches | lr 0.000119 | ms/batch 37.55 | loss  4.36 | ppl    78.594
total_loss: 32779.63683319092, total_len: 7360
total_loss: 36201.286697387695, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  27 at step     5400 | time:  6.40s | valid loss  4.45 | valid ppl    85.949
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5600 |     34 batches | lr 0.000119 | ms/batch 37.63 | loss  4.31 | ppl    74.428
total_loss: 32677.827407836914, total_len: 7360
total_loss: 36097.619705200195, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  28 at step     5600 | time:  6.39s | valid loss  4.44 | valid ppl    84.768
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5800 |    234 batches | lr 0.000119 | ms/batch 37.85 | loss  4.28 | ppl    72.176
total_loss: 32540.04722595215, total_len: 7360
total_loss: 35967.62593841553, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  29 at step     5800 | time:  6.40s | valid loss  4.42 | valid ppl    83.196
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  25 step     6000 |    192 batches | lr 0.000118 | ms/batch 37.73 | loss  4.25 | ppl    70.391
total_loss: 32332.162567138672, total_len: 7360
total_loss: 35725.917877197266, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  30 at step     6000 | time:  6.37s | valid loss  4.39 | valid ppl    80.879
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  26 step     6200 |    150 batches | lr 0.000118 | ms/batch 38.14 | loss  4.22 | ppl    68.327
total_loss: 32213.9375, total_len: 7360
total_loss: 35564.27359008789, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  31 at step     6200 | time:  6.39s | valid loss  4.38 | valid ppl    79.590
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  27 step     6400 |    108 batches | lr 0.000117 | ms/batch 36.58 | loss  4.21 | ppl    67.089
total_loss: 32112.982131958008, total_len: 7360
total_loss: 35466.68202972412, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  32 at step     6400 | time:  6.37s | valid loss  4.36 | valid ppl    78.506
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  28 step     6600 |     66 batches | lr 0.000117 | ms/batch 37.98 | loss  4.19 | ppl    65.910
total_loss: 31993.129554748535, total_len: 7360
total_loss: 35322.50890350342, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  33 at step     6600 | time:  6.42s | valid loss  4.35 | valid ppl    77.238
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     6800 |     24 batches | lr 0.000116 | ms/batch 38.25 | loss  4.15 | ppl    63.308
total_loss: 31899.234329223633, total_len: 7360
total_loss: 35236.59242248535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  34 at step     6800 | time:  6.40s | valid loss  4.33 | valid ppl    76.259
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     7000 |    224 batches | lr 0.000116 | ms/batch 37.28 | loss  4.13 | ppl    61.985
total_loss: 31857.17808532715, total_len: 7360
total_loss: 35184.88523101807, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  35 at step     7000 | time:  6.40s | valid loss  4.33 | valid ppl    75.824
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  30 step     7200 |    182 batches | lr 0.000115 | ms/batch 38.04 | loss  4.11 | ppl    60.796
total_loss: 31714.93009185791, total_len: 7360
total_loss: 35005.05791473389, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  36 at step     7200 | time:  6.43s | valid loss  4.31 | valid ppl    74.373
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  31 step     7400 |    140 batches | lr 0.000115 | ms/batch 37.79 | loss  4.09 | ppl    59.745
total_loss: 31673.287284851074, total_len: 7360
total_loss: 34946.77080535889, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  37 at step     7400 | time:  6.39s | valid loss  4.30 | valid ppl    73.953
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  32 step     7600 |     98 batches | lr 0.000114 | ms/batch 36.68 | loss  4.08 | ppl    59.351
total_loss: 31580.107498168945, total_len: 7360
total_loss: 34844.1559753418, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  38 at step     7600 | time:  6.37s | valid loss  4.29 | valid ppl    73.023
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  33 step     7800 |     56 batches | lr 0.000114 | ms/batch 37.62 | loss  4.06 | ppl    57.931
total_loss: 31516.26788330078, total_len: 7360
total_loss: 34771.38854217529, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  39 at step     7800 | time:  6.37s | valid loss  4.28 | valid ppl    72.392
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8000 |     14 batches | lr 0.000113 | ms/batch 37.18 | loss  4.03 | ppl    56.297
total_loss: 31473.110633850098, total_len: 7360
total_loss: 34733.60021972656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  40 at step     8000 | time:  6.34s | valid loss  4.28 | valid ppl    71.969
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8200 |    214 batches | lr 0.000112 | ms/batch 37.33 | loss  4.02 | ppl    55.581
total_loss: 31420.48056793213, total_len: 7360
total_loss: 34642.59041595459, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  41 at step     8200 | time:  6.36s | valid loss  4.27 | valid ppl    71.456
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  35 step     8400 |    172 batches | lr 0.000112 | ms/batch 38.04 | loss  4.00 | ppl    54.440
total_loss: 31394.622596740723, total_len: 7360
total_loss: 34607.924880981445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  42 at step     8400 | time:  6.37s | valid loss  4.27 | valid ppl    71.206
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  36 step     8600 |    130 batches | lr 0.000111 | ms/batch 37.74 | loss  3.98 | ppl    53.708
total_loss: 31303.66332244873, total_len: 7360
total_loss: 34513.7825012207, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  43 at step     8600 | time:  6.39s | valid loss  4.25 | valid ppl    70.331
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  37 step     8800 |     88 batches | lr 0.000111 | ms/batch 37.53 | loss  3.99 | ppl    53.842
total_loss: 31210.6934967041, total_len: 7360
total_loss: 34405.71738433838, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  44 at step     8800 | time:  6.41s | valid loss  4.24 | valid ppl    69.448
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  38 step     9000 |     46 batches | lr 0.00011 | ms/batch 37.78 | loss  3.96 | ppl    52.207
total_loss: 31182.489616394043, total_len: 7360
total_loss: 34371.789710998535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  45 at step     9000 | time:  6.40s | valid loss  4.24 | valid ppl    69.183
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9200 |      4 batches | lr 0.000109 | ms/batch 37.57 | loss  3.94 | ppl    51.235
total_loss: 31121.217208862305, total_len: 7360
total_loss: 34312.29656982422, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  46 at step     9200 | time:  6.36s | valid loss  4.23 | valid ppl    68.609
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9400 |    204 batches | lr 0.000109 | ms/batch 37.84 | loss  3.92 | ppl    50.619
total_loss: 31052.49153137207, total_len: 7360
total_loss: 34234.14165496826, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  47 at step     9400 | time:  6.40s | valid loss  4.22 | valid ppl    67.972
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  40 step     9600 |    162 batches | lr 0.000108 | ms/batch 37.62 | loss  3.91 | ppl    49.914
total_loss: 31114.845993041992, total_len: 7360
total_loss: 34286.58804321289, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  48 at step     9600 | time:  6.42s | valid loss  4.23 | valid ppl    68.550
----------------------------------------------------------------------------------------------------
| epoch  41 step     9800 |    120 batches | lr 0.000107 | ms/batch 31.76 | loss  3.90 | ppl    49.362
total_loss: 31040.645179748535, total_len: 7360
total_loss: 34192.01175689697, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  49 at step     9800 | time:  6.36s | valid loss  4.22 | valid ppl    67.862
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  42 step    10000 |     78 batches | lr 0.000107 | ms/batch 37.65 | loss  3.91 | ppl    49.651
total_loss: 30959.300132751465, total_len: 7360
total_loss: 34091.388511657715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  50 at step    10000 | time:  6.35s | valid loss  4.21 | valid ppl    67.116
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10200 |     36 batches | lr 0.000106 | ms/batch 37.38 | loss  3.87 | ppl    48.012
total_loss: 30916.07593536377, total_len: 7360
total_loss: 34056.35440826416, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  51 at step    10200 | time:  6.38s | valid loss  4.20 | valid ppl    66.723
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10400 |    236 batches | lr 0.000105 | ms/batch 37.44 | loss  3.86 | ppl    47.331
total_loss: 30937.072647094727, total_len: 7360
total_loss: 34091.46204376221, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  52 at step    10400 | time:  6.35s | valid loss  4.20 | valid ppl    66.914
----------------------------------------------------------------------------------------------------
| epoch  44 step    10600 |    194 batches | lr 0.000105 | ms/batch 31.61 | loss  3.85 | ppl    47.006
total_loss: 30896.027252197266, total_len: 7360
total_loss: 34015.64463043213, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  53 at step    10600 | time:  6.31s | valid loss  4.20 | valid ppl    66.542
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  45 step    10800 |    152 batches | lr 0.000104 | ms/batch 37.38 | loss  3.84 | ppl    46.438
total_loss: 30846.5121383667, total_len: 7360
total_loss: 33954.06386566162, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  54 at step    10800 | time:  6.35s | valid loss  4.19 | valid ppl    66.096
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  46 step    11000 |    110 batches | lr 0.000103 | ms/batch 37.44 | loss  3.84 | ppl    46.332
total_loss: 30778.16967010498, total_len: 7360
total_loss: 33882.78412628174, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  55 at step    11000 | time:  6.37s | valid loss  4.18 | valid ppl    65.485
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  47 step    11200 |     68 batches | lr 0.000102 | ms/batch 38.02 | loss  3.83 | ppl    46.135
total_loss: 30741.631950378418, total_len: 7360
total_loss: 33850.47644042969, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  56 at step    11200 | time:  6.42s | valid loss  4.18 | valid ppl    65.160
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11400 |     26 batches | lr 0.000102 | ms/batch 37.47 | loss  3.80 | ppl    44.864
total_loss: 30752.640838623047, total_len: 7360
total_loss: 33853.07130432129, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  57 at step    11400 | time:  6.36s | valid loss  4.18 | valid ppl    65.258
----------------------------------------------------------------------------------------------------
| epoch  48 step    11600 |    226 batches | lr 0.000101 | ms/batch 31.72 | loss  3.79 | ppl    44.392
total_loss: 30757.22248840332, total_len: 7360
total_loss: 33859.96291351318, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  58 at step    11600 | time:  6.39s | valid loss  4.18 | valid ppl    65.299
----------------------------------------------------------------------------------------------------
| epoch  49 step    11800 |    184 batches | lr 0.0001 | ms/batch 32.72 | loss  3.79 | ppl    44.050
total_loss: 30665.621910095215, total_len: 7360
total_loss: 33742.798919677734, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  59 at step    11800 | time:  6.49s | valid loss  4.17 | valid ppl    64.491
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  50 step    12000 |    142 batches | lr 9.92e-05 | ms/batch 39.76 | loss  3.78 | ppl    43.848
total_loss: 30674.042289733887, total_len: 7360
total_loss: 33745.23405456543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  60 at step    12000 | time:  6.81s | valid loss  4.17 | valid ppl    64.565
----------------------------------------------------------------------------------------------------
| epoch  51 step    12200 |    100 batches | lr 9.84e-05 | ms/batch 30.74 | loss  3.78 | ppl    43.724
total_loss: 30634.10395050049, total_len: 7360
total_loss: 33709.79421234131, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  61 at step    12200 | time:  6.15s | valid loss  4.16 | valid ppl    64.215
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  52 step    12400 |     58 batches | lr 9.76e-05 | ms/batch 36.46 | loss  3.77 | ppl    43.308
total_loss: 30616.19652557373, total_len: 7360
total_loss: 33696.08459472656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  62 at step    12400 | time:  6.16s | valid loss  4.16 | valid ppl    64.059
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12600 |     16 batches | lr 9.68e-05 | ms/batch 36.55 | loss  3.75 | ppl    42.412
total_loss: 30611.08731842041, total_len: 7360
total_loss: 33686.72798156738, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  63 at step    12600 | time:  6.16s | valid loss  4.16 | valid ppl    64.015
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12800 |    216 batches | lr 9.6e-05 | ms/batch 44.68 | loss  3.74 | ppl    42.123
total_loss: 30548.496116638184, total_len: 7360
total_loss: 33602.08673095703, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  64 at step    12800 | time:  6.17s | valid loss  4.15 | valid ppl    63.473
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  54 step    13000 |    174 batches | lr 9.52e-05 | ms/batch 37.57 | loss  3.73 | ppl    41.660
total_loss: 30607.15380859375, total_len: 7360
total_loss: 33663.17401885986, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  65 at step    13000 | time:  6.36s | valid loss  4.16 | valid ppl    63.981
----------------------------------------------------------------------------------------------------
| epoch  55 step    13200 |    132 batches | lr 9.43e-05 | ms/batch 31.77 | loss  3.72 | ppl    41.428
total_loss: 30561.047164916992, total_len: 7360
total_loss: 33606.02258300781, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  66 at step    13200 | time:  6.36s | valid loss  4.15 | valid ppl    63.581
----------------------------------------------------------------------------------------------------
| epoch  56 step    13400 |     90 batches | lr 9.35e-05 | ms/batch 31.78 | loss  3.73 | ppl    41.784
total_loss: 30539.640419006348, total_len: 7360
total_loss: 33580.86811065674, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  67 at step    13400 | time:  6.35s | valid loss  4.15 | valid ppl    63.396
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  57 step    13600 |     48 batches | lr 9.26e-05 | ms/batch 37.59 | loss  3.71 | ppl    40.842
total_loss: 30513.081787109375, total_len: 7360
total_loss: 33575.818099975586, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  68 at step    13600 | time:  6.37s | valid loss  4.15 | valid ppl    63.168
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    13800 |      6 batches | lr 9.17e-05 | ms/batch 37.97 | loss  3.70 | ppl    40.324
total_loss: 30485.76722717285, total_len: 7360
total_loss: 33525.26036834717, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  69 at step    13800 | time:  6.42s | valid loss  4.14 | valid ppl    62.934
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    14000 |    206 batches | lr 9.09e-05 | ms/batch 37.72 | loss  3.69 | ppl    40.084
total_loss: 30489.56965637207, total_len: 7360
total_loss: 33525.11528015137, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  70 at step    14000 | time:  6.36s | valid loss  4.14 | valid ppl    62.967
----------------------------------------------------------------------------------------------------
| epoch  59 step    14200 |    164 batches | lr 9e-05 | ms/batch 31.65 | loss  3.68 | ppl    39.795
total_loss: 30431.01188659668, total_len: 7360
total_loss: 33469.059425354004, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  71 at step    14200 | time:  6.33s | valid loss  4.13 | valid ppl    62.468
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  60 step    14400 |    122 batches | lr 8.91e-05 | ms/batch 37.44 | loss  3.68 | ppl    39.552
total_loss: 30454.079513549805, total_len: 7360
total_loss: 33485.515045166016, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  72 at step    14400 | time:  6.36s | valid loss  4.14 | valid ppl    62.664
----------------------------------------------------------------------------------------------------
| epoch  61 step    14600 |     80 batches | lr 8.82e-05 | ms/batch 31.61 | loss  3.69 | ppl    40.082
total_loss: 30420.157913208008, total_len: 7360
total_loss: 33425.946128845215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  73 at step    14600 | time:  6.33s | valid loss  4.13 | valid ppl    62.376
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    14800 |     38 batches | lr 8.73e-05 | ms/batch 37.36 | loss  3.66 | ppl    38.862
total_loss: 30410.587631225586, total_len: 7360
total_loss: 33442.52175140381, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  74 at step    14800 | time:  6.37s | valid loss  4.13 | valid ppl    62.295
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    15000 |    238 batches | lr 8.64e-05 | ms/batch 37.12 | loss  3.65 | ppl    38.666
total_loss: 30424.686889648438, total_len: 7360
total_loss: 33471.33596038818, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  75 at step    15000 | time:  6.36s | valid loss  4.13 | valid ppl    62.414
----------------------------------------------------------------------------------------------------
| epoch  63 step    15200 |    196 batches | lr 8.55e-05 | ms/batch 31.68 | loss  3.65 | ppl    38.472
total_loss: 30367.0023727417, total_len: 7360
total_loss: 33393.77812957764, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  76 at step    15200 | time:  6.32s | valid loss  4.13 | valid ppl    61.927
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  64 step    15400 |    154 batches | lr 8.46e-05 | ms/batch 37.27 | loss  3.64 | ppl    38.140
total_loss: 30349.000946044922, total_len: 7360
total_loss: 33349.55578613281, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  77 at step    15400 | time:  6.37s | valid loss  4.12 | valid ppl    61.775
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  65 step    15600 |    112 batches | lr 8.37e-05 | ms/batch 37.35 | loss  3.64 | ppl    38.181
total_loss: 30285.390937805176, total_len: 7360
total_loss: 33290.283699035645, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  78 at step    15600 | time:  6.35s | valid loss  4.11 | valid ppl    61.244
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  66 step    15800 |     70 batches | lr 8.27e-05 | ms/batch 37.30 | loss  3.65 | ppl    38.298
total_loss: 30294.89779663086, total_len: 7360
total_loss: 33292.20671081543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  79 at step    15800 | time:  6.38s | valid loss  4.12 | valid ppl    61.323
----------------------------------------------------------------------------------------------------
| epoch  67 step    16000 |     28 batches | lr 8.18e-05 | ms/batch 31.85 | loss  3.62 | ppl    37.346
total_loss: 30301.25513458252, total_len: 7360
total_loss: 33291.48484802246, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  80 at step    16000 | time:  6.38s | valid loss  4.12 | valid ppl    61.376
----------------------------------------------------------------------------------------------------
| epoch  67 step    16200 |    228 batches | lr 8.09e-05 | ms/batch 31.93 | loss  3.61 | ppl    37.131
total_loss: 30341.66527557373, total_len: 7360
total_loss: 33327.43283843994, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  81 at step    16200 | time:  6.36s | valid loss  4.12 | valid ppl    61.714
----------------------------------------------------------------------------------------------------
| epoch  68 step    16400 |    186 batches | lr 7.99e-05 | ms/batch 31.87 | loss  3.61 | ppl    37.063
total_loss: 30317.002449035645, total_len: 7360
total_loss: 33283.39813995361, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  82 at step    16400 | time:  6.37s | valid loss  4.12 | valid ppl    61.507
----------------------------------------------------------------------------------------------------
| epoch  69 step    16600 |    144 batches | lr 7.9e-05 | ms/batch 31.78 | loss  3.61 | ppl    36.816
total_loss: 30277.763359069824, total_len: 7360
total_loss: 33241.82819366455, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  83 at step    16600 | time:  6.36s | valid loss  4.11 | valid ppl    61.180
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  70 step    16800 |    102 batches | lr 7.8e-05 | ms/batch 20407.13 | loss  3.61 | ppl    37.016
total_loss: 30274.97816467285, total_len: 7360
total_loss: 33263.07447052002, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  84 at step    16800 | time:  6.56s | valid loss  4.11 | valid ppl    61.157
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  71 step    17000 |     60 batches | lr 7.71e-05 | ms/batch 38.96 | loss  3.60 | ppl    36.763
total_loss: 30243.928855895996, total_len: 7360
total_loss: 33217.0407409668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  85 at step    17000 | time:  6.63s | valid loss  4.11 | valid ppl    60.900
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17200 |     18 batches | lr 7.61e-05 | ms/batch 38.72 | loss  3.59 | ppl    36.120
total_loss: 30228.141090393066, total_len: 7360
total_loss: 33227.03924560547, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  86 at step    17200 | time:  6.48s | valid loss  4.11 | valid ppl    60.769
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17400 |    218 batches | lr 7.52e-05 | ms/batch 40.68 | loss  3.58 | ppl    35.945
total_loss: 30213.933624267578, total_len: 7360
total_loss: 33185.4254989624, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  87 at step    17400 | time:  7.54s | valid loss  4.11 | valid ppl    60.652
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
----------------------------------------------------------------------------------------------------
Exiting from training early
total_loss: 33185.4254989624, total_len: 8224
====================================================================================================
| End of training | test loss  4.04 | test ppl    56.554
====================================================================================================
Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 71
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_71_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
total_loss: 71305.38400268555, total_len: 7744
total_loss: 75733.5317993164, total_len: 8224
total_loss: 67787.81530761719, total_len: 7360
| Start of training | test loss  9.21 | test bpc 9985.04594
| epoch   1 step      200 |    200 batches | lr 0.000125 | ms/batch 41.27 | loss  7.05 | ppl  1151.995
total_loss: 45562.351150512695, total_len: 7360
total_loss: 50539.71376037598, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   1 at step      200 | time:  9.67s | valid loss  6.19 | valid ppl   488.108
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   2 step      400 |    158 batches | lr 0.000125 | ms/batch 41.46 | loss  6.08 | ppl   435.028
total_loss: 42755.67807006836, total_len: 7360
total_loss: 47375.191177368164, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   2 at step      400 | time:  6.87s | valid loss  5.81 | valid ppl   333.351
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   3 step      600 |    116 batches | lr 0.000125 | ms/batch 45.95 | loss  5.80 | ppl   329.189
total_loss: 41353.83596801758, total_len: 7360
total_loss: 45794.00099182129, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   3 at step      600 | time:  6.74s | valid loss  5.62 | valid ppl   275.539
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   4 step      800 |     74 batches | lr 0.000125 | ms/batch 44.36 | loss  5.65 | ppl   283.580
total_loss: 40524.57647705078, total_len: 7360
total_loss: 44834.937728881836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   4 at step      800 | time:  7.71s | valid loss  5.51 | valid ppl   246.178
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1000 |     32 batches | lr 0.000125 | ms/batch 45.17 | loss  5.52 | ppl   249.912
total_loss: 39924.97303771973, total_len: 7360
total_loss: 44157.593185424805, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1000 | time:  6.64s | valid loss  5.42 | valid ppl   226.918
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1200 |    232 batches | lr 0.000125 | ms/batch 40.48 | loss  5.43 | ppl   227.884
total_loss: 39440.73085021973, total_len: 7360
total_loss: 43641.316482543945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1200 | time:  6.65s | valid loss  5.36 | valid ppl   212.469
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   6 step     1400 |    190 batches | lr 0.000125 | ms/batch 41.33 | loss  5.36 | ppl   212.312
total_loss: 39022.14125061035, total_len: 7360
total_loss: 43146.14389038086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1400 | time:  6.73s | valid loss  5.30 | valid ppl   200.722
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   7 step     1600 |    148 batches | lr 0.000125 | ms/batch 40.44 | loss  5.29 | ppl   198.815
total_loss: 38648.93908691406, total_len: 7360
total_loss: 42737.298751831055, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   8 at step     1600 | time:  6.69s | valid loss  5.25 | valid ppl   190.798
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   8 step     1800 |    106 batches | lr 0.000124 | ms/batch 40.41 | loss  5.24 | ppl   188.909
total_loss: 38278.81700134277, total_len: 7360
total_loss: 42307.20149230957, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   9 at step     1800 | time:  6.71s | valid loss  5.20 | valid ppl   181.440
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   9 step     2000 |     64 batches | lr 0.000124 | ms/batch 40.66 | loss  5.18 | ppl   178.573
total_loss: 37888.13185119629, total_len: 7360
total_loss: 41879.925552368164, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2000 | time:  6.69s | valid loss  5.15 | valid ppl   172.060
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2200 |     22 batches | lr 0.000124 | ms/batch 41.03 | loss  5.11 | ppl   166.310
total_loss: 37517.77072143555, total_len: 7360
total_loss: 41471.90673828125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2200 | time:  6.72s | valid loss  5.10 | valid ppl   163.616
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2400 |    222 batches | lr 0.000124 | ms/batch 39.16 | loss  5.06 | ppl   157.870
total_loss: 37160.479553222656, total_len: 7360
total_loss: 41088.50750732422, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  12 at step     2400 | time:  6.67s | valid loss  5.05 | valid ppl   155.863
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  11 step     2600 |    180 batches | lr 0.000124 | ms/batch 39.92 | loss  5.01 | ppl   149.411
total_loss: 36807.47261047363, total_len: 7360
total_loss: 40687.10073852539, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  13 at step     2600 | time:  6.71s | valid loss  5.00 | valid ppl   148.564
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  12 step     2800 |    138 batches | lr 0.000123 | ms/batch 46.45 | loss  4.95 | ppl   141.798
total_loss: 36478.39981842041, total_len: 7360
total_loss: 40311.25059509277, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  14 at step     2800 | time:  6.95s | valid loss  4.96 | valid ppl   142.068
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  13 step     3000 |     96 batches | lr 0.000123 | ms/batch 42.19 | loss  4.92 | ppl   136.351
total_loss: 36106.16110992432, total_len: 7360
total_loss: 39900.2223815918, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3000 | time:  6.73s | valid loss  4.91 | valid ppl   135.061
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  14 step     3200 |     54 batches | lr 0.000123 | ms/batch 40.73 | loss  4.85 | ppl   127.838
total_loss: 35768.729568481445, total_len: 7360
total_loss: 39520.30114746094, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  16 at step     3200 | time:  6.72s | valid loss  4.86 | valid ppl   129.009
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3400 |     12 batches | lr 0.000123 | ms/batch 40.31 | loss  4.79 | ppl   120.369
total_loss: 35388.12815093994, total_len: 7360
total_loss: 39095.468002319336, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  17 at step     3400 | time:  6.67s | valid loss  4.81 | valid ppl   122.507
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3600 |    212 batches | lr 0.000123 | ms/batch 41.63 | loss  4.74 | ppl   114.230
total_loss: 35041.67392730713, total_len: 7360
total_loss: 38708.10684967041, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  18 at step     3600 | time:  6.76s | valid loss  4.76 | valid ppl   116.874
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  16 step     3800 |    170 batches | lr 0.000122 | ms/batch 38.66 | loss  4.68 | ppl   107.955
total_loss: 34670.867012023926, total_len: 7360
total_loss: 38296.71910858154, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  19 at step     3800 | time:  6.64s | valid loss  4.71 | valid ppl   111.132
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  17 step     4000 |    128 batches | lr 0.000122 | ms/batch 39.34 | loss  4.63 | ppl   102.652
total_loss: 34441.63433074951, total_len: 7360
total_loss: 38044.89872741699, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  20 at step     4000 | time:  6.93s | valid loss  4.68 | valid ppl   107.724
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  18 step     4200 |     86 batches | lr 0.000122 | ms/batch 40.54 | loss  4.60 | ppl    99.574
total_loss: 34086.022468566895, total_len: 7360
total_loss: 37640.693298339844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  21 at step     4200 | time:  7.50s | valid loss  4.63 | valid ppl   102.643
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  19 step     4400 |     44 batches | lr 0.000121 | ms/batch 41.62 | loss  4.54 | ppl    93.459
total_loss: 33803.74239349365, total_len: 7360
total_loss: 37327.255615234375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  22 at step     4400 | time:  6.56s | valid loss  4.59 | valid ppl    98.780
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4600 |      2 batches | lr 0.000121 | ms/batch 38.60 | loss  4.49 | ppl    89.182
total_loss: 33550.14311981201, total_len: 7360
total_loss: 37066.44216918945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  23 at step     4600 | time:  8.03s | valid loss  4.56 | valid ppl    95.435
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4800 |    202 batches | lr 0.000121 | ms/batch 40.85 | loss  4.45 | ppl    85.846
total_loss: 33379.251304626465, total_len: 7360
total_loss: 36886.77533721924, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  24 at step     4800 | time:  6.66s | valid loss  4.54 | valid ppl    93.244
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  21 step     5000 |    160 batches | lr 0.00012 | ms/batch 40.30 | loss  4.42 | ppl    82.738
total_loss: 33181.14273071289, total_len: 7360
total_loss: 36662.850646972656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  25 at step     5000 | time:  6.72s | valid loss  4.51 | valid ppl    90.768
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  22 step     5200 |    118 batches | lr 0.00012 | ms/batch 40.90 | loss  4.38 | ppl    79.909
total_loss: 32973.455253601074, total_len: 7360
total_loss: 36415.81368255615, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  26 at step     5200 | time:  6.86s | valid loss  4.48 | valid ppl    88.243
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  23 step     5400 |     76 batches | lr 0.000119 | ms/batch 44.68 | loss  4.36 | ppl    78.594
total_loss: 32779.63683319092, total_len: 7360
total_loss: 36201.286697387695, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  27 at step     5400 | time:  6.97s | valid loss  4.45 | valid ppl    85.949
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5600 |     34 batches | lr 0.000119 | ms/batch 40.66 | loss  4.31 | ppl    74.428
total_loss: 32677.827407836914, total_len: 7360
total_loss: 36097.619705200195, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  28 at step     5600 | time:  6.37s | valid loss  4.44 | valid ppl    84.768
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5800 |    234 batches | lr 0.000119 | ms/batch 41.04 | loss  4.28 | ppl    72.176
total_loss: 32540.04722595215, total_len: 7360
total_loss: 35967.62593841553, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  29 at step     5800 | time:  6.87s | valid loss  4.42 | valid ppl    83.196
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  25 step     6000 |    192 batches | lr 0.000118 | ms/batch 40.57 | loss  4.25 | ppl    70.391
total_loss: 32332.162567138672, total_len: 7360
total_loss: 35725.917877197266, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  30 at step     6000 | time:  6.55s | valid loss  4.39 | valid ppl    80.879
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  26 step     6200 |    150 batches | lr 0.000118 | ms/batch 39.68 | loss  4.22 | ppl    68.327
total_loss: 32213.9375, total_len: 7360
total_loss: 35564.27359008789, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  31 at step     6200 | time:  6.34s | valid loss  4.38 | valid ppl    79.590
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  27 step     6400 |    108 batches | lr 0.000117 | ms/batch 42.11 | loss  4.21 | ppl    67.089
total_loss: 32112.982131958008, total_len: 7360
total_loss: 35466.68202972412, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  32 at step     6400 | time:  6.93s | valid loss  4.36 | valid ppl    78.506
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  28 step     6600 |     66 batches | lr 0.000117 | ms/batch 40.73 | loss  4.19 | ppl    65.910
total_loss: 31993.129554748535, total_len: 7360
total_loss: 35322.50890350342, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  33 at step     6600 | time:  6.91s | valid loss  4.35 | valid ppl    77.238
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     6800 |     24 batches | lr 0.000116 | ms/batch 39.42 | loss  4.15 | ppl    63.308
total_loss: 31899.234329223633, total_len: 7360
total_loss: 35236.59242248535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  34 at step     6800 | time:  6.38s | valid loss  4.33 | valid ppl    76.259
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     7000 |    224 batches | lr 0.000116 | ms/batch 44.30 | loss  4.13 | ppl    61.985
total_loss: 31857.17808532715, total_len: 7360
total_loss: 35184.88523101807, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  35 at step     7000 | time:  7.18s | valid loss  4.33 | valid ppl    75.824
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  30 step     7200 |    182 batches | lr 0.000115 | ms/batch 41.27 | loss  4.11 | ppl    60.796
total_loss: 31714.93009185791, total_len: 7360
total_loss: 35005.05791473389, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  36 at step     7200 | time:  6.74s | valid loss  4.31 | valid ppl    74.373
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  31 step     7400 |    140 batches | lr 0.000115 | ms/batch 41.12 | loss  4.09 | ppl    59.745
total_loss: 31673.287284851074, total_len: 7360
total_loss: 34946.77080535889, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  37 at step     7400 | time:  7.20s | valid loss  4.30 | valid ppl    73.953
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  32 step     7600 |     98 batches | lr 0.000114 | ms/batch 46.95 | loss  4.08 | ppl    59.351
total_loss: 31580.107498168945, total_len: 7360
total_loss: 34844.1559753418, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  38 at step     7600 | time:  6.48s | valid loss  4.29 | valid ppl    73.023
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  33 step     7800 |     56 batches | lr 0.000114 | ms/batch 40.99 | loss  4.06 | ppl    57.931
total_loss: 31516.26788330078, total_len: 7360
total_loss: 34771.38854217529, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  39 at step     7800 | time:  7.19s | valid loss  4.28 | valid ppl    72.392
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8000 |     14 batches | lr 0.000113 | ms/batch 43.11 | loss  4.03 | ppl    56.297
total_loss: 31473.110633850098, total_len: 7360
total_loss: 34733.60021972656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  40 at step     8000 | time:  6.69s | valid loss  4.28 | valid ppl    71.969
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8200 |    214 batches | lr 0.000112 | ms/batch 39.40 | loss  4.02 | ppl    55.581
total_loss: 31420.48056793213, total_len: 7360
total_loss: 34642.59041595459, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  41 at step     8200 | time:  7.37s | valid loss  4.27 | valid ppl    71.456
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  35 step     8400 |    172 batches | lr 0.000112 | ms/batch 43.01 | loss  4.00 | ppl    54.440
total_loss: 31394.622596740723, total_len: 7360
total_loss: 34607.924880981445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  42 at step     8400 | time:  6.95s | valid loss  4.27 | valid ppl    71.206
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  36 step     8600 |    130 batches | lr 0.000111 | ms/batch 39.81 | loss  3.98 | ppl    53.708
total_loss: 31303.66332244873, total_len: 7360
total_loss: 34513.7825012207, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  43 at step     8600 | time:  6.67s | valid loss  4.25 | valid ppl    70.331
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  37 step     8800 |     88 batches | lr 0.000111 | ms/batch 41.45 | loss  3.99 | ppl    53.842
total_loss: 31210.6934967041, total_len: 7360
total_loss: 34405.71738433838, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  44 at step     8800 | time:  7.22s | valid loss  4.24 | valid ppl    69.448
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  38 step     9000 |     46 batches | lr 0.00011 | ms/batch 42.24 | loss  3.96 | ppl    52.207
total_loss: 31182.489616394043, total_len: 7360
total_loss: 34371.789710998535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  45 at step     9000 | time:  6.71s | valid loss  4.24 | valid ppl    69.183
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9200 |      4 batches | lr 0.000109 | ms/batch 43.97 | loss  3.94 | ppl    51.235
total_loss: 31121.217208862305, total_len: 7360
total_loss: 34312.29656982422, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  46 at step     9200 | time:  7.08s | valid loss  4.23 | valid ppl    68.609
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9400 |    204 batches | lr 0.000109 | ms/batch 41.08 | loss  3.92 | ppl    50.619
total_loss: 31052.49153137207, total_len: 7360
total_loss: 34234.14165496826, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  47 at step     9400 | time:  6.72s | valid loss  4.22 | valid ppl    67.972
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  40 step     9600 |    162 batches | lr 0.000108 | ms/batch 42.45 | loss  3.91 | ppl    49.914
total_loss: 31114.845993041992, total_len: 7360
total_loss: 34286.58804321289, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  48 at step     9600 | time:  6.91s | valid loss  4.23 | valid ppl    68.550
----------------------------------------------------------------------------------------------------
| epoch  41 step     9800 |    120 batches | lr 0.000107 | ms/batch 33.74 | loss  3.90 | ppl    49.362
total_loss: 31040.645179748535, total_len: 7360
total_loss: 34192.01175689697, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  49 at step     9800 | time:  7.34s | valid loss  4.22 | valid ppl    67.862
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  42 step    10000 |     78 batches | lr 0.000107 | ms/batch 39.42 | loss  3.91 | ppl    49.651
total_loss: 30959.300132751465, total_len: 7360
total_loss: 34091.388511657715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  50 at step    10000 | time:  7.29s | valid loss  4.21 | valid ppl    67.116
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10200 |     36 batches | lr 0.000106 | ms/batch 41.62 | loss  3.87 | ppl    48.012
total_loss: 30916.07593536377, total_len: 7360
total_loss: 34056.35440826416, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  51 at step    10200 | time:  6.77s | valid loss  4.20 | valid ppl    66.723
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10400 |    236 batches | lr 0.000105 | ms/batch 40.87 | loss  3.86 | ppl    47.331
total_loss: 30937.072647094727, total_len: 7360
total_loss: 34091.46204376221, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  52 at step    10400 | time:  6.64s | valid loss  4.20 | valid ppl    66.914
----------------------------------------------------------------------------------------------------
| epoch  44 step    10600 |    194 batches | lr 0.000105 | ms/batch 33.05 | loss  3.85 | ppl    47.006
total_loss: 30896.027252197266, total_len: 7360
total_loss: 34015.64463043213, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  53 at step    10600 | time:  6.88s | valid loss  4.20 | valid ppl    66.542
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  45 step    10800 |    152 batches | lr 0.000104 | ms/batch 40.17 | loss  3.84 | ppl    46.438
total_loss: 30846.5121383667, total_len: 7360
total_loss: 33954.06386566162, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  54 at step    10800 | time:  6.69s | valid loss  4.19 | valid ppl    66.096
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  46 step    11000 |    110 batches | lr 0.000103 | ms/batch 39.47 | loss  3.84 | ppl    46.332
total_loss: 30778.16967010498, total_len: 7360
total_loss: 33882.78412628174, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  55 at step    11000 | time:  6.89s | valid loss  4.18 | valid ppl    65.485
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  47 step    11200 |     68 batches | lr 0.000102 | ms/batch 39.49 | loss  3.83 | ppl    46.135
total_loss: 30741.631950378418, total_len: 7360
total_loss: 33850.47644042969, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  56 at step    11200 | time:  8.23s | valid loss  4.18 | valid ppl    65.160
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11400 |     26 batches | lr 0.000102 | ms/batch 47.52 | loss  3.80 | ppl    44.864
total_loss: 30752.640838623047, total_len: 7360
total_loss: 33853.07130432129, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  57 at step    11400 | time:  6.74s | valid loss  4.18 | valid ppl    65.258
----------------------------------------------------------------------------------------------------
| epoch  48 step    11600 |    226 batches | lr 0.000101 | ms/batch 33.57 | loss  3.79 | ppl    44.392
total_loss: 30757.22248840332, total_len: 7360
total_loss: 33859.96291351318, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  58 at step    11600 | time:  6.71s | valid loss  4.18 | valid ppl    65.299
----------------------------------------------------------------------------------------------------
| epoch  49 step    11800 |    184 batches | lr 0.0001 | ms/batch 33.52 | loss  3.79 | ppl    44.050
total_loss: 30665.621910095215, total_len: 7360
total_loss: 33742.798919677734, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  59 at step    11800 | time:  6.69s | valid loss  4.17 | valid ppl    64.491
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  50 step    12000 |    142 batches | lr 9.92e-05 | ms/batch 40.82 | loss  3.78 | ppl    43.848
total_loss: 30674.042289733887, total_len: 7360
total_loss: 33745.23405456543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  60 at step    12000 | time:  6.70s | valid loss  4.17 | valid ppl    64.565
----------------------------------------------------------------------------------------------------
| epoch  51 step    12200 |    100 batches | lr 9.84e-05 | ms/batch 35.49 | loss  3.78 | ppl    43.724
total_loss: 30634.10395050049, total_len: 7360
total_loss: 33709.79421234131, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  61 at step    12200 | time:  7.30s | valid loss  4.16 | valid ppl    64.215
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  52 step    12400 |     58 batches | lr 9.76e-05 | ms/batch 42.29 | loss  3.77 | ppl    43.308
total_loss: 30616.19652557373, total_len: 7360
total_loss: 33696.08459472656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  62 at step    12400 | time:  7.27s | valid loss  4.16 | valid ppl    64.059
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12600 |     16 batches | lr 9.68e-05 | ms/batch 41.37 | loss  3.75 | ppl    42.412
total_loss: 30611.08731842041, total_len: 7360
total_loss: 33686.72798156738, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  63 at step    12600 | time:  7.17s | valid loss  4.16 | valid ppl    64.015
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12800 |    216 batches | lr 9.6e-05 | ms/batch 43.81 | loss  3.74 | ppl    42.123
total_loss: 30548.496116638184, total_len: 7360
total_loss: 33602.08673095703, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  64 at step    12800 | time:  7.35s | valid loss  4.15 | valid ppl    63.473
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  54 step    13000 |    174 batches | lr 9.52e-05 | ms/batch 47.12 | loss  3.73 | ppl    41.660
total_loss: 30607.15380859375, total_len: 7360
total_loss: 33663.17401885986, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  65 at step    13000 | time:  7.32s | valid loss  4.16 | valid ppl    63.981
----------------------------------------------------------------------------------------------------
| epoch  55 step    13200 |    132 batches | lr 9.43e-05 | ms/batch 36.62 | loss  3.72 | ppl    41.428
total_loss: 30561.047164916992, total_len: 7360
total_loss: 33606.02258300781, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  66 at step    13200 | time:  7.45s | valid loss  4.15 | valid ppl    63.581
----------------------------------------------------------------------------------------------------
| epoch  56 step    13400 |     90 batches | lr 9.35e-05 | ms/batch 36.55 | loss  3.73 | ppl    41.784
total_loss: 30539.640419006348, total_len: 7360
total_loss: 33580.86811065674, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  67 at step    13400 | time:  7.24s | valid loss  4.15 | valid ppl    63.396
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  57 step    13600 |     48 batches | lr 9.26e-05 | ms/batch 46.10 | loss  3.71 | ppl    40.842
total_loss: 30513.081787109375, total_len: 7360
total_loss: 33575.818099975586, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  68 at step    13600 | time:  9.45s | valid loss  4.15 | valid ppl    63.168
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    13800 |      6 batches | lr 9.17e-05 | ms/batch 46.47 | loss  3.70 | ppl    40.324
total_loss: 30485.76722717285, total_len: 7360
total_loss: 33525.26036834717, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  69 at step    13800 | time:  7.27s | valid loss  4.14 | valid ppl    62.934
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    14000 |    206 batches | lr 9.09e-05 | ms/batch 46.95 | loss  3.69 | ppl    40.084
total_loss: 30489.56965637207, total_len: 7360
total_loss: 33525.11528015137, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  70 at step    14000 | time:  7.53s | valid loss  4.14 | valid ppl    62.967
----------------------------------------------------------------------------------------------------
| epoch  59 step    14200 |    164 batches | lr 9e-05 | ms/batch 36.94 | loss  3.68 | ppl    39.795
total_loss: 30431.01188659668, total_len: 7360
total_loss: 33469.059425354004, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  71 at step    14200 | time:  7.30s | valid loss  4.13 | valid ppl    62.468
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  60 step    14400 |    122 batches | lr 8.91e-05 | ms/batch 44.64 | loss  3.68 | ppl    39.552
total_loss: 30454.079513549805, total_len: 7360
total_loss: 33485.515045166016, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  72 at step    14400 | time:  7.10s | valid loss  4.14 | valid ppl    62.664
----------------------------------------------------------------------------------------------------
| epoch  61 step    14600 |     80 batches | lr 8.82e-05 | ms/batch 33.46 | loss  3.69 | ppl    40.082
total_loss: 30420.157913208008, total_len: 7360
total_loss: 33425.946128845215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  73 at step    14600 | time:  6.70s | valid loss  4.13 | valid ppl    62.376
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    14800 |     38 batches | lr 8.73e-05 | ms/batch 40.28 | loss  3.66 | ppl    38.862
total_loss: 30410.587631225586, total_len: 7360
total_loss: 33442.52175140381, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  74 at step    14800 | time:  6.69s | valid loss  4.13 | valid ppl    62.295
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    15000 |    238 batches | lr 8.64e-05 | ms/batch 43.33 | loss  3.65 | ppl    38.666
total_loss: 30424.686889648438, total_len: 7360
total_loss: 33471.33596038818, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  75 at step    15000 | time:  6.72s | valid loss  4.13 | valid ppl    62.414
----------------------------------------------------------------------------------------------------
| epoch  63 step    15200 |    196 batches | lr 8.55e-05 | ms/batch 33.42 | loss  3.65 | ppl    38.472
total_loss: 30367.0023727417, total_len: 7360
total_loss: 33393.77812957764, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  76 at step    15200 | time:  6.68s | valid loss  4.13 | valid ppl    61.927
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  64 step    15400 |    154 batches | lr 8.46e-05 | ms/batch 40.59 | loss  3.64 | ppl    38.140
total_loss: 30349.000946044922, total_len: 7360
total_loss: 33349.55578613281, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  77 at step    15400 | time:  6.74s | valid loss  4.12 | valid ppl    61.775
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  65 step    15600 |    112 batches | lr 8.37e-05 | ms/batch 40.04 | loss  3.64 | ppl    38.181
total_loss: 30285.390937805176, total_len: 7360
total_loss: 33290.283699035645, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  78 at step    15600 | time:  6.72s | valid loss  4.11 | valid ppl    61.244
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  66 step    15800 |     70 batches | lr 8.27e-05 | ms/batch 39.94 | loss  3.65 | ppl    38.298
total_loss: 30294.89779663086, total_len: 7360
total_loss: 33292.20671081543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  79 at step    15800 | time:  6.87s | valid loss  4.12 | valid ppl    61.323
----------------------------------------------------------------------------------------------------
| epoch  67 step    16000 |     28 batches | lr 8.18e-05 | ms/batch 34.26 | loss  3.62 | ppl    37.346
total_loss: 30301.25513458252, total_len: 7360
total_loss: 33291.48484802246, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  80 at step    16000 | time:  6.75s | valid loss  4.12 | valid ppl    61.376
----------------------------------------------------------------------------------------------------
| epoch  67 step    16200 |    228 batches | lr 8.09e-05 | ms/batch 33.56 | loss  3.61 | ppl    37.131
total_loss: 30341.66527557373, total_len: 7360
total_loss: 33327.43283843994, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  81 at step    16200 | time:  6.71s | valid loss  4.12 | valid ppl    61.714
----------------------------------------------------------------------------------------------------
| epoch  68 step    16400 |    186 batches | lr 7.99e-05 | ms/batch 33.66 | loss  3.61 | ppl    37.063
total_loss: 30317.002449035645, total_len: 7360
total_loss: 33283.39813995361, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  82 at step    16400 | time:  6.75s | valid loss  4.12 | valid ppl    61.507
----------------------------------------------------------------------------------------------------
| epoch  69 step    16600 |    144 batches | lr 7.9e-05 | ms/batch 33.60 | loss  3.61 | ppl    36.816
total_loss: 30277.763359069824, total_len: 7360
total_loss: 33241.82819366455, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  83 at step    16600 | time:  6.71s | valid loss  4.11 | valid ppl    61.180
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  70 step    16800 |    102 batches | lr 7.8e-05 | ms/batch 42.35 | loss  3.61 | ppl    37.016
total_loss: 30274.97816467285, total_len: 7360
total_loss: 33263.07447052002, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  84 at step    16800 | time:  6.73s | valid loss  4.11 | valid ppl    61.157
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  71 step    17000 |     60 batches | lr 7.71e-05 | ms/batch 40.16 | loss  3.60 | ppl    36.763
total_loss: 30243.928855895996, total_len: 7360
total_loss: 33217.0407409668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  85 at step    17000 | time:  6.69s | valid loss  4.11 | valid ppl    60.900
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17200 |     18 batches | lr 7.61e-05 | ms/batch 39.87 | loss  3.59 | ppl    36.120
total_loss: 30228.141090393066, total_len: 7360
total_loss: 33227.03924560547, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  86 at step    17200 | time:  6.74s | valid loss  4.11 | valid ppl    60.769
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17400 |    218 batches | lr 7.52e-05 | ms/batch 39.50 | loss  3.58 | ppl    35.945
total_loss: 30213.933624267578, total_len: 7360
total_loss: 33185.4254989624, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  87 at step    17400 | time:  6.68s | valid loss  4.11 | valid ppl    60.652
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  73 step    17600 |    176 batches | lr 7.42e-05 | ms/batch 40.80 | loss  3.58 | ppl    35.759
total_loss: 30191.031845092773, total_len: 7360
total_loss: 33159.640449523926, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  88 at step    17600 | time:  6.78s | valid loss  4.10 | valid ppl    60.464
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  74 step    17800 |    134 batches | lr 7.32e-05 | ms/batch 40.01 | loss  3.57 | ppl    35.646
total_loss: 30199.334930419922, total_len: 7360
total_loss: 33171.01356506348, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  89 at step    17800 | time:  7.26s | valid loss  4.10 | valid ppl    60.532
----------------------------------------------------------------------------------------------------
| epoch  75 step    18000 |     92 batches | lr 7.23e-05 | ms/batch 36.33 | loss  3.59 | ppl    36.123
total_loss: 30207.06731414795, total_len: 7360
total_loss: 33166.150451660156, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  90 at step    18000 | time:  6.69s | valid loss  4.10 | valid ppl    60.596
----------------------------------------------------------------------------------------------------
| epoch  76 step    18200 |     50 batches | lr 7.13e-05 | ms/batch 33.12 | loss  3.57 | ppl    35.437
total_loss: 30167.976524353027, total_len: 7360
total_loss: 33146.95391082764, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  91 at step    18200 | time:  6.62s | valid loss  4.10 | valid ppl    60.275
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  77 step    18400 |      8 batches | lr 7.03e-05 | ms/batch 45.14 | loss  3.56 | ppl    34.999
total_loss: 30149.217445373535, total_len: 7360
total_loss: 33121.07524871826, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  92 at step    18400 | time:  6.66s | valid loss  4.10 | valid ppl    60.121
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  77 step    18600 |    208 batches | lr 6.94e-05 | ms/batch 39.41 | loss  3.55 | ppl    34.984
total_loss: 30170.11870574951, total_len: 7360
total_loss: 33143.46104431152, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  93 at step    18600 | time:  6.57s | valid loss  4.10 | valid ppl    60.292
----------------------------------------------------------------------------------------------------
| epoch  78 step    18800 |    166 batches | lr 6.84e-05 | ms/batch 32.76 | loss  3.55 | ppl    34.745
total_loss: 30139.0484085083, total_len: 7360
total_loss: 33114.27976989746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  94 at step    18800 | time:  6.63s | valid loss  4.09 | valid ppl    60.038
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  79 step    19000 |    124 batches | lr 6.74e-05 | ms/batch 40.08 | loss  3.55 | ppl    34.683
total_loss: 30132.700469970703, total_len: 7360
total_loss: 33091.53232574463, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  95 at step    19000 | time:  6.66s | valid loss  4.09 | valid ppl    59.986
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  80 step    19200 |     82 batches | lr 6.64e-05 | ms/batch 39.84 | loss  3.56 | ppl    35.165
total_loss: 30116.679069519043, total_len: 7360
total_loss: 33080.5309677124, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  96 at step    19200 | time:  6.70s | valid loss  4.09 | valid ppl    59.856
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19400 |     40 batches | lr 6.54e-05 | ms/batch 39.38 | loss  3.53 | ppl    34.229
total_loss: 30099.42872619629, total_len: 7360
total_loss: 33069.59526062012, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  97 at step    19400 | time:  7.64s | valid loss  4.09 | valid ppl    59.716
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19600 |    240 batches | lr 6.45e-05 | ms/batch 45.36 | loss  3.53 | ppl    33.999
total_loss: 30124.094512939453, total_len: 7360
total_loss: 33094.63981628418, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  98 at step    19600 | time:  6.73s | valid loss  4.09 | valid ppl    59.916
----------------------------------------------------------------------------------------------------
| epoch  82 step    19800 |    198 batches | lr 6.35e-05 | ms/batch 33.44 | loss  3.53 | ppl    34.065
total_loss: 30081.33999633789, total_len: 7360
total_loss: 33044.37501525879, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  99 at step    19800 | time:  6.68s | valid loss  4.09 | valid ppl    59.569
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  83 step    20000 |    156 batches | lr 6.25e-05 | ms/batch 39.78 | loss  3.52 | ppl    33.875
total_loss: 30110.509017944336, total_len: 7360
total_loss: 33074.26015472412, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 100 at step    20000 | time:  6.70s | valid loss  4.09 | valid ppl    59.806
----------------------------------------------------------------------------------------------------
| epoch  84 step    20200 |    114 batches | lr 6.15e-05 | ms/batch 33.43 | loss  3.53 | ppl    33.956
total_loss: 30036.496185302734, total_len: 7360
total_loss: 32993.79225921631, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 101 at step    20200 | time:  6.71s | valid loss  4.08 | valid ppl    59.207
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  85 step    20400 |     72 batches | lr 6.05e-05 | ms/batch 42.40 | loss  3.53 | ppl    34.207
total_loss: 30042.689514160156, total_len: 7360
total_loss: 33001.45115661621, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 102 at step    20400 | time:  6.95s | valid loss  4.08 | valid ppl    59.257
----------------------------------------------------------------------------------------------------
| epoch  86 step    20600 |     30 batches | lr 5.96e-05 | ms/batch 33.41 | loss  3.51 | ppl    33.390
total_loss: 30052.81876373291, total_len: 7360
total_loss: 33006.379150390625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 103 at step    20600 | time:  6.71s | valid loss  4.08 | valid ppl    59.339
----------------------------------------------------------------------------------------------------
| epoch  86 step    20800 |    230 batches | lr 5.86e-05 | ms/batch 33.62 | loss  3.51 | ppl    33.333
total_loss: 30038.128410339355, total_len: 7360
total_loss: 33003.845695495605, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 104 at step    20800 | time:  6.63s | valid loss  4.08 | valid ppl    59.220
----------------------------------------------------------------------------------------------------
| epoch  87 step    21000 |    188 batches | lr 5.76e-05 | ms/batch 33.23 | loss  3.50 | ppl    33.279
total_loss: 30052.442794799805, total_len: 7360
total_loss: 33011.458839416504, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 105 at step    21000 | time:  7.21s | valid loss  4.08 | valid ppl    59.336
----------------------------------------------------------------------------------------------------
| epoch  88 step    21200 |    146 batches | lr 5.66e-05 | ms/batch 34.94 | loss  3.50 | ppl    33.125
total_loss: 30053.667587280273, total_len: 7360
total_loss: 33003.68507385254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 106 at step    21200 | time:  6.70s | valid loss  4.08 | valid ppl    59.346
----------------------------------------------------------------------------------------------------
| epoch  89 step    21400 |    104 batches | lr 5.56e-05 | ms/batch 33.64 | loss  3.51 | ppl    33.349
total_loss: 30020.969367980957, total_len: 7360
total_loss: 32973.248878479004, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 107 at step    21400 | time:  6.74s | valid loss  4.08 | valid ppl    59.083
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  90 step    21600 |     62 batches | lr 5.47e-05 | ms/batch 40.01 | loss  3.50 | ppl    33.219
total_loss: 29969.594924926758, total_len: 7360
total_loss: 32916.99711608887, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 108 at step    21600 | time:  6.58s | valid loss  4.07 | valid ppl    58.672
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  91 step    21800 |     20 batches | lr 5.37e-05 | ms/batch 41.22 | loss  3.49 | ppl    32.660
total_loss: 30038.88555908203, total_len: 7360
total_loss: 32993.856048583984, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 109 at step    21800 | time:  6.71s | valid loss  4.08 | valid ppl    59.227
----------------------------------------------------------------------------------------------------
| epoch  91 step    22000 |    220 batches | lr 5.27e-05 | ms/batch 33.78 | loss  3.48 | ppl    32.592
total_loss: 30008.324417114258, total_len: 7360
total_loss: 32928.82344818115, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 110 at step    22000 | time:  8.27s | valid loss  4.08 | valid ppl    58.981
----------------------------------------------------------------------------------------------------
| epoch  92 step    22200 |    178 batches | lr 5.18e-05 | ms/batch 43.22 | loss  3.48 | ppl    32.429
total_loss: 30002.274528503418, total_len: 7360
total_loss: 32923.69909667969, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 111 at step    22200 | time:  6.98s | valid loss  4.08 | valid ppl    58.933
----------------------------------------------------------------------------------------------------
| epoch  93 step    22400 |    136 batches | lr 5.08e-05 | ms/batch 33.63 | loss  3.48 | ppl    32.395
total_loss: 30015.899703979492, total_len: 7360
total_loss: 32928.39650726318, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 112 at step    22400 | time:  6.70s | valid loss  4.08 | valid ppl    59.042
----------------------------------------------------------------------------------------------------
| epoch  94 step    22600 |     94 batches | lr 4.98e-05 | ms/batch 33.60 | loss  3.49 | ppl    32.791
total_loss: 30021.055541992188, total_len: 7360
total_loss: 32954.48125457764, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 113 at step    22600 | time:  6.73s | valid loss  4.08 | valid ppl    59.083
----------------------------------------------------------------------------------------------------
| epoch  95 step    22800 |     52 batches | lr 4.89e-05 | ms/batch 33.58 | loss  3.48 | ppl    32.384
total_loss: 29972.768852233887, total_len: 7360
total_loss: 32902.90328979492, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 114 at step    22800 | time:  6.69s | valid loss  4.07 | valid ppl    58.697
----------------------------------------------------------------------------------------------------
| epoch  96 step    23000 |     10 batches | lr 4.79e-05 | ms/batch 33.13 | loss  3.47 | ppl    32.035
total_loss: 30012.11562347412, total_len: 7360
total_loss: 32952.002769470215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 115 at step    23000 | time:  6.81s | valid loss  4.08 | valid ppl    59.012
----------------------------------------------------------------------------------------------------
| epoch  96 step    23200 |    210 batches | lr 4.7e-05 | ms/batch 33.57 | loss  3.47 | ppl    32.101
total_loss: 29968.705192565918, total_len: 7360
total_loss: 32891.033210754395, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 116 at step    23200 | time:  7.16s | valid loss  4.07 | valid ppl    58.665
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  97 step    23400 |    168 batches | lr 4.6e-05 | ms/batch 46.39 | loss  3.46 | ppl    31.902
total_loss: 29988.944618225098, total_len: 7360
total_loss: 32920.78592681885, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 117 at step    23400 | time:  6.70s | valid loss  4.07 | valid ppl    58.826
----------------------------------------------------------------------------------------------------
| epoch  98 step    23600 |    126 batches | lr 4.51e-05 | ms/batch 33.25 | loss  3.46 | ppl    31.864
total_loss: 30003.9002532959, total_len: 7360
total_loss: 32932.14549255371, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 118 at step    23600 | time:  7.07s | valid loss  4.08 | valid ppl    58.946
----------------------------------------------------------------------------------------------------
| epoch  99 step    23800 |     84 batches | lr 4.41e-05 | ms/batch 35.54 | loss  3.48 | ppl    32.374
total_loss: 29955.88227081299, total_len: 7360
total_loss: 32869.33940124512, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 119 at step    23800 | time:  6.78s | valid loss  4.07 | valid ppl    58.562
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 100 step    24000 |     42 batches | lr 4.32e-05 | ms/batch 44.31 | loss  3.46 | ppl    31.690
total_loss: 29958.292289733887, total_len: 7360
total_loss: 32877.397857666016, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 120 at step    24000 | time:  6.72s | valid loss  4.07 | valid ppl    58.582
----------------------------------------------------------------------------------------------------
| epoch 100 step    24200 |    242 batches | lr 4.23e-05 | ms/batch 33.38 | loss  3.45 | ppl    31.491
total_loss: 29981.23609161377, total_len: 7360
total_loss: 32894.243812561035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 121 at step    24200 | time:  6.71s | valid loss  4.07 | valid ppl    58.764
----------------------------------------------------------------------------------------------------
| epoch 101 step    24400 |    200 batches | lr 4.13e-05 | ms/batch 33.79 | loss  3.45 | ppl    31.595
total_loss: 29920.651336669922, total_len: 7360
total_loss: 32829.76375579834, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 122 at step    24400 | time:  6.72s | valid loss  4.07 | valid ppl    58.283
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 102 step    24600 |    158 batches | lr 4.04e-05 | ms/batch 40.59 | loss  3.45 | ppl    31.387
total_loss: 29949.173461914062, total_len: 7360
total_loss: 32855.19871520996, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 123 at step    24600 | time:  7.02s | valid loss  4.07 | valid ppl    58.509
----------------------------------------------------------------------------------------------------
| epoch 103 step    24800 |    116 batches | lr 3.95e-05 | ms/batch 35.29 | loss  3.45 | ppl    31.501
total_loss: 29946.94086456299, total_len: 7360
total_loss: 32862.44002532959, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 124 at step    24800 | time:  6.73s | valid loss  4.07 | valid ppl    58.491
----------------------------------------------------------------------------------------------------
| epoch 104 step    25000 |     74 batches | lr 3.86e-05 | ms/batch 33.38 | loss  3.46 | ppl    31.843
total_loss: 29923.43408203125, total_len: 7360
total_loss: 32827.75045013428, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 125 at step    25000 | time:  6.68s | valid loss  4.07 | valid ppl    58.305
----------------------------------------------------------------------------------------------------
| epoch 105 step    25200 |     32 batches | lr 3.77e-05 | ms/batch 33.39 | loss  3.44 | ppl    31.154
total_loss: 29927.355598449707, total_len: 7360
total_loss: 32836.68099975586, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 126 at step    25200 | time:  6.68s | valid loss  4.07 | valid ppl    58.336
----------------------------------------------------------------------------------------------------
| epoch 105 step    25400 |    232 batches | lr 3.68e-05 | ms/batch 33.46 | loss  3.43 | ppl    30.939
total_loss: 29909.856353759766, total_len: 7360
total_loss: 32823.3927154541, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 127 at step    25400 | time:  6.69s | valid loss  4.06 | valid ppl    58.197
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 106 step    25600 |    190 batches | lr 3.59e-05 | ms/batch 40.53 | loss  3.43 | ppl    31.018
total_loss: 29933.4736328125, total_len: 7360
total_loss: 32844.26313781738, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 128 at step    25600 | time:  6.70s | valid loss  4.07 | valid ppl    58.384
----------------------------------------------------------------------------------------------------
| epoch 107 step    25800 |    148 batches | lr 3.5e-05 | ms/batch 33.35 | loss  3.43 | ppl    30.862
total_loss: 29924.407569885254, total_len: 7360
total_loss: 32812.59413146973, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 129 at step    25800 | time:  8.58s | valid loss  4.07 | valid ppl    58.312
----------------------------------------------------------------------------------------------------
| epoch 108 step    26000 |    106 batches | lr 3.41e-05 | ms/batch 34.18 | loss  3.44 | ppl    31.207
total_loss: 29924.660552978516, total_len: 7360
total_loss: 32836.132652282715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 130 at step    26000 | time:  6.71s | valid loss  4.07 | valid ppl    58.314
----------------------------------------------------------------------------------------------------
| epoch 109 step    26200 |     64 batches | lr 3.33e-05 | ms/batch 34.92 | loss  3.44 | ppl    31.236
total_loss: 29882.331382751465, total_len: 7360
total_loss: 32786.85315704346, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 131 at step    26200 | time:  6.98s | valid loss  4.06 | valid ppl    57.980
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 110 step    26400 |     22 batches | lr 3.24e-05 | ms/batch 40.17 | loss  3.42 | ppl    30.658
total_loss: 29899.38442993164, total_len: 7360
total_loss: 32813.740966796875, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 132 at step    26400 | time:  6.73s | valid loss  4.06 | valid ppl    58.115
----------------------------------------------------------------------------------------------------
| epoch 110 step    26600 |    222 batches | lr 3.15e-05 | ms/batch 32.98 | loss  3.43 | ppl    30.729
total_loss: 29921.686462402344, total_len: 7360
total_loss: 32828.32628631592, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 133 at step    26600 | time:  6.61s | valid loss  4.07 | valid ppl    58.291
----------------------------------------------------------------------------------------------------
| epoch 111 step    26800 |    180 batches | lr 3.07e-05 | ms/batch 33.34 | loss  3.42 | ppl    30.579
total_loss: 29912.166397094727, total_len: 7360
total_loss: 32825.138008117676, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 134 at step    26800 | time:  6.54s | valid loss  4.06 | valid ppl    58.216
----------------------------------------------------------------------------------------------------
| epoch 112 step    27000 |    138 batches | lr 2.98e-05 | ms/batch 32.57 | loss  3.42 | ppl    30.620
total_loss: 29900.096450805664, total_len: 7360
total_loss: 32796.29959106445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 135 at step    27000 | time:  6.51s | valid loss  4.06 | valid ppl    58.120
----------------------------------------------------------------------------------------------------
| epoch 113 step    27200 |     96 batches | lr 2.9e-05 | ms/batch 32.66 | loss  3.43 | ppl    30.991
total_loss: 29924.65030670166, total_len: 7360
total_loss: 32833.801597595215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 136 at step    27200 | time:  6.53s | valid loss  4.07 | valid ppl    58.314
----------------------------------------------------------------------------------------------------
| epoch 114 step    27400 |     54 batches | lr 2.82e-05 | ms/batch 32.66 | loss  3.42 | ppl    30.596
total_loss: 29890.350944519043, total_len: 7360
total_loss: 32810.38176727295, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 137 at step    27400 | time:  6.52s | valid loss  4.06 | valid ppl    58.043
----------------------------------------------------------------------------------------------------
| epoch 115 step    27600 |     12 batches | lr 2.74e-05 | ms/batch 32.60 | loss  3.41 | ppl    30.299
total_loss: 29878.462295532227, total_len: 7360
total_loss: 32786.49198150635, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 138 at step    27600 | time:  6.51s | valid loss  4.06 | valid ppl    57.950
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 115 step    27800 |    212 batches | lr 2.66e-05 | ms/batch 41.03 | loss  3.41 | ppl    30.330
total_loss: 29870.80962371826, total_len: 7360
total_loss: 32773.36119842529, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 139 at step    27800 | time:  6.76s | valid loss  4.06 | valid ppl    57.889
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 116 step    28000 |    170 batches | lr 2.58e-05 | ms/batch 40.61 | loss  3.41 | ppl    30.278
total_loss: 29891.109909057617, total_len: 7360
total_loss: 32801.43193054199, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 140 at step    28000 | time:  6.69s | valid loss  4.06 | valid ppl    58.049
----------------------------------------------------------------------------------------------------
| epoch 117 step    28200 |    128 batches | lr 2.5e-05 | ms/batch 33.17 | loss  3.41 | ppl    30.351
total_loss: 29891.224891662598, total_len: 7360
total_loss: 32801.6357421875, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 141 at step    28200 | time:  6.61s | valid loss  4.06 | valid ppl    58.050
----------------------------------------------------------------------------------------------------
| epoch 118 step    28400 |     86 batches | lr 2.42e-05 | ms/batch 32.46 | loss  3.42 | ppl    30.705
total_loss: 29860.425926208496, total_len: 7360
total_loss: 32768.267578125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 142 at step    28400 | time:  6.83s | valid loss  4.06 | valid ppl    57.808
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 119 step    28600 |     44 batches | lr 2.34e-05 | ms/batch 40.21 | loss  3.41 | ppl    30.150
total_loss: 29857.535568237305, total_len: 7360
total_loss: 32759.67847442627, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 143 at step    28600 | time:  6.51s | valid loss  4.06 | valid ppl    57.785
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 120 step    28800 |      2 batches | lr 2.27e-05 | ms/batch 39.09 | loss  3.40 | ppl    29.880
total_loss: 29887.08455657959, total_len: 7360
total_loss: 32792.2516784668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 144 at step    28800 | time:  6.91s | valid loss  4.06 | valid ppl    58.018
----------------------------------------------------------------------------------------------------
| epoch 120 step    29000 |    202 batches | lr 2.19e-05 | ms/batch 34.40 | loss  3.40 | ppl    30.104
total_loss: 29877.449829101562, total_len: 7360
total_loss: 32775.45448303223, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 145 at step    29000 | time:  7.23s | valid loss  4.06 | valid ppl    57.942
----------------------------------------------------------------------------------------------------
| epoch 121 step    29200 |    160 batches | lr 2.12e-05 | ms/batch 37.37 | loss  3.40 | ppl    29.987
total_loss: 29886.790031433105, total_len: 7360
total_loss: 32775.227882385254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 146 at step    29200 | time:  7.31s | valid loss  4.06 | valid ppl    58.015
----------------------------------------------------------------------------------------------------
| epoch 122 step    29400 |    118 batches | lr 2.04e-05 | ms/batch 36.18 | loss  3.40 | ppl    30.041
total_loss: 29863.74227142334, total_len: 7360
total_loss: 32756.71315765381, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 147 at step    29400 | time:  7.25s | valid loss  4.06 | valid ppl    57.834
----------------------------------------------------------------------------------------------------
| epoch 123 step    29600 |     76 batches | lr 1.97e-05 | ms/batch 35.95 | loss  3.42 | ppl    30.458
total_loss: 29853.379135131836, total_len: 7360
total_loss: 32753.472106933594, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 148 at step    29600 | time:  7.33s | valid loss  4.06 | valid ppl    57.752
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 124 step    29800 |     34 batches | lr 1.9e-05 | ms/batch 43.14 | loss  3.40 | ppl    29.830
total_loss: 29851.061447143555, total_len: 7360
total_loss: 32746.85472869873, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 149 at step    29800 | time:  7.30s | valid loss  4.06 | valid ppl    57.734
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 124 step    30000 |    234 batches | lr 1.83e-05 | ms/batch 46.77 | loss  3.39 | ppl    29.741
total_loss: 29849.163452148438, total_len: 7360
total_loss: 32755.29730987549, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 150 at step    30000 | time:  7.43s | valid loss  4.06 | valid ppl    57.719
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 125 step    30200 |    192 batches | lr 1.76e-05 | ms/batch 48.74 | loss  3.40 | ppl    29.874
total_loss: 29845.7566986084, total_len: 7360
total_loss: 32743.983863830566, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 151 at step    30200 | time:  7.28s | valid loss  4.06 | valid ppl    57.693
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 126 step    30400 |    150 batches | lr 1.69e-05 | ms/batch 44.10 | loss  3.39 | ppl    29.714
total_loss: 29889.29158782959, total_len: 7360
total_loss: 32781.14304351807, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 152 at step    30400 | time:  6.89s | valid loss  4.06 | valid ppl    58.035
----------------------------------------------------------------------------------------------------
| epoch 127 step    30600 |    108 batches | lr 1.63e-05 | ms/batch 33.53 | loss  3.40 | ppl    30.040
total_loss: 29879.399894714355, total_len: 7360
total_loss: 32775.89569854736, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 153 at step    30600 | time:  6.69s | valid loss  4.06 | valid ppl    57.957
----------------------------------------------------------------------------------------------------
| epoch 128 step    30800 |     66 batches | lr 1.56e-05 | ms/batch 33.49 | loss  3.40 | ppl    30.059
total_loss: 29841.573959350586, total_len: 7360
total_loss: 32733.8237991333, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 154 at step    30800 | time:  6.71s | valid loss  4.05 | valid ppl    57.660
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 129 step    31000 |     24 batches | lr 1.5e-05 | ms/batch 40.15 | loss  3.39 | ppl    29.532
total_loss: 29839.90404510498, total_len: 7360
total_loss: 32730.5376663208, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 155 at step    31000 | time:  6.61s | valid loss  4.05 | valid ppl    57.647
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 129 step    31200 |    224 batches | lr 1.43e-05 | ms/batch 38.88 | loss  3.39 | ppl    29.615
total_loss: 29855.946144104004, total_len: 7360
total_loss: 32745.486740112305, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 156 at step    31200 | time:  6.63s | valid loss  4.06 | valid ppl    57.773
----------------------------------------------------------------------------------------------------
| epoch 130 step    31400 |    182 batches | lr 1.37e-05 | ms/batch 33.32 | loss  3.39 | ppl    29.540
total_loss: 29843.158111572266, total_len: 7360
total_loss: 32738.484329223633, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 157 at step    31400 | time:  6.67s | valid loss  4.05 | valid ppl    57.672
----------------------------------------------------------------------------------------------------
| epoch 131 step    31600 |    140 batches | lr 1.31e-05 | ms/batch 33.38 | loss  3.39 | ppl    29.566
total_loss: 29848.605026245117, total_len: 7360
total_loss: 32741.068969726562, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 158 at step    31600 | time:  6.67s | valid loss  4.06 | valid ppl    57.715
----------------------------------------------------------------------------------------------------
| epoch 132 step    31800 |     98 batches | lr 1.25e-05 | ms/batch 33.49 | loss  3.40 | ppl    30.013
total_loss: 29847.585792541504, total_len: 7360
total_loss: 32741.210388183594, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 159 at step    31800 | time:  6.70s | valid loss  4.06 | valid ppl    57.707
----------------------------------------------------------------------------------------------------
| epoch 133 step    32000 |     56 batches | lr 1.19e-05 | ms/batch 33.49 | loss  3.39 | ppl    29.675
total_loss: 29836.75691986084, total_len: 7360
total_loss: 32731.440238952637, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 160 at step    32000 | time:  6.69s | valid loss  4.05 | valid ppl    57.622
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 134 step    32200 |     14 batches | lr 1.14e-05 | ms/batch 39.08 | loss  3.38 | ppl    29.375
total_loss: 29846.891571044922, total_len: 7360
total_loss: 32741.373825073242, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 161 at step    32200 | time:  6.56s | valid loss  4.06 | valid ppl    57.702
----------------------------------------------------------------------------------------------------
| epoch 134 step    32400 |    214 batches | lr 1.08e-05 | ms/batch 32.73 | loss  3.39 | ppl    29.547
total_loss: 29834.583297729492, total_len: 7360
total_loss: 32724.32942199707, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 162 at step    32400 | time:  6.53s | valid loss  4.05 | valid ppl    57.605
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 135 step    32600 |    172 batches | lr 1.03e-05 | ms/batch 38.43 | loss  3.38 | ppl    29.350
total_loss: 29843.45890045166, total_len: 7360
total_loss: 32733.128791809082, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 163 at step    32600 | time:  6.49s | valid loss  4.05 | valid ppl    57.675
----------------------------------------------------------------------------------------------------
| epoch 136 step    32800 |    130 batches | lr 9.73e-06 | ms/batch 32.74 | loss  3.38 | ppl    29.420
total_loss: 29853.305786132812, total_len: 7360
total_loss: 32748.80535888672, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 164 at step    32800 | time:  6.78s | valid loss  4.06 | valid ppl    57.752
----------------------------------------------------------------------------------------------------
| epoch 137 step    33000 |     88 batches | lr 9.21e-06 | ms/batch 33.90 | loss  3.40 | ppl    29.876
total_loss: 29826.55630493164, total_len: 7360
total_loss: 32720.634468078613, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 165 at step    33000 | time:  6.53s | valid loss  4.05 | valid ppl    57.542
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 138 step    33200 |     46 batches | lr 8.7e-06 | ms/batch 39.01 | loss  3.38 | ppl    29.419
total_loss: 29832.125213623047, total_len: 7360
total_loss: 32721.668884277344, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 166 at step    33200 | time:  6.64s | valid loss  4.05 | valid ppl    57.586
----------------------------------------------------------------------------------------------------
| epoch 139 step    33400 |      4 batches | lr 8.21e-06 | ms/batch 33.38 | loss  3.37 | ppl    29.204
total_loss: 29824.730262756348, total_len: 7360
total_loss: 32716.76707458496, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 167 at step    33400 | time:  6.46s | valid loss  4.05 | valid ppl    57.528
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 139 step    33600 |    204 batches | lr 7.73e-06 | ms/batch 39.57 | loss  3.38 | ppl    29.354
total_loss: 29840.238624572754, total_len: 7360
total_loss: 32731.776397705078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 168 at step    33600 | time:  6.64s | valid loss  4.05 | valid ppl    57.649
----------------------------------------------------------------------------------------------------
| epoch 140 step    33800 |    162 batches | lr 7.26e-06 | ms/batch 33.10 | loss  3.38 | ppl    29.302
total_loss: 29836.28271484375, total_len: 7360
total_loss: 32719.628379821777, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 169 at step    33800 | time:  6.58s | valid loss  4.05 | valid ppl    57.618
----------------------------------------------------------------------------------------------------
| epoch 141 step    34000 |    120 batches | lr 6.81e-06 | ms/batch 32.91 | loss  3.38 | ppl    29.348
total_loss: 29823.92611694336, total_len: 7360
total_loss: 32714.3618850708, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 170 at step    34000 | time:  6.45s | valid loss  4.05 | valid ppl    57.522
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 142 step    34200 |     78 batches | lr 6.37e-06 | ms/batch 38.36 | loss  3.40 | ppl    29.853
total_loss: 29822.618438720703, total_len: 7360
total_loss: 32708.725456237793, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 171 at step    34200 | time:  6.47s | valid loss  4.05 | valid ppl    57.512
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 143 step    34400 |     36 batches | lr 5.95e-06 | ms/batch 43.35 | loss  3.37 | ppl    29.186
total_loss: 29830.262329101562, total_len: 7360
total_loss: 32720.144912719727, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 172 at step    34400 | time:  6.57s | valid loss  4.05 | valid ppl    57.571
----------------------------------------------------------------------------------------------------
| epoch 143 step    34600 |    236 batches | lr 5.54e-06 | ms/batch 32.69 | loss  3.37 | ppl    29.158
total_loss: 29815.026931762695, total_len: 7360
total_loss: 32704.438537597656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 173 at step    34600 | time:  6.53s | valid loss  4.05 | valid ppl    57.452
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 144 step    34800 |    194 batches | lr 5.14e-06 | ms/batch 41.27 | loss  3.38 | ppl    29.245
total_loss: 29824.996673583984, total_len: 7360
total_loss: 32715.902282714844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 174 at step    34800 | time:  6.57s | valid loss  4.05 | valid ppl    57.530
----------------------------------------------------------------------------------------------------
| epoch 145 step    35000 |    152 batches | lr 4.76e-06 | ms/batch 32.78 | loss  3.37 | ppl    29.121
total_loss: 29825.596786499023, total_len: 7360
total_loss: 32709.91037750244, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 175 at step    35000 | time:  6.56s | valid loss  4.05 | valid ppl    57.535
----------------------------------------------------------------------------------------------------
| epoch 146 step    35200 |    110 batches | lr 4.39e-06 | ms/batch 32.84 | loss  3.38 | ppl    29.387
total_loss: 29829.096794128418, total_len: 7360
total_loss: 32717.567741394043, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 176 at step    35200 | time:  6.54s | valid loss  4.05 | valid ppl    57.562
----------------------------------------------------------------------------------------------------
| epoch 147 step    35400 |     68 batches | lr 4.03e-06 | ms/batch 32.74 | loss  3.39 | ppl    29.565
total_loss: 29825.763748168945, total_len: 7360
total_loss: 32713.073699951172, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 177 at step    35400 | time:  6.54s | valid loss  4.05 | valid ppl    57.536
----------------------------------------------------------------------------------------------------
| epoch 148 step    35600 |     26 batches | lr 3.69e-06 | ms/batch 32.65 | loss  3.37 | ppl    29.136
total_loss: 29831.30499267578, total_len: 7360
total_loss: 32719.345092773438, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 178 at step    35600 | time:  6.52s | valid loss  4.05 | valid ppl    57.579
----------------------------------------------------------------------------------------------------
| epoch 148 step    35800 |    226 batches | lr 3.37e-06 | ms/batch 32.64 | loss  3.37 | ppl    29.164
total_loss: 29812.068099975586, total_len: 7360
total_loss: 32697.018783569336, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 179 at step    35800 | time:  6.53s | valid loss  4.05 | valid ppl    57.429
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 149 step    36000 |    184 batches | lr 3.06e-06 | ms/batch 38.91 | loss  3.37 | ppl    29.076
total_loss: 29824.344215393066, total_len: 7360
total_loss: 32708.87004852295, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 180 at step    36000 | time:  6.55s | valid loss  4.05 | valid ppl    57.525
----------------------------------------------------------------------------------------------------
| epoch 150 step    36200 |    142 batches | lr 2.76e-06 | ms/batch 32.64 | loss  3.38 | ppl    29.238
total_loss: 29833.849151611328, total_len: 7360
total_loss: 32720.694679260254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 181 at step    36200 | time:  6.53s | valid loss  4.05 | valid ppl    57.599
----------------------------------------------------------------------------------------------------
| epoch 151 step    36400 |    100 batches | lr 2.48e-06 | ms/batch 32.40 | loss  3.39 | ppl    29.531
total_loss: 29821.322761535645, total_len: 7360
total_loss: 32706.11420440674, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 182 at step    36400 | time:  6.48s | valid loss  4.05 | valid ppl    57.501
----------------------------------------------------------------------------------------------------
| epoch 152 step    36600 |     58 batches | lr 2.22e-06 | ms/batch 32.50 | loss  3.38 | ppl    29.423
total_loss: 29821.222610473633, total_len: 7360
total_loss: 32707.58445739746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 183 at step    36600 | time:  7.12s | valid loss  4.05 | valid ppl    57.501
----------------------------------------------------------------------------------------------------
| epoch 153 step    36800 |     16 batches | lr 1.96e-06 | ms/batch 34.18 | loss  3.37 | ppl    29.022
total_loss: 29825.96164703369, total_len: 7360
total_loss: 32711.73162841797, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 184 at step    36800 | time:  6.57s | valid loss  4.05 | valid ppl    57.538
----------------------------------------------------------------------------------------------------
| epoch 153 step    37000 |    216 batches | lr 1.73e-06 | ms/batch 33.41 | loss  3.37 | ppl    29.165
total_loss: 29819.722915649414, total_len: 7360
total_loss: 32704.839630126953, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 185 at step    37000 | time:  6.67s | valid loss  4.05 | valid ppl    57.489
----------------------------------------------------------------------------------------------------
| epoch 154 step    37200 |    174 batches | lr 1.51e-06 | ms/batch 33.37 | loss  3.37 | ppl    29.092
total_loss: 29827.54136657715, total_len: 7360
total_loss: 32711.577560424805, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 186 at step    37200 | time:  6.66s | valid loss  4.05 | valid ppl    57.550
----------------------------------------------------------------------------------------------------
| epoch 155 step    37400 |    132 batches | lr 1.3e-06 | ms/batch 33.42 | loss  3.37 | ppl    29.142
total_loss: 29826.504112243652, total_len: 7360
total_loss: 32712.196250915527, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 187 at step    37400 | time:  7.41s | valid loss  4.05 | valid ppl    57.542
----------------------------------------------------------------------------------------------------
| epoch 156 step    37600 |     90 batches | lr 1.11e-06 | ms/batch 33.83 | loss  3.39 | ppl    29.602
total_loss: 29817.604835510254, total_len: 7360
total_loss: 32702.315551757812, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 188 at step    37600 | time:  6.73s | valid loss  4.05 | valid ppl    57.472
----------------------------------------------------------------------------------------------------
| epoch 157 step    37800 |     48 batches | lr 9.31e-07 | ms/batch 33.63 | loss  3.37 | ppl    29.162
total_loss: 29824.164642333984, total_len: 7360
total_loss: 32709.535415649414, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 189 at step    37800 | time:  6.72s | valid loss  4.05 | valid ppl    57.524
----------------------------------------------------------------------------------------------------
| epoch 158 step    38000 |      6 batches | lr 7.69e-07 | ms/batch 33.64 | loss  3.37 | ppl    29.014
total_loss: 29823.296257019043, total_len: 7360
total_loss: 32707.950942993164, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 190 at step    38000 | time:  6.71s | valid loss  4.05 | valid ppl    57.517
----------------------------------------------------------------------------------------------------
| epoch 158 step    38200 |    206 batches | lr 6.24e-07 | ms/batch 33.50 | loss  3.37 | ppl    29.084
total_loss: 29824.23680114746, total_len: 7360
total_loss: 32708.44571685791, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 191 at step    38200 | time:  6.69s | valid loss  4.05 | valid ppl    57.524
----------------------------------------------------------------------------------------------------
| epoch 159 step    38400 |    164 batches | lr 4.93e-07 | ms/batch 33.42 | loss  3.37 | ppl    29.098
total_loss: 29823.363021850586, total_len: 7360
total_loss: 32707.877151489258, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 192 at step    38400 | time:  6.65s | valid loss  4.05 | valid ppl    57.517
----------------------------------------------------------------------------------------------------
| epoch 160 step    38600 |    122 batches | lr 3.77e-07 | ms/batch 32.65 | loss  3.37 | ppl    29.210
total_loss: 29822.242919921875, total_len: 7360
total_loss: 32707.022994995117, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 193 at step    38600 | time:  6.61s | valid loss  4.05 | valid ppl    57.509
----------------------------------------------------------------------------------------------------
| epoch 161 step    38800 |     80 batches | lr 2.77e-07 | ms/batch 33.64 | loss  3.39 | ppl    29.671
total_loss: 29819.37734222412, total_len: 7360
total_loss: 32703.950225830078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 194 at step    38800 | time:  6.70s | valid loss  4.05 | valid ppl    57.486
----------------------------------------------------------------------------------------------------
| epoch 162 step    39000 |     38 batches | lr 1.93e-07 | ms/batch 33.62 | loss  3.37 | ppl    29.063
total_loss: 29821.052711486816, total_len: 7360
total_loss: 32706.04160308838, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 195 at step    39000 | time:  6.64s | valid loss  4.05 | valid ppl    57.499
----------------------------------------------------------------------------------------------------
| epoch 162 step    39200 |    238 batches | lr 1.23e-07 | ms/batch 33.18 | loss  3.37 | ppl    29.013
total_loss: 29822.21460723877, total_len: 7360
total_loss: 32707.237503051758, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 196 at step    39200 | time:  7.08s | valid loss  4.05 | valid ppl    57.508
----------------------------------------------------------------------------------------------------
| epoch 163 step    39400 |    196 batches | lr 6.94e-08 | ms/batch 33.80 | loss  3.37 | ppl    29.116
total_loss: 29822.799522399902, total_len: 7360
total_loss: 32707.911094665527, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 197 at step    39400 | time:  6.71s | valid loss  4.05 | valid ppl    57.513
----------------------------------------------------------------------------------------------------
| epoch 164 step    39600 |    154 batches | lr 3.08e-08 | ms/batch 33.66 | loss  3.37 | ppl    29.114
total_loss: 29822.760467529297, total_len: 7360
total_loss: 32707.89072418213, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 198 at step    39600 | time:  6.71s | valid loss  4.05 | valid ppl    57.513
----------------------------------------------------------------------------------------------------
| epoch 165 step    39800 |    112 batches | lr 7.71e-09 | ms/batch 33.50 | loss  3.38 | ppl    29.326
total_loss: 29822.645195007324, total_len: 7360
total_loss: 32707.681579589844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 199 at step    39800 | time:  6.89s | valid loss  4.05 | valid ppl    57.512
----------------------------------------------------------------------------------------------------
| epoch 166 step    40000 |     70 batches | lr 0 | ms/batch 34.05 | loss  3.39 | ppl    29.608
total_loss: 29822.705253601074, total_len: 7360
total_loss: 32707.733139038086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 200 at step    40000 | time:  6.70s | valid loss  4.05 | valid ppl    57.512
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
End of training
total_loss: 32697.018783569336, total_len: 8224
====================================================================================================
| End of training | test loss  3.98 | test ppl    53.293
====================================================================================================
Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 71
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_71_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 71
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_71_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
total_loss: 71305.38400268555, total_len: 7744
total_loss: 75733.5317993164, total_len: 8224
total_loss: 67787.81530761719, total_len: 7360
| Start of training | test loss  9.21 | test bpc 9985.04594
| epoch   1 step      200 |    200 batches | lr 0.000125 | ms/batch 41.07 | loss  7.04 | ppl  1146.498
total_loss: 45598.98162841797, total_len: 7360
total_loss: 50580.599044799805, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   1 at step      200 | time:  9.70s | valid loss  6.20 | valid ppl   490.543
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   2 step      400 |    158 batches | lr 0.000125 | ms/batch 39.23 | loss  6.07 | ppl   432.756
total_loss: 42695.823974609375, total_len: 7360
total_loss: 47319.09616088867, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   2 at step      400 | time:  6.72s | valid loss  5.80 | valid ppl   330.651
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   3 step      600 |    116 batches | lr 0.000125 | ms/batch 37.61 | loss  5.79 | ppl   325.909
total_loss: 41301.09994506836, total_len: 7360
total_loss: 45741.75778198242, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   3 at step      600 | time:  6.71s | valid loss  5.61 | valid ppl   273.571
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   4 step      800 |     74 batches | lr 0.000125 | ms/batch 39.17 | loss  5.63 | ppl   279.501
total_loss: 40462.59471130371, total_len: 7360
total_loss: 44774.09841918945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   4 at step      800 | time:  6.70s | valid loss  5.50 | valid ppl   244.114
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1000 |     32 batches | lr 0.000125 | ms/batch 37.68 | loss  5.51 | ppl   246.577
total_loss: 39868.421936035156, total_len: 7360
total_loss: 44099.52473449707, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1000 | time:  6.68s | valid loss  5.42 | valid ppl   225.181
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1200 |    232 batches | lr 0.000125 | ms/batch 38.88 | loss  5.41 | ppl   223.757
total_loss: 39350.35498046875, total_len: 7360
total_loss: 43544.60786437988, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1200 | time:  6.69s | valid loss  5.35 | valid ppl   209.876
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   6 step     1400 |    190 batches | lr 0.000125 | ms/batch 39.49 | loss  5.34 | ppl   207.845
total_loss: 38945.86756896973, total_len: 7360
total_loss: 43055.06750488281, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1400 | time:  6.83s | valid loss  5.29 | valid ppl   198.653
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   7 step     1600 |    148 batches | lr 0.000125 | ms/batch 39.59 | loss  5.27 | ppl   194.531
total_loss: 38550.23731994629, total_len: 7360
total_loss: 42629.28015136719, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   8 at step     1600 | time:  6.81s | valid loss  5.24 | valid ppl   188.256
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   8 step     1800 |    106 batches | lr 0.000124 | ms/batch 40.01 | loss  5.22 | ppl   184.608
total_loss: 38176.77012634277, total_len: 7360
total_loss: 42202.05796813965, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   9 at step     1800 | time:  6.84s | valid loss  5.19 | valid ppl   178.942
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   9 step     2000 |     64 batches | lr 0.000124 | ms/batch 39.29 | loss  5.16 | ppl   174.254
total_loss: 37744.10777282715, total_len: 7360
total_loss: 41731.10627746582, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2000 | time:  6.71s | valid loss  5.13 | valid ppl   168.726
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2200 |     22 batches | lr 0.000124 | ms/batch 40.11 | loss  5.08 | ppl   160.156
total_loss: 37186.84362030029, total_len: 7360
total_loss: 41121.42152404785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2200 | time:  6.82s | valid loss  5.05 | valid ppl   156.422
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2400 |    222 batches | lr 0.000124 | ms/batch 39.52 | loss  5.00 | ppl   148.363
total_loss: 36592.25890350342, total_len: 7360
total_loss: 40460.3766784668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  12 at step     2400 | time:  6.80s | valid loss  4.97 | valid ppl   144.283
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  11 step     2600 |    180 batches | lr 0.000124 | ms/batch 39.05 | loss  4.92 | ppl   136.383
total_loss: 36069.78999328613, total_len: 7360
total_loss: 39872.77870178223, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  13 at step     2600 | time:  6.65s | valid loss  4.90 | valid ppl   134.395
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  12 step     2800 |    138 batches | lr 0.000123 | ms/batch 38.97 | loss  4.84 | ppl   125.912
total_loss: 35501.83010101318, total_len: 7360
total_loss: 39259.88999938965, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  14 at step     2800 | time:  6.66s | valid loss  4.82 | valid ppl   124.414
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  13 step     3000 |     96 batches | lr 0.000123 | ms/batch 38.82 | loss  4.77 | ppl   117.517
total_loss: 34944.99309539795, total_len: 7360
total_loss: 38643.64811706543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3000 | time:  6.68s | valid loss  4.75 | valid ppl   115.349
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  14 step     3200 |     54 batches | lr 0.000123 | ms/batch 38.91 | loss  4.69 | ppl   108.514
total_loss: 34558.357971191406, total_len: 7360
total_loss: 38202.454734802246, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  16 at step     3200 | time:  6.66s | valid loss  4.70 | valid ppl   109.446
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3400 |     12 batches | lr 0.000123 | ms/batch 39.40 | loss  4.62 | ppl   101.377
total_loss: 34172.5242767334, total_len: 7360
total_loss: 37776.9926071167, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  17 at step     3400 | time:  6.81s | valid loss  4.64 | valid ppl   103.856
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3600 |    212 batches | lr 0.000123 | ms/batch 39.49 | loss  4.56 | ppl    95.798
total_loss: 33841.895080566406, total_len: 7360
total_loss: 37424.99688720703, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  18 at step     3600 | time:  6.83s | valid loss  4.60 | valid ppl    99.294
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  16 step     3800 |    170 batches | lr 0.000122 | ms/batch 39.67 | loss  4.51 | ppl    90.944
total_loss: 33539.177070617676, total_len: 7360
total_loss: 37072.87226104736, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  19 at step     3800 | time:  6.80s | valid loss  4.56 | valid ppl    95.293
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  17 step     4000 |    128 batches | lr 0.000122 | ms/batch 39.06 | loss  4.47 | ppl    86.966
total_loss: 33334.782653808594, total_len: 7360
total_loss: 36837.12855529785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  20 at step     4000 | time:  6.76s | valid loss  4.53 | valid ppl    92.683
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  18 step     4200 |     86 batches | lr 0.000122 | ms/batch 38.98 | loss  4.44 | ppl    84.634
total_loss: 33112.155601501465, total_len: 7360
total_loss: 36569.17182159424, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  21 at step     4200 | time:  6.68s | valid loss  4.50 | valid ppl    89.921
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  19 step     4400 |     44 batches | lr 0.000121 | ms/batch 39.80 | loss  4.38 | ppl    80.123
total_loss: 32877.270652770996, total_len: 7360
total_loss: 36311.434646606445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  22 at step     4400 | time:  6.84s | valid loss  4.47 | valid ppl    87.097
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4600 |      2 batches | lr 0.000121 | ms/batch 39.14 | loss  4.35 | ppl    77.504
total_loss: 32766.57036590576, total_len: 7360
total_loss: 36183.815589904785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  23 at step     4600 | time:  6.95s | valid loss  4.45 | valid ppl    85.797
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4800 |    202 batches | lr 0.000121 | ms/batch 39.04 | loss  4.33 | ppl    75.669
total_loss: 32622.24609375, total_len: 7360
total_loss: 36029.44765472412, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  24 at step     4800 | time:  6.69s | valid loss  4.43 | valid ppl    84.131
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  21 step     5000 |    160 batches | lr 0.00012 | ms/batch 39.49 | loss  4.30 | ppl    73.962
total_loss: 32530.718338012695, total_len: 7360
total_loss: 35910.12935638428, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  25 at step     5000 | time:  6.74s | valid loss  4.42 | valid ppl    83.091
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  22 step     5200 |    118 batches | lr 0.00012 | ms/batch 38.94 | loss  4.28 | ppl    72.348
total_loss: 32320.778732299805, total_len: 7360
total_loss: 35701.189125061035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  26 at step     5200 | time:  6.66s | valid loss  4.39 | valid ppl    80.754
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  23 step     5400 |     76 batches | lr 0.000119 | ms/batch 38.95 | loss  4.27 | ppl    71.613
total_loss: 32241.258155822754, total_len: 7360
total_loss: 35575.27275085449, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  27 at step     5400 | time:  6.67s | valid loss  4.38 | valid ppl    79.886
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5600 |     34 batches | lr 0.000119 | ms/batch 38.77 | loss  4.22 | ppl    67.844
total_loss: 32075.320739746094, total_len: 7360
total_loss: 35398.00833892822, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  28 at step     5600 | time:  6.67s | valid loss  4.36 | valid ppl    78.105
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5800 |    234 batches | lr 0.000119 | ms/batch 38.80 | loss  4.19 | ppl    65.767
total_loss: 31930.97755432129, total_len: 7360
total_loss: 35250.948585510254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  29 at step     5800 | time:  6.66s | valid loss  4.34 | valid ppl    76.589
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  25 step     6000 |    192 batches | lr 0.000118 | ms/batch 39.14 | loss  4.16 | ppl    64.364
total_loss: 31778.426094055176, total_len: 7360
total_loss: 35081.5718460083, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  30 at step     6000 | time:  6.68s | valid loss  4.32 | valid ppl    75.017
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  26 step     6200 |    150 batches | lr 0.000118 | ms/batch 39.37 | loss  4.13 | ppl    62.353
total_loss: 31622.531814575195, total_len: 7360
total_loss: 34887.46318817139, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  31 at step     6200 | time:  6.78s | valid loss  4.30 | valid ppl    73.445
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  27 step     6400 |    108 batches | lr 0.000117 | ms/batch 39.14 | loss  4.11 | ppl    61.219
total_loss: 31539.770477294922, total_len: 7360
total_loss: 34799.3030090332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  32 at step     6400 | time:  6.68s | valid loss  4.29 | valid ppl    72.624
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  28 step     6600 |     66 batches | lr 0.000117 | ms/batch 39.11 | loss  4.09 | ppl    59.556
total_loss: 31372.70384979248, total_len: 7360
total_loss: 34609.75482940674, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  33 at step     6600 | time:  6.71s | valid loss  4.26 | valid ppl    70.994
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     6800 |     24 batches | lr 0.000116 | ms/batch 39.27 | loss  4.05 | ppl    57.140
total_loss: 31209.592315673828, total_len: 7360
total_loss: 34432.130615234375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  34 at step     6800 | time:  6.70s | valid loss  4.24 | valid ppl    69.438
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     7000 |    224 batches | lr 0.000116 | ms/batch 37.88 | loss  4.02 | ppl    55.775
total_loss: 31111.877418518066, total_len: 7360
total_loss: 34326.35708618164, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  35 at step     7000 | time:  6.68s | valid loss  4.23 | valid ppl    68.522
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  30 step     7200 |    182 batches | lr 0.000115 | ms/batch 38.91 | loss  3.99 | ppl    54.062
total_loss: 30980.670539855957, total_len: 7360
total_loss: 34164.03533935547, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  36 at step     7200 | time:  6.67s | valid loss  4.21 | valid ppl    67.311
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  31 step     7400 |    140 batches | lr 0.000115 | ms/batch 37.62 | loss  3.97 | ppl    53.072
total_loss: 30866.29465484619, total_len: 7360
total_loss: 34037.65187072754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  37 at step     7400 | time:  6.68s | valid loss  4.19 | valid ppl    66.273
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  32 step     7600 |     98 batches | lr 0.000114 | ms/batch 38.97 | loss  3.96 | ppl    52.353
total_loss: 30741.35174560547, total_len: 7360
total_loss: 33909.89507293701, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  38 at step     7600 | time:  6.68s | valid loss  4.18 | valid ppl    65.158
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  33 step     7800 |     56 batches | lr 0.000114 | ms/batch 39.14 | loss  3.93 | ppl    50.929
total_loss: 30618.01820373535, total_len: 7360
total_loss: 33755.944175720215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  39 at step     7800 | time:  6.71s | valid loss  4.16 | valid ppl    64.075
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8000 |     14 batches | lr 0.000113 | ms/batch 39.28 | loss  3.90 | ppl    49.337
total_loss: 30516.481002807617, total_len: 7360
total_loss: 33665.060386657715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  40 at step     8000 | time:  6.69s | valid loss  4.15 | valid ppl    63.197
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8200 |    214 batches | lr 0.000112 | ms/batch 38.85 | loss  3.88 | ppl    48.384
total_loss: 30465.77577972412, total_len: 7360
total_loss: 33606.83606719971, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  41 at step     8200 | time:  6.67s | valid loss  4.14 | valid ppl    62.763
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  35 step     8400 |    172 batches | lr 0.000112 | ms/batch 38.87 | loss  3.86 | ppl    47.299
total_loss: 30364.24993133545, total_len: 7360
total_loss: 33496.06072998047, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  42 at step     8400 | time:  6.69s | valid loss  4.13 | valid ppl    61.904
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  36 step     8600 |    130 batches | lr 0.000111 | ms/batch 38.15 | loss  3.84 | ppl    46.570
total_loss: 30362.039031982422, total_len: 7360
total_loss: 33486.61988067627, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  43 at step     8600 | time:  6.67s | valid loss  4.13 | valid ppl    61.885
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  37 step     8800 |     88 batches | lr 0.000111 | ms/batch 39.41 | loss  3.84 | ppl    46.516
total_loss: 30239.138275146484, total_len: 7360
total_loss: 33347.237800598145, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  44 at step     8800 | time:  6.71s | valid loss  4.11 | valid ppl    60.860
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  38 step     9000 |     46 batches | lr 0.00011 | ms/batch 38.86 | loss  3.81 | ppl    44.948
total_loss: 30146.87092590332, total_len: 7360
total_loss: 33255.293464660645, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  45 at step     9000 | time:  6.69s | valid loss  4.10 | valid ppl    60.102
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9200 |      4 batches | lr 0.000109 | ms/batch 39.09 | loss  3.78 | ppl    43.899
total_loss: 30107.090782165527, total_len: 7360
total_loss: 33226.118881225586, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  46 at step     9200 | time:  6.67s | valid loss  4.09 | valid ppl    59.778
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9400 |    204 batches | lr 0.000109 | ms/batch 38.68 | loss  3.77 | ppl    43.400
total_loss: 30065.60369873047, total_len: 7360
total_loss: 33157.72401428223, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  47 at step     9400 | time:  6.69s | valid loss  4.09 | valid ppl    59.442
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  40 step     9600 |    162 batches | lr 0.000108 | ms/batch 39.10 | loss  3.75 | ppl    42.613
total_loss: 30063.209953308105, total_len: 7360
total_loss: 33142.852447509766, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  48 at step     9600 | time:  6.72s | valid loss  4.08 | valid ppl    59.423
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  41 step     9800 |    120 batches | lr 0.000107 | ms/batch 38.90 | loss  3.74 | ppl    42.120
total_loss: 30009.633781433105, total_len: 7360
total_loss: 33096.75644683838, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  49 at step     9800 | time:  6.69s | valid loss  4.08 | valid ppl    58.992
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  42 step    10000 |     78 batches | lr 0.000107 | ms/batch 39.06 | loss  3.75 | ppl    42.330
total_loss: 29976.935791015625, total_len: 7360
total_loss: 33028.299880981445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  50 at step    10000 | time:  6.70s | valid loss  4.07 | valid ppl    58.730
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10200 |     36 batches | lr 0.000106 | ms/batch 38.96 | loss  3.71 | ppl    40.792
total_loss: 29922.797401428223, total_len: 7360
total_loss: 33001.628273010254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  51 at step    10200 | time:  6.68s | valid loss  4.07 | valid ppl    58.300
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10400 |    236 batches | lr 0.000105 | ms/batch 39.12 | loss  3.69 | ppl    40.134
total_loss: 29861.801628112793, total_len: 7360
total_loss: 32902.25510406494, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  52 at step    10400 | time:  6.70s | valid loss  4.06 | valid ppl    57.819
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  44 step    10600 |    194 batches | lr 0.000105 | ms/batch 38.56 | loss  3.68 | ppl    39.745
total_loss: 29761.530532836914, total_len: 7360
total_loss: 32812.45623779297, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  53 at step    10600 | time:  6.64s | valid loss  4.04 | valid ppl    57.036
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  45 step    10800 |    152 batches | lr 0.000104 | ms/batch 38.44 | loss  3.67 | ppl    39.334
total_loss: 29778.16268157959, total_len: 7360
total_loss: 32805.03441619873, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  54 at step    10800 | time:  6.70s | valid loss  4.05 | valid ppl    57.165
----------------------------------------------------------------------------------------------------
| epoch  46 step    11000 |    110 batches | lr 0.000103 | ms/batch 33.41 | loss  3.66 | ppl    38.959
total_loss: 29774.00373840332, total_len: 7360
total_loss: 32792.851318359375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  55 at step    11000 | time:  6.68s | valid loss  4.05 | valid ppl    57.133
----------------------------------------------------------------------------------------------------
| epoch  47 step    11200 |     68 batches | lr 0.000102 | ms/batch 33.44 | loss  3.66 | ppl    38.839
total_loss: 29700.876579284668, total_len: 7360
total_loss: 32717.96884918213, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  56 at step    11200 | time:  6.68s | valid loss  4.04 | valid ppl    56.568
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11400 |     26 batches | lr 0.000102 | ms/batch 39.04 | loss  3.63 | ppl    37.802
total_loss: 29679.64365386963, total_len: 7360
total_loss: 32701.91033935547, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  57 at step    11400 | time:  6.80s | valid loss  4.03 | valid ppl    56.405
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11600 |    226 batches | lr 0.000101 | ms/batch 39.67 | loss  3.62 | ppl    37.308
total_loss: 29672.37767791748, total_len: 7360
total_loss: 32698.459701538086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  58 at step    11600 | time:  6.82s | valid loss  4.03 | valid ppl    56.349
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  49 step    11800 |    184 batches | lr 0.0001 | ms/batch 39.03 | loss  3.61 | ppl    37.054
total_loss: 29637.785186767578, total_len: 7360
total_loss: 32645.790588378906, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  59 at step    11800 | time:  6.84s | valid loss  4.03 | valid ppl    56.085
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  50 step    12000 |    142 batches | lr 9.92e-05 | ms/batch 39.50 | loss  3.60 | ppl    36.680
total_loss: 29591.79470062256, total_len: 7360
total_loss: 32589.530738830566, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  60 at step    12000 | time:  6.81s | valid loss  4.02 | valid ppl    55.736
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  51 step    12200 |    100 batches | lr 9.84e-05 | ms/batch 39.12 | loss  3.60 | ppl    36.608
total_loss: 29580.060371398926, total_len: 7360
total_loss: 32574.193885803223, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  61 at step    12200 | time:  6.74s | valid loss  4.02 | valid ppl    55.647
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  52 step    12400 |     58 batches | lr 9.76e-05 | ms/batch 39.39 | loss  3.59 | ppl    36.244
total_loss: 29512.825088500977, total_len: 7360
total_loss: 32489.879196166992, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  62 at step    12400 | time:  6.81s | valid loss  4.01 | valid ppl    55.141
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12600 |     16 batches | lr 9.68e-05 | ms/batch 39.65 | loss  3.57 | ppl    35.422
total_loss: 29535.08514404297, total_len: 7360
total_loss: 32498.861488342285, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  63 at step    12600 | time:  6.83s | valid loss  4.01 | valid ppl    55.308
----------------------------------------------------------------------------------------------------
| epoch  53 step    12800 |    216 batches | lr 9.6e-05 | ms/batch 34.19 | loss  3.56 | ppl    35.047
total_loss: 29459.97873687744, total_len: 7360
total_loss: 32428.675270080566, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  64 at step    12800 | time:  6.84s | valid loss  4.00 | valid ppl    54.747
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  54 step    13000 |    174 batches | lr 9.52e-05 | ms/batch 39.82 | loss  3.54 | ppl    34.622
total_loss: 29428.844215393066, total_len: 7360
total_loss: 32408.805656433105, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  65 at step    13000 | time:  6.82s | valid loss  4.00 | valid ppl    54.515
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  55 step    13200 |    132 batches | lr 9.43e-05 | ms/batch 39.46 | loss  3.54 | ppl    34.398
total_loss: 29453.75983428955, total_len: 7360
total_loss: 32422.338607788086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  66 at step    13200 | time:  6.81s | valid loss  4.00 | valid ppl    54.700
----------------------------------------------------------------------------------------------------
| epoch  56 step    13400 |     90 batches | lr 9.35e-05 | ms/batch 34.18 | loss  3.55 | ppl    34.704
total_loss: 29376.406997680664, total_len: 7360
total_loss: 32336.24831390381, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  67 at step    13400 | time:  6.84s | valid loss  3.99 | valid ppl    54.128
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  57 step    13600 |     48 batches | lr 9.26e-05 | ms/batch 39.57 | loss  3.52 | ppl    33.801
total_loss: 29338.654258728027, total_len: 7360
total_loss: 32313.867698669434, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  68 at step    13600 | time:  6.82s | valid loss  3.99 | valid ppl    53.851
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    13800 |      6 batches | lr 9.17e-05 | ms/batch 39.64 | loss  3.51 | ppl    33.329
total_loss: 29320.308883666992, total_len: 7360
total_loss: 32264.16037750244, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  69 at step    13800 | time:  6.81s | valid loss  3.98 | valid ppl    53.717
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    14000 |    206 batches | lr 9.09e-05 | ms/batch 39.50 | loss  3.50 | ppl    33.103
total_loss: 29303.17421722412, total_len: 7360
total_loss: 32246.78240966797, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  70 at step    14000 | time:  6.81s | valid loss  3.98 | valid ppl    53.593
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  59 step    14200 |    164 batches | lr 9e-05 | ms/batch 39.43 | loss  3.49 | ppl    32.935
total_loss: 29323.328826904297, total_len: 7360
total_loss: 32265.88363647461, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  71 at step    14200 | time:  6.82s | valid loss  3.98 | valid ppl    53.739
----------------------------------------------------------------------------------------------------
| epoch  60 step    14400 |    122 batches | lr 8.91e-05 | ms/batch 33.87 | loss  3.49 | ppl    32.720
total_loss: 29352.623237609863, total_len: 7360
total_loss: 32297.15687561035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  72 at step    14400 | time:  6.76s | valid loss  3.99 | valid ppl    53.954
----------------------------------------------------------------------------------------------------
| epoch  61 step    14600 |     80 batches | lr 8.82e-05 | ms/batch 33.42 | loss  3.50 | ppl    33.064
total_loss: 29269.979606628418, total_len: 7360
total_loss: 32197.173652648926, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  73 at step    14600 | time:  6.68s | valid loss  3.98 | valid ppl    53.351
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    14800 |     38 batches | lr 8.73e-05 | ms/batch 38.84 | loss  3.47 | ppl    32.099
total_loss: 29278.912788391113, total_len: 7360
total_loss: 32214.237274169922, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  74 at step    14800 | time:  6.68s | valid loss  3.98 | valid ppl    53.416
----------------------------------------------------------------------------------------------------
| epoch  62 step    15000 |    238 batches | lr 8.64e-05 | ms/batch 33.36 | loss  3.46 | ppl    31.816
total_loss: 29234.826011657715, total_len: 7360
total_loss: 32155.206901550293, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  75 at step    15000 | time:  6.67s | valid loss  3.97 | valid ppl    53.097
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  63 step    15200 |    196 batches | lr 8.55e-05 | ms/batch 38.13 | loss  3.46 | ppl    31.732
total_loss: 29193.73988342285, total_len: 7360
total_loss: 32111.20612335205, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  76 at step    15200 | time:  6.67s | valid loss  3.97 | valid ppl    52.802
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  64 step    15400 |    154 batches | lr 8.46e-05 | ms/batch 38.98 | loss  3.45 | ppl    31.443
total_loss: 29199.127265930176, total_len: 7360
total_loss: 32092.023918151855, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  77 at step    15400 | time:  6.74s | valid loss  3.97 | valid ppl    52.840
----------------------------------------------------------------------------------------------------
| epoch  65 step    15600 |    112 batches | lr 8.37e-05 | ms/batch 34.21 | loss  3.45 | ppl    31.427
total_loss: 29180.960441589355, total_len: 7360
total_loss: 32083.868576049805, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  78 at step    15600 | time:  6.80s | valid loss  3.96 | valid ppl    52.710
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  66 step    15800 |     70 batches | lr 8.27e-05 | ms/batch 38.85 | loss  3.45 | ppl    31.486
total_loss: 29157.546997070312, total_len: 7360
total_loss: 32058.589614868164, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  79 at step    15800 | time:  6.69s | valid loss  3.96 | valid ppl    52.543
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16000 |     28 batches | lr 8.18e-05 | ms/batch 38.28 | loss  3.43 | ppl    30.790
total_loss: 29122.310539245605, total_len: 7360
total_loss: 32027.55248260498, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  80 at step    16000 | time:  6.69s | valid loss  3.96 | valid ppl    52.292
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16200 |    228 batches | lr 8.09e-05 | ms/batch 38.82 | loss  3.42 | ppl    30.513
total_loss: 29206.925895690918, total_len: 7360
total_loss: 32097.61329650879, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  81 at step    16200 | time:  6.67s | valid loss  3.97 | valid ppl    52.896
----------------------------------------------------------------------------------------------------
| epoch  68 step    16400 |    186 batches | lr 7.99e-05 | ms/batch 33.27 | loss  3.41 | ppl    30.371
total_loss: 29096.027046203613, total_len: 7360
total_loss: 31992.684379577637, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  82 at step    16400 | time:  6.65s | valid loss  3.95 | valid ppl    52.105
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  69 step    16600 |    144 batches | lr 7.9e-05 | ms/batch 38.87 | loss  3.41 | ppl    30.232
total_loss: 29095.722831726074, total_len: 7360
total_loss: 31959.910919189453, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  83 at step    16600 | time:  6.66s | valid loss  3.95 | valid ppl    52.103
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  70 step    16800 |    102 batches | lr 7.8e-05 | ms/batch 39.12 | loss  3.41 | ppl    30.304
total_loss: 29103.300903320312, total_len: 7360
total_loss: 31970.62940979004, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  84 at step    16800 | time:  6.68s | valid loss  3.95 | valid ppl    52.157
----------------------------------------------------------------------------------------------------
| epoch  71 step    17000 |     60 batches | lr 7.71e-05 | ms/batch 33.34 | loss  3.40 | ppl    30.084
total_loss: 29046.282112121582, total_len: 7360
total_loss: 31909.34418487549, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  85 at step    17000 | time:  6.66s | valid loss  3.95 | valid ppl    51.754
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17200 |     18 batches | lr 7.61e-05 | ms/batch 39.07 | loss  3.38 | ppl    29.511
total_loss: 29072.66862487793, total_len: 7360
total_loss: 31937.229721069336, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  86 at step    17200 | time:  6.67s | valid loss  3.95 | valid ppl    51.940
----------------------------------------------------------------------------------------------------
| epoch  72 step    17400 |    218 batches | lr 7.52e-05 | ms/batch 33.33 | loss  3.38 | ppl    29.466
total_loss: 29047.259735107422, total_len: 7360
total_loss: 31904.167778015137, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  87 at step    17400 | time:  6.66s | valid loss  3.95 | valid ppl    51.761
----------------------------------------------------------------------------------------------------
| epoch  73 step    17600 |    176 batches | lr 7.42e-05 | ms/batch 33.32 | loss  3.38 | ppl    29.250
total_loss: 28971.975326538086, total_len: 7360
total_loss: 31825.53214263916, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  88 at step    17600 | time:  6.67s | valid loss  3.94 | valid ppl    51.234
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  74 step    17800 |    134 batches | lr 7.32e-05 | ms/batch 39.00 | loss  3.37 | ppl    29.006
total_loss: 29034.21421813965, total_len: 7360
total_loss: 31886.57745361328, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  89 at step    17800 | time:  6.70s | valid loss  3.94 | valid ppl    51.669
----------------------------------------------------------------------------------------------------
| epoch  75 step    18000 |     92 batches | lr 7.23e-05 | ms/batch 33.39 | loss  3.38 | ppl    29.377
total_loss: 28984.84051513672, total_len: 7360
total_loss: 31829.019813537598, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  90 at step    18000 | time:  6.68s | valid loss  3.94 | valid ppl    51.324
----------------------------------------------------------------------------------------------------
| epoch  76 step    18200 |     50 batches | lr 7.13e-05 | ms/batch 33.39 | loss  3.36 | ppl    28.771
total_loss: 28977.903411865234, total_len: 7360
total_loss: 31838.79997253418, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  91 at step    18200 | time:  6.68s | valid loss  3.94 | valid ppl    51.276
----------------------------------------------------------------------------------------------------
| epoch  77 step    18400 |      8 batches | lr 7.03e-05 | ms/batch 33.39 | loss  3.35 | ppl    28.431
total_loss: 29006.217124938965, total_len: 7360
total_loss: 31850.455123901367, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  92 at step    18400 | time:  6.68s | valid loss  3.94 | valid ppl    51.473
----------------------------------------------------------------------------------------------------
| epoch  77 step    18600 |    208 batches | lr 6.94e-05 | ms/batch 33.41 | loss  3.34 | ppl    28.359
total_loss: 28958.44408416748, total_len: 7360
total_loss: 31798.245025634766, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  93 at step    18600 | time:  6.66s | valid loss  3.93 | valid ppl    51.140
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  78 step    18800 |    166 batches | lr 6.84e-05 | ms/batch 38.85 | loss  3.34 | ppl    28.161
total_loss: 28980.130798339844, total_len: 7360
total_loss: 31826.707344055176, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  94 at step    18800 | time:  6.67s | valid loss  3.94 | valid ppl    51.291
----------------------------------------------------------------------------------------------------
