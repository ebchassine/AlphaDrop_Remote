Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 37
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_37_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
total_loss: 71343.69268798828, total_len: 7744
total_loss: 75775.15365600586, total_len: 8224
total_loss: 67810.1452331543, total_len: 7360
| Start of training | test loss  9.21 | test bpc 10035.70859
| epoch   1 step      200 |    200 batches | lr 0.000125 | ms/batch 39.41 | loss  7.04 | ppl  1145.157
----------------------------------------------------------------------------------------------------
Exiting from training early
Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 37
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_37_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
total_loss: 71343.69268798828, total_len: 7744
total_loss: 75775.15365600586, total_len: 8224
total_loss: 67810.1452331543, total_len: 7360
| Start of training | test loss  9.21 | test bpc 10035.70859
| epoch   1 step      200 |    200 batches | lr 0.000125 | ms/batch 45.87 | loss  7.04 | ppl  1145.157
total_loss: 45495.919494628906, total_len: 7360
total_loss: 50468.38854980469, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   1 at step      200 | time: 10.76s | valid loss  6.18 | valid ppl   483.722
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   2 step      400 |    158 batches | lr 0.000125 | ms/batch 44.08 | loss  6.07 | ppl   433.056
total_loss: 42714.44580078125, total_len: 7360
total_loss: 47341.100814819336, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   2 at step      400 | time:  7.69s | valid loss  5.80 | valid ppl   331.489
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   3 step      600 |    116 batches | lr 0.000125 | ms/batch 47.27 | loss  5.80 | ppl   330.376
total_loss: 41419.31651306152, total_len: 7360
total_loss: 45893.12294006348, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   3 at step      600 | time:  7.51s | valid loss  5.63 | valid ppl   278.001
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   4 step      800 |     74 batches | lr 0.000125 | ms/batch 44.49 | loss  5.65 | ppl   285.424
total_loss: 40562.01724243164, total_len: 7360
total_loss: 44917.211013793945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   4 at step      800 | time:  8.42s | valid loss  5.51 | valid ppl   247.434
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1000 |     32 batches | lr 0.000125 | ms/batch 48.95 | loss  5.53 | ppl   251.452
total_loss: 39939.400634765625, total_len: 7360
total_loss: 44211.196044921875, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1000 | time:  7.67s | valid loss  5.43 | valid ppl   227.363
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1200 |    232 batches | lr 0.000125 | ms/batch 45.62 | loss  5.44 | ppl   229.433
total_loss: 39466.883361816406, total_len: 7360
total_loss: 43696.23165893555, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1200 | time:  7.94s | valid loss  5.36 | valid ppl   213.225
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   6 step     1400 |    190 batches | lr 0.000125 | ms/batch 49.62 | loss  5.37 | ppl   214.282
total_loss: 39084.52673339844, total_len: 7360
total_loss: 43245.2106628418, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1400 | time:  7.60s | valid loss  5.31 | valid ppl   202.431
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   7 step     1600 |    148 batches | lr 0.000125 | ms/batch 45.02 | loss  5.30 | ppl   201.185
total_loss: 38684.24301147461, total_len: 7360
total_loss: 42790.39123535156, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   8 at step     1600 | time:  7.59s | valid loss  5.26 | valid ppl   191.715
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   8 step     1800 |    106 batches | lr 0.000124 | ms/batch 43.21 | loss  5.26 | ppl   191.815
total_loss: 38443.835021972656, total_len: 7360
total_loss: 42506.31034851074, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   9 at step     1800 | time:  6.84s | valid loss  5.22 | valid ppl   185.554
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   9 step     2000 |     64 batches | lr 0.000124 | ms/batch 40.18 | loss  5.21 | ppl   182.637
total_loss: 38055.93896484375, total_len: 7360
total_loss: 42068.152740478516, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2000 | time:  7.13s | valid loss  5.17 | valid ppl   176.028
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2200 |     22 batches | lr 0.000124 | ms/batch 40.52 | loss  5.14 | ppl   170.849
total_loss: 37728.635818481445, total_len: 7360
total_loss: 41719.16932678223, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2200 | time:  6.69s | valid loss  5.13 | valid ppl   168.372
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2400 |    222 batches | lr 0.000124 | ms/batch 41.25 | loss  5.09 | ppl   161.759
total_loss: 37287.840881347656, total_len: 7360
total_loss: 41239.84800720215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  12 at step     2400 | time:  6.80s | valid loss  5.07 | valid ppl   158.584
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  11 step     2600 |    180 batches | lr 0.000124 | ms/batch 40.33 | loss  5.02 | ppl   151.039
total_loss: 36768.253273010254, total_len: 7360
total_loss: 40665.144439697266, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  13 at step     2600 | time:  6.82s | valid loss  5.00 | valid ppl   147.774
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  12 step     2800 |    138 batches | lr 0.000123 | ms/batch 40.74 | loss  4.95 | ppl   141.420
total_loss: 36337.08966064453, total_len: 7360
total_loss: 40181.37097167969, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  14 at step     2800 | time:  7.12s | valid loss  4.94 | valid ppl   139.366
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  13 step     3000 |     96 batches | lr 0.000123 | ms/batch 41.93 | loss  4.90 | ppl   133.787
total_loss: 35920.279037475586, total_len: 7360
total_loss: 39684.4382019043, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3000 | time:  6.99s | valid loss  4.88 | valid ppl   131.693
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  14 step     3200 |     54 batches | lr 0.000123 | ms/batch 46.15 | loss  4.82 | ppl   123.626
total_loss: 35434.41030883789, total_len: 7360
total_loss: 39173.859451293945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  16 at step     3200 | time:  6.56s | valid loss  4.81 | valid ppl   123.280
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3400 |     12 batches | lr 0.000123 | ms/batch 44.17 | loss  4.75 | ppl   115.051
total_loss: 35081.04429626465, total_len: 7360
total_loss: 38789.29554748535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  17 at step     3400 | time:  6.41s | valid loss  4.77 | valid ppl   117.501
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3600 |    212 batches | lr 0.000123 | ms/batch 38.38 | loss  4.69 | ppl   108.578
total_loss: 34700.46134185791, total_len: 7360
total_loss: 38367.08866119385, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  18 at step     3600 | time:  6.57s | valid loss  4.71 | valid ppl   111.579
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  16 step     3800 |    170 batches | lr 0.000122 | ms/batch 43.13 | loss  4.63 | ppl   102.317
total_loss: 34340.30009460449, total_len: 7360
total_loss: 37948.28261566162, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  19 at step     3800 | time:  6.73s | valid loss  4.67 | valid ppl   106.251
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  17 step     4000 |    128 batches | lr 0.000122 | ms/batch 43.57 | loss  4.58 | ppl    97.241
total_loss: 34055.86161804199, total_len: 7360
total_loss: 37604.91697692871, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  20 at step     4000 | time:  6.75s | valid loss  4.63 | valid ppl   102.223
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  18 step     4200 |     86 batches | lr 0.000122 | ms/batch 40.11 | loss  4.54 | ppl    94.036
total_loss: 33729.21336364746, total_len: 7360
total_loss: 37233.43049621582, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  21 at step     4200 | time:  7.03s | valid loss  4.58 | valid ppl    97.785
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  19 step     4400 |     44 batches | lr 0.000121 | ms/batch 44.44 | loss  4.48 | ppl    88.658
total_loss: 33493.66052246094, total_len: 7360
total_loss: 36999.791580200195, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  22 at step     4400 | time:  6.63s | valid loss  4.55 | valid ppl    94.705
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4600 |      2 batches | lr 0.000121 | ms/batch 39.08 | loss  4.44 | ppl    84.689
total_loss: 33322.10274505615, total_len: 7360
total_loss: 36800.101165771484, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  23 at step     4600 | time:  6.63s | valid loss  4.53 | valid ppl    92.523
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4800 |    202 batches | lr 0.000121 | ms/batch 39.86 | loss  4.40 | ppl    81.739
total_loss: 33104.88716888428, total_len: 7360
total_loss: 36554.63395690918, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  24 at step     4800 | time:  6.65s | valid loss  4.50 | valid ppl    89.832
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  21 step     5000 |    160 batches | lr 0.00012 | ms/batch 39.80 | loss  4.37 | ppl    78.981
total_loss: 32984.265449523926, total_len: 7360
total_loss: 36415.29206085205, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  25 at step     5000 | time:  6.65s | valid loss  4.48 | valid ppl    88.372
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  22 step     5200 |    118 batches | lr 0.00012 | ms/batch 39.01 | loss  4.34 | ppl    76.574
total_loss: 32849.004165649414, total_len: 7360
total_loss: 36234.67169189453, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  26 at step     5200 | time:  6.57s | valid loss  4.46 | valid ppl    86.763
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  23 step     5400 |     76 batches | lr 0.000119 | ms/batch 38.76 | loss  4.32 | ppl    75.474
total_loss: 32663.751121520996, total_len: 7360
total_loss: 36021.75121307373, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  27 at step     5400 | time:  6.57s | valid loss  4.44 | valid ppl    84.606
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5600 |     34 batches | lr 0.000119 | ms/batch 42.18 | loss  4.27 | ppl    71.796
total_loss: 32556.38405609131, total_len: 7360
total_loss: 35893.037925720215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  28 at step     5600 | time:  6.75s | valid loss  4.42 | valid ppl    83.381
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5800 |    234 batches | lr 0.000119 | ms/batch 39.83 | loss  4.25 | ppl    69.804
total_loss: 32404.7957611084, total_len: 7360
total_loss: 35714.794525146484, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  29 at step     5800 | time:  6.62s | valid loss  4.40 | valid ppl    81.681
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  25 step     6000 |    192 batches | lr 0.000118 | ms/batch 38.57 | loss  4.22 | ppl    68.206
total_loss: 32296.746658325195, total_len: 7360
total_loss: 35593.96942901611, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  30 at step     6000 | time:  6.63s | valid loss  4.39 | valid ppl    80.491
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  26 step     6200 |    150 batches | lr 0.000118 | ms/batch 39.03 | loss  4.19 | ppl    66.293
total_loss: 32203.053268432617, total_len: 7360
total_loss: 35471.472160339355, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  31 at step     6200 | time:  6.75s | valid loss  4.38 | valid ppl    79.473
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  27 step     6400 |    108 batches | lr 0.000117 | ms/batch 39.95 | loss  4.18 | ppl    65.422
total_loss: 32118.564002990723, total_len: 7360
total_loss: 35381.449211120605, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  32 at step     6400 | time:  7.49s | valid loss  4.36 | valid ppl    78.566
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  28 step     6600 |     66 batches | lr 0.000117 | ms/batch 41.21 | loss  4.16 | ppl    64.081
total_loss: 31998.3546295166, total_len: 7360
total_loss: 35250.93826293945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  33 at step     6600 | time:  6.35s | valid loss  4.35 | valid ppl    77.293
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     6800 |     24 batches | lr 0.000116 | ms/batch 41.16 | loss  4.12 | ppl    61.782
total_loss: 31874.151077270508, total_len: 7360
total_loss: 35118.55498504639, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  34 at step     6800 | time:  6.72s | valid loss  4.33 | valid ppl    76.000
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     7000 |    224 batches | lr 0.000116 | ms/batch 38.79 | loss  4.10 | ppl    60.505
total_loss: 31799.64549255371, total_len: 7360
total_loss: 35027.88954162598, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  35 at step     7000 | time:  7.16s | valid loss  4.32 | valid ppl    75.234
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  30 step     7200 |    182 batches | lr 0.000115 | ms/batch 45.11 | loss  4.08 | ppl    59.319
total_loss: 31707.176559448242, total_len: 7360
total_loss: 34910.356536865234, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  36 at step     7200 | time:  6.48s | valid loss  4.31 | valid ppl    74.295
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  31 step     7400 |    140 batches | lr 0.000115 | ms/batch 44.36 | loss  4.07 | ppl    58.340
total_loss: 31627.433975219727, total_len: 7360
total_loss: 34813.152740478516, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  37 at step     7400 | time:  6.82s | valid loss  4.30 | valid ppl    73.494
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  32 step     7600 |     98 batches | lr 0.000114 | ms/batch 38.96 | loss  4.06 | ppl    57.889
total_loss: 31555.978118896484, total_len: 7360
total_loss: 34741.86614227295, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  38 at step     7600 | time:  6.52s | valid loss  4.29 | valid ppl    72.784
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  33 step     7800 |     56 batches | lr 0.000114 | ms/batch 45.05 | loss  4.03 | ppl    56.525
total_loss: 31474.944618225098, total_len: 7360
total_loss: 34637.90064239502, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  39 at step     7800 | time:  6.39s | valid loss  4.28 | valid ppl    71.987
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8000 |     14 batches | lr 0.000113 | ms/batch 41.20 | loss  4.01 | ppl    55.018
total_loss: 31444.761711120605, total_len: 7360
total_loss: 34607.37760925293, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  40 at step     8000 | time:  6.47s | valid loss  4.27 | valid ppl    71.692
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8200 |    214 batches | lr 0.000112 | ms/batch 39.10 | loss  4.00 | ppl    54.380
total_loss: 31382.27059173584, total_len: 7360
total_loss: 34521.39817047119, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  41 at step     8200 | time:  6.40s | valid loss  4.26 | valid ppl    71.086
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  35 step     8400 |    172 batches | lr 0.000112 | ms/batch 40.25 | loss  3.98 | ppl    53.264
total_loss: 31301.501220703125, total_len: 7360
total_loss: 34449.27781677246, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  42 at step     8400 | time:  6.45s | valid loss  4.25 | valid ppl    70.311
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  36 step     8600 |    130 batches | lr 0.000111 | ms/batch 38.60 | loss  3.96 | ppl    52.627
total_loss: 31283.599479675293, total_len: 7360
total_loss: 34405.5361328125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  43 at step     8600 | time:  6.41s | valid loss  4.25 | valid ppl    70.140
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  37 step     8800 |     88 batches | lr 0.000111 | ms/batch 37.96 | loss  3.96 | ppl    52.615
total_loss: 31247.07836151123, total_len: 7360
total_loss: 34354.2583694458, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  44 at step     8800 | time:  6.36s | valid loss  4.25 | valid ppl    69.793
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  38 step     9000 |     46 batches | lr 0.00011 | ms/batch 37.87 | loss  3.93 | ppl    51.154
total_loss: 31185.953727722168, total_len: 7360
total_loss: 34301.298110961914, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  45 at step     9000 | time:  6.35s | valid loss  4.24 | valid ppl    69.215
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9200 |      4 batches | lr 0.000109 | ms/batch 37.13 | loss  3.91 | ppl    50.115
total_loss: 31070.30118560791, total_len: 7360
total_loss: 34174.72659301758, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  46 at step     9200 | time:  6.18s | valid loss  4.22 | valid ppl    68.136
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9400 |    204 batches | lr 0.000109 | ms/batch 43.59 | loss  3.90 | ppl    49.519
total_loss: 31060.286712646484, total_len: 7360
total_loss: 34171.27687072754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  47 at step     9400 | time:  6.21s | valid loss  4.22 | valid ppl    68.044
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  40 step     9600 |    162 batches | lr 0.000108 | ms/batch 36.21 | loss  3.89 | ppl    48.763
total_loss: 30968.706413269043, total_len: 7360
total_loss: 34065.983154296875, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  48 at step     9600 | time:  6.25s | valid loss  4.21 | valid ppl    67.202
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  41 step     9800 |    120 batches | lr 0.000107 | ms/batch 39.86 | loss  3.87 | ppl    48.097
total_loss: 30952.22536468506, total_len: 7360
total_loss: 34029.05965423584, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  49 at step     9800 | time:  6.59s | valid loss  4.21 | valid ppl    67.052
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  42 step    10000 |     78 batches | lr 0.000107 | ms/batch 40.26 | loss  3.88 | ppl    48.294
total_loss: 30871.01016998291, total_len: 7360
total_loss: 33953.15651702881, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  50 at step    10000 | time:  6.54s | valid loss  4.19 | valid ppl    66.316
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10200 |     36 batches | lr 0.000106 | ms/batch 42.75 | loss  3.84 | ppl    46.659
total_loss: 30813.815086364746, total_len: 7360
total_loss: 33878.68796539307, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  51 at step    10200 | time:  6.71s | valid loss  4.19 | valid ppl    65.803
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10400 |    236 batches | lr 0.000105 | ms/batch 39.25 | loss  3.83 | ppl    45.870
total_loss: 30695.095573425293, total_len: 7360
total_loss: 33769.25884246826, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  52 at step    10400 | time:  6.62s | valid loss  4.17 | valid ppl    64.750
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  44 step    10600 |    194 batches | lr 0.000105 | ms/batch 44.02 | loss  3.82 | ppl    45.452
total_loss: 30664.47332763672, total_len: 7360
total_loss: 33704.11374664307, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  53 at step    10600 | time:  6.95s | valid loss  4.17 | valid ppl    64.481
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  45 step    10800 |    152 batches | lr 0.000104 | ms/batch 41.33 | loss  3.80 | ppl    44.635
total_loss: 30579.704162597656, total_len: 7360
total_loss: 33611.67498779297, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  54 at step    10800 | time:  6.47s | valid loss  4.15 | valid ppl    63.742
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  46 step    11000 |    110 batches | lr 0.000103 | ms/batch 39.09 | loss  3.79 | ppl    44.345
total_loss: 30501.222274780273, total_len: 7360
total_loss: 33540.701416015625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  55 at step    11000 | time:  6.34s | valid loss  4.14 | valid ppl    63.066
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  47 step    11200 |     68 batches | lr 0.000102 | ms/batch 39.38 | loss  3.79 | ppl    44.102
total_loss: 30376.1826171875, total_len: 7360
total_loss: 33392.22897338867, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  56 at step    11200 | time:  9.76s | valid loss  4.13 | valid ppl    62.004
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11400 |     26 batches | lr 0.000102 | ms/batch 56.03 | loss  3.76 | ppl    42.736
total_loss: 30327.20957183838, total_len: 7360
total_loss: 33334.728660583496, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  57 at step    11400 | time:  6.57s | valid loss  4.12 | valid ppl    61.593
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11600 |    226 batches | lr 0.000101 | ms/batch 38.35 | loss  3.74 | ppl    42.124
total_loss: 30239.12437438965, total_len: 7360
total_loss: 33242.68077850342, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  58 at step    11600 | time:  6.45s | valid loss  4.11 | valid ppl    60.860
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  49 step    11800 |    184 batches | lr 0.0001 | ms/batch 38.31 | loss  3.73 | ppl    41.534
total_loss: 30225.7032623291, total_len: 7360
total_loss: 33191.3674697876, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  59 at step    11800 | time:  6.62s | valid loss  4.11 | valid ppl    60.749
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  50 step    12000 |    142 batches | lr 9.92e-05 | ms/batch 39.71 | loss  3.72 | ppl    41.187
total_loss: 30107.330947875977, total_len: 7360
total_loss: 33070.0788269043, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  60 at step    12000 | time:  6.42s | valid loss  4.09 | valid ppl    59.780
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  51 step    12200 |    100 batches | lr 9.84e-05 | ms/batch 38.06 | loss  3.71 | ppl    40.979
total_loss: 30094.743453979492, total_len: 7360
total_loss: 33079.72203063965, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  61 at step    12200 | time:  6.35s | valid loss  4.09 | valid ppl    59.678
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  52 step    12400 |     58 batches | lr 9.76e-05 | ms/batch 37.73 | loss  3.70 | ppl    40.440
total_loss: 29981.528381347656, total_len: 7360
total_loss: 32965.91152191162, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  62 at step    12400 | time:  6.43s | valid loss  4.07 | valid ppl    58.767
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12600 |     16 batches | lr 9.68e-05 | ms/batch 37.66 | loss  3.68 | ppl    39.493
total_loss: 29913.571250915527, total_len: 7360
total_loss: 32870.53112030029, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  63 at step    12600 | time:  6.32s | valid loss  4.06 | valid ppl    58.227
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12800 |    216 batches | lr 9.6e-05 | ms/batch 37.04 | loss  3.67 | ppl    39.195
total_loss: 29950.0142288208, total_len: 7360
total_loss: 32892.36890411377, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  64 at step    12800 | time:  6.74s | valid loss  4.07 | valid ppl    58.516
----------------------------------------------------------------------------------------------------
| epoch  54 step    13000 |    174 batches | lr 9.52e-05 | ms/batch 30.95 | loss  3.66 | ppl    38.679
total_loss: 29837.866249084473, total_len: 7360
total_loss: 32761.674682617188, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  65 at step    13000 | time:  6.16s | valid loss  4.05 | valid ppl    57.631
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  55 step    13200 |    132 batches | lr 9.43e-05 | ms/batch 37.54 | loss  3.65 | ppl    38.345
total_loss: 29830.338844299316, total_len: 7360
total_loss: 32748.74568939209, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  66 at step    13200 | time:  6.22s | valid loss  4.05 | valid ppl    57.572
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  56 step    13400 |     90 batches | lr 9.35e-05 | ms/batch 38.29 | loss  3.65 | ppl    38.467
total_loss: 29757.106559753418, total_len: 7360
total_loss: 32679.316780090332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  67 at step    13400 | time:  6.48s | valid loss  4.04 | valid ppl    57.002
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  57 step    13600 |     48 batches | lr 9.26e-05 | ms/batch 40.52 | loss  3.63 | ppl    37.594
total_loss: 29761.99639892578, total_len: 7360
total_loss: 32662.2724609375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  68 at step    13600 | time:  6.26s | valid loss  4.04 | valid ppl    57.040
----------------------------------------------------------------------------------------------------
| epoch  58 step    13800 |      6 batches | lr 9.17e-05 | ms/batch 32.68 | loss  3.61 | ppl    37.020
total_loss: 29679.381561279297, total_len: 7360
total_loss: 32573.662559509277, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  69 at step    13800 | time:  6.55s | valid loss  4.03 | valid ppl    56.403
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    14000 |    206 batches | lr 9.09e-05 | ms/batch 38.66 | loss  3.60 | ppl    36.769
total_loss: 29718.123779296875, total_len: 7360
total_loss: 32603.856590270996, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  70 at step    14000 | time:  6.58s | valid loss  4.04 | valid ppl    56.701
----------------------------------------------------------------------------------------------------
| epoch  59 step    14200 |    164 batches | lr 9e-05 | ms/batch 32.08 | loss  3.60 | ppl    36.437
total_loss: 29660.504737854004, total_len: 7360
total_loss: 32549.264320373535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  71 at step    14200 | time:  6.56s | valid loss  4.03 | valid ppl    56.259
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  60 step    14400 |    122 batches | lr 8.91e-05 | ms/batch 39.74 | loss  3.59 | ppl    36.141
total_loss: 29641.494201660156, total_len: 7360
total_loss: 32528.482162475586, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  72 at step    14400 | time:  6.31s | valid loss  4.03 | valid ppl    56.114
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  61 step    14600 |     80 batches | lr 8.82e-05 | ms/batch 37.51 | loss  3.60 | ppl    36.477
total_loss: 29592.483604431152, total_len: 7360
total_loss: 32467.816665649414, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  73 at step    14600 | time:  6.60s | valid loss  4.02 | valid ppl    55.741
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    14800 |     38 batches | lr 8.73e-05 | ms/batch 43.70 | loss  3.57 | ppl    35.403
total_loss: 29595.97735595703, total_len: 7360
total_loss: 32472.099571228027, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  74 at step    14800 | time:  6.53s | valid loss  4.02 | valid ppl    55.768
----------------------------------------------------------------------------------------------------
| epoch  62 step    15000 |    238 batches | lr 8.64e-05 | ms/batch 32.62 | loss  3.56 | ppl    35.067
total_loss: 29576.338981628418, total_len: 7360
total_loss: 32450.988121032715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  75 at step    15000 | time:  6.58s | valid loss  4.02 | valid ppl    55.619
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  63 step    15200 |    196 batches | lr 8.55e-05 | ms/batch 47.69 | loss  3.55 | ppl    34.892
total_loss: 29517.89813232422, total_len: 7360
total_loss: 32385.73332977295, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  76 at step    15200 | time:  6.83s | valid loss  4.01 | valid ppl    55.179
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  64 step    15400 |    154 batches | lr 8.46e-05 | ms/batch 49.11 | loss  3.54 | ppl    34.623
total_loss: 29500.871284484863, total_len: 7360
total_loss: 32355.67111968994, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  77 at step    15400 | time:  7.64s | valid loss  4.01 | valid ppl    55.052
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  65 step    15600 |    112 batches | lr 8.37e-05 | ms/batch 43.67 | loss  3.54 | ppl    34.535
total_loss: 29468.2098236084, total_len: 7360
total_loss: 32313.289627075195, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  78 at step    15600 | time:  7.50s | valid loss  4.00 | valid ppl    54.808
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  66 step    15800 |     70 batches | lr 8.27e-05 | ms/batch 44.44 | loss  3.54 | ppl    34.577
total_loss: 29421.18083190918, total_len: 7360
total_loss: 32279.649696350098, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  79 at step    15800 | time:  7.72s | valid loss  4.00 | valid ppl    54.459
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16000 |     28 batches | lr 8.18e-05 | ms/batch 46.25 | loss  3.52 | ppl    33.702
total_loss: 29417.016960144043, total_len: 7360
total_loss: 32266.763710021973, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  80 at step    16000 | time:  7.76s | valid loss  4.00 | valid ppl    54.428
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16200 |    228 batches | lr 8.09e-05 | ms/batch 45.13 | loss  3.51 | ppl    33.451
total_loss: 29466.64936065674, total_len: 7360
total_loss: 32316.760887145996, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  81 at step    16200 | time:  7.66s | valid loss  4.00 | valid ppl    54.796
----------------------------------------------------------------------------------------------------
| epoch  68 step    16400 |    186 batches | lr 7.99e-05 | ms/batch 38.18 | loss  3.50 | ppl    33.262
total_loss: 29437.37173461914, total_len: 7360
total_loss: 32279.200828552246, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  82 at step    16400 | time:  7.98s | valid loss  4.00 | valid ppl    54.579
----------------------------------------------------------------------------------------------------
| epoch  69 step    16600 |    144 batches | lr 7.9e-05 | ms/batch 38.38 | loss  3.50 | ppl    33.153
total_loss: 29354.08132171631, total_len: 7360
total_loss: 32174.269020080566, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  83 at step    16600 | time:  7.50s | valid loss  3.99 | valid ppl    53.964
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  70 step    16800 |    102 batches | lr 7.8e-05 | ms/batch 44.77 | loss  3.50 | ppl    33.147
total_loss: 29335.551818847656, total_len: 7360
total_loss: 32175.03598022461, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  84 at step    16800 | time:  7.81s | valid loss  3.99 | valid ppl    53.829
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  71 step    17000 |     60 batches | lr 7.71e-05 | ms/batch 44.09 | loss  3.50 | ppl    32.999
total_loss: 29299.06672668457, total_len: 7360
total_loss: 32133.35880279541, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  85 at step    17000 | time:  7.52s | valid loss  3.98 | valid ppl    53.563
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17200 |     18 batches | lr 7.61e-05 | ms/batch 43.84 | loss  3.48 | ppl    32.339
total_loss: 29285.009689331055, total_len: 7360
total_loss: 32102.980125427246, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  86 at step    17200 | time:  7.57s | valid loss  3.98 | valid ppl    53.460
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17400 |    218 batches | lr 7.52e-05 | ms/batch 44.21 | loss  3.47 | ppl    32.177
total_loss: 29296.587928771973, total_len: 7360
total_loss: 32106.407218933105, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  87 at step    17400 | time:  6.65s | valid loss  3.98 | valid ppl    53.545
----------------------------------------------------------------------------------------------------
| epoch  73 step    17600 |    176 batches | lr 7.42e-05 | ms/batch 32.07 | loss  3.46 | ppl    31.915
total_loss: 29254.035232543945, total_len: 7360
total_loss: 32061.11100769043, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  88 at step    17600 | time:  6.41s | valid loss  3.97 | valid ppl    53.236
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  74 step    17800 |    134 batches | lr 7.32e-05 | ms/batch 47.19 | loss  3.46 | ppl    31.863
total_loss: 29254.28089904785, total_len: 7360
total_loss: 32061.43324279785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  89 at step    17800 | time:  6.75s | valid loss  3.97 | valid ppl    53.238
----------------------------------------------------------------------------------------------------
| epoch  75 step    18000 |     92 batches | lr 7.23e-05 | ms/batch 33.12 | loss  3.47 | ppl    32.182
total_loss: 29257.652862548828, total_len: 7360
total_loss: 32071.283325195312, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  90 at step    18000 | time:  6.55s | valid loss  3.98 | valid ppl    53.262
----------------------------------------------------------------------------------------------------
| epoch  76 step    18200 |     50 batches | lr 7.13e-05 | ms/batch 32.63 | loss  3.45 | ppl    31.537
total_loss: 29199.152877807617, total_len: 7360
total_loss: 32014.125686645508, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  91 at step    18200 | time:  6.48s | valid loss  3.97 | valid ppl    52.840
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  77 step    18400 |      8 batches | lr 7.03e-05 | ms/batch 42.07 | loss  3.44 | ppl    31.182
total_loss: 29177.780166625977, total_len: 7360
total_loss: 31962.22007751465, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  92 at step    18400 | time:  6.59s | valid loss  3.96 | valid ppl    52.687
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  77 step    18600 |    208 batches | lr 6.94e-05 | ms/batch 43.16 | loss  3.44 | ppl    31.079
total_loss: 29206.256423950195, total_len: 7360
total_loss: 32006.420738220215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  93 at step    18600 | time:  6.83s | valid loss  3.97 | valid ppl    52.891
----------------------------------------------------------------------------------------------------
| epoch  78 step    18800 |    166 batches | lr 6.84e-05 | ms/batch 32.84 | loss  3.43 | ppl    30.879
total_loss: 29198.477348327637, total_len: 7360
total_loss: 31991.37860107422, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  94 at step    18800 | time:  6.54s | valid loss  3.97 | valid ppl    52.836
----------------------------------------------------------------------------------------------------
| epoch  79 step    19000 |    124 batches | lr 6.74e-05 | ms/batch 32.66 | loss  3.43 | ppl    30.743
total_loss: 29210.80728149414, total_len: 7360
total_loss: 32012.963958740234, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  95 at step    19000 | time:  6.53s | valid loss  3.97 | valid ppl    52.924
----------------------------------------------------------------------------------------------------
| epoch  80 step    19200 |     82 batches | lr 6.64e-05 | ms/batch 32.69 | loss  3.44 | ppl    31.218
total_loss: 29169.44285583496, total_len: 7360
total_loss: 31968.373405456543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  96 at step    19200 | time:  6.43s | valid loss  3.96 | valid ppl    52.628
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19400 |     40 batches | lr 6.54e-05 | ms/batch 38.42 | loss  3.41 | ppl    30.377
total_loss: 29181.423217773438, total_len: 7360
total_loss: 31959.99481201172, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  97 at step    19400 | time:  6.28s | valid loss  3.96 | valid ppl    52.713
----------------------------------------------------------------------------------------------------
| epoch  81 step    19600 |    240 batches | lr 6.45e-05 | ms/batch 31.05 | loss  3.41 | ppl    30.205
total_loss: 29183.735946655273, total_len: 7360
total_loss: 31978.2953414917, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  98 at step    19600 | time:  6.17s | valid loss  3.97 | valid ppl    52.730
----------------------------------------------------------------------------------------------------
| epoch  82 step    19800 |    198 batches | lr 6.35e-05 | ms/batch 30.86 | loss  3.41 | ppl    30.238
total_loss: 29151.628829956055, total_len: 7360
total_loss: 31943.57940673828, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  99 at step    19800 | time:  6.33s | valid loss  3.96 | valid ppl    52.500
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  83 step    20000 |    156 batches | lr 6.25e-05 | ms/batch 40.05 | loss  3.40 | ppl    29.996
total_loss: 29124.79997253418, total_len: 7360
total_loss: 31899.541732788086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 100 at step    20000 | time:  6.37s | valid loss  3.96 | valid ppl    52.309
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  84 step    20200 |    114 batches | lr 6.15e-05 | ms/batch 38.58 | loss  3.40 | ppl    29.964
total_loss: 29131.05558013916, total_len: 7360
total_loss: 31902.137580871582, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 101 at step    20200 | time:  6.37s | valid loss  3.96 | valid ppl    52.354
----------------------------------------------------------------------------------------------------
| epoch  85 step    20400 |     72 batches | lr 6.05e-05 | ms/batch 31.61 | loss  3.41 | ppl    30.227
total_loss: 29093.722686767578, total_len: 7360
total_loss: 31870.414543151855, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 102 at step    20400 | time:  6.33s | valid loss  3.95 | valid ppl    52.089
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  86 step    20600 |     30 batches | lr 5.96e-05 | ms/batch 39.10 | loss  3.39 | ppl    29.528
total_loss: 29071.932708740234, total_len: 7360
total_loss: 31836.51732635498, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 103 at step    20600 | time:  6.53s | valid loss  3.95 | valid ppl    51.935
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  86 step    20800 |    230 batches | lr 5.86e-05 | ms/batch 43.20 | loss  3.38 | ppl    29.360
total_loss: 29096.163688659668, total_len: 7360
total_loss: 31869.854026794434, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 104 at step    20800 | time:  7.58s | valid loss  3.95 | valid ppl    52.106
----------------------------------------------------------------------------------------------------
| epoch  87 step    21000 |    188 batches | lr 5.76e-05 | ms/batch 38.42 | loss  3.38 | ppl    29.380
total_loss: 29087.876678466797, total_len: 7360
total_loss: 31859.885749816895, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 105 at step    21000 | time:  7.95s | valid loss  3.95 | valid ppl    52.048
----------------------------------------------------------------------------------------------------
| epoch  88 step    21200 |    146 batches | lr 5.66e-05 | ms/batch 39.03 | loss  3.38 | ppl    29.314
total_loss: 29047.311653137207, total_len: 7360
total_loss: 31798.924713134766, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 106 at step    21200 | time:  7.47s | valid loss  3.95 | valid ppl    51.761
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  89 step    21400 |    104 batches | lr 5.56e-05 | ms/batch 50.40 | loss  3.38 | ppl    29.385
total_loss: 29064.988288879395, total_len: 7360
total_loss: 31821.237228393555, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 107 at step    21400 | time:  7.60s | valid loss  3.95 | valid ppl    51.886
----------------------------------------------------------------------------------------------------
| epoch  90 step    21600 |     62 batches | lr 5.47e-05 | ms/batch 37.26 | loss  3.38 | ppl    29.280
total_loss: 29000.507064819336, total_len: 7360
total_loss: 31742.39111328125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 108 at step    21600 | time:  7.45s | valid loss  3.94 | valid ppl    51.433
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  91 step    21800 |     20 batches | lr 5.37e-05 | ms/batch 44.20 | loss  3.36 | ppl    28.772
total_loss: 29003.768280029297, total_len: 7360
total_loss: 31754.378288269043, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 109 at step    21800 | time:  7.53s | valid loss  3.94 | valid ppl    51.456
----------------------------------------------------------------------------------------------------
| epoch  91 step    22000 |    220 batches | lr 5.27e-05 | ms/batch 36.98 | loss  3.36 | ppl    28.801
total_loss: 29034.806091308594, total_len: 7360
total_loss: 31782.847259521484, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 110 at step    22000 | time:  7.40s | valid loss  3.94 | valid ppl    51.674
----------------------------------------------------------------------------------------------------
| epoch  92 step    22200 |    178 batches | lr 5.18e-05 | ms/batch 37.54 | loss  3.35 | ppl    28.639
total_loss: 29028.82586669922, total_len: 7360
total_loss: 31782.152961730957, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 111 at step    22200 | time:  7.50s | valid loss  3.94 | valid ppl    51.632
----------------------------------------------------------------------------------------------------
| epoch  93 step    22400 |    136 batches | lr 5.08e-05 | ms/batch 37.18 | loss  3.35 | ppl    28.549
total_loss: 29005.91576385498, total_len: 7360
total_loss: 31759.041122436523, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 112 at step    22400 | time:  7.44s | valid loss  3.94 | valid ppl    51.471
----------------------------------------------------------------------------------------------------
| epoch  94 step    22600 |     94 batches | lr 4.98e-05 | ms/batch 37.92 | loss  3.36 | ppl    28.829
total_loss: 28962.68507385254, total_len: 7360
total_loss: 31707.006149291992, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 113 at step    22600 | time:  7.59s | valid loss  3.94 | valid ppl    51.170
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  95 step    22800 |     52 batches | lr 4.89e-05 | ms/batch 44.84 | loss  3.35 | ppl    28.508
total_loss: 28990.075927734375, total_len: 7360
total_loss: 31737.928985595703, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 114 at step    22800 | time:  7.45s | valid loss  3.94 | valid ppl    51.360
----------------------------------------------------------------------------------------------------
| epoch  96 step    23000 |     10 batches | lr 4.79e-05 | ms/batch 38.15 | loss  3.34 | ppl    28.130
total_loss: 28996.37843322754, total_len: 7360
total_loss: 31734.432960510254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 115 at step    23000 | time:  8.03s | valid loss  3.94 | valid ppl    51.404
----------------------------------------------------------------------------------------------------
| epoch  96 step    23200 |    210 batches | lr 4.7e-05 | ms/batch 36.98 | loss  3.34 | ppl    28.193
total_loss: 28988.040534973145, total_len: 7360
total_loss: 31725.692726135254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 116 at step    23200 | time:  6.79s | valid loss  3.94 | valid ppl    51.346
----------------------------------------------------------------------------------------------------
| epoch  97 step    23400 |    168 batches | lr 4.6e-05 | ms/batch 33.45 | loss  3.33 | ppl    28.063
total_loss: 28992.210327148438, total_len: 7360
total_loss: 31730.46809387207, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 117 at step    23400 | time:  6.59s | valid loss  3.94 | valid ppl    51.375
----------------------------------------------------------------------------------------------------
| epoch  98 step    23600 |    126 batches | lr 4.51e-05 | ms/batch 32.43 | loss  3.33 | ppl    28.001
total_loss: 29001.36880493164, total_len: 7360
total_loss: 31736.844917297363, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 118 at step    23600 | time:  6.41s | valid loss  3.94 | valid ppl    51.439
----------------------------------------------------------------------------------------------------
| epoch  99 step    23800 |     84 batches | lr 4.41e-05 | ms/batch 32.13 | loss  3.35 | ppl    28.394
total_loss: 28940.33683013916, total_len: 7360
total_loss: 31673.386238098145, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 119 at step    23800 | time:  6.47s | valid loss  3.93 | valid ppl    51.015
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 100 step    24000 |     42 batches | lr 4.32e-05 | ms/batch 40.31 | loss  3.32 | ppl    27.761
total_loss: 28965.416564941406, total_len: 7360
total_loss: 31700.461791992188, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 120 at step    24000 | time:  6.99s | valid loss  3.94 | valid ppl    51.189
----------------------------------------------------------------------------------------------------
| epoch 100 step    24200 |    242 batches | lr 4.23e-05 | ms/batch 35.78 | loss  3.32 | ppl    27.607
total_loss: 28973.49250793457, total_len: 7360
total_loss: 31718.974433898926, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 121 at step    24200 | time:  6.72s | valid loss  3.94 | valid ppl    51.245
----------------------------------------------------------------------------------------------------
| epoch 101 step    24400 |    200 batches | lr 4.13e-05 | ms/batch 33.14 | loss  3.32 | ppl    27.697
total_loss: 28946.681427001953, total_len: 7360
total_loss: 31683.23080444336, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 122 at step    24400 | time:  8.29s | valid loss  3.93 | valid ppl    51.059
----------------------------------------------------------------------------------------------------
| epoch 102 step    24600 |    158 batches | lr 4.04e-05 | ms/batch 32.86 | loss  3.32 | ppl    27.537
total_loss: 28942.157890319824, total_len: 7360
total_loss: 31681.06192779541, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 123 at step    24600 | time:  6.60s | valid loss  3.93 | valid ppl    51.027
----------------------------------------------------------------------------------------------------
| epoch 103 step    24800 |    116 batches | lr 3.95e-05 | ms/batch 31.63 | loss  3.32 | ppl    27.584
total_loss: 28939.294006347656, total_len: 7360
total_loss: 31681.54907989502, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 124 at step    24800 | time:  6.39s | valid loss  3.93 | valid ppl    51.007
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 104 step    25000 |     74 batches | lr 3.86e-05 | ms/batch 38.28 | loss  3.33 | ppl    27.800
total_loss: 28919.50872039795, total_len: 7360
total_loss: 31653.211196899414, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 125 at step    25000 | time:  6.32s | valid loss  3.93 | valid ppl    50.870
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 105 step    25200 |     32 batches | lr 3.77e-05 | ms/batch 37.91 | loss  3.30 | ppl    27.228
total_loss: 28925.08642578125, total_len: 7360
total_loss: 31659.932945251465, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 126 at step    25200 | time:  6.44s | valid loss  3.93 | valid ppl    50.909
----------------------------------------------------------------------------------------------------
| epoch 105 step    25400 |    232 batches | lr 3.68e-05 | ms/batch 31.95 | loss  3.30 | ppl    27.150
total_loss: 28958.648727416992, total_len: 7360
total_loss: 31693.58536529541, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 127 at step    25400 | time:  6.34s | valid loss  3.93 | valid ppl    51.142
----------------------------------------------------------------------------------------------------
| epoch 106 step    25600 |    190 batches | lr 3.59e-05 | ms/batch 32.20 | loss  3.30 | ppl    27.198
total_loss: 28934.363761901855, total_len: 7360
total_loss: 31663.995834350586, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 128 at step    25600 | time:  6.81s | valid loss  3.93 | valid ppl    50.973
----------------------------------------------------------------------------------------------------
| epoch 107 step    25800 |    148 batches | lr 3.5e-05 | ms/batch 34.27 | loss  3.30 | ppl    27.154
total_loss: 28927.91753387451, total_len: 7360
total_loss: 31644.7201461792, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 129 at step    25800 | time:  6.94s | valid loss  3.93 | valid ppl    50.929
----------------------------------------------------------------------------------------------------
| epoch 108 step    26000 |    106 batches | lr 3.41e-05 | ms/batch 34.88 | loss  3.31 | ppl    27.302
total_loss: 28933.944480895996, total_len: 7360
total_loss: 31673.883865356445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 130 at step    26000 | time:  6.57s | valid loss  3.93 | valid ppl    50.970
----------------------------------------------------------------------------------------------------
| epoch 109 step    26200 |     64 batches | lr 3.33e-05 | ms/batch 32.54 | loss  3.31 | ppl    27.255
total_loss: 28901.87558746338, total_len: 7360
total_loss: 31632.4930267334, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 131 at step    26200 | time:  6.50s | valid loss  3.93 | valid ppl    50.749
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 110 step    26400 |     22 batches | lr 3.24e-05 | ms/batch 42.81 | loss  3.29 | ppl    26.842
total_loss: 28907.1879196167, total_len: 7360
total_loss: 31627.749633789062, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 132 at step    26400 | time:  6.50s | valid loss  3.93 | valid ppl    50.785
----------------------------------------------------------------------------------------------------
| epoch 110 step    26600 |    222 batches | lr 3.15e-05 | ms/batch 32.36 | loss  3.29 | ppl    26.835
total_loss: 28927.263145446777, total_len: 7360
total_loss: 31636.44179534912, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 133 at step    26600 | time:  6.46s | valid loss  3.93 | valid ppl    50.924
----------------------------------------------------------------------------------------------------
| epoch 111 step    26800 |    180 batches | lr 3.07e-05 | ms/batch 32.20 | loss  3.29 | ppl    26.825
total_loss: 28919.430290222168, total_len: 7360
total_loss: 31633.154808044434, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 134 at step    26800 | time:  6.36s | valid loss  3.93 | valid ppl    50.870
----------------------------------------------------------------------------------------------------
| epoch 112 step    27000 |    138 batches | lr 2.98e-05 | ms/batch 31.41 | loss  3.29 | ppl    26.750
total_loss: 28912.89119720459, total_len: 7360
total_loss: 31634.210250854492, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 135 at step    27000 | time:  6.59s | valid loss  3.93 | valid ppl    50.825
----------------------------------------------------------------------------------------------------
| epoch 113 step    27200 |     96 batches | lr 2.9e-05 | ms/batch 31.65 | loss  3.30 | ppl    27.107
total_loss: 28903.491325378418, total_len: 7360
total_loss: 31622.306785583496, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 136 at step    27200 | time:  6.48s | valid loss  3.93 | valid ppl    50.760
----------------------------------------------------------------------------------------------------
| epoch 114 step    27400 |     54 batches | lr 2.82e-05 | ms/batch 32.54 | loss  3.29 | ppl    26.722
total_loss: 28863.77928161621, total_len: 7360
total_loss: 31584.273643493652, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 137 at step    27400 | time:  6.28s | valid loss  3.92 | valid ppl    50.487
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 115 step    27600 |     12 batches | lr 2.74e-05 | ms/batch 39.82 | loss  3.28 | ppl    26.562
total_loss: 28883.094833374023, total_len: 7360
total_loss: 31595.555587768555, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 138 at step    27600 | time:  6.57s | valid loss  3.92 | valid ppl    50.619
----------------------------------------------------------------------------------------------------
| epoch 115 step    27800 |    212 batches | lr 2.66e-05 | ms/batch 32.43 | loss  3.28 | ppl    26.600
total_loss: 28902.174476623535, total_len: 7360
total_loss: 31615.14665222168, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 139 at step    27800 | time:  6.56s | valid loss  3.93 | valid ppl    50.751
----------------------------------------------------------------------------------------------------
| epoch 116 step    28000 |    170 batches | lr 2.58e-05 | ms/batch 33.38 | loss  3.28 | ppl    26.498
total_loss: 28902.306495666504, total_len: 7360
total_loss: 31616.556266784668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 140 at step    28000 | time:  6.73s | valid loss  3.93 | valid ppl    50.752
----------------------------------------------------------------------------------------------------
| epoch 117 step    28200 |    128 batches | lr 2.5e-05 | ms/batch 33.52 | loss  3.28 | ppl    26.456
total_loss: 28883.60401916504, total_len: 7360
total_loss: 31595.64292907715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 141 at step    28200 | time:  6.62s | valid loss  3.92 | valid ppl    50.623
----------------------------------------------------------------------------------------------------
| epoch 118 step    28400 |     86 batches | lr 2.42e-05 | ms/batch 32.36 | loss  3.29 | ppl    26.790
total_loss: 28866.689392089844, total_len: 7360
total_loss: 31577.734939575195, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 142 at step    28400 | time:  6.75s | valid loss  3.92 | valid ppl    50.507
----------------------------------------------------------------------------------------------------
| epoch 119 step    28600 |     44 batches | lr 2.34e-05 | ms/batch 32.44 | loss  3.27 | ppl    26.362
total_loss: 28905.172729492188, total_len: 7360
total_loss: 31615.279220581055, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 143 at step    28600 | time:  6.39s | valid loss  3.93 | valid ppl    50.771
----------------------------------------------------------------------------------------------------
| epoch 120 step    28800 |      2 batches | lr 2.27e-05 | ms/batch 32.39 | loss  3.27 | ppl    26.225
total_loss: 28883.57144165039, total_len: 7360
total_loss: 31587.241706848145, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 144 at step    28800 | time:  6.49s | valid loss  3.92 | valid ppl    50.623
----------------------------------------------------------------------------------------------------
| epoch 120 step    29000 |    202 batches | lr 2.19e-05 | ms/batch 33.20 | loss  3.27 | ppl    26.321
total_loss: 28896.389602661133, total_len: 7360
total_loss: 31596.784545898438, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 145 at step    29000 | time:  6.68s | valid loss  3.93 | valid ppl    50.711
----------------------------------------------------------------------------------------------------
| epoch 121 step    29200 |    160 batches | lr 2.12e-05 | ms/batch 33.78 | loss  3.27 | ppl    26.269
total_loss: 28872.452430725098, total_len: 7360
total_loss: 31581.590995788574, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 146 at step    29200 | time:  6.75s | valid loss  3.92 | valid ppl    50.546
----------------------------------------------------------------------------------------------------
| epoch 122 step    29400 |    118 batches | lr 2.04e-05 | ms/batch 33.46 | loss  3.27 | ppl    26.278
total_loss: 28879.420684814453, total_len: 7360
total_loss: 31587.754592895508, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 147 at step    29400 | time:  6.60s | valid loss  3.92 | valid ppl    50.594
----------------------------------------------------------------------------------------------------
| epoch 123 step    29600 |     76 batches | lr 1.97e-05 | ms/batch 32.41 | loss  3.28 | ppl    26.546
total_loss: 28859.143798828125, total_len: 7360
total_loss: 31565.351707458496, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 148 at step    29600 | time:  6.53s | valid loss  3.92 | valid ppl    50.455
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 124 step    29800 |     34 batches | lr 1.9e-05 | ms/batch 39.35 | loss  3.26 | ppl    26.056
total_loss: 28844.63813018799, total_len: 7360
total_loss: 31547.076400756836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 149 at step    29800 | time:  6.80s | valid loss  3.92 | valid ppl    50.356
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 124 step    30000 |    234 batches | lr 1.83e-05 | ms/batch 46.54 | loss  3.26 | ppl    26.008
total_loss: 28880.330795288086, total_len: 7360
total_loss: 31586.57258605957, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 150 at step    30000 | time:  6.76s | valid loss  3.92 | valid ppl    50.600
----------------------------------------------------------------------------------------------------
| epoch 125 step    30200 |    192 batches | lr 1.76e-05 | ms/batch 33.18 | loss  3.26 | ppl    26.092
total_loss: 28906.0433883667, total_len: 7360
total_loss: 31612.673721313477, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 151 at step    30200 | time:  6.83s | valid loss  3.93 | valid ppl    50.777
----------------------------------------------------------------------------------------------------
| epoch 126 step    30400 |    150 batches | lr 1.69e-05 | ms/batch 34.22 | loss  3.26 | ppl    25.959
total_loss: 28878.02614593506, total_len: 7360
total_loss: 31579.800956726074, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 152 at step    30400 | time:  6.61s | valid loss  3.92 | valid ppl    50.584
----------------------------------------------------------------------------------------------------
| epoch 127 step    30600 |    108 batches | lr 1.63e-05 | ms/batch 32.89 | loss  3.27 | ppl    26.233
total_loss: 28863.12467956543, total_len: 7360
total_loss: 31568.76473236084, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 153 at step    30600 | time:  6.41s | valid loss  3.92 | valid ppl    50.482
----------------------------------------------------------------------------------------------------
| epoch 128 step    30800 |     66 batches | lr 1.56e-05 | ms/batch 32.40 | loss  3.27 | ppl    26.194
total_loss: 28846.20314025879, total_len: 7360
total_loss: 31545.5336227417, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 154 at step    30800 | time:  6.56s | valid loss  3.92 | valid ppl    50.366
----------------------------------------------------------------------------------------------------
| epoch 129 step    31000 |     24 batches | lr 1.5e-05 | ms/batch 32.86 | loss  3.25 | ppl    25.810
total_loss: 28852.93084716797, total_len: 7360
total_loss: 31550.471992492676, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 155 at step    31000 | time:  6.57s | valid loss  3.92 | valid ppl    50.412
----------------------------------------------------------------------------------------------------
| epoch 129 step    31200 |    224 batches | lr 1.43e-05 | ms/batch 33.38 | loss  3.25 | ppl    25.854
total_loss: 28861.002555847168, total_len: 7360
total_loss: 31559.391632080078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 156 at step    31200 | time:  6.64s | valid loss  3.92 | valid ppl    50.468
----------------------------------------------------------------------------------------------------
| epoch 130 step    31400 |    182 batches | lr 1.37e-05 | ms/batch 33.25 | loss  3.25 | ppl    25.768
total_loss: 28846.158683776855, total_len: 7360
total_loss: 31545.315925598145, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 157 at step    31400 | time:  6.62s | valid loss  3.92 | valid ppl    50.366
----------------------------------------------------------------------------------------------------
| epoch 131 step    31600 |    140 batches | lr 1.31e-05 | ms/batch 33.25 | loss  3.25 | ppl    25.839
total_loss: 28853.014450073242, total_len: 7360
total_loss: 31551.091651916504, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 158 at step    31600 | time:  6.68s | valid loss  3.92 | valid ppl    50.413
----------------------------------------------------------------------------------------------------
| epoch 132 step    31800 |     98 batches | lr 1.25e-05 | ms/batch 32.97 | loss  3.26 | ppl    26.119
total_loss: 28835.958152770996, total_len: 7360
total_loss: 31534.19757080078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 159 at step    31800 | time:  6.51s | valid loss  3.92 | valid ppl    50.296
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 133 step    32000 |     56 batches | lr 1.19e-05 | ms/batch 39.88 | loss  3.25 | ppl    25.894
total_loss: 28855.641006469727, total_len: 7360
total_loss: 31558.0272064209, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 160 at step    32000 | time:  6.57s | valid loss  3.92 | valid ppl    50.431
----------------------------------------------------------------------------------------------------
| epoch 134 step    32200 |     14 batches | lr 1.14e-05 | ms/batch 32.74 | loss  3.25 | ppl    25.668
total_loss: 28850.18963623047, total_len: 7360
total_loss: 31548.860809326172, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 161 at step    32200 | time:  6.52s | valid loss  3.92 | valid ppl    50.394
----------------------------------------------------------------------------------------------------
| epoch 134 step    32400 |    214 batches | lr 1.08e-05 | ms/batch 32.72 | loss  3.25 | ppl    25.797
total_loss: 28853.736289978027, total_len: 7360
total_loss: 31553.158210754395, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 162 at step    32400 | time:  6.57s | valid loss  3.92 | valid ppl    50.418
----------------------------------------------------------------------------------------------------
| epoch 135 step    32600 |    172 batches | lr 1.03e-05 | ms/batch 33.45 | loss  3.24 | ppl    25.648
total_loss: 28839.24501800537, total_len: 7360
total_loss: 31537.541816711426, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 163 at step    32600 | time:  6.67s | valid loss  3.92 | valid ppl    50.319
----------------------------------------------------------------------------------------------------
| epoch 136 step    32800 |    130 batches | lr 9.73e-06 | ms/batch 32.76 | loss  3.24 | ppl    25.650
total_loss: 28852.248748779297, total_len: 7360
total_loss: 31553.464645385742, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 164 at step    32800 | time:  7.07s | valid loss  3.92 | valid ppl    50.408
----------------------------------------------------------------------------------------------------
| epoch 137 step    33000 |     88 batches | lr 9.21e-06 | ms/batch 36.03 | loss  3.26 | ppl    26.092
total_loss: 28842.352210998535, total_len: 7360
total_loss: 31540.51188659668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 165 at step    33000 | time:  6.68s | valid loss  3.92 | valid ppl    50.340
----------------------------------------------------------------------------------------------------
| epoch 138 step    33200 |     46 batches | lr 8.7e-06 | ms/batch 32.56 | loss  3.25 | ppl    25.728
total_loss: 28839.86538696289, total_len: 7360
total_loss: 31535.205825805664, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 166 at step    33200 | time:  6.46s | valid loss  3.92 | valid ppl    50.323
----------------------------------------------------------------------------------------------------
| epoch 139 step    33400 |      4 batches | lr 8.21e-06 | ms/batch 32.08 | loss  3.24 | ppl    25.572
total_loss: 28845.016021728516, total_len: 7360
total_loss: 31541.477027893066, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 167 at step    33400 | time:  6.39s | valid loss  3.92 | valid ppl    50.358
----------------------------------------------------------------------------------------------------
| epoch 139 step    33600 |    204 batches | lr 7.73e-06 | ms/batch 32.17 | loss  3.24 | ppl    25.644
total_loss: 28855.700721740723, total_len: 7360
total_loss: 31554.492736816406, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 168 at step    33600 | time:  6.47s | valid loss  3.92 | valid ppl    50.431
----------------------------------------------------------------------------------------------------
| epoch 140 step    33800 |    162 batches | lr 7.26e-06 | ms/batch 32.61 | loss  3.24 | ppl    25.547
total_loss: 28848.670051574707, total_len: 7360
total_loss: 31544.49390411377, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 169 at step    33800 | time:  6.46s | valid loss  3.92 | valid ppl    50.383
----------------------------------------------------------------------------------------------------
| epoch 141 step    34000 |    120 batches | lr 6.81e-06 | ms/batch 32.19 | loss  3.24 | ppl    25.653
total_loss: 28844.339874267578, total_len: 7360
total_loss: 31541.249366760254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 170 at step    34000 | time:  6.57s | valid loss  3.92 | valid ppl    50.353
----------------------------------------------------------------------------------------------------
| epoch 142 step    34200 |     78 batches | lr 6.37e-06 | ms/batch 33.54 | loss  3.26 | ppl    26.028
total_loss: 28833.025184631348, total_len: 7360
total_loss: 31523.511276245117, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 171 at step    34200 | time:  6.85s | valid loss  3.92 | valid ppl    50.276
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 143 step    34400 |     36 batches | lr 5.95e-06 | ms/batch 41.64 | loss  3.24 | ppl    25.468
total_loss: 28830.611709594727, total_len: 7360
total_loss: 31522.371337890625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 172 at step    34400 | time:  6.65s | valid loss  3.92 | valid ppl    50.260
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 143 step    34600 |    236 batches | lr 5.54e-06 | ms/batch 42.22 | loss  3.23 | ppl    25.403
total_loss: 28850.816383361816, total_len: 7360
total_loss: 31545.75798034668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 173 at step    34600 | time:  7.48s | valid loss  3.92 | valid ppl    50.398
----------------------------------------------------------------------------------------------------
| epoch 144 step    34800 |    194 batches | lr 5.14e-06 | ms/batch 37.62 | loss  3.24 | ppl    25.572
total_loss: 28833.64292907715, total_len: 7360
total_loss: 31527.75798034668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 174 at step    34800 | time:  7.50s | valid loss  3.92 | valid ppl    50.280
----------------------------------------------------------------------------------------------------
| epoch 145 step    35000 |    152 batches | lr 4.76e-06 | ms/batch 36.87 | loss  3.24 | ppl    25.479
total_loss: 28839.01934814453, total_len: 7360
total_loss: 31531.147491455078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 175 at step    35000 | time:  7.39s | valid loss  3.92 | valid ppl    50.317
----------------------------------------------------------------------------------------------------
| epoch 146 step    35200 |    110 batches | lr 4.39e-06 | ms/batch 38.22 | loss  3.25 | ppl    25.673
total_loss: 28836.022979736328, total_len: 7360
total_loss: 31527.421768188477, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 176 at step    35200 | time:  7.63s | valid loss  3.92 | valid ppl    50.297
----------------------------------------------------------------------------------------------------
| epoch 147 step    35400 |     68 batches | lr 4.03e-06 | ms/batch 37.35 | loss  3.25 | ppl    25.834
total_loss: 28827.641410827637, total_len: 7360
total_loss: 31520.858055114746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 177 at step    35400 | time:  7.46s | valid loss  3.92 | valid ppl    50.239
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 148 step    35600 |     26 batches | lr 3.69e-06 | ms/batch 45.44 | loss  3.23 | ppl    25.308
total_loss: 28837.13042449951, total_len: 7360
total_loss: 31531.259063720703, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 178 at step    35600 | time:  7.57s | valid loss  3.92 | valid ppl    50.304
----------------------------------------------------------------------------------------------------
| epoch 148 step    35800 |    226 batches | lr 3.37e-06 | ms/batch 38.08 | loss  3.23 | ppl    25.322
total_loss: 28830.31586456299, total_len: 7360
total_loss: 31525.750457763672, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 179 at step    35800 | time:  7.58s | valid loss  3.92 | valid ppl    50.258
----------------------------------------------------------------------------------------------------
| epoch 149 step    36000 |    184 batches | lr 3.06e-06 | ms/batch 38.74 | loss  3.24 | ppl    25.432
total_loss: 28832.142868041992, total_len: 7360
total_loss: 31525.218711853027, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 180 at step    36000 | time:  7.74s | valid loss  3.92 | valid ppl    50.270
----------------------------------------------------------------------------------------------------
| epoch 150 step    36200 |    142 batches | lr 2.76e-06 | ms/batch 36.69 | loss  3.24 | ppl    25.461
total_loss: 28833.366668701172, total_len: 7360
total_loss: 31525.77935028076, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 181 at step    36200 | time:  7.32s | valid loss  3.92 | valid ppl    50.278
----------------------------------------------------------------------------------------------------
| epoch 151 step    36400 |    100 batches | lr 2.48e-06 | ms/batch 37.58 | loss  3.25 | ppl    25.705
total_loss: 28836.995399475098, total_len: 7360
total_loss: 31527.464782714844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 182 at step    36400 | time:  7.55s | valid loss  3.92 | valid ppl    50.303
----------------------------------------------------------------------------------------------------
| epoch 152 step    36600 |     58 batches | lr 2.22e-06 | ms/batch 37.64 | loss  3.24 | ppl    25.623
total_loss: 28834.463523864746, total_len: 7360
total_loss: 31524.84659576416, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 183 at step    36600 | time:  7.44s | valid loss  3.92 | valid ppl    50.286
----------------------------------------------------------------------------------------------------
| epoch 153 step    36800 |     16 batches | lr 1.96e-06 | ms/batch 37.94 | loss  3.23 | ppl    25.378
total_loss: 28843.85245513916, total_len: 7360
total_loss: 31539.270622253418, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 184 at step    36800 | time:  7.63s | valid loss  3.92 | valid ppl    50.350
----------------------------------------------------------------------------------------------------
| epoch 153 step    37000 |    216 batches | lr 1.73e-06 | ms/batch 37.69 | loss  3.23 | ppl    25.382
total_loss: 28834.573471069336, total_len: 7360
total_loss: 31527.056060791016, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 185 at step    37000 | time:  7.55s | valid loss  3.92 | valid ppl    50.287
----------------------------------------------------------------------------------------------------
| epoch 154 step    37200 |    174 batches | lr 1.51e-06 | ms/batch 34.01 | loss  3.23 | ppl    25.394
total_loss: 28832.02414703369, total_len: 7360
total_loss: 31524.76271057129, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 186 at step    37200 | time:  6.59s | valid loss  3.92 | valid ppl    50.269
----------------------------------------------------------------------------------------------------
| epoch 155 step    37400 |    132 batches | lr 1.3e-06 | ms/batch 33.99 | loss  3.24 | ppl    25.426
total_loss: 28835.149993896484, total_len: 7360
total_loss: 31527.8556060791, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 187 at step    37400 | time:  6.70s | valid loss  3.92 | valid ppl    50.291
----------------------------------------------------------------------------------------------------
| epoch 156 step    37600 |     90 batches | lr 1.11e-06 | ms/batch 32.94 | loss  3.25 | ppl    25.818
total_loss: 28833.40151977539, total_len: 7360
total_loss: 31524.629592895508, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 188 at step    37600 | time:  6.62s | valid loss  3.92 | valid ppl    50.279
----------------------------------------------------------------------------------------------------
| epoch 157 step    37800 |     48 batches | lr 9.31e-07 | ms/batch 33.29 | loss  3.24 | ppl    25.495
total_loss: 28833.156852722168, total_len: 7360
total_loss: 31524.44329071045, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 189 at step    37800 | time:  6.62s | valid loss  3.92 | valid ppl    50.277
----------------------------------------------------------------------------------------------------
| epoch 158 step    38000 |      6 batches | lr 7.69e-07 | ms/batch 32.89 | loss  3.23 | ppl    25.371
total_loss: 28840.649536132812, total_len: 7360
total_loss: 31533.85523223877, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 190 at step    38000 | time:  6.79s | valid loss  3.92 | valid ppl    50.328
----------------------------------------------------------------------------------------------------
| epoch 158 step    38200 |    206 batches | lr 6.24e-07 | ms/batch 33.59 | loss  3.24 | ppl    25.416
total_loss: 28836.61492919922, total_len: 7360
total_loss: 31529.084999084473, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 191 at step    38200 | time:  6.42s | valid loss  3.92 | valid ppl    50.301
----------------------------------------------------------------------------------------------------
| epoch 159 step    38400 |    164 batches | lr 4.93e-07 | ms/batch 31.31 | loss  3.23 | ppl    25.370
total_loss: 28838.182807922363, total_len: 7360
total_loss: 31530.09368133545, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 192 at step    38400 | time:  6.26s | valid loss  3.92 | valid ppl    50.311
----------------------------------------------------------------------------------------------------
| epoch 160 step    38600 |    122 batches | lr 3.77e-07 | ms/batch 31.18 | loss  3.24 | ppl    25.443
total_loss: 28835.68137359619, total_len: 7360
total_loss: 31527.48748779297, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 193 at step    38600 | time:  6.22s | valid loss  3.92 | valid ppl    50.294
----------------------------------------------------------------------------------------------------
| epoch 161 step    38800 |     80 batches | lr 2.77e-07 | ms/batch 31.38 | loss  3.25 | ppl    25.837
total_loss: 28832.974586486816, total_len: 7360
total_loss: 31524.610260009766, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 194 at step    38800 | time:  6.31s | valid loss  3.92 | valid ppl    50.276
----------------------------------------------------------------------------------------------------
| epoch 162 step    39000 |     38 batches | lr 1.93e-07 | ms/batch 31.39 | loss  3.23 | ppl    25.256
total_loss: 28834.279266357422, total_len: 7360
total_loss: 31526.39372253418, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 195 at step    39000 | time:  6.33s | valid loss  3.92 | valid ppl    50.285
----------------------------------------------------------------------------------------------------
| epoch 162 step    39200 |    238 batches | lr 1.23e-07 | ms/batch 31.72 | loss  3.23 | ppl    25.270
total_loss: 28834.69676208496, total_len: 7360
total_loss: 31526.852905273438, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 196 at step    39200 | time:  6.26s | valid loss  3.92 | valid ppl    50.288
----------------------------------------------------------------------------------------------------
| epoch 163 step    39400 |    196 batches | lr 6.94e-08 | ms/batch 31.15 | loss  3.23 | ppl    25.366
total_loss: 28835.1806640625, total_len: 7360
total_loss: 31527.255683898926, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 197 at step    39400 | time:  6.19s | valid loss  3.92 | valid ppl    50.291
----------------------------------------------------------------------------------------------------
| epoch 164 step    39600 |    154 batches | lr 3.08e-08 | ms/batch 30.72 | loss  3.24 | ppl    25.426
total_loss: 28835.55891418457, total_len: 7360
total_loss: 31527.650062561035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 198 at step    39600 | time:  6.17s | valid loss  3.92 | valid ppl    50.293
----------------------------------------------------------------------------------------------------
| epoch 165 step    39800 |    112 batches | lr 7.71e-09 | ms/batch 30.86 | loss  3.24 | ppl    25.452
total_loss: 28835.526222229004, total_len: 7360
total_loss: 31527.623680114746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 199 at step    39800 | time:  6.16s | valid loss  3.92 | valid ppl    50.293
----------------------------------------------------------------------------------------------------
| epoch 166 step    40000 |     70 batches | lr 0 | ms/batch 31.23 | loss  3.25 | ppl    25.761
total_loss: 28835.543380737305, total_len: 7360
total_loss: 31527.64535522461, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 200 at step    40000 | time:  6.27s | valid loss  3.92 | valid ppl    50.293
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
End of training
total_loss: 31520.858055114746, total_len: 8224
====================================================================================================
| End of training | test loss  3.83 | test ppl    46.191
====================================================================================================
