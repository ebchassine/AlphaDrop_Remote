Training on Single GPU......
Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 51
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_51_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
total_loss: 71321.9536743164, total_len: 7744
total_loss: 75762.84469604492, total_len: 8224
total_loss: 67808.84530639648, total_len: 7360
| Start of training | test loss  9.21 | test bpc 10020.69926
| epoch   1 step      200 |    200 batches | lr 0.000125 | ms/batch 37.92 | loss  7.05 | ppl  1153.182
total_loss: 45490.54122924805, total_len: 7360
total_loss: 50441.456787109375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   1 at step      200 | time:  8.94s | valid loss  6.18 | valid ppl   483.369
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   2 step      400 |    158 batches | lr 0.000125 | ms/batch 36.25 | loss  6.07 | ppl   431.965
total_loss: 42734.8438873291, total_len: 7360
total_loss: 47339.70756530762, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   2 at step      400 | time:  6.09s | valid loss  5.81 | valid ppl   332.409
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   3 step      600 |    116 batches | lr 0.000125 | ms/batch 35.92 | loss  5.80 | ppl   330.176
total_loss: 41441.65525817871, total_len: 7360
total_loss: 45892.552017211914, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   3 at step      600 | time:  6.05s | valid loss  5.63 | valid ppl   278.846
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   4 step      800 |     74 batches | lr 0.000125 | ms/batch 36.46 | loss  5.66 | ppl   285.760
total_loss: 40545.38578796387, total_len: 7360
total_loss: 44881.20442199707, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   4 at step      800 | time:  6.24s | valid loss  5.51 | valid ppl   246.875
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1000 |     32 batches | lr 0.000125 | ms/batch 36.86 | loss  5.52 | ppl   250.736
total_loss: 39941.67402648926, total_len: 7360
total_loss: 44199.69923400879, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1000 | time:  6.16s | valid loss  5.43 | valid ppl   227.433
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1200 |    232 batches | lr 0.000125 | ms/batch 36.01 | loss  5.43 | ppl   228.285
total_loss: 39427.22299194336, total_len: 7360
total_loss: 43655.66259765625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1200 | time:  6.17s | valid loss  5.36 | valid ppl   212.079
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   6 step     1400 |    190 batches | lr 0.000125 | ms/batch 37.16 | loss  5.36 | ppl   212.071
total_loss: 38945.579666137695, total_len: 7360
total_loss: 43102.74685668945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1400 | time:  6.20s | valid loss  5.29 | valid ppl   198.645
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   7 step     1600 |    148 batches | lr 0.000125 | ms/batch 36.28 | loss  5.29 | ppl   198.559
total_loss: 38589.75556945801, total_len: 7360
total_loss: 42718.05700683594, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   8 at step     1600 | time:  6.22s | valid loss  5.24 | valid ppl   189.270
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   8 step     1800 |    106 batches | lr 0.000124 | ms/batch 36.69 | loss  5.24 | ppl   188.621
total_loss: 38296.6628112793, total_len: 7360
total_loss: 42383.94039916992, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   9 at step     1800 | time:  6.11s | valid loss  5.20 | valid ppl   181.881
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   9 step     2000 |     64 batches | lr 0.000124 | ms/batch 35.84 | loss  5.19 | ppl   179.317
total_loss: 37882.99578857422, total_len: 7360
total_loss: 41926.77735900879, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2000 | time:  6.15s | valid loss  5.15 | valid ppl   171.940
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2200 |     22 batches | lr 0.000124 | ms/batch 37.48 | loss  5.13 | ppl   168.320
total_loss: 37559.32012939453, total_len: 7360
total_loss: 41570.01858520508, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2200 | time:  6.23s | valid loss  5.10 | valid ppl   164.542
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2400 |    222 batches | lr 0.000124 | ms/batch 34.77 | loss  5.08 | ppl   160.983
total_loss: 37338.81369018555, total_len: 7360
total_loss: 41316.90577697754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  12 at step     2400 | time:  6.09s | valid loss  5.07 | valid ppl   159.686
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  11 step     2600 |    180 batches | lr 0.000124 | ms/batch 36.76 | loss  5.04 | ppl   153.709
total_loss: 37027.34780883789, total_len: 7360
total_loss: 40970.763916015625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  13 at step     2600 | time:  6.16s | valid loss  5.03 | valid ppl   153.069
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  12 step     2800 |    138 batches | lr 0.000123 | ms/batch 36.40 | loss  4.99 | ppl   147.588
total_loss: 36793.28564453125, total_len: 7360
total_loss: 40704.22987365723, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  14 at step     2800 | time:  6.26s | valid loss  5.00 | valid ppl   148.278
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  13 step     3000 |     96 batches | lr 0.000123 | ms/batch 36.63 | loss  4.97 | ppl   143.766
total_loss: 36537.639572143555, total_len: 7360
total_loss: 40404.60009765625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3000 | time:  6.21s | valid loss  4.96 | valid ppl   143.216
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  14 step     3200 |     54 batches | lr 0.000123 | ms/batch 36.36 | loss  4.92 | ppl   136.637
total_loss: 36253.54870605469, total_len: 7360
total_loss: 40091.53352355957, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  16 at step     3200 | time:  6.17s | valid loss  4.93 | valid ppl   137.793
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3400 |     12 batches | lr 0.000123 | ms/batch 36.31 | loss  4.87 | ppl   129.805
total_loss: 36028.717376708984, total_len: 7360
total_loss: 39841.37562561035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  17 at step     3400 | time:  6.19s | valid loss  4.90 | valid ppl   133.648
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3600 |    212 batches | lr 0.000123 | ms/batch 36.76 | loss  4.83 | ppl   124.870
total_loss: 35719.443115234375, total_len: 7360
total_loss: 39481.50247192383, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  18 at step     3600 | time:  6.22s | valid loss  4.85 | valid ppl   128.148
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  16 step     3800 |    170 batches | lr 0.000122 | ms/batch 36.17 | loss  4.78 | ppl   119.517
total_loss: 35504.49932098389, total_len: 7360
total_loss: 39232.85632324219, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  19 at step     3800 | time:  6.18s | valid loss  4.82 | valid ppl   124.460
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  17 step     4000 |    128 batches | lr 0.000122 | ms/batch 36.45 | loss  4.75 | ppl   115.062
total_loss: 35285.07095336914, total_len: 7360
total_loss: 38971.8405456543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  20 at step     4000 | time:  6.14s | valid loss  4.79 | valid ppl   120.804
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  18 step     4200 |     86 batches | lr 0.000122 | ms/batch 35.50 | loss  4.73 | ppl   112.861
total_loss: 35030.373107910156, total_len: 7360
total_loss: 38660.19290924072, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  21 at step     4200 | time:  6.24s | valid loss  4.76 | valid ppl   116.695
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  19 step     4400 |     44 batches | lr 0.000121 | ms/batch 36.54 | loss  4.67 | ppl   106.764
total_loss: 34786.686096191406, total_len: 7360
total_loss: 38395.90076446533, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  22 at step     4400 | time:  6.19s | valid loss  4.73 | valid ppl   112.894
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4600 |      2 batches | lr 0.000121 | ms/batch 36.88 | loss  4.63 | ppl   102.266
total_loss: 34603.176025390625, total_len: 7360
total_loss: 38183.66881561279, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  23 at step     4600 | time:  6.22s | valid loss  4.70 | valid ppl   110.114
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4800 |    202 batches | lr 0.000121 | ms/batch 36.24 | loss  4.60 | ppl    99.108
total_loss: 34420.248542785645, total_len: 7360
total_loss: 37964.23802947998, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  24 at step     4800 | time:  6.15s | valid loss  4.68 | valid ppl   107.411
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  21 step     5000 |    160 batches | lr 0.00012 | ms/batch 38.01 | loss  4.56 | ppl    95.370
total_loss: 34208.401596069336, total_len: 7360
total_loss: 37717.55471801758, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  25 at step     5000 | time:  6.23s | valid loss  4.65 | valid ppl   104.364
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  22 step     5200 |    118 batches | lr 0.00012 | ms/batch 36.63 | loss  4.52 | ppl    92.277
total_loss: 34012.63530731201, total_len: 7360
total_loss: 37497.391662597656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  26 at step     5200 | time:  6.10s | valid loss  4.62 | valid ppl   101.624
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  23 step     5400 |     76 batches | lr 0.000119 | ms/batch 36.05 | loss  4.51 | ppl    90.683
total_loss: 33784.694328308105, total_len: 7360
total_loss: 37225.40604400635, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  27 at step     5400 | time:  6.06s | valid loss  4.59 | valid ppl    98.525
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5600 |     34 batches | lr 0.000119 | ms/batch 35.92 | loss  4.45 | ppl    85.812
total_loss: 33550.93836975098, total_len: 7360
total_loss: 36979.235511779785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  28 at step     5600 | time:  6.14s | valid loss  4.56 | valid ppl    95.445
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5800 |    234 batches | lr 0.000119 | ms/batch 35.96 | loss  4.41 | ppl    82.425
total_loss: 33478.66641998291, total_len: 7360
total_loss: 36887.92519378662, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  29 at step     5800 | time:  6.06s | valid loss  4.55 | valid ppl    94.512
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  25 step     6000 |    192 batches | lr 0.000118 | ms/batch 35.07 | loss  4.39 | ppl    80.248
total_loss: 33191.020584106445, total_len: 7360
total_loss: 36570.33585357666, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  30 at step     6000 | time:  6.09s | valid loss  4.51 | valid ppl    90.890
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  26 step     6200 |    150 batches | lr 0.000118 | ms/batch 36.04 | loss  4.35 | ppl    77.453
total_loss: 33001.920097351074, total_len: 7360
total_loss: 36355.604751586914, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  31 at step     6200 | time:  6.05s | valid loss  4.48 | valid ppl    88.584
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  27 step     6400 |    108 batches | lr 0.000117 | ms/batch 35.72 | loss  4.33 | ppl    75.977
total_loss: 32912.77716064453, total_len: 7360
total_loss: 36254.98667907715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  32 at step     6400 | time:  6.12s | valid loss  4.47 | valid ppl    87.518
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  28 step     6600 |     66 batches | lr 0.000117 | ms/batch 36.41 | loss  4.30 | ppl    74.010
total_loss: 32698.64850616455, total_len: 7360
total_loss: 36026.13698577881, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  33 at step     6600 | time:  6.15s | valid loss  4.44 | valid ppl    85.008
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     6800 |     24 batches | lr 0.000116 | ms/batch 36.89 | loss  4.26 | ppl    70.725
total_loss: 32595.186378479004, total_len: 7360
total_loss: 35907.08491516113, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  34 at step     6800 | time:  6.17s | valid loss  4.43 | valid ppl    83.822
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     7000 |    224 batches | lr 0.000116 | ms/batch 35.92 | loss  4.23 | ppl    68.984
total_loss: 32471.65040588379, total_len: 7360
total_loss: 35768.40915679932, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  35 at step     7000 | time:  6.10s | valid loss  4.41 | valid ppl    82.427
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  30 step     7200 |    182 batches | lr 0.000115 | ms/batch 36.44 | loss  4.21 | ppl    67.266
total_loss: 32287.899726867676, total_len: 7360
total_loss: 35557.59462738037, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  36 at step     7200 | time:  6.15s | valid loss  4.39 | valid ppl    80.394
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  31 step     7400 |    140 batches | lr 0.000115 | ms/batch 36.52 | loss  4.19 | ppl    65.846
total_loss: 32238.198684692383, total_len: 7360
total_loss: 35482.372901916504, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  37 at step     7400 | time:  6.20s | valid loss  4.38 | valid ppl    79.853
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  32 step     7600 |     98 batches | lr 0.000114 | ms/batch 36.35 | loss  4.18 | ppl    65.147
total_loss: 32131.908195495605, total_len: 7360
total_loss: 35350.67922210693, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  38 at step     7600 | time:  6.09s | valid loss  4.37 | valid ppl    78.708
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  33 step     7800 |     56 batches | lr 0.000114 | ms/batch 36.45 | loss  4.15 | ppl    63.284
total_loss: 32092.39860534668, total_len: 7360
total_loss: 35311.37133026123, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  39 at step     7800 | time:  6.24s | valid loss  4.36 | valid ppl    78.287
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8000 |     14 batches | lr 0.000113 | ms/batch 36.86 | loss  4.11 | ppl    61.226
total_loss: 31956.92800140381, total_len: 7360
total_loss: 35149.21284484863, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  40 at step     8000 | time:  6.24s | valid loss  4.34 | valid ppl    76.859
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8200 |    214 batches | lr 0.000112 | ms/batch 36.36 | loss  4.10 | ppl    60.267
total_loss: 31906.675148010254, total_len: 7360
total_loss: 35077.40482330322, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  41 at step     8200 | time:  6.13s | valid loss  4.34 | valid ppl    76.336
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  35 step     8400 |    172 batches | lr 0.000112 | ms/batch 36.56 | loss  4.08 | ppl    59.015
total_loss: 31775.39080810547, total_len: 7360
total_loss: 34959.83026885986, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  42 at step     8400 | time:  6.09s | valid loss  4.32 | valid ppl    74.987
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  36 step     8600 |    130 batches | lr 0.000111 | ms/batch 36.04 | loss  4.06 | ppl    57.967
total_loss: 31770.833724975586, total_len: 7360
total_loss: 34912.285232543945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  43 at step     8600 | time:  6.20s | valid loss  4.32 | valid ppl    74.940
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  37 step     8800 |     88 batches | lr 0.000111 | ms/batch 36.57 | loss  4.06 | ppl    58.112
total_loss: 31628.95418548584, total_len: 7360
total_loss: 34776.84428405762, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  44 at step     8800 | time:  6.14s | valid loss  4.30 | valid ppl    73.509
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  38 step     9000 |     46 batches | lr 0.00011 | ms/batch 36.34 | loss  4.03 | ppl    55.995
total_loss: 31549.340782165527, total_len: 7360
total_loss: 34681.73155212402, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  45 at step     9000 | time:  6.16s | valid loss  4.29 | valid ppl    72.718
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9200 |      4 batches | lr 0.000109 | ms/batch 36.55 | loss  4.00 | ppl    54.811
total_loss: 31518.2035446167, total_len: 7360
total_loss: 34642.414878845215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  46 at step     9200 | time:  6.17s | valid loss  4.28 | valid ppl    72.411
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9400 |    204 batches | lr 0.000109 | ms/batch 36.48 | loss  3.99 | ppl    54.110
total_loss: 31527.32974243164, total_len: 7360
total_loss: 34649.68444061279, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  47 at step     9400 | time:  6.17s | valid loss  4.28 | valid ppl    72.501
----------------------------------------------------------------------------------------------------
| epoch  40 step     9600 |    162 batches | lr 0.000108 | ms/batch 30.60 | loss  3.97 | ppl    53.111
total_loss: 31380.2333984375, total_len: 7360
total_loss: 34489.8924407959, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  48 at step     9600 | time:  6.11s | valid loss  4.26 | valid ppl    71.067
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  41 step     9800 |    120 batches | lr 0.000107 | ms/batch 36.39 | loss  3.96 | ppl    52.527
total_loss: 31338.323051452637, total_len: 7360
total_loss: 34466.0387878418, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  49 at step     9800 | time:  6.21s | valid loss  4.26 | valid ppl    70.663
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  42 step    10000 |     78 batches | lr 0.000107 | ms/batch 37.18 | loss  3.96 | ppl    52.701
total_loss: 31327.728340148926, total_len: 7360
total_loss: 34419.39890289307, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  50 at step    10000 | time:  6.28s | valid loss  4.26 | valid ppl    70.562
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10200 |     36 batches | lr 0.000106 | ms/batch 36.98 | loss  3.93 | ppl    50.997
total_loss: 31262.703002929688, total_len: 7360
total_loss: 34349.32248687744, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  51 at step    10200 | time:  6.15s | valid loss  4.25 | valid ppl    69.941
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10400 |    236 batches | lr 0.000105 | ms/batch 37.08 | loss  3.91 | ppl    50.112
total_loss: 31295.031745910645, total_len: 7360
total_loss: 34369.5407333374, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  52 at step    10400 | time:  7.01s | valid loss  4.25 | valid ppl    70.249
----------------------------------------------------------------------------------------------------
| epoch  44 step    10600 |    194 batches | lr 0.000105 | ms/batch 30.94 | loss  3.90 | ppl    49.634
total_loss: 31180.03702545166, total_len: 7360
total_loss: 34259.19522857666, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  53 at step    10600 | time:  6.15s | valid loss  4.24 | valid ppl    69.160
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  45 step    10800 |    152 batches | lr 0.000104 | ms/batch 36.56 | loss  3.89 | ppl    48.866
total_loss: 31172.74845123291, total_len: 7360
total_loss: 34235.24348449707, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  54 at step    10800 | time:  6.29s | valid loss  4.24 | valid ppl    69.091
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  46 step    11000 |    110 batches | lr 0.000103 | ms/batch 36.56 | loss  3.89 | ppl    48.842
total_loss: 31087.95973968506, total_len: 7360
total_loss: 34140.654235839844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  55 at step    11000 | time:  6.24s | valid loss  4.22 | valid ppl    68.300
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  47 step    11200 |     68 batches | lr 0.000102 | ms/batch 37.01 | loss  3.88 | ppl    48.549
total_loss: 31075.15110015869, total_len: 7360
total_loss: 34137.24560546875, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  56 at step    11200 | time:  6.17s | valid loss  4.22 | valid ppl    68.181
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11400 |     26 batches | lr 0.000102 | ms/batch 36.60 | loss  3.85 | ppl    47.103
total_loss: 31036.82875061035, total_len: 7360
total_loss: 34076.811431884766, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  57 at step    11400 | time:  6.25s | valid loss  4.22 | valid ppl    67.827
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11600 |    226 batches | lr 0.000101 | ms/batch 37.03 | loss  3.84 | ppl    46.468
total_loss: 31031.991973876953, total_len: 7360
total_loss: 34078.319496154785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  58 at step    11600 | time:  6.20s | valid loss  4.22 | valid ppl    67.782
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  49 step    11800 |    184 batches | lr 0.0001 | ms/batch 37.83 | loss  3.83 | ppl    46.138
total_loss: 30951.375297546387, total_len: 7360
total_loss: 33988.08695220947, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  59 at step    11800 | time:  6.45s | valid loss  4.21 | valid ppl    67.044
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  50 step    12000 |    142 batches | lr 9.92e-05 | ms/batch 36.51 | loss  3.82 | ppl    45.755
total_loss: 30896.58595275879, total_len: 7360
total_loss: 33915.34535217285, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  60 at step    12000 | time:  6.16s | valid loss  4.20 | valid ppl    66.547
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  51 step    12200 |    100 batches | lr 9.84e-05 | ms/batch 35.90 | loss  3.82 | ppl    45.747
total_loss: 30883.759757995605, total_len: 7360
total_loss: 33892.21974945068, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  61 at step    12200 | time:  6.11s | valid loss  4.20 | valid ppl    66.431
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  52 step    12400 |     58 batches | lr 9.76e-05 | ms/batch 36.72 | loss  3.81 | ppl    45.126
total_loss: 30906.360496520996, total_len: 7360
total_loss: 33929.137855529785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  62 at step    12400 | time:  6.20s | valid loss  4.20 | valid ppl    66.635
----------------------------------------------------------------------------------------------------
| epoch  53 step    12600 |     16 batches | lr 9.68e-05 | ms/batch 32.09 | loss  3.79 | ppl    44.158
total_loss: 30834.014503479004, total_len: 7360
total_loss: 33843.03352355957, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  63 at step    12600 | time:  6.37s | valid loss  4.19 | valid ppl    65.983
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12800 |    216 batches | lr 9.6e-05 | ms/batch 35.18 | loss  3.78 | ppl    43.781
total_loss: 30828.29009246826, total_len: 7360
total_loss: 33832.57865142822, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  64 at step    12800 | time:  6.12s | valid loss  4.19 | valid ppl    65.932
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  54 step    13000 |    174 batches | lr 9.52e-05 | ms/batch 35.60 | loss  3.77 | ppl    43.411
total_loss: 30797.03497314453, total_len: 7360
total_loss: 33800.70613861084, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  65 at step    13000 | time:  5.95s | valid loss  4.18 | valid ppl    65.653
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  55 step    13200 |    132 batches | lr 9.43e-05 | ms/batch 35.18 | loss  3.76 | ppl    42.950
total_loss: 30735.75347137451, total_len: 7360
total_loss: 33725.16990661621, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  66 at step    13200 | time:  5.93s | valid loss  4.18 | valid ppl    65.108
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  56 step    13400 |     90 batches | lr 9.35e-05 | ms/batch 35.50 | loss  3.77 | ppl    43.275
total_loss: 30731.375778198242, total_len: 7360
total_loss: 33725.02788543701, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  67 at step    13400 | time:  5.99s | valid loss  4.18 | valid ppl    65.070
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  57 step    13600 |     48 batches | lr 9.26e-05 | ms/batch 35.38 | loss  3.75 | ppl    42.315
total_loss: 30678.98053741455, total_len: 7360
total_loss: 33654.93183135986, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  68 at step    13600 | time:  5.97s | valid loss  4.17 | valid ppl    64.608
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    13800 |      6 batches | lr 9.17e-05 | ms/batch 35.90 | loss  3.73 | ppl    41.738
total_loss: 30674.341903686523, total_len: 7360
total_loss: 33631.82207489014, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  69 at step    13800 | time:  6.15s | valid loss  4.17 | valid ppl    64.567
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    14000 |    206 batches | lr 9.09e-05 | ms/batch 36.12 | loss  3.73 | ppl    41.491
total_loss: 30697.350303649902, total_len: 7360
total_loss: 33657.07139587402, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  70 at step    14000 | time:  6.10s | valid loss  4.17 | valid ppl    64.770
----------------------------------------------------------------------------------------------------
| epoch  59 step    14200 |    164 batches | lr 9e-05 | ms/batch 29.94 | loss  3.72 | ppl    41.225
total_loss: 30651.669647216797, total_len: 7360
total_loss: 33606.88179779053, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  71 at step    14200 | time:  6.03s | valid loss  4.16 | valid ppl    64.369
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  60 step    14400 |    122 batches | lr 8.91e-05 | ms/batch 35.47 | loss  3.71 | ppl    40.930
total_loss: 30631.154960632324, total_len: 7360
total_loss: 33589.85587310791, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  72 at step    14400 | time:  6.00s | valid loss  4.16 | valid ppl    64.190
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  61 step    14600 |     80 batches | lr 8.82e-05 | ms/batch 35.55 | loss  3.72 | ppl    41.348
total_loss: 30612.805725097656, total_len: 7360
total_loss: 33543.16854095459, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  73 at step    14600 | time:  5.99s | valid loss  4.16 | valid ppl    64.030
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    14800 |     38 batches | lr 8.73e-05 | ms/batch 35.64 | loss  3.69 | ppl    40.117
total_loss: 30575.046585083008, total_len: 7360
total_loss: 33513.50835418701, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  74 at step    14800 | time:  6.08s | valid loss  4.15 | valid ppl    63.702
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    15000 |    238 batches | lr 8.64e-05 | ms/batch 35.97 | loss  3.68 | ppl    39.828
total_loss: 30618.92197418213, total_len: 7360
total_loss: 33545.23597717285, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  75 at step    15000 | time:  6.08s | valid loss  4.16 | valid ppl    64.083
----------------------------------------------------------------------------------------------------
| epoch  63 step    15200 |    196 batches | lr 8.55e-05 | ms/batch 30.47 | loss  3.68 | ppl    39.662
total_loss: 30577.197303771973, total_len: 7360
total_loss: 33514.21664428711, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  76 at step    15200 | time:  6.15s | valid loss  4.15 | valid ppl    63.721
----------------------------------------------------------------------------------------------------
| epoch  64 step    15400 |    154 batches | lr 8.46e-05 | ms/batch 30.54 | loss  3.67 | ppl    39.257
total_loss: 30523.624969482422, total_len: 7360
total_loss: 33468.87635040283, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  77 at step    15400 | time:  6.08s | valid loss  4.15 | valid ppl    63.259
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  65 step    15600 |    112 batches | lr 8.37e-05 | ms/batch 36.17 | loss  3.67 | ppl    39.363
total_loss: 30534.432273864746, total_len: 7360
total_loss: 33462.505126953125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  78 at step    15600 | time:  6.05s | valid loss  4.15 | valid ppl    63.352
----------------------------------------------------------------------------------------------------
| epoch  66 step    15800 |     70 batches | lr 8.27e-05 | ms/batch 30.43 | loss  3.67 | ppl    39.330
total_loss: 30492.305152893066, total_len: 7360
total_loss: 33417.264472961426, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  79 at step    15800 | time:  6.15s | valid loss  4.14 | valid ppl    62.990
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16000 |     28 batches | lr 8.18e-05 | ms/batch 36.87 | loss  3.65 | ppl    38.440
total_loss: 30548.44285583496, total_len: 7360
total_loss: 33483.50154876709, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  80 at step    16000 | time:  6.24s | valid loss  4.15 | valid ppl    63.472
----------------------------------------------------------------------------------------------------
| epoch  67 step    16200 |    228 batches | lr 8.09e-05 | ms/batch 31.15 | loss  3.64 | ppl    38.208
total_loss: 30481.976707458496, total_len: 7360
total_loss: 33412.49743652344, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  81 at step    16200 | time:  6.26s | valid loss  4.14 | valid ppl    62.902
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  68 step    16400 |    186 batches | lr 7.99e-05 | ms/batch 36.88 | loss  3.64 | ppl    37.977
total_loss: 30496.936248779297, total_len: 7360
total_loss: 33414.87537384033, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  82 at step    16400 | time:  6.65s | valid loss  4.14 | valid ppl    63.030
----------------------------------------------------------------------------------------------------
| epoch  69 step    16600 |    144 batches | lr 7.9e-05 | ms/batch 33.01 | loss  3.63 | ppl    37.764
total_loss: 30428.11882019043, total_len: 7360
total_loss: 33333.89659118652, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  83 at step    16600 | time:  6.56s | valid loss  4.13 | valid ppl    62.443
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  70 step    16800 |    102 batches | lr 7.8e-05 | ms/batch 37.05 | loss  3.64 | ppl    38.043
total_loss: 30443.19647216797, total_len: 7360
total_loss: 33348.252281188965, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  84 at step    16800 | time:  6.24s | valid loss  4.14 | valid ppl    62.571
----------------------------------------------------------------------------------------------------
| epoch  71 step    17000 |     60 batches | lr 7.71e-05 | ms/batch 31.01 | loss  3.63 | ppl    37.762
total_loss: 30434.466674804688, total_len: 7360
total_loss: 33336.5163192749, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  85 at step    17000 | time:  6.17s | valid loss  4.14 | valid ppl    62.497
----------------------------------------------------------------------------------------------------
| epoch  72 step    17200 |     18 batches | lr 7.61e-05 | ms/batch 30.73 | loss  3.61 | ppl    37.102
total_loss: 30386.379318237305, total_len: 7360
total_loss: 33302.8655090332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  86 at step    17200 | time:  6.13s | valid loss  4.13 | valid ppl    62.090
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17400 |    218 batches | lr 7.52e-05 | ms/batch 36.46 | loss  3.61 | ppl    36.865
total_loss: 30416.339111328125, total_len: 7360
total_loss: 33321.0520324707, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  87 at step    17400 | time:  6.16s | valid loss  4.13 | valid ppl    62.343
----------------------------------------------------------------------------------------------------
| epoch  73 step    17600 |    176 batches | lr 7.42e-05 | ms/batch 30.72 | loss  3.60 | ppl    36.665
total_loss: 30367.754119873047, total_len: 7360
total_loss: 33264.38530731201, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  88 at step    17600 | time:  6.14s | valid loss  4.13 | valid ppl    61.933
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  74 step    17800 |    134 batches | lr 7.32e-05 | ms/batch 36.47 | loss  3.60 | ppl    36.552
total_loss: 30396.238426208496, total_len: 7360
total_loss: 33288.13914489746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  89 at step    17800 | time:  6.17s | valid loss  4.13 | valid ppl    62.173
----------------------------------------------------------------------------------------------------
| epoch  75 step    18000 |     92 batches | lr 7.23e-05 | ms/batch 31.08 | loss  3.61 | ppl    36.903
total_loss: 30382.30499267578, total_len: 7360
total_loss: 33271.68578338623, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  90 at step    18000 | time:  6.23s | valid loss  4.13 | valid ppl    62.056
----------------------------------------------------------------------------------------------------
| epoch  76 step    18200 |     50 batches | lr 7.13e-05 | ms/batch 31.22 | loss  3.59 | ppl    36.239
total_loss: 30338.441566467285, total_len: 7360
total_loss: 33223.45970916748, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  91 at step    18200 | time:  6.24s | valid loss  4.12 | valid ppl    61.687
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  77 step    18400 |      8 batches | lr 7.03e-05 | ms/batch 37.81 | loss  3.58 | ppl    35.884
total_loss: 30339.2488861084, total_len: 7360
total_loss: 33214.01399230957, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  92 at step    18400 | time:  6.44s | valid loss  4.12 | valid ppl    61.694
----------------------------------------------------------------------------------------------------
| epoch  77 step    18600 |    208 batches | lr 6.94e-05 | ms/batch 32.13 | loss  3.58 | ppl    35.743
total_loss: 30365.29360961914, total_len: 7360
total_loss: 33261.71691131592, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  93 at step    18600 | time:  6.42s | valid loss  4.13 | valid ppl    61.912
----------------------------------------------------------------------------------------------------
| epoch  78 step    18800 |    166 batches | lr 6.84e-05 | ms/batch 32.61 | loss  3.57 | ppl    35.632
total_loss: 30323.679313659668, total_len: 7360
total_loss: 33207.93166351318, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  94 at step    18800 | time:  6.52s | valid loss  4.12 | valid ppl    61.563
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  79 step    19000 |    124 batches | lr 6.74e-05 | ms/batch 37.12 | loss  3.57 | ppl    35.496
total_loss: 30386.249198913574, total_len: 7360
total_loss: 33261.68788146973, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  95 at step    19000 | time:  6.45s | valid loss  4.13 | valid ppl    62.089
----------------------------------------------------------------------------------------------------
| epoch  80 step    19200 |     82 batches | lr 6.64e-05 | ms/batch 31.23 | loss  3.58 | ppl    35.964
total_loss: 30323.2449798584, total_len: 7360
total_loss: 33184.86563873291, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  96 at step    19200 | time:  7.82s | valid loss  4.12 | valid ppl    61.560
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19400 |     40 batches | lr 6.54e-05 | ms/batch 44.17 | loss  3.56 | ppl    35.128
total_loss: 30305.995147705078, total_len: 7360
total_loss: 33178.68236541748, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  97 at step    19400 | time:  6.26s | valid loss  4.12 | valid ppl    61.416
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19600 |    240 batches | lr 6.45e-05 | ms/batch 36.91 | loss  3.55 | ppl    34.894
total_loss: 30298.87152862549, total_len: 7360
total_loss: 33156.54286193848, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  98 at step    19600 | time:  6.26s | valid loss  4.12 | valid ppl    61.356
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  82 step    19800 |    198 batches | lr 6.35e-05 | ms/batch 37.46 | loss  3.55 | ppl    34.878
total_loss: 30310.049514770508, total_len: 7360
total_loss: 33176.294189453125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  99 at step    19800 | time:  6.35s | valid loss  4.12 | valid ppl    61.449
----------------------------------------------------------------------------------------------------
| epoch  83 step    20000 |    156 batches | lr 6.25e-05 | ms/batch 31.96 | loss  3.54 | ppl    34.613
total_loss: 30285.427574157715, total_len: 7360
total_loss: 33142.878005981445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 100 at step    20000 | time:  6.41s | valid loss  4.11 | valid ppl    61.244
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  84 step    20200 |    114 batches | lr 6.15e-05 | ms/batch 37.48 | loss  3.54 | ppl    34.637
total_loss: 30269.52074432373, total_len: 7360
total_loss: 33123.323669433594, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 101 at step    20200 | time:  6.36s | valid loss  4.11 | valid ppl    61.112
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  85 step    20400 |     72 batches | lr 6.05e-05 | ms/batch 37.48 | loss  3.55 | ppl    34.968
total_loss: 30286.874450683594, total_len: 7360
total_loss: 33136.27819061279, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 102 at step    20400 | time:  6.37s | valid loss  4.12 | valid ppl    61.256
----------------------------------------------------------------------------------------------------
| epoch  86 step    20600 |     30 batches | lr 5.96e-05 | ms/batch 31.83 | loss  3.53 | ppl    34.168
total_loss: 30271.944381713867, total_len: 7360
total_loss: 33117.94231414795, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 103 at step    20600 | time:  6.35s | valid loss  4.11 | valid ppl    61.132
----------------------------------------------------------------------------------------------------
| epoch  86 step    20800 |    230 batches | lr 5.86e-05 | ms/batch 31.78 | loss  3.53 | ppl    33.973
total_loss: 30281.01880645752, total_len: 7360
total_loss: 33128.88227081299, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 104 at step    20800 | time:  6.37s | valid loss  4.11 | valid ppl    61.207
----------------------------------------------------------------------------------------------------
| epoch  87 step    21000 |    188 batches | lr 5.76e-05 | ms/batch 31.63 | loss  3.53 | ppl    33.954
total_loss: 30265.598274230957, total_len: 7360
total_loss: 33120.02349090576, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 105 at step    21000 | time:  6.31s | valid loss  4.11 | valid ppl    61.079
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  88 step    21200 |    146 batches | lr 5.66e-05 | ms/batch 37.36 | loss  3.52 | ppl    33.851
total_loss: 30252.955200195312, total_len: 7360
total_loss: 33098.115867614746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 106 at step    21200 | time:  6.36s | valid loss  4.11 | valid ppl    60.975
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  89 step    21400 |    104 batches | lr 5.56e-05 | ms/batch 37.06 | loss  3.53 | ppl    34.044
total_loss: 30225.35083770752, total_len: 7360
total_loss: 33064.66550445557, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 107 at step    21400 | time:  6.34s | valid loss  4.11 | valid ppl    60.746
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  90 step    21600 |     62 batches | lr 5.47e-05 | ms/batch 36.79 | loss  3.52 | ppl    33.919
total_loss: 30294.63117980957, total_len: 7360
total_loss: 33128.487800598145, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 108 at step    21600 | time:  6.28s | valid loss  4.12 | valid ppl    61.321
----------------------------------------------------------------------------------------------------
| epoch  91 step    21800 |     20 batches | lr 5.37e-05 | ms/batch 31.14 | loss  3.51 | ppl    33.325
total_loss: 30246.630561828613, total_len: 7360
total_loss: 33087.93371582031, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 109 at step    21800 | time:  6.24s | valid loss  4.11 | valid ppl    60.922
----------------------------------------------------------------------------------------------------
| epoch  91 step    22000 |    220 batches | lr 5.27e-05 | ms/batch 31.22 | loss  3.51 | ppl    33.319
total_loss: 30264.621116638184, total_len: 7360
total_loss: 33109.15518951416, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 110 at step    22000 | time:  6.23s | valid loss  4.11 | valid ppl    61.071
----------------------------------------------------------------------------------------------------
| epoch  92 step    22200 |    178 batches | lr 5.18e-05 | ms/batch 31.14 | loss  3.50 | ppl    33.164
total_loss: 30202.174171447754, total_len: 7360
total_loss: 33031.852462768555, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 111 at step    22200 | time:  6.22s | valid loss  4.10 | valid ppl    60.555
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  93 step    22400 |    136 batches | lr 5.08e-05 | ms/batch 36.59 | loss  3.50 | ppl    33.151
total_loss: 30216.850616455078, total_len: 7360
total_loss: 33053.211181640625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 112 at step    22400 | time:  6.23s | valid loss  4.11 | valid ppl    60.676
----------------------------------------------------------------------------------------------------
| epoch  94 step    22600 |     94 batches | lr 4.98e-05 | ms/batch 31.13 | loss  3.51 | ppl    33.592
total_loss: 30248.791381835938, total_len: 7360
total_loss: 33078.442459106445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 113 at step    22600 | time:  6.23s | valid loss  4.11 | valid ppl    60.940
----------------------------------------------------------------------------------------------------
| epoch  95 step    22800 |     52 batches | lr 4.89e-05 | ms/batch 31.53 | loss  3.50 | ppl    33.024
total_loss: 30222.498558044434, total_len: 7360
total_loss: 33055.46543884277, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 114 at step    22800 | time:  6.31s | valid loss  4.11 | valid ppl    60.723
----------------------------------------------------------------------------------------------------
| epoch  96 step    23000 |     10 batches | lr 4.79e-05 | ms/batch 31.26 | loss  3.49 | ppl    32.707
total_loss: 30182.01459503174, total_len: 7360
total_loss: 33004.13758850098, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 115 at step    23000 | time:  6.25s | valid loss  4.10 | valid ppl    60.390
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  96 step    23200 |    210 batches | lr 4.7e-05 | ms/batch 36.44 | loss  3.49 | ppl    32.676
total_loss: 30208.830772399902, total_len: 7360
total_loss: 33041.69284057617, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 116 at step    23200 | time:  6.22s | valid loss  4.10 | valid ppl    60.610
----------------------------------------------------------------------------------------------------
| epoch  97 step    23400 |    168 batches | lr 4.6e-05 | ms/batch 31.09 | loss  3.48 | ppl    32.531
total_loss: 30171.03578186035, total_len: 7360
total_loss: 32993.59593963623, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 117 at step    23400 | time:  6.22s | valid loss  4.10 | valid ppl    60.300
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  98 step    23600 |    126 batches | lr 4.51e-05 | ms/batch 36.81 | loss  3.48 | ppl    32.468
total_loss: 30246.003051757812, total_len: 7360
total_loss: 33069.74668121338, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 118 at step    23600 | time:  6.24s | valid loss  4.11 | valid ppl    60.917
----------------------------------------------------------------------------------------------------
| epoch  99 step    23800 |     84 batches | lr 4.41e-05 | ms/batch 31.08 | loss  3.49 | ppl    32.927
total_loss: 30164.682418823242, total_len: 7360
total_loss: 32982.045265197754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 119 at step    23800 | time:  6.23s | valid loss  4.10 | valid ppl    60.248
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 100 step    24000 |     42 batches | lr 4.32e-05 | ms/batch 36.55 | loss  3.48 | ppl    32.304
total_loss: 30161.138610839844, total_len: 7360
total_loss: 32986.69366455078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 120 at step    24000 | time:  6.20s | valid loss  4.10 | valid ppl    60.219
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 100 step    24200 |    242 batches | lr 4.23e-05 | ms/batch 36.55 | loss  3.47 | ppl    32.134
total_loss: 30188.482635498047, total_len: 7360
total_loss: 33004.069023132324, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 121 at step    24200 | time:  6.21s | valid loss  4.10 | valid ppl    60.443
----------------------------------------------------------------------------------------------------
| epoch 101 step    24400 |    200 batches | lr 4.13e-05 | ms/batch 31.55 | loss  3.47 | ppl    32.132
total_loss: 30184.291648864746, total_len: 7360
total_loss: 32999.3366394043, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 122 at step    24400 | time:  6.30s | valid loss  4.10 | valid ppl    60.408
----------------------------------------------------------------------------------------------------
| epoch 102 step    24600 |    158 batches | lr 4.04e-05 | ms/batch 31.19 | loss  3.47 | ppl    32.040
total_loss: 30173.60581970215, total_len: 7360
total_loss: 32996.33592224121, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 123 at step    24600 | time:  6.24s | valid loss  4.10 | valid ppl    60.321
----------------------------------------------------------------------------------------------------
| epoch 103 step    24800 |    116 batches | lr 3.95e-05 | ms/batch 31.04 | loss  3.47 | ppl    32.068
total_loss: 30180.953941345215, total_len: 7360
total_loss: 32997.00337219238, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 124 at step    24800 | time:  6.20s | valid loss  4.10 | valid ppl    60.381
----------------------------------------------------------------------------------------------------
| epoch 104 step    25000 |     74 batches | lr 3.86e-05 | ms/batch 31.16 | loss  3.48 | ppl    32.392
total_loss: 30183.571655273438, total_len: 7360
total_loss: 33000.753089904785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 125 at step    25000 | time:  6.24s | valid loss  4.10 | valid ppl    60.402
----------------------------------------------------------------------------------------------------
| epoch 105 step    25200 |     32 batches | lr 3.77e-05 | ms/batch 31.22 | loss  3.46 | ppl    31.753
total_loss: 30177.977569580078, total_len: 7360
total_loss: 32999.849113464355, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 126 at step    25200 | time:  6.24s | valid loss  4.10 | valid ppl    60.357
----------------------------------------------------------------------------------------------------
| epoch 105 step    25400 |    232 batches | lr 3.68e-05 | ms/batch 31.20 | loss  3.45 | ppl    31.466
total_loss: 30173.377265930176, total_len: 7360
total_loss: 32993.121658325195, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 127 at step    25400 | time:  6.24s | valid loss  4.10 | valid ppl    60.319
----------------------------------------------------------------------------------------------------
| epoch 106 step    25600 |    190 batches | lr 3.59e-05 | ms/batch 31.19 | loss  3.45 | ppl    31.639
total_loss: 30177.073539733887, total_len: 7360
total_loss: 32995.75076293945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 128 at step    25600 | time:  6.24s | valid loss  4.10 | valid ppl    60.349
----------------------------------------------------------------------------------------------------
| epoch 107 step    25800 |    148 batches | lr 3.5e-05 | ms/batch 31.21 | loss  3.45 | ppl    31.532
total_loss: 30148.35243988037, total_len: 7360
total_loss: 32960.877449035645, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 129 at step    25800 | time:  6.24s | valid loss  4.10 | valid ppl    60.114
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 108 step    26000 |    106 batches | lr 3.41e-05 | ms/batch 36.73 | loss  3.46 | ppl    31.758
total_loss: 30132.365966796875, total_len: 7360
total_loss: 32936.17951965332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 130 at step    26000 | time:  6.26s | valid loss  4.09 | valid ppl    59.984
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 109 step    26200 |     64 batches | lr 3.33e-05 | ms/batch 36.62 | loss  3.46 | ppl    31.792
total_loss: 30143.48225402832, total_len: 7360
total_loss: 32950.8596496582, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 131 at step    26200 | time:  6.26s | valid loss  4.10 | valid ppl    60.074
----------------------------------------------------------------------------------------------------
| epoch 110 step    26400 |     22 batches | lr 3.24e-05 | ms/batch 31.29 | loss  3.44 | ppl    31.252
total_loss: 30145.259910583496, total_len: 7360
total_loss: 32958.088523864746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 132 at step    26400 | time:  6.24s | valid loss  4.10 | valid ppl    60.089
----------------------------------------------------------------------------------------------------
| epoch 110 step    26600 |    222 batches | lr 3.15e-05 | ms/batch 31.21 | loss  3.44 | ppl    31.297
total_loss: 30141.953575134277, total_len: 7360
total_loss: 32961.46267700195, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 133 at step    26600 | time:  6.24s | valid loss  4.10 | valid ppl    60.062
----------------------------------------------------------------------------------------------------
| epoch 111 step    26800 |    180 batches | lr 3.07e-05 | ms/batch 31.22 | loss  3.44 | ppl    31.126
total_loss: 30114.614486694336, total_len: 7360
total_loss: 32932.119888305664, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 134 at step    26800 | time:  6.24s | valid loss  4.09 | valid ppl    59.839
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 112 step    27000 |    138 batches | lr 2.98e-05 | ms/batch 37.22 | loss  3.44 | ppl    31.136
total_loss: 30150.47824859619, total_len: 7360
total_loss: 32954.87314605713, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 135 at step    27000 | time:  6.26s | valid loss  4.10 | valid ppl    60.131
----------------------------------------------------------------------------------------------------
| epoch 113 step    27200 |     96 batches | lr 2.9e-05 | ms/batch 31.20 | loss  3.45 | ppl    31.533
total_loss: 30136.577896118164, total_len: 7360
total_loss: 32945.72573852539, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 136 at step    27200 | time:  6.24s | valid loss  4.09 | valid ppl    60.018
----------------------------------------------------------------------------------------------------
| epoch 114 step    27400 |     54 batches | lr 2.82e-05 | ms/batch 31.21 | loss  3.44 | ppl    31.166
total_loss: 30089.40264892578, total_len: 7360
total_loss: 32891.91781616211, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 137 at step    27400 | time:  6.24s | valid loss  4.09 | valid ppl    59.634
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 115 step    27600 |     12 batches | lr 2.74e-05 | ms/batch 36.88 | loss  3.43 | ppl    30.951
total_loss: 30116.410064697266, total_len: 7360
total_loss: 32917.20506286621, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 138 at step    27600 | time:  6.26s | valid loss  4.09 | valid ppl    59.854
----------------------------------------------------------------------------------------------------
| epoch 115 step    27800 |    212 batches | lr 2.66e-05 | ms/batch 31.21 | loss  3.43 | ppl    30.986
total_loss: 30113.350067138672, total_len: 7360
total_loss: 32911.47053527832, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 139 at step    27800 | time:  6.25s | valid loss  4.09 | valid ppl    59.829
----------------------------------------------------------------------------------------------------
| epoch 116 step    28000 |    170 batches | lr 2.58e-05 | ms/batch 31.27 | loss  3.43 | ppl    30.864
total_loss: 30087.314849853516, total_len: 7360
total_loss: 32885.50843811035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 140 at step    28000 | time:  6.24s | valid loss  4.09 | valid ppl    59.618
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 117 step    28200 |    128 batches | lr 2.5e-05 | ms/batch 37.13 | loss  3.43 | ppl    30.882
total_loss: 30147.396354675293, total_len: 7360
total_loss: 32940.15222167969, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 141 at step    28200 | time:  6.27s | valid loss  4.10 | valid ppl    60.106
----------------------------------------------------------------------------------------------------
| epoch 118 step    28400 |     86 batches | lr 2.42e-05 | ms/batch 31.27 | loss  3.44 | ppl    31.201
total_loss: 30118.597930908203, total_len: 7360
total_loss: 32903.323989868164, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 142 at step    28400 | time:  6.82s | valid loss  4.09 | valid ppl    59.872
----------------------------------------------------------------------------------------------------
| epoch 119 step    28600 |     44 batches | lr 2.34e-05 | ms/batch 31.37 | loss  3.42 | ppl    30.709
total_loss: 30116.28060913086, total_len: 7360
total_loss: 32911.35642242432, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 143 at step    28600 | time:  6.27s | valid loss  4.09 | valid ppl    59.853
----------------------------------------------------------------------------------------------------
| epoch 120 step    28800 |      2 batches | lr 2.27e-05 | ms/batch 31.22 | loss  3.42 | ppl    30.559
total_loss: 30124.159469604492, total_len: 7360
total_loss: 32917.60545349121, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 144 at step    28800 | time:  6.24s | valid loss  4.09 | valid ppl    59.917
----------------------------------------------------------------------------------------------------
| epoch 120 step    29000 |    202 batches | lr 2.19e-05 | ms/batch 31.20 | loss  3.42 | ppl    30.611
total_loss: 30112.572799682617, total_len: 7360
total_loss: 32895.24938964844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 145 at step    29000 | time:  6.24s | valid loss  4.09 | valid ppl    59.823
----------------------------------------------------------------------------------------------------
| epoch 121 step    29200 |    160 batches | lr 2.12e-05 | ms/batch 31.21 | loss  3.42 | ppl    30.549
total_loss: 30099.01089477539, total_len: 7360
total_loss: 32883.11437988281, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 146 at step    29200 | time:  6.24s | valid loss  4.09 | valid ppl    59.712
----------------------------------------------------------------------------------------------------
| epoch 122 step    29400 |    118 batches | lr 2.04e-05 | ms/batch 31.22 | loss  3.42 | ppl    30.561
total_loss: 30111.437408447266, total_len: 7360
total_loss: 32891.52462768555, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 147 at step    29400 | time:  6.24s | valid loss  4.09 | valid ppl    59.813
----------------------------------------------------------------------------------------------------
| epoch 123 step    29600 |     76 batches | lr 1.97e-05 | ms/batch 31.18 | loss  3.43 | ppl    31.029
total_loss: 30139.964782714844, total_len: 7360
total_loss: 32927.83201599121, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 148 at step    29600 | time:  6.26s | valid loss  4.10 | valid ppl    60.046
----------------------------------------------------------------------------------------------------
| epoch 124 step    29800 |     34 batches | lr 1.9e-05 | ms/batch 31.34 | loss  3.41 | ppl    30.416
total_loss: 30103.542022705078, total_len: 7360
total_loss: 32892.13635253906, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 149 at step    29800 | time:  6.25s | valid loss  4.09 | valid ppl    59.749
----------------------------------------------------------------------------------------------------
| epoch 124 step    30000 |    234 batches | lr 1.83e-05 | ms/batch 31.21 | loss  3.41 | ppl    30.299
total_loss: 30089.255981445312, total_len: 7360
total_loss: 32878.36696624756, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 150 at step    30000 | time:  6.24s | valid loss  4.09 | valid ppl    59.633
----------------------------------------------------------------------------------------------------
| epoch 125 step    30200 |    192 batches | lr 1.76e-05 | ms/batch 31.19 | loss  3.41 | ppl    30.332
total_loss: 30096.508811950684, total_len: 7360
total_loss: 32879.018951416016, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 151 at step    30200 | time:  6.25s | valid loss  4.09 | valid ppl    59.692
----------------------------------------------------------------------------------------------------
| epoch 126 step    30400 |    150 batches | lr 1.69e-05 | ms/batch 31.24 | loss  3.41 | ppl    30.218
total_loss: 30094.51057434082, total_len: 7360
total_loss: 32878.504486083984, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 152 at step    30400 | time:  6.24s | valid loss  4.09 | valid ppl    59.676
----------------------------------------------------------------------------------------------------
| epoch 127 step    30600 |    108 batches | lr 1.63e-05 | ms/batch 31.22 | loss  3.42 | ppl    30.552
total_loss: 30095.86496734619, total_len: 7360
total_loss: 32869.64649963379, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 153 at step    30600 | time:  6.25s | valid loss  4.09 | valid ppl    59.687
----------------------------------------------------------------------------------------------------
| epoch 128 step    30800 |     66 batches | lr 1.56e-05 | ms/batch 31.26 | loss  3.42 | ppl    30.567
total_loss: 30088.55669403076, total_len: 7360
total_loss: 32868.14463806152, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 154 at step    30800 | time:  6.24s | valid loss  4.09 | valid ppl    59.628
----------------------------------------------------------------------------------------------------
| epoch 129 step    31000 |     24 batches | lr 1.5e-05 | ms/batch 31.24 | loss  3.41 | ppl    30.142
total_loss: 30070.434593200684, total_len: 7360
total_loss: 32857.63404083252, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 155 at step    31000 | time:  6.24s | valid loss  4.09 | valid ppl    59.481
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 129 step    31200 |    224 batches | lr 1.43e-05 | ms/batch 37.12 | loss  3.41 | ppl    30.136
total_loss: 30106.396598815918, total_len: 7360
total_loss: 32894.315170288086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 156 at step    31200 | time:  6.25s | valid loss  4.09 | valid ppl    59.772
----------------------------------------------------------------------------------------------------
| epoch 130 step    31400 |    182 batches | lr 1.37e-05 | ms/batch 33.25 | loss  3.40 | ppl    30.094
total_loss: 30055.70133972168, total_len: 7360
total_loss: 32832.98811340332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 157 at step    31400 | time:  6.70s | valid loss  4.08 | valid ppl    59.362
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 131 step    31600 |    140 batches | lr 1.31e-05 | ms/batch 40.22 | loss  3.41 | ppl    30.188
total_loss: 30097.064582824707, total_len: 7360
total_loss: 32873.75062561035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 158 at step    31600 | time:  7.01s | valid loss  4.09 | valid ppl    59.697
----------------------------------------------------------------------------------------------------
| epoch 132 step    31800 |     98 batches | lr 1.25e-05 | ms/batch 32.30 | loss  3.41 | ppl    30.397
total_loss: 30092.705894470215, total_len: 7360
total_loss: 32871.98407745361, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 159 at step    31800 | time:  6.35s | valid loss  4.09 | valid ppl    59.661
----------------------------------------------------------------------------------------------------
| epoch 133 step    32000 |     56 batches | lr 1.19e-05 | ms/batch 31.61 | loss  3.41 | ppl    30.287
total_loss: 30081.103874206543, total_len: 7360
total_loss: 32856.67835998535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 160 at step    32000 | time:  6.32s | valid loss  4.09 | valid ppl    59.567
----------------------------------------------------------------------------------------------------
| epoch 134 step    32200 |     14 batches | lr 1.14e-05 | ms/batch 31.55 | loss  3.40 | ppl    30.026
total_loss: 30083.224327087402, total_len: 7360
total_loss: 32858.39948272705, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 161 at step    32200 | time:  6.29s | valid loss  4.09 | valid ppl    59.584
----------------------------------------------------------------------------------------------------
| epoch 134 step    32400 |    214 batches | lr 1.08e-05 | ms/batch 31.75 | loss  3.40 | ppl    30.021
total_loss: 30085.199241638184, total_len: 7360
total_loss: 32859.95976257324, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 162 at step    32400 | time:  6.34s | valid loss  4.09 | valid ppl    59.600
----------------------------------------------------------------------------------------------------
| epoch 135 step    32600 |    172 batches | lr 1.03e-05 | ms/batch 31.76 | loss  3.40 | ppl    29.931
total_loss: 30053.52935028076, total_len: 7360
total_loss: 32827.506088256836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 163 at step    32600 | time:  6.35s | valid loss  4.08 | valid ppl    59.345
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 136 step    32800 |    130 batches | lr 9.73e-06 | ms/batch 37.34 | loss  3.40 | ppl    29.912
total_loss: 30103.63520050049, total_len: 7360
total_loss: 32881.41651916504, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 164 at step    32800 | time:  6.37s | valid loss  4.09 | valid ppl    59.750
----------------------------------------------------------------------------------------------------
| epoch 137 step    33000 |     88 batches | lr 9.21e-06 | ms/batch 31.56 | loss  3.42 | ppl    30.440
total_loss: 30095.723762512207, total_len: 7360
total_loss: 32876.830642700195, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 165 at step    33000 | time:  6.30s | valid loss  4.09 | valid ppl    59.686
----------------------------------------------------------------------------------------------------
| epoch 138 step    33200 |     46 batches | lr 8.7e-06 | ms/batch 31.14 | loss  3.40 | ppl    29.916
total_loss: 30080.15916442871, total_len: 7360
total_loss: 32859.45790863037, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 166 at step    33200 | time:  6.23s | valid loss  4.09 | valid ppl    59.560
----------------------------------------------------------------------------------------------------
| epoch 139 step    33400 |      4 batches | lr 8.21e-06 | ms/batch 31.15 | loss  3.39 | ppl    29.751
total_loss: 30081.57292175293, total_len: 7360
total_loss: 32857.35404968262, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 167 at step    33400 | time:  6.23s | valid loss  4.09 | valid ppl    59.571
----------------------------------------------------------------------------------------------------
| epoch 139 step    33600 |    204 batches | lr 7.73e-06 | ms/batch 31.15 | loss  3.40 | ppl    29.895
total_loss: 30060.61912536621, total_len: 7360
total_loss: 32831.155433654785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 168 at step    33600 | time:  6.23s | valid loss  4.08 | valid ppl    59.402
----------------------------------------------------------------------------------------------------
| epoch 140 step    33800 |    162 batches | lr 7.26e-06 | ms/batch 31.12 | loss  3.39 | ppl    29.788
total_loss: 30071.27980041504, total_len: 7360
total_loss: 32842.46551513672, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 169 at step    33800 | time:  6.23s | valid loss  4.09 | valid ppl    59.488
----------------------------------------------------------------------------------------------------
| epoch 141 step    34000 |    120 batches | lr 6.81e-06 | ms/batch 31.17 | loss  3.40 | ppl    29.835
total_loss: 30083.363845825195, total_len: 7360
total_loss: 32858.48410797119, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 170 at step    34000 | time:  6.22s | valid loss  4.09 | valid ppl    59.586
----------------------------------------------------------------------------------------------------
| epoch 142 step    34200 |     78 batches | lr 6.37e-06 | ms/batch 31.15 | loss  3.41 | ppl    30.347
total_loss: 30071.603729248047, total_len: 7360
total_loss: 32847.96449279785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 171 at step    34200 | time:  6.23s | valid loss  4.09 | valid ppl    59.490
----------------------------------------------------------------------------------------------------
| epoch 143 step    34400 |     36 batches | lr 5.95e-06 | ms/batch 31.30 | loss  3.39 | ppl    29.745
total_loss: 30077.540855407715, total_len: 7360
total_loss: 32854.06010437012, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 172 at step    34400 | time:  6.28s | valid loss  4.09 | valid ppl    59.538
----------------------------------------------------------------------------------------------------
| epoch 143 step    34600 |    236 batches | lr 5.54e-06 | ms/batch 31.79 | loss  3.39 | ppl    29.700
total_loss: 30075.003059387207, total_len: 7360
total_loss: 32848.83605957031, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 173 at step    34600 | time:  6.36s | valid loss  4.09 | valid ppl    59.518
----------------------------------------------------------------------------------------------------
| epoch 144 step    34800 |    194 batches | lr 5.14e-06 | ms/batch 31.32 | loss  3.40 | ppl    29.882
total_loss: 30055.555633544922, total_len: 7360
total_loss: 32828.7014465332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 174 at step    34800 | time:  6.25s | valid loss  4.08 | valid ppl    59.361
----------------------------------------------------------------------------------------------------
| epoch 145 step    35000 |    152 batches | lr 4.76e-06 | ms/batch 31.25 | loss  3.39 | ppl    29.712
total_loss: 30072.98770904541, total_len: 7360
total_loss: 32846.212814331055, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 175 at step    35000 | time:  6.23s | valid loss  4.09 | valid ppl    59.502
----------------------------------------------------------------------------------------------------
| epoch 146 step    35200 |    110 batches | lr 4.39e-06 | ms/batch 30.92 | loss  3.40 | ppl    29.935
total_loss: 30070.03842163086, total_len: 7360
total_loss: 32842.20585632324, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 176 at step    35200 | time:  6.05s | valid loss  4.09 | valid ppl    59.478
----------------------------------------------------------------------------------------------------
| epoch 147 step    35400 |     68 batches | lr 4.03e-06 | ms/batch 30.59 | loss  3.41 | ppl    30.131
total_loss: 30067.65980529785, total_len: 7360
total_loss: 32839.994857788086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 177 at step    35400 | time:  6.26s | valid loss  4.09 | valid ppl    59.459
----------------------------------------------------------------------------------------------------
| epoch 148 step    35600 |     26 batches | lr 3.69e-06 | ms/batch 31.35 | loss  3.39 | ppl    29.666
total_loss: 30068.23780822754, total_len: 7360
total_loss: 32842.25688171387, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 178 at step    35600 | time:  6.27s | valid loss  4.09 | valid ppl    59.463
----------------------------------------------------------------------------------------------------
| epoch 148 step    35800 |    226 batches | lr 3.37e-06 | ms/batch 31.51 | loss  3.39 | ppl    29.570
total_loss: 30064.508224487305, total_len: 7360
total_loss: 32837.32905578613, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 179 at step    35800 | time:  6.30s | valid loss  4.08 | valid ppl    59.433
----------------------------------------------------------------------------------------------------
| epoch 149 step    36000 |    184 batches | lr 3.06e-06 | ms/batch 31.53 | loss  3.39 | ppl    29.638
total_loss: 30066.586616516113, total_len: 7360
total_loss: 32838.814109802246, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 180 at step    36000 | time:  6.30s | valid loss  4.09 | valid ppl    59.450
----------------------------------------------------------------------------------------------------
| epoch 150 step    36200 |    142 batches | lr 2.76e-06 | ms/batch 31.18 | loss  3.39 | ppl    29.672
total_loss: 30073.238899230957, total_len: 7360
total_loss: 32843.8983001709, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 181 at step    36200 | time:  6.23s | valid loss  4.09 | valid ppl    59.504
----------------------------------------------------------------------------------------------------
| epoch 151 step    36400 |    100 batches | lr 2.48e-06 | ms/batch 31.16 | loss  3.40 | ppl    30.024
total_loss: 30062.773162841797, total_len: 7360
total_loss: 32834.29749298096, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 182 at step    36400 | time:  6.23s | valid loss  4.08 | valid ppl    59.419
----------------------------------------------------------------------------------------------------
| epoch 152 step    36600 |     58 batches | lr 2.22e-06 | ms/batch 31.19 | loss  3.40 | ppl    29.944
total_loss: 30062.81268310547, total_len: 7360
total_loss: 32836.33215332031, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 183 at step    36600 | time:  6.23s | valid loss  4.08 | valid ppl    59.419
----------------------------------------------------------------------------------------------------
| epoch 153 step    36800 |     16 batches | lr 1.96e-06 | ms/batch 31.18 | loss  3.39 | ppl    29.618
total_loss: 30066.304565429688, total_len: 7360
total_loss: 32838.31307220459, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 184 at step    36800 | time:  6.24s | valid loss  4.09 | valid ppl    59.448
----------------------------------------------------------------------------------------------------
| epoch 153 step    37000 |    216 batches | lr 1.73e-06 | ms/batch 31.22 | loss  3.39 | ppl    29.619
total_loss: 30059.308807373047, total_len: 7360
total_loss: 32830.19409942627, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 185 at step    37000 | time:  6.24s | valid loss  4.08 | valid ppl    59.391
----------------------------------------------------------------------------------------------------
| epoch 154 step    37200 |    174 batches | lr 1.51e-06 | ms/batch 31.19 | loss  3.39 | ppl    29.563
total_loss: 30062.243171691895, total_len: 7360
total_loss: 32832.41620635986, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 186 at step    37200 | time:  6.22s | valid loss  4.08 | valid ppl    59.415
----------------------------------------------------------------------------------------------------
| epoch 155 step    37400 |    132 batches | lr 1.3e-06 | ms/batch 31.95 | loss  3.39 | ppl    29.636
total_loss: 30065.40712738037, total_len: 7360
total_loss: 32834.31188201904, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 187 at step    37400 | time:  6.39s | valid loss  4.08 | valid ppl    59.440
----------------------------------------------------------------------------------------------------
| epoch 156 step    37600 |     90 batches | lr 1.11e-06 | ms/batch 31.67 | loss  3.40 | ppl    30.100
total_loss: 30062.37074279785, total_len: 7360
total_loss: 32830.961906433105, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 188 at step    37600 | time:  6.33s | valid loss  4.08 | valid ppl    59.416
----------------------------------------------------------------------------------------------------
| epoch 157 step    37800 |     48 batches | lr 9.31e-07 | ms/batch 31.72 | loss  3.39 | ppl    29.688
total_loss: 30064.198928833008, total_len: 7360
total_loss: 32834.083572387695, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 189 at step    37800 | time:  6.34s | valid loss  4.08 | valid ppl    59.431
----------------------------------------------------------------------------------------------------
| epoch 158 step    38000 |      6 batches | lr 7.69e-07 | ms/batch 31.15 | loss  3.39 | ppl    29.567
total_loss: 30062.07932281494, total_len: 7360
total_loss: 32831.23946380615, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 190 at step    38000 | time:  6.52s | valid loss  4.08 | valid ppl    59.414
----------------------------------------------------------------------------------------------------
| epoch 158 step    38200 |    206 batches | lr 6.24e-07 | ms/batch 31.16 | loss  3.39 | ppl    29.625
total_loss: 30063.168991088867, total_len: 7360
total_loss: 32832.413749694824, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 191 at step    38200 | time:  6.23s | valid loss  4.08 | valid ppl    59.422
----------------------------------------------------------------------------------------------------
| epoch 159 step    38400 |    164 batches | lr 4.93e-07 | ms/batch 32.11 | loss  3.39 | ppl    29.552
total_loss: 30062.683143615723, total_len: 7360
total_loss: 32831.604835510254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 192 at step    38400 | time:  6.47s | valid loss  4.08 | valid ppl    59.418
----------------------------------------------------------------------------------------------------
| epoch 160 step    38600 |    122 batches | lr 3.77e-07 | ms/batch 33.01 | loss  3.39 | ppl    29.678
total_loss: 30059.605514526367, total_len: 7360
total_loss: 32828.94275665283, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 193 at step    38600 | time:  6.77s | valid loss  4.08 | valid ppl    59.394
----------------------------------------------------------------------------------------------------
| epoch 161 step    38800 |     80 batches | lr 2.77e-07 | ms/batch 33.80 | loss  3.41 | ppl    30.168
total_loss: 30060.435371398926, total_len: 7360
total_loss: 32830.04792022705, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 194 at step    38800 | time:  6.54s | valid loss  4.08 | valid ppl    59.400
----------------------------------------------------------------------------------------------------
| epoch 162 step    39000 |     38 batches | lr 1.93e-07 | ms/batch 32.70 | loss  3.39 | ppl    29.579
total_loss: 30061.82004547119, total_len: 7360
total_loss: 32831.57346343994, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 195 at step    39000 | time:  6.55s | valid loss  4.08 | valid ppl    59.411
----------------------------------------------------------------------------------------------------
| epoch 162 step    39200 |    238 batches | lr 1.23e-07 | ms/batch 32.73 | loss  3.38 | ppl    29.508
total_loss: 30059.949966430664, total_len: 7360
total_loss: 32829.5319519043, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 196 at step    39200 | time:  6.53s | valid loss  4.08 | valid ppl    59.396
----------------------------------------------------------------------------------------------------
| epoch 163 step    39400 |    196 batches | lr 6.94e-08 | ms/batch 32.65 | loss  3.39 | ppl    29.624
total_loss: 30060.417808532715, total_len: 7360
total_loss: 32830.28820037842, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 197 at step    39400 | time:  6.53s | valid loss  4.08 | valid ppl    59.400
----------------------------------------------------------------------------------------------------
| epoch 164 step    39600 |    154 batches | lr 3.08e-08 | ms/batch 31.32 | loss  3.39 | ppl    29.630
total_loss: 30060.522102355957, total_len: 7360
total_loss: 32830.43111419678, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 198 at step    39600 | time:  6.26s | valid loss  4.08 | valid ppl    59.401
----------------------------------------------------------------------------------------------------
| epoch 165 step    39800 |    112 batches | lr 7.71e-09 | ms/batch 31.11 | loss  3.39 | ppl    29.792
total_loss: 30060.221534729004, total_len: 7360
total_loss: 32830.10366821289, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 199 at step    39800 | time:  6.21s | valid loss  4.08 | valid ppl    59.399
----------------------------------------------------------------------------------------------------
| epoch 166 step    40000 |     70 batches | lr 0 | ms/batch 31.10 | loss  3.41 | ppl    30.143
total_loss: 30060.237342834473, total_len: 7360
total_loss: 32830.12030029297, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 200 at step    40000 | time:  6.23s | valid loss  4.08 | valid ppl    59.399
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
End of training
total_loss: 32827.506088256836, total_len: 8224
====================================================================================================
| End of training | test loss  3.99 | test ppl    54.145
====================================================================================================
Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 51
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_51_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
total_loss: 71321.9536743164, total_len: 7744
total_loss: 75762.84469604492, total_len: 8224
total_loss: 67808.84530639648, total_len: 7360
| Start of training | test loss  9.21 | test bpc 10020.69926
| epoch   1 step      200 |    200 batches | lr 0.000125 | ms/batch 39.25 | loss  7.05 | ppl  1153.182
total_loss: 45490.54122924805, total_len: 7360
total_loss: 50441.456787109375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   1 at step      200 | time:  9.22s | valid loss  6.18 | valid ppl   483.369
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   2 step      400 |    158 batches | lr 0.000125 | ms/batch 39.08 | loss  6.07 | ppl   431.965
total_loss: 42734.8438873291, total_len: 7360
total_loss: 47339.70756530762, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   2 at step      400 | time:  6.72s | valid loss  5.81 | valid ppl   332.409
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   3 step      600 |    116 batches | lr 0.000125 | ms/batch 39.34 | loss  5.80 | ppl   330.176
total_loss: 41441.65525817871, total_len: 7360
total_loss: 45892.552017211914, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   3 at step      600 | time:  6.65s | valid loss  5.63 | valid ppl   278.846
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   4 step      800 |     74 batches | lr 0.000125 | ms/batch 39.44 | loss  5.66 | ppl   285.760
total_loss: 40545.38578796387, total_len: 7360
total_loss: 44881.20442199707, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   4 at step      800 | time:  6.71s | valid loss  5.51 | valid ppl   246.875
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1000 |     32 batches | lr 0.000125 | ms/batch 39.15 | loss  5.52 | ppl   250.736
total_loss: 39941.67402648926, total_len: 7360
total_loss: 44199.69923400879, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1000 | time:  6.74s | valid loss  5.43 | valid ppl   227.433
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1200 |    232 batches | lr 0.000125 | ms/batch 39.60 | loss  5.43 | ppl   228.285
total_loss: 39427.22299194336, total_len: 7360
total_loss: 43655.66259765625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1200 | time:  8.75s | valid loss  5.36 | valid ppl   212.079
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   6 step     1400 |    190 batches | lr 0.000125 | ms/batch 40.05 | loss  5.36 | ppl   212.071
total_loss: 38945.579666137695, total_len: 7360
total_loss: 43102.74685668945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1400 | time:  6.80s | valid loss  5.29 | valid ppl   198.645
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   7 step     1600 |    148 batches | lr 0.000125 | ms/batch 37.74 | loss  5.29 | ppl   198.559
total_loss: 38589.75556945801, total_len: 7360
total_loss: 42718.05700683594, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   8 at step     1600 | time:  6.74s | valid loss  5.24 | valid ppl   189.270
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   8 step     1800 |    106 batches | lr 0.000124 | ms/batch 39.24 | loss  5.24 | ppl   188.621
total_loss: 38296.6628112793, total_len: 7360
total_loss: 42383.94039916992, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   9 at step     1800 | time:  6.71s | valid loss  5.20 | valid ppl   181.881
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   9 step     2000 |     64 batches | lr 0.000124 | ms/batch 38.33 | loss  5.19 | ppl   179.317
total_loss: 37882.99578857422, total_len: 7360
total_loss: 41926.77735900879, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2000 | time:  6.75s | valid loss  5.15 | valid ppl   171.940
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2200 |     22 batches | lr 0.000124 | ms/batch 39.60 | loss  5.13 | ppl   168.320
total_loss: 37559.32012939453, total_len: 7360
total_loss: 41570.01858520508, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2200 | time:  6.75s | valid loss  5.10 | valid ppl   164.542
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2400 |    222 batches | lr 0.000124 | ms/batch 39.48 | loss  5.08 | ppl   160.983
total_loss: 37338.81369018555, total_len: 7360
total_loss: 41316.90577697754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  12 at step     2400 | time:  6.68s | valid loss  5.07 | valid ppl   159.686
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  11 step     2600 |    180 batches | lr 0.000124 | ms/batch 38.89 | loss  5.04 | ppl   153.709
total_loss: 37027.34780883789, total_len: 7360
total_loss: 40970.763916015625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  13 at step     2600 | time:  6.61s | valid loss  5.03 | valid ppl   153.069
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  12 step     2800 |    138 batches | lr 0.000123 | ms/batch 38.19 | loss  4.99 | ppl   147.588
total_loss: 36793.28564453125, total_len: 7360
total_loss: 40704.22987365723, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  14 at step     2800 | time:  6.48s | valid loss  5.00 | valid ppl   148.278
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  13 step     3000 |     96 batches | lr 0.000123 | ms/batch 38.58 | loss  4.97 | ppl   143.766
total_loss: 36537.639572143555, total_len: 7360
total_loss: 40404.60009765625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3000 | time:  6.68s | valid loss  4.96 | valid ppl   143.216
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  14 step     3200 |     54 batches | lr 0.000123 | ms/batch 38.10 | loss  4.92 | ppl   136.637
total_loss: 36253.54870605469, total_len: 7360
total_loss: 40091.53352355957, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  16 at step     3200 | time:  6.41s | valid loss  4.93 | valid ppl   137.793
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3400 |     12 batches | lr 0.000123 | ms/batch 38.97 | loss  4.87 | ppl   129.805
total_loss: 36028.717376708984, total_len: 7360
total_loss: 39841.37562561035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  17 at step     3400 | time:  6.55s | valid loss  4.90 | valid ppl   133.648
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3600 |    212 batches | lr 0.000123 | ms/batch 38.86 | loss  4.83 | ppl   124.870
total_loss: 35719.443115234375, total_len: 7360
total_loss: 39481.50247192383, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  18 at step     3600 | time:  6.52s | valid loss  4.85 | valid ppl   128.148
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  16 step     3800 |    170 batches | lr 0.000122 | ms/batch 38.71 | loss  4.78 | ppl   119.517
total_loss: 35504.49932098389, total_len: 7360
total_loss: 39232.85632324219, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  19 at step     3800 | time:  6.56s | valid loss  4.82 | valid ppl   124.460
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  17 step     4000 |    128 batches | lr 0.000122 | ms/batch 38.72 | loss  4.75 | ppl   115.062
total_loss: 35285.07095336914, total_len: 7360
total_loss: 38971.8405456543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  20 at step     4000 | time:  6.47s | valid loss  4.79 | valid ppl   120.804
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  18 step     4200 |     86 batches | lr 0.000122 | ms/batch 37.40 | loss  4.73 | ppl   112.861
total_loss: 35030.373107910156, total_len: 7360
total_loss: 38660.19290924072, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  21 at step     4200 | time:  6.39s | valid loss  4.76 | valid ppl   116.695
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  19 step     4400 |     44 batches | lr 0.000121 | ms/batch 37.91 | loss  4.67 | ppl   106.764
total_loss: 34786.686096191406, total_len: 7360
total_loss: 38395.90076446533, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  22 at step     4400 | time:  6.41s | valid loss  4.73 | valid ppl   112.894
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4600 |      2 batches | lr 0.000121 | ms/batch 38.60 | loss  4.63 | ppl   102.266
total_loss: 34603.176025390625, total_len: 7360
total_loss: 38183.66881561279, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  23 at step     4600 | time:  6.54s | valid loss  4.70 | valid ppl   110.114
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4800 |    202 batches | lr 0.000121 | ms/batch 38.30 | loss  4.60 | ppl    99.108
total_loss: 34420.248542785645, total_len: 7360
total_loss: 37964.23802947998, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  24 at step     4800 | time:  6.41s | valid loss  4.68 | valid ppl   107.411
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  21 step     5000 |    160 batches | lr 0.00012 | ms/batch 37.56 | loss  4.56 | ppl    95.370
total_loss: 34208.401596069336, total_len: 7360
total_loss: 37717.55471801758, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  25 at step     5000 | time:  6.44s | valid loss  4.65 | valid ppl   104.364
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  22 step     5200 |    118 batches | lr 0.00012 | ms/batch 37.98 | loss  4.52 | ppl    92.277
total_loss: 34012.63530731201, total_len: 7360
total_loss: 37497.391662597656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  26 at step     5200 | time:  6.36s | valid loss  4.62 | valid ppl   101.624
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  23 step     5400 |     76 batches | lr 0.000119 | ms/batch 38.28 | loss  4.51 | ppl    90.683
total_loss: 33784.694328308105, total_len: 7360
total_loss: 37225.40604400635, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  27 at step     5400 | time:  6.46s | valid loss  4.59 | valid ppl    98.525
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5600 |     34 batches | lr 0.000119 | ms/batch 38.80 | loss  4.45 | ppl    85.812
total_loss: 33550.93836975098, total_len: 7360
total_loss: 36979.235511779785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  28 at step     5600 | time:  6.53s | valid loss  4.56 | valid ppl    95.445
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5800 |    234 batches | lr 0.000119 | ms/batch 38.51 | loss  4.41 | ppl    82.425
total_loss: 33478.66641998291, total_len: 7360
total_loss: 36887.92519378662, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  29 at step     5800 | time:  6.49s | valid loss  4.55 | valid ppl    94.512
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  25 step     6000 |    192 batches | lr 0.000118 | ms/batch 37.68 | loss  4.39 | ppl    80.248
total_loss: 33191.020584106445, total_len: 7360
total_loss: 36570.33585357666, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  30 at step     6000 | time:  6.42s | valid loss  4.51 | valid ppl    90.890
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  26 step     6200 |    150 batches | lr 0.000118 | ms/batch 37.78 | loss  4.35 | ppl    77.453
total_loss: 33001.920097351074, total_len: 7360
total_loss: 36355.604751586914, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  31 at step     6200 | time:  6.42s | valid loss  4.48 | valid ppl    88.584
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  27 step     6400 |    108 batches | lr 0.000117 | ms/batch 37.94 | loss  4.33 | ppl    75.977
total_loss: 32912.77716064453, total_len: 7360
total_loss: 36254.98667907715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  32 at step     6400 | time:  6.56s | valid loss  4.47 | valid ppl    87.518
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  28 step     6600 |     66 batches | lr 0.000117 | ms/batch 38.23 | loss  4.30 | ppl    74.010
total_loss: 32698.64850616455, total_len: 7360
total_loss: 36026.13698577881, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  33 at step     6600 | time:  6.47s | valid loss  4.44 | valid ppl    85.008
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     6800 |     24 batches | lr 0.000116 | ms/batch 36.21 | loss  4.26 | ppl    70.725
total_loss: 32595.186378479004, total_len: 7360
total_loss: 35907.08491516113, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  34 at step     6800 | time:  6.32s | valid loss  4.43 | valid ppl    83.822
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     7000 |    224 batches | lr 0.000116 | ms/batch 37.29 | loss  4.23 | ppl    68.984
total_loss: 32471.65040588379, total_len: 7360
total_loss: 35768.40915679932, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  35 at step     7000 | time:  6.34s | valid loss  4.41 | valid ppl    82.427
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  30 step     7200 |    182 batches | lr 0.000115 | ms/batch 36.96 | loss  4.21 | ppl    67.266
total_loss: 32287.899726867676, total_len: 7360
total_loss: 35557.59462738037, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  36 at step     7200 | time:  6.37s | valid loss  4.39 | valid ppl    80.394
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  31 step     7400 |    140 batches | lr 0.000115 | ms/batch 37.93 | loss  4.19 | ppl    65.846
total_loss: 32238.198684692383, total_len: 7360
total_loss: 35482.372901916504, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  37 at step     7400 | time:  6.45s | valid loss  4.38 | valid ppl    79.853
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  32 step     7600 |     98 batches | lr 0.000114 | ms/batch 37.27 | loss  4.18 | ppl    65.147
total_loss: 32131.908195495605, total_len: 7360
total_loss: 35350.67922210693, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  38 at step     7600 | time:  6.41s | valid loss  4.37 | valid ppl    78.708
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  33 step     7800 |     56 batches | lr 0.000114 | ms/batch 38.32 | loss  4.15 | ppl    63.284
total_loss: 32092.39860534668, total_len: 7360
total_loss: 35311.37133026123, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  39 at step     7800 | time:  6.49s | valid loss  4.36 | valid ppl    78.287
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8000 |     14 batches | lr 0.000113 | ms/batch 37.81 | loss  4.11 | ppl    61.226
total_loss: 31956.92800140381, total_len: 7360
total_loss: 35149.21284484863, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  40 at step     8000 | time:  6.45s | valid loss  4.34 | valid ppl    76.859
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8200 |    214 batches | lr 0.000112 | ms/batch 40.41 | loss  4.10 | ppl    60.267
total_loss: 31906.675148010254, total_len: 7360
total_loss: 35077.40482330322, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  41 at step     8200 | time:  6.49s | valid loss  4.34 | valid ppl    76.336
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  35 step     8400 |    172 batches | lr 0.000112 | ms/batch 37.83 | loss  4.08 | ppl    59.015
total_loss: 31775.39080810547, total_len: 7360
total_loss: 34959.83026885986, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  42 at step     8400 | time:  6.44s | valid loss  4.32 | valid ppl    74.987
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  36 step     8600 |    130 batches | lr 0.000111 | ms/batch 38.80 | loss  4.06 | ppl    57.967
total_loss: 31770.833724975586, total_len: 7360
total_loss: 34912.285232543945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  43 at step     8600 | time:  6.57s | valid loss  4.32 | valid ppl    74.940
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  37 step     8800 |     88 batches | lr 0.000111 | ms/batch 38.78 | loss  4.06 | ppl    58.112
total_loss: 31628.95418548584, total_len: 7360
total_loss: 34776.84428405762, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  44 at step     8800 | time:  6.55s | valid loss  4.30 | valid ppl    73.509
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  38 step     9000 |     46 batches | lr 0.00011 | ms/batch 38.82 | loss  4.03 | ppl    55.995
total_loss: 31549.340782165527, total_len: 7360
total_loss: 34681.73155212402, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  45 at step     9000 | time:  6.54s | valid loss  4.29 | valid ppl    72.718
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9200 |      4 batches | lr 0.000109 | ms/batch 39.26 | loss  4.00 | ppl    54.811
total_loss: 31518.2035446167, total_len: 7360
total_loss: 34642.414878845215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  46 at step     9200 | time:  6.48s | valid loss  4.28 | valid ppl    72.411
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9400 |    204 batches | lr 0.000109 | ms/batch 38.22 | loss  3.99 | ppl    54.110
total_loss: 31527.32974243164, total_len: 7360
total_loss: 34649.68444061279, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  47 at step     9400 | time:  6.59s | valid loss  4.28 | valid ppl    72.501
----------------------------------------------------------------------------------------------------
| epoch  40 step     9600 |    162 batches | lr 0.000108 | ms/batch 33.05 | loss  3.97 | ppl    53.111
total_loss: 31380.2333984375, total_len: 7360
total_loss: 34489.8924407959, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  48 at step     9600 | time:  6.64s | valid loss  4.26 | valid ppl    71.067
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  41 step     9800 |    120 batches | lr 0.000107 | ms/batch 38.31 | loss  3.96 | ppl    52.527
total_loss: 31338.323051452637, total_len: 7360
total_loss: 34466.0387878418, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  49 at step     9800 | time:  6.47s | valid loss  4.26 | valid ppl    70.663
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  42 step    10000 |     78 batches | lr 0.000107 | ms/batch 38.08 | loss  3.96 | ppl    52.701
total_loss: 31327.728340148926, total_len: 7360
total_loss: 34419.39890289307, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  50 at step    10000 | time:  6.48s | valid loss  4.26 | valid ppl    70.562
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10200 |     36 batches | lr 0.000106 | ms/batch 38.93 | loss  3.93 | ppl    50.997
total_loss: 31262.703002929688, total_len: 7360
total_loss: 34349.32248687744, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  51 at step    10200 | time:  6.56s | valid loss  4.25 | valid ppl    69.941
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10400 |    236 batches | lr 0.000105 | ms/batch 37.88 | loss  3.91 | ppl    50.112
total_loss: 31295.031745910645, total_len: 7360
total_loss: 34369.5407333374, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  52 at step    10400 | time:  6.42s | valid loss  4.25 | valid ppl    70.249
----------------------------------------------------------------------------------------------------
| epoch  44 step    10600 |    194 batches | lr 0.000105 | ms/batch 31.86 | loss  3.90 | ppl    49.634
total_loss: 31180.03702545166, total_len: 7360
total_loss: 34259.19522857666, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  53 at step    10600 | time:  6.35s | valid loss  4.24 | valid ppl    69.160
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  45 step    10800 |    152 batches | lr 0.000104 | ms/batch 37.93 | loss  3.89 | ppl    48.866
total_loss: 31172.74845123291, total_len: 7360
total_loss: 34235.24348449707, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  54 at step    10800 | time:  6.42s | valid loss  4.24 | valid ppl    69.091
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  46 step    11000 |    110 batches | lr 0.000103 | ms/batch 37.93 | loss  3.89 | ppl    48.842
total_loss: 31087.95973968506, total_len: 7360
total_loss: 34140.654235839844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  55 at step    11000 | time:  6.57s | valid loss  4.22 | valid ppl    68.300
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  47 step    11200 |     68 batches | lr 0.000102 | ms/batch 38.74 | loss  3.88 | ppl    48.549
total_loss: 31075.15110015869, total_len: 7360
total_loss: 34137.24560546875, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  56 at step    11200 | time:  6.49s | valid loss  4.22 | valid ppl    68.181
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11400 |     26 batches | lr 0.000102 | ms/batch 37.65 | loss  3.85 | ppl    47.103
total_loss: 31036.82875061035, total_len: 7360
total_loss: 34076.811431884766, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  57 at step    11400 | time:  6.38s | valid loss  4.22 | valid ppl    67.827
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11600 |    226 batches | lr 0.000101 | ms/batch 38.38 | loss  3.84 | ppl    46.468
total_loss: 31031.991973876953, total_len: 7360
total_loss: 34078.319496154785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  58 at step    11600 | time:  6.47s | valid loss  4.22 | valid ppl    67.782
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  49 step    11800 |    184 batches | lr 0.0001 | ms/batch 38.10 | loss  3.83 | ppl    46.138
total_loss: 30951.375297546387, total_len: 7360
total_loss: 33988.08695220947, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  59 at step    11800 | time:  6.50s | valid loss  4.21 | valid ppl    67.044
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  50 step    12000 |    142 batches | lr 9.92e-05 | ms/batch 37.91 | loss  3.82 | ppl    45.755
total_loss: 30896.58595275879, total_len: 7360
total_loss: 33915.34535217285, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  60 at step    12000 | time:  6.45s | valid loss  4.20 | valid ppl    66.547
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  51 step    12200 |    100 batches | lr 9.84e-05 | ms/batch 37.76 | loss  3.82 | ppl    45.747
total_loss: 30883.759757995605, total_len: 7360
total_loss: 33892.21974945068, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  61 at step    12200 | time:  6.46s | valid loss  4.20 | valid ppl    66.431
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  52 step    12400 |     58 batches | lr 9.76e-05 | ms/batch 38.25 | loss  3.81 | ppl    45.126
total_loss: 30906.360496520996, total_len: 7360
total_loss: 33929.137855529785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  62 at step    12400 | time:  6.52s | valid loss  4.20 | valid ppl    66.635
----------------------------------------------------------------------------------------------------
| epoch  53 step    12600 |     16 batches | lr 9.68e-05 | ms/batch 32.50 | loss  3.79 | ppl    44.158
total_loss: 30834.014503479004, total_len: 7360
total_loss: 33843.03352355957, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  63 at step    12600 | time:  6.46s | valid loss  4.19 | valid ppl    65.983
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12800 |    216 batches | lr 9.6e-05 | ms/batch 37.30 | loss  3.78 | ppl    43.781
total_loss: 30828.29009246826, total_len: 7360
total_loss: 33832.57865142822, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  64 at step    12800 | time:  6.52s | valid loss  4.19 | valid ppl    65.932
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  54 step    13000 |    174 batches | lr 9.52e-05 | ms/batch 38.23 | loss  3.77 | ppl    43.411
total_loss: 30797.03497314453, total_len: 7360
total_loss: 33800.70613861084, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  65 at step    13000 | time:  6.42s | valid loss  4.18 | valid ppl    65.653
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  55 step    13200 |    132 batches | lr 9.43e-05 | ms/batch 37.15 | loss  3.76 | ppl    42.950
total_loss: 30735.75347137451, total_len: 7360
total_loss: 33725.16990661621, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  66 at step    13200 | time:  6.44s | valid loss  4.18 | valid ppl    65.108
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  56 step    13400 |     90 batches | lr 9.35e-05 | ms/batch 38.38 | loss  3.77 | ppl    43.275
total_loss: 30731.375778198242, total_len: 7360
total_loss: 33725.02788543701, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  67 at step    13400 | time:  6.54s | valid loss  4.18 | valid ppl    65.070
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  57 step    13600 |     48 batches | lr 9.26e-05 | ms/batch 38.63 | loss  3.75 | ppl    42.315
total_loss: 30678.98053741455, total_len: 7360
total_loss: 33654.93183135986, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  68 at step    13600 | time:  6.68s | valid loss  4.17 | valid ppl    64.608
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    13800 |      6 batches | lr 9.17e-05 | ms/batch 39.21 | loss  3.73 | ppl    41.738
total_loss: 30674.341903686523, total_len: 7360
total_loss: 33631.82207489014, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  69 at step    13800 | time:  6.67s | valid loss  4.17 | valid ppl    64.567
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    14000 |    206 batches | lr 9.09e-05 | ms/batch 38.10 | loss  3.73 | ppl    41.491
total_loss: 30697.350303649902, total_len: 7360
total_loss: 33657.07139587402, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  70 at step    14000 | time:  6.40s | valid loss  4.17 | valid ppl    64.770
----------------------------------------------------------------------------------------------------
| epoch  59 step    14200 |    164 batches | lr 9e-05 | ms/batch 31.99 | loss  3.72 | ppl    41.225
total_loss: 30651.669647216797, total_len: 7360
total_loss: 33606.88179779053, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  71 at step    14200 | time:  6.50s | valid loss  4.16 | valid ppl    64.369
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  60 step    14400 |    122 batches | lr 8.91e-05 | ms/batch 37.98 | loss  3.71 | ppl    40.930
total_loss: 30631.154960632324, total_len: 7360
total_loss: 33589.85587310791, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  72 at step    14400 | time:  6.44s | valid loss  4.16 | valid ppl    64.190
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  61 step    14600 |     80 batches | lr 8.82e-05 | ms/batch 38.03 | loss  3.72 | ppl    41.348
total_loss: 30612.805725097656, total_len: 7360
total_loss: 33543.16854095459, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  73 at step    14600 | time:  6.43s | valid loss  4.16 | valid ppl    64.030
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    14800 |     38 batches | lr 8.73e-05 | ms/batch 37.34 | loss  3.69 | ppl    40.117
total_loss: 30575.046585083008, total_len: 7360
total_loss: 33513.50835418701, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  74 at step    14800 | time:  6.43s | valid loss  4.15 | valid ppl    63.702
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    15000 |    238 batches | lr 8.64e-05 | ms/batch 38.38 | loss  3.68 | ppl    39.828
total_loss: 30618.92197418213, total_len: 7360
total_loss: 33545.23597717285, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  75 at step    15000 | time:  6.46s | valid loss  4.16 | valid ppl    64.083
----------------------------------------------------------------------------------------------------
| epoch  63 step    15200 |    196 batches | lr 8.55e-05 | ms/batch 31.82 | loss  3.68 | ppl    39.662
total_loss: 30577.197303771973, total_len: 7360
total_loss: 33514.21664428711, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  76 at step    15200 | time:  6.37s | valid loss  4.15 | valid ppl    63.721
----------------------------------------------------------------------------------------------------
| epoch  64 step    15400 |    154 batches | lr 8.46e-05 | ms/batch 32.86 | loss  3.67 | ppl    39.257
total_loss: 30523.624969482422, total_len: 7360
total_loss: 33468.87635040283, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  77 at step    15400 | time:  6.63s | valid loss  4.15 | valid ppl    63.259
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  65 step    15600 |    112 batches | lr 8.37e-05 | ms/batch 38.32 | loss  3.67 | ppl    39.363
total_loss: 30534.432273864746, total_len: 7360
total_loss: 33462.505126953125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  78 at step    15600 | time:  6.48s | valid loss  4.15 | valid ppl    63.352
----------------------------------------------------------------------------------------------------
| epoch  66 step    15800 |     70 batches | lr 8.27e-05 | ms/batch 32.15 | loss  3.67 | ppl    39.330
total_loss: 30492.305152893066, total_len: 7360
total_loss: 33417.264472961426, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  79 at step    15800 | time:  6.45s | valid loss  4.14 | valid ppl    62.990
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16000 |     28 batches | lr 8.18e-05 | ms/batch 38.11 | loss  3.65 | ppl    38.440
total_loss: 30548.44285583496, total_len: 7360
total_loss: 33483.50154876709, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  80 at step    16000 | time:  6.54s | valid loss  4.15 | valid ppl    63.472
----------------------------------------------------------------------------------------------------
| epoch  67 step    16200 |    228 batches | lr 8.09e-05 | ms/batch 33.03 | loss  3.64 | ppl    38.208
total_loss: 30481.976707458496, total_len: 7360
total_loss: 33412.49743652344, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  81 at step    16200 | time:  6.59s | valid loss  4.14 | valid ppl    62.902
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  68 step    16400 |    186 batches | lr 7.99e-05 | ms/batch 38.84 | loss  3.64 | ppl    37.977
total_loss: 30496.936248779297, total_len: 7360
total_loss: 33414.87537384033, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  82 at step    16400 | time:  6.60s | valid loss  4.14 | valid ppl    63.030
----------------------------------------------------------------------------------------------------
| epoch  69 step    16600 |    144 batches | lr 7.9e-05 | ms/batch 32.69 | loss  3.63 | ppl    37.764
total_loss: 30428.11882019043, total_len: 7360
total_loss: 33333.89659118652, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  83 at step    16600 | time:  6.65s | valid loss  4.13 | valid ppl    62.443
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  70 step    16800 |    102 batches | lr 7.8e-05 | ms/batch 38.92 | loss  3.64 | ppl    38.043
total_loss: 30443.19647216797, total_len: 7360
total_loss: 33348.252281188965, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  84 at step    16800 | time:  6.50s | valid loss  4.14 | valid ppl    62.571
----------------------------------------------------------------------------------------------------
| epoch  71 step    17000 |     60 batches | lr 7.71e-05 | ms/batch 31.98 | loss  3.63 | ppl    37.762
total_loss: 30434.466674804688, total_len: 7360
total_loss: 33336.5163192749, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  85 at step    17000 | time:  6.43s | valid loss  4.14 | valid ppl    62.497
----------------------------------------------------------------------------------------------------
| epoch  72 step    17200 |     18 batches | lr 7.61e-05 | ms/batch 32.33 | loss  3.61 | ppl    37.102
total_loss: 30386.379318237305, total_len: 7360
total_loss: 33302.8655090332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  86 at step    17200 | time:  6.50s | valid loss  4.13 | valid ppl    62.090
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17400 |    218 batches | lr 7.52e-05 | ms/batch 38.56 | loss  3.61 | ppl    36.865
total_loss: 30416.339111328125, total_len: 7360
total_loss: 33321.0520324707, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  87 at step    17400 | time:  6.38s | valid loss  4.13 | valid ppl    62.343
----------------------------------------------------------------------------------------------------
| epoch  73 step    17600 |    176 batches | lr 7.42e-05 | ms/batch 31.41 | loss  3.60 | ppl    36.665
total_loss: 30367.754119873047, total_len: 7360
total_loss: 33264.38530731201, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  88 at step    17600 | time:  6.34s | valid loss  4.13 | valid ppl    61.933
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  74 step    17800 |    134 batches | lr 7.32e-05 | ms/batch 37.27 | loss  3.60 | ppl    36.552
total_loss: 30396.238426208496, total_len: 7360
total_loss: 33288.13914489746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  89 at step    17800 | time:  6.35s | valid loss  4.13 | valid ppl    62.173
----------------------------------------------------------------------------------------------------
| epoch  75 step    18000 |     92 batches | lr 7.23e-05 | ms/batch 31.87 | loss  3.61 | ppl    36.903
total_loss: 30382.30499267578, total_len: 7360
total_loss: 33271.68578338623, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  90 at step    18000 | time:  6.38s | valid loss  4.13 | valid ppl    62.056
----------------------------------------------------------------------------------------------------
| epoch  76 step    18200 |     50 batches | lr 7.13e-05 | ms/batch 32.21 | loss  3.59 | ppl    36.239
total_loss: 30338.441566467285, total_len: 7360
total_loss: 33223.45970916748, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  91 at step    18200 | time:  6.46s | valid loss  4.12 | valid ppl    61.687
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  77 step    18400 |      8 batches | lr 7.03e-05 | ms/batch 38.16 | loss  3.58 | ppl    35.884
total_loss: 30339.2488861084, total_len: 7360
total_loss: 33214.01399230957, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  92 at step    18400 | time:  6.46s | valid loss  4.12 | valid ppl    61.694
----------------------------------------------------------------------------------------------------
| epoch  77 step    18600 |    208 batches | lr 6.94e-05 | ms/batch 31.89 | loss  3.58 | ppl    35.743
total_loss: 30365.29360961914, total_len: 7360
total_loss: 33261.71691131592, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  93 at step    18600 | time:  6.37s | valid loss  4.13 | valid ppl    61.912
----------------------------------------------------------------------------------------------------
| epoch  78 step    18800 |    166 batches | lr 6.84e-05 | ms/batch 32.26 | loss  3.57 | ppl    35.632
total_loss: 30323.679313659668, total_len: 7360
total_loss: 33207.93166351318, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  94 at step    18800 | time:  6.44s | valid loss  4.12 | valid ppl    61.563
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  79 step    19000 |    124 batches | lr 6.74e-05 | ms/batch 38.05 | loss  3.57 | ppl    35.496
total_loss: 30386.249198913574, total_len: 7360
total_loss: 33261.68788146973, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  95 at step    19000 | time:  6.51s | valid loss  4.13 | valid ppl    62.089
----------------------------------------------------------------------------------------------------
| epoch  80 step    19200 |     82 batches | lr 6.64e-05 | ms/batch 32.09 | loss  3.58 | ppl    35.964
total_loss: 30323.2449798584, total_len: 7360
total_loss: 33184.86563873291, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  96 at step    19200 | time:  6.38s | valid loss  4.12 | valid ppl    61.560
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19400 |     40 batches | lr 6.54e-05 | ms/batch 38.03 | loss  3.56 | ppl    35.128
total_loss: 30305.995147705078, total_len: 7360
total_loss: 33178.68236541748, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  97 at step    19400 | time:  6.43s | valid loss  4.12 | valid ppl    61.416
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19600 |    240 batches | lr 6.45e-05 | ms/batch 37.36 | loss  3.55 | ppl    34.894
total_loss: 30298.87152862549, total_len: 7360
total_loss: 33156.54286193848, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  98 at step    19600 | time:  6.30s | valid loss  4.12 | valid ppl    61.356
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  82 step    19800 |    198 batches | lr 6.35e-05 | ms/batch 37.49 | loss  3.55 | ppl    34.878
total_loss: 30310.049514770508, total_len: 7360
total_loss: 33176.294189453125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  99 at step    19800 | time:  6.36s | valid loss  4.12 | valid ppl    61.449
----------------------------------------------------------------------------------------------------
| epoch  83 step    20000 |    156 batches | lr 6.25e-05 | ms/batch 31.50 | loss  3.54 | ppl    34.613
total_loss: 30285.427574157715, total_len: 7360
total_loss: 33142.878005981445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 100 at step    20000 | time:  6.30s | valid loss  4.11 | valid ppl    61.244
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  84 step    20200 |    114 batches | lr 6.15e-05 | ms/batch 37.46 | loss  3.54 | ppl    34.637
total_loss: 30269.52074432373, total_len: 7360
total_loss: 33123.323669433594, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 101 at step    20200 | time:  6.39s | valid loss  4.11 | valid ppl    61.112
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  85 step    20400 |     72 batches | lr 6.05e-05 | ms/batch 38.01 | loss  3.55 | ppl    34.968
total_loss: 30286.874450683594, total_len: 7360
total_loss: 33136.27819061279, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 102 at step    20400 | time:  6.47s | valid loss  4.12 | valid ppl    61.256
----------------------------------------------------------------------------------------------------
| epoch  86 step    20600 |     30 batches | lr 5.96e-05 | ms/batch 32.14 | loss  3.53 | ppl    34.168
total_loss: 30271.944381713867, total_len: 7360
total_loss: 33117.94231414795, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 103 at step    20600 | time:  6.39s | valid loss  4.11 | valid ppl    61.132
----------------------------------------------------------------------------------------------------
| epoch  86 step    20800 |    230 batches | lr 5.86e-05 | ms/batch 31.94 | loss  3.53 | ppl    33.973
total_loss: 30281.01880645752, total_len: 7360
total_loss: 33128.88227081299, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 104 at step    20800 | time:  6.38s | valid loss  4.11 | valid ppl    61.207
----------------------------------------------------------------------------------------------------
| epoch  87 step    21000 |    188 batches | lr 5.76e-05 | ms/batch 31.63 | loss  3.53 | ppl    33.954
total_loss: 30265.598274230957, total_len: 7360
total_loss: 33120.02349090576, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 105 at step    21000 | time:  6.32s | valid loss  4.11 | valid ppl    61.079
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  88 step    21200 |    146 batches | lr 5.66e-05 | ms/batch 37.43 | loss  3.52 | ppl    33.851
total_loss: 30252.955200195312, total_len: 7360
total_loss: 33098.115867614746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 106 at step    21200 | time:  6.38s | valid loss  4.11 | valid ppl    60.975
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  89 step    21400 |    104 batches | lr 5.56e-05 | ms/batch 37.82 | loss  3.53 | ppl    34.044
total_loss: 30225.35083770752, total_len: 7360
total_loss: 33064.66550445557, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 107 at step    21400 | time:  6.47s | valid loss  4.11 | valid ppl    60.746
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  90 step    21600 |     62 batches | lr 5.47e-05 | ms/batch 37.93 | loss  3.52 | ppl    33.919
total_loss: 30294.63117980957, total_len: 7360
total_loss: 33128.487800598145, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 108 at step    21600 | time:  6.41s | valid loss  4.12 | valid ppl    61.321
----------------------------------------------------------------------------------------------------
| epoch  91 step    21800 |     20 batches | lr 5.37e-05 | ms/batch 31.84 | loss  3.51 | ppl    33.325
total_loss: 30246.630561828613, total_len: 7360
total_loss: 33087.93371582031, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 109 at step    21800 | time:  6.37s | valid loss  4.11 | valid ppl    60.922
----------------------------------------------------------------------------------------------------
| epoch  91 step    22000 |    220 batches | lr 5.27e-05 | ms/batch 32.01 | loss  3.51 | ppl    33.319
total_loss: 30264.621116638184, total_len: 7360
total_loss: 33109.15518951416, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 110 at step    22000 | time:  6.38s | valid loss  4.11 | valid ppl    61.071
----------------------------------------------------------------------------------------------------
| epoch  92 step    22200 |    178 batches | lr 5.18e-05 | ms/batch 32.13 | loss  3.50 | ppl    33.164
total_loss: 30202.174171447754, total_len: 7360
total_loss: 33031.852462768555, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 111 at step    22200 | time:  6.42s | valid loss  4.10 | valid ppl    60.555
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  93 step    22400 |    136 batches | lr 5.08e-05 | ms/batch 37.72 | loss  3.50 | ppl    33.151
total_loss: 30216.850616455078, total_len: 7360
total_loss: 33053.211181640625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 112 at step    22400 | time:  6.36s | valid loss  4.11 | valid ppl    60.676
----------------------------------------------------------------------------------------------------
| epoch  94 step    22600 |     94 batches | lr 4.98e-05 | ms/batch 31.55 | loss  3.51 | ppl    33.592
total_loss: 30248.791381835938, total_len: 7360
total_loss: 33078.442459106445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 113 at step    22600 | time:  6.29s | valid loss  4.11 | valid ppl    60.940
----------------------------------------------------------------------------------------------------
| epoch  95 step    22800 |     52 batches | lr 4.89e-05 | ms/batch 31.99 | loss  3.50 | ppl    33.024
total_loss: 30222.498558044434, total_len: 7360
total_loss: 33055.46543884277, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 114 at step    22800 | time:  6.40s | valid loss  4.11 | valid ppl    60.723
----------------------------------------------------------------------------------------------------
| epoch  96 step    23000 |     10 batches | lr 4.79e-05 | ms/batch 31.86 | loss  3.49 | ppl    32.707
total_loss: 30182.01459503174, total_len: 7360
total_loss: 33004.13758850098, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 115 at step    23000 | time:  6.45s | valid loss  4.10 | valid ppl    60.390
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  96 step    23200 |    210 batches | lr 4.7e-05 | ms/batch 37.64 | loss  3.49 | ppl    32.676
total_loss: 30208.830772399902, total_len: 7360
total_loss: 33041.69284057617, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 116 at step    23200 | time:  6.37s | valid loss  4.10 | valid ppl    60.610
----------------------------------------------------------------------------------------------------
| epoch  97 step    23400 |    168 batches | lr 4.6e-05 | ms/batch 32.05 | loss  3.48 | ppl    32.531
total_loss: 30171.03578186035, total_len: 7360
total_loss: 32993.59593963623, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 117 at step    23400 | time:  6.41s | valid loss  4.10 | valid ppl    60.300
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  98 step    23600 |    126 batches | lr 4.51e-05 | ms/batch 38.46 | loss  3.48 | ppl    32.468
total_loss: 30246.003051757812, total_len: 7360
total_loss: 33069.74668121338, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 118 at step    23600 | time:  6.49s | valid loss  4.11 | valid ppl    60.917
----------------------------------------------------------------------------------------------------
| epoch  99 step    23800 |     84 batches | lr 4.41e-05 | ms/batch 31.93 | loss  3.49 | ppl    32.927
total_loss: 30164.682418823242, total_len: 7360
total_loss: 32982.045265197754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 119 at step    23800 | time:  6.37s | valid loss  4.10 | valid ppl    60.248
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 100 step    24000 |     42 batches | lr 4.32e-05 | ms/batch 38.54 | loss  3.48 | ppl    32.304
total_loss: 30161.138610839844, total_len: 7360
total_loss: 32986.69366455078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 120 at step    24000 | time:  6.53s | valid loss  4.10 | valid ppl    60.219
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 100 step    24200 |    242 batches | lr 4.23e-05 | ms/batch 38.36 | loss  3.47 | ppl    32.134
total_loss: 30188.482635498047, total_len: 7360
total_loss: 33004.069023132324, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 121 at step    24200 | time:  6.44s | valid loss  4.10 | valid ppl    60.443
----------------------------------------------------------------------------------------------------
| epoch 101 step    24400 |    200 batches | lr 4.13e-05 | ms/batch 31.96 | loss  3.47 | ppl    32.132
total_loss: 30184.291648864746, total_len: 7360
total_loss: 32999.3366394043, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 122 at step    24400 | time:  6.44s | valid loss  4.10 | valid ppl    60.408
----------------------------------------------------------------------------------------------------
| epoch 102 step    24600 |    158 batches | lr 4.04e-05 | ms/batch 32.19 | loss  3.47 | ppl    32.040
total_loss: 30173.60581970215, total_len: 7360
total_loss: 32996.33592224121, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 123 at step    24600 | time:  6.42s | valid loss  4.10 | valid ppl    60.321
----------------------------------------------------------------------------------------------------
| epoch 103 step    24800 |    116 batches | lr 3.95e-05 | ms/batch 32.32 | loss  3.47 | ppl    32.068
total_loss: 30180.953941345215, total_len: 7360
total_loss: 32997.00337219238, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 124 at step    24800 | time:  6.47s | valid loss  4.10 | valid ppl    60.381
----------------------------------------------------------------------------------------------------
| epoch 104 step    25000 |     74 batches | lr 3.86e-05 | ms/batch 32.09 | loss  3.48 | ppl    32.392
total_loss: 30183.571655273438, total_len: 7360
total_loss: 33000.753089904785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 125 at step    25000 | time:  6.39s | valid loss  4.10 | valid ppl    60.402
----------------------------------------------------------------------------------------------------
| epoch 105 step    25200 |     32 batches | lr 3.77e-05 | ms/batch 31.81 | loss  3.46 | ppl    31.753
total_loss: 30177.977569580078, total_len: 7360
total_loss: 32999.849113464355, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 126 at step    25200 | time:  6.38s | valid loss  4.10 | valid ppl    60.357
----------------------------------------------------------------------------------------------------
| epoch 105 step    25400 |    232 batches | lr 3.68e-05 | ms/batch 32.11 | loss  3.45 | ppl    31.466
total_loss: 30173.377265930176, total_len: 7360
total_loss: 32993.121658325195, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 127 at step    25400 | time:  6.42s | valid loss  4.10 | valid ppl    60.319
----------------------------------------------------------------------------------------------------
| epoch 106 step    25600 |    190 batches | lr 3.59e-05 | ms/batch 32.10 | loss  3.45 | ppl    31.639
total_loss: 30177.073539733887, total_len: 7360
total_loss: 32995.75076293945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 128 at step    25600 | time:  6.43s | valid loss  4.10 | valid ppl    60.349
----------------------------------------------------------------------------------------------------
| epoch 107 step    25800 |    148 batches | lr 3.5e-05 | ms/batch 32.14 | loss  3.45 | ppl    31.532
total_loss: 30148.35243988037, total_len: 7360
total_loss: 32960.877449035645, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 129 at step    25800 | time:  6.39s | valid loss  4.10 | valid ppl    60.114
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 108 step    26000 |    106 batches | lr 3.41e-05 | ms/batch 37.76 | loss  3.46 | ppl    31.758
total_loss: 30132.365966796875, total_len: 7360
total_loss: 32936.17951965332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 130 at step    26000 | time:  6.42s | valid loss  4.09 | valid ppl    59.984
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 109 step    26200 |     64 batches | lr 3.33e-05 | ms/batch 38.00 | loss  3.46 | ppl    31.792
total_loss: 30143.48225402832, total_len: 7360
total_loss: 32950.8596496582, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 131 at step    26200 | time:  6.43s | valid loss  4.10 | valid ppl    60.074
----------------------------------------------------------------------------------------------------
| epoch 110 step    26400 |     22 batches | lr 3.24e-05 | ms/batch 31.94 | loss  3.44 | ppl    31.252
total_loss: 30145.259910583496, total_len: 7360
total_loss: 32958.088523864746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 132 at step    26400 | time:  6.31s | valid loss  4.10 | valid ppl    60.089
----------------------------------------------------------------------------------------------------
| epoch 110 step    26600 |    222 batches | lr 3.15e-05 | ms/batch 31.71 | loss  3.44 | ppl    31.297
total_loss: 30141.953575134277, total_len: 7360
total_loss: 32961.46267700195, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 133 at step    26600 | time:  6.33s | valid loss  4.10 | valid ppl    60.062
----------------------------------------------------------------------------------------------------
| epoch 111 step    26800 |    180 batches | lr 3.07e-05 | ms/batch 31.88 | loss  3.44 | ppl    31.126
total_loss: 30114.614486694336, total_len: 7360
total_loss: 32932.119888305664, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 134 at step    26800 | time:  6.40s | valid loss  4.09 | valid ppl    59.839
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 112 step    27000 |    138 batches | lr 2.98e-05 | ms/batch 37.42 | loss  3.44 | ppl    31.136
total_loss: 30150.47824859619, total_len: 7360
total_loss: 32954.87314605713, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 135 at step    27000 | time:  6.40s | valid loss  4.10 | valid ppl    60.131
----------------------------------------------------------------------------------------------------
| epoch 113 step    27200 |     96 batches | lr 2.9e-05 | ms/batch 31.96 | loss  3.45 | ppl    31.533
total_loss: 30136.577896118164, total_len: 7360
total_loss: 32945.72573852539, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 136 at step    27200 | time:  6.38s | valid loss  4.09 | valid ppl    60.018
----------------------------------------------------------------------------------------------------
| epoch 114 step    27400 |     54 batches | lr 2.82e-05 | ms/batch 31.91 | loss  3.44 | ppl    31.166
total_loss: 30089.40264892578, total_len: 7360
total_loss: 32891.91781616211, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 137 at step    27400 | time:  6.41s | valid loss  4.09 | valid ppl    59.634
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 115 step    27600 |     12 batches | lr 2.74e-05 | ms/batch 37.93 | loss  3.43 | ppl    30.951
total_loss: 30116.410064697266, total_len: 7360
total_loss: 32917.20506286621, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 138 at step    27600 | time:  6.44s | valid loss  4.09 | valid ppl    59.854
----------------------------------------------------------------------------------------------------
| epoch 115 step    27800 |    212 batches | lr 2.66e-05 | ms/batch 32.05 | loss  3.43 | ppl    30.986
total_loss: 30113.350067138672, total_len: 7360
total_loss: 32911.47053527832, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 139 at step    27800 | time:  6.40s | valid loss  4.09 | valid ppl    59.829
----------------------------------------------------------------------------------------------------
| epoch 116 step    28000 |    170 batches | lr 2.58e-05 | ms/batch 32.02 | loss  3.43 | ppl    30.864
total_loss: 30087.314849853516, total_len: 7360
total_loss: 32885.50843811035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 140 at step    28000 | time:  6.44s | valid loss  4.09 | valid ppl    59.618
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 117 step    28200 |    128 batches | lr 2.5e-05 | ms/batch 38.09 | loss  3.43 | ppl    30.882
total_loss: 30147.396354675293, total_len: 7360
total_loss: 32940.15222167969, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 141 at step    28200 | time:  6.43s | valid loss  4.10 | valid ppl    60.106
----------------------------------------------------------------------------------------------------
| epoch 118 step    28400 |     86 batches | lr 2.42e-05 | ms/batch 31.89 | loss  3.44 | ppl    31.201
total_loss: 30118.597930908203, total_len: 7360
total_loss: 32903.323989868164, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 142 at step    28400 | time:  6.36s | valid loss  4.09 | valid ppl    59.872
----------------------------------------------------------------------------------------------------
| epoch 119 step    28600 |     44 batches | lr 2.34e-05 | ms/batch 31.11 | loss  3.42 | ppl    30.709
total_loss: 30116.28060913086, total_len: 7360
total_loss: 32911.35642242432, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 143 at step    28600 | time:  6.28s | valid loss  4.09 | valid ppl    59.853
----------------------------------------------------------------------------------------------------
| epoch 120 step    28800 |      2 batches | lr 2.27e-05 | ms/batch 31.76 | loss  3.42 | ppl    30.559
total_loss: 30124.159469604492, total_len: 7360
total_loss: 32917.60545349121, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 144 at step    28800 | time:  6.28s | valid loss  4.09 | valid ppl    59.917
----------------------------------------------------------------------------------------------------
| epoch 120 step    29000 |    202 batches | lr 2.19e-05 | ms/batch 31.35 | loss  3.42 | ppl    30.611
total_loss: 30112.572799682617, total_len: 7360
total_loss: 32895.24938964844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 145 at step    29000 | time:  6.26s | valid loss  4.09 | valid ppl    59.823
----------------------------------------------------------------------------------------------------
| epoch 121 step    29200 |    160 batches | lr 2.12e-05 | ms/batch 31.10 | loss  3.42 | ppl    30.549
total_loss: 30099.01089477539, total_len: 7360
total_loss: 32883.11437988281, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 146 at step    29200 | time:  6.24s | valid loss  4.09 | valid ppl    59.712
----------------------------------------------------------------------------------------------------
| epoch 122 step    29400 |    118 batches | lr 2.04e-05 | ms/batch 31.68 | loss  3.42 | ppl    30.561
total_loss: 30111.437408447266, total_len: 7360
total_loss: 32891.52462768555, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 147 at step    29400 | time:  6.32s | valid loss  4.09 | valid ppl    59.813
----------------------------------------------------------------------------------------------------
| epoch 123 step    29600 |     76 batches | lr 1.97e-05 | ms/batch 31.72 | loss  3.43 | ppl    31.029
total_loss: 30139.964782714844, total_len: 7360
total_loss: 32927.83201599121, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 148 at step    29600 | time:  6.32s | valid loss  4.10 | valid ppl    60.046
----------------------------------------------------------------------------------------------------
| epoch 124 step    29800 |     34 batches | lr 1.9e-05 | ms/batch 30.91 | loss  3.41 | ppl    30.416
total_loss: 30103.542022705078, total_len: 7360
total_loss: 32892.13635253906, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 149 at step    29800 | time:  6.22s | valid loss  4.09 | valid ppl    59.749
----------------------------------------------------------------------------------------------------
| epoch 124 step    30000 |    234 batches | lr 1.83e-05 | ms/batch 31.80 | loss  3.41 | ppl    30.299
total_loss: 30089.255981445312, total_len: 7360
total_loss: 32878.36696624756, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 150 at step    30000 | time:  6.33s | valid loss  4.09 | valid ppl    59.633
----------------------------------------------------------------------------------------------------
| epoch 125 step    30200 |    192 batches | lr 1.76e-05 | ms/batch 31.53 | loss  3.41 | ppl    30.332
total_loss: 30096.508811950684, total_len: 7360
total_loss: 32879.018951416016, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 151 at step    30200 | time:  6.32s | valid loss  4.09 | valid ppl    59.692
----------------------------------------------------------------------------------------------------
| epoch 126 step    30400 |    150 batches | lr 1.69e-05 | ms/batch 31.18 | loss  3.41 | ppl    30.218
total_loss: 30094.51057434082, total_len: 7360
total_loss: 32878.504486083984, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 152 at step    30400 | time:  6.20s | valid loss  4.09 | valid ppl    59.676
----------------------------------------------------------------------------------------------------
| epoch 127 step    30600 |    108 batches | lr 1.63e-05 | ms/batch 31.38 | loss  3.42 | ppl    30.552
total_loss: 30095.86496734619, total_len: 7360
total_loss: 32869.64649963379, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 153 at step    30600 | time:  6.33s | valid loss  4.09 | valid ppl    59.687
----------------------------------------------------------------------------------------------------
| epoch 128 step    30800 |     66 batches | lr 1.56e-05 | ms/batch 31.16 | loss  3.42 | ppl    30.567
total_loss: 30088.55669403076, total_len: 7360
total_loss: 32868.14463806152, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 154 at step    30800 | time:  6.20s | valid loss  4.09 | valid ppl    59.628
----------------------------------------------------------------------------------------------------
| epoch 129 step    31000 |     24 batches | lr 1.5e-05 | ms/batch 31.78 | loss  3.41 | ppl    30.142
total_loss: 30070.434593200684, total_len: 7360
total_loss: 32857.63404083252, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 155 at step    31000 | time:  6.37s | valid loss  4.09 | valid ppl    59.481
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 129 step    31200 |    224 batches | lr 1.43e-05 | ms/batch 37.40 | loss  3.41 | ppl    30.136
total_loss: 30106.396598815918, total_len: 7360
total_loss: 32894.315170288086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 156 at step    31200 | time:  6.28s | valid loss  4.09 | valid ppl    59.772
----------------------------------------------------------------------------------------------------
| epoch 130 step    31400 |    182 batches | lr 1.37e-05 | ms/batch 31.10 | loss  3.40 | ppl    30.094
total_loss: 30055.70133972168, total_len: 7360
total_loss: 32832.98811340332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 157 at step    31400 | time:  6.20s | valid loss  4.08 | valid ppl    59.362
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 131 step    31600 |    140 batches | lr 1.31e-05 | ms/batch 37.29 | loss  3.41 | ppl    30.188
total_loss: 30097.064582824707, total_len: 7360
total_loss: 32873.75062561035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 158 at step    31600 | time:  6.22s | valid loss  4.09 | valid ppl    59.697
----------------------------------------------------------------------------------------------------
| epoch 132 step    31800 |     98 batches | lr 1.25e-05 | ms/batch 30.95 | loss  3.41 | ppl    30.397
total_loss: 30092.705894470215, total_len: 7360
total_loss: 32871.98407745361, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 159 at step    31800 | time:  6.19s | valid loss  4.09 | valid ppl    59.661
----------------------------------------------------------------------------------------------------
| epoch 133 step    32000 |     56 batches | lr 1.19e-05 | ms/batch 31.08 | loss  3.41 | ppl    30.287
total_loss: 30081.103874206543, total_len: 7360
total_loss: 32856.67835998535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 160 at step    32000 | time:  6.22s | valid loss  4.09 | valid ppl    59.567
----------------------------------------------------------------------------------------------------
| epoch 134 step    32200 |     14 batches | lr 1.14e-05 | ms/batch 31.62 | loss  3.40 | ppl    30.026
total_loss: 30083.224327087402, total_len: 7360
total_loss: 32858.39948272705, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 161 at step    32200 | time:  6.32s | valid loss  4.09 | valid ppl    59.584
----------------------------------------------------------------------------------------------------
| epoch 134 step    32400 |    214 batches | lr 1.08e-05 | ms/batch 31.23 | loss  3.40 | ppl    30.021
total_loss: 30085.199241638184, total_len: 7360
total_loss: 32859.95976257324, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 162 at step    32400 | time:  6.26s | valid loss  4.09 | valid ppl    59.600
----------------------------------------------------------------------------------------------------
| epoch 135 step    32600 |    172 batches | lr 1.03e-05 | ms/batch 30.87 | loss  3.40 | ppl    29.931
total_loss: 30053.52935028076, total_len: 7360
total_loss: 32827.506088256836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 163 at step    32600 | time:  6.15s | valid loss  4.08 | valid ppl    59.345
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 136 step    32800 |    130 batches | lr 9.73e-06 | ms/batch 37.19 | loss  3.40 | ppl    29.912
total_loss: 30103.63520050049, total_len: 7360
total_loss: 32881.41651916504, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 164 at step    32800 | time:  6.33s | valid loss  4.09 | valid ppl    59.750
----------------------------------------------------------------------------------------------------
| epoch 137 step    33000 |     88 batches | lr 9.21e-06 | ms/batch 31.12 | loss  3.42 | ppl    30.440
total_loss: 30095.723762512207, total_len: 7360
total_loss: 32876.830642700195, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 165 at step    33000 | time:  6.56s | valid loss  4.09 | valid ppl    59.686
----------------------------------------------------------------------------------------------------
| epoch 138 step    33200 |     46 batches | lr 8.7e-06 | ms/batch 31.30 | loss  3.40 | ppl    29.916
total_loss: 30080.15916442871, total_len: 7360
total_loss: 32859.45790863037, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 166 at step    33200 | time:  6.27s | valid loss  4.09 | valid ppl    59.560
----------------------------------------------------------------------------------------------------
| epoch 139 step    33400 |      4 batches | lr 8.21e-06 | ms/batch 31.40 | loss  3.39 | ppl    29.751
total_loss: 30081.57292175293, total_len: 7360
total_loss: 32857.35404968262, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 167 at step    33400 | time:  6.26s | valid loss  4.09 | valid ppl    59.571
----------------------------------------------------------------------------------------------------
| epoch 139 step    33600 |    204 batches | lr 7.73e-06 | ms/batch 31.28 | loss  3.40 | ppl    29.895
total_loss: 30060.61912536621, total_len: 7360
total_loss: 32831.155433654785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 168 at step    33600 | time:  6.30s | valid loss  4.08 | valid ppl    59.402
----------------------------------------------------------------------------------------------------
| epoch 140 step    33800 |    162 batches | lr 7.26e-06 | ms/batch 31.18 | loss  3.39 | ppl    29.788
total_loss: 30071.27980041504, total_len: 7360
total_loss: 32842.46551513672, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 169 at step    33800 | time:  6.18s | valid loss  4.09 | valid ppl    59.488
----------------------------------------------------------------------------------------------------
| epoch 141 step    34000 |    120 batches | lr 6.81e-06 | ms/batch 31.29 | loss  3.40 | ppl    29.835
total_loss: 30083.363845825195, total_len: 7360
total_loss: 32858.48410797119, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 170 at step    34000 | time:  6.28s | valid loss  4.09 | valid ppl    59.586
----------------------------------------------------------------------------------------------------
| epoch 142 step    34200 |     78 batches | lr 6.37e-06 | ms/batch 31.20 | loss  3.41 | ppl    30.347
total_loss: 30071.603729248047, total_len: 7360
total_loss: 32847.96449279785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 171 at step    34200 | time:  6.25s | valid loss  4.09 | valid ppl    59.490
----------------------------------------------------------------------------------------------------
| epoch 143 step    34400 |     36 batches | lr 5.95e-06 | ms/batch 31.72 | loss  3.39 | ppl    29.745
total_loss: 30077.540855407715, total_len: 7360
total_loss: 32854.06010437012, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 172 at step    34400 | time:  6.37s | valid loss  4.09 | valid ppl    59.538
----------------------------------------------------------------------------------------------------
| epoch 143 step    34600 |    236 batches | lr 5.54e-06 | ms/batch 31.54 | loss  3.39 | ppl    29.700
total_loss: 30075.003059387207, total_len: 7360
total_loss: 32848.83605957031, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 173 at step    34600 | time:  6.33s | valid loss  4.09 | valid ppl    59.518
----------------------------------------------------------------------------------------------------
| epoch 144 step    34800 |    194 batches | lr 5.14e-06 | ms/batch 31.66 | loss  3.40 | ppl    29.882
total_loss: 30055.555633544922, total_len: 7360
total_loss: 32828.7014465332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 174 at step    34800 | time:  6.30s | valid loss  4.08 | valid ppl    59.361
----------------------------------------------------------------------------------------------------
| epoch 145 step    35000 |    152 batches | lr 4.76e-06 | ms/batch 31.28 | loss  3.39 | ppl    29.712
total_loss: 30072.98770904541, total_len: 7360
total_loss: 32846.212814331055, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 175 at step    35000 | time:  6.21s | valid loss  4.09 | valid ppl    59.502
----------------------------------------------------------------------------------------------------
| epoch 146 step    35200 |    110 batches | lr 4.39e-06 | ms/batch 30.90 | loss  3.40 | ppl    29.935
total_loss: 30070.03842163086, total_len: 7360
total_loss: 32842.20585632324, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 176 at step    35200 | time:  6.23s | valid loss  4.09 | valid ppl    59.478
----------------------------------------------------------------------------------------------------
| epoch 147 step    35400 |     68 batches | lr 4.03e-06 | ms/batch 31.43 | loss  3.41 | ppl    30.131
total_loss: 30067.65980529785, total_len: 7360
total_loss: 32839.994857788086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 177 at step    35400 | time:  6.24s | valid loss  4.09 | valid ppl    59.459
----------------------------------------------------------------------------------------------------
| epoch 148 step    35600 |     26 batches | lr 3.69e-06 | ms/batch 31.47 | loss  3.39 | ppl    29.666
total_loss: 30068.23780822754, total_len: 7360
total_loss: 32842.25688171387, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 178 at step    35600 | time:  6.30s | valid loss  4.09 | valid ppl    59.463
----------------------------------------------------------------------------------------------------
| epoch 148 step    35800 |    226 batches | lr 3.37e-06 | ms/batch 31.36 | loss  3.39 | ppl    29.570
total_loss: 30064.508224487305, total_len: 7360
total_loss: 32837.32905578613, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 179 at step    35800 | time:  6.30s | valid loss  4.08 | valid ppl    59.433
----------------------------------------------------------------------------------------------------
| epoch 149 step    36000 |    184 batches | lr 3.06e-06 | ms/batch 31.50 | loss  3.39 | ppl    29.638
total_loss: 30066.586616516113, total_len: 7360
total_loss: 32838.814109802246, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 180 at step    36000 | time:  7.52s | valid loss  4.09 | valid ppl    59.450
----------------------------------------------------------------------------------------------------
| epoch 150 step    36200 |    142 batches | lr 2.76e-06 | ms/batch 31.70 | loss  3.39 | ppl    29.672
total_loss: 30073.238899230957, total_len: 7360
total_loss: 32843.8983001709, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 181 at step    36200 | time:  6.34s | valid loss  4.09 | valid ppl    59.504
----------------------------------------------------------------------------------------------------
| epoch 151 step    36400 |    100 batches | lr 2.48e-06 | ms/batch 31.88 | loss  3.40 | ppl    30.024
total_loss: 30062.773162841797, total_len: 7360
total_loss: 32834.29749298096, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 182 at step    36400 | time:  6.45s | valid loss  4.08 | valid ppl    59.419
----------------------------------------------------------------------------------------------------
| epoch 152 step    36600 |     58 batches | lr 2.22e-06 | ms/batch 32.32 | loss  3.40 | ppl    29.944
total_loss: 30062.81268310547, total_len: 7360
total_loss: 32836.33215332031, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 183 at step    36600 | time:  6.35s | valid loss  4.08 | valid ppl    59.419
----------------------------------------------------------------------------------------------------
| epoch 153 step    36800 |     16 batches | lr 1.96e-06 | ms/batch 31.52 | loss  3.39 | ppl    29.618
total_loss: 30066.304565429688, total_len: 7360
total_loss: 32838.31307220459, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 184 at step    36800 | time:  6.35s | valid loss  4.09 | valid ppl    59.448
----------------------------------------------------------------------------------------------------
| epoch 153 step    37000 |    216 batches | lr 1.73e-06 | ms/batch 32.01 | loss  3.39 | ppl    29.619
total_loss: 30059.308807373047, total_len: 7360
total_loss: 32830.19409942627, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 185 at step    37000 | time:  6.40s | valid loss  4.08 | valid ppl    59.391
----------------------------------------------------------------------------------------------------
| epoch 154 step    37200 |    174 batches | lr 1.51e-06 | ms/batch 31.68 | loss  3.39 | ppl    29.563
total_loss: 30062.243171691895, total_len: 7360
total_loss: 32832.41620635986, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 186 at step    37200 | time:  6.31s | valid loss  4.08 | valid ppl    59.415
----------------------------------------------------------------------------------------------------
| epoch 155 step    37400 |    132 batches | lr 1.3e-06 | ms/batch 31.57 | loss  3.39 | ppl    29.636
total_loss: 30065.40712738037, total_len: 7360
total_loss: 32834.31188201904, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 187 at step    37400 | time:  6.33s | valid loss  4.08 | valid ppl    59.440
----------------------------------------------------------------------------------------------------
| epoch 156 step    37600 |     90 batches | lr 1.11e-06 | ms/batch 31.78 | loss  3.40 | ppl    30.100
total_loss: 30062.37074279785, total_len: 7360
total_loss: 32830.961906433105, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 188 at step    37600 | time:  6.31s | valid loss  4.08 | valid ppl    59.416
----------------------------------------------------------------------------------------------------
| epoch 157 step    37800 |     48 batches | lr 9.31e-07 | ms/batch 31.41 | loss  3.39 | ppl    29.688
total_loss: 30064.198928833008, total_len: 7360
total_loss: 32834.083572387695, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 189 at step    37800 | time:  6.33s | valid loss  4.08 | valid ppl    59.431
----------------------------------------------------------------------------------------------------
| epoch 158 step    38000 |      6 batches | lr 7.69e-07 | ms/batch 31.75 | loss  3.39 | ppl    29.567
total_loss: 30062.07932281494, total_len: 7360
total_loss: 32831.23946380615, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 190 at step    38000 | time:  6.28s | valid loss  4.08 | valid ppl    59.414
----------------------------------------------------------------------------------------------------
| epoch 158 step    38200 |    206 batches | lr 6.24e-07 | ms/batch 31.32 | loss  3.39 | ppl    29.625
total_loss: 30063.168991088867, total_len: 7360
total_loss: 32832.413749694824, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 191 at step    38200 | time:  6.27s | valid loss  4.08 | valid ppl    59.422
----------------------------------------------------------------------------------------------------
| epoch 159 step    38400 |    164 batches | lr 4.93e-07 | ms/batch 31.27 | loss  3.39 | ppl    29.552
total_loss: 30062.683143615723, total_len: 7360
total_loss: 32831.604835510254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 192 at step    38400 | time:  6.22s | valid loss  4.08 | valid ppl    59.418
----------------------------------------------------------------------------------------------------
| epoch 160 step    38600 |    122 batches | lr 3.77e-07 | ms/batch 30.75 | loss  3.39 | ppl    29.678
total_loss: 30059.605514526367, total_len: 7360
total_loss: 32828.94275665283, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 193 at step    38600 | time:  6.18s | valid loss  4.08 | valid ppl    59.394
----------------------------------------------------------------------------------------------------
| epoch 161 step    38800 |     80 batches | lr 2.77e-07 | ms/batch 31.06 | loss  3.41 | ppl    30.168
total_loss: 30060.435371398926, total_len: 7360
total_loss: 32830.04792022705, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 194 at step    38800 | time:  6.21s | valid loss  4.08 | valid ppl    59.400
----------------------------------------------------------------------------------------------------
| epoch 162 step    39000 |     38 batches | lr 1.93e-07 | ms/batch 31.48 | loss  3.39 | ppl    29.579
total_loss: 30061.82004547119, total_len: 7360
total_loss: 32831.57346343994, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 195 at step    39000 | time:  6.28s | valid loss  4.08 | valid ppl    59.411
----------------------------------------------------------------------------------------------------
| epoch 162 step    39200 |    238 batches | lr 1.23e-07 | ms/batch 31.10 | loss  3.38 | ppl    29.508
total_loss: 30059.949966430664, total_len: 7360
total_loss: 32829.5319519043, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 196 at step    39200 | time:  6.24s | valid loss  4.08 | valid ppl    59.396
----------------------------------------------------------------------------------------------------
| epoch 163 step    39400 |    196 batches | lr 6.94e-08 | ms/batch 31.54 | loss  3.39 | ppl    29.624
total_loss: 30060.417808532715, total_len: 7360
total_loss: 32830.28820037842, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 197 at step    39400 | time:  6.29s | valid loss  4.08 | valid ppl    59.400
----------------------------------------------------------------------------------------------------
| epoch 164 step    39600 |    154 batches | lr 3.08e-08 | ms/batch 31.10 | loss  3.39 | ppl    29.630
total_loss: 30060.522102355957, total_len: 7360
total_loss: 32830.43111419678, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 198 at step    39600 | time:  6.24s | valid loss  4.08 | valid ppl    59.401
----------------------------------------------------------------------------------------------------
| epoch 165 step    39800 |    112 batches | lr 7.71e-09 | ms/batch 31.48 | loss  3.39 | ppl    29.792
total_loss: 30060.221534729004, total_len: 7360
total_loss: 32830.10366821289, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 199 at step    39800 | time:  6.28s | valid loss  4.08 | valid ppl    59.399
----------------------------------------------------------------------------------------------------
| epoch 166 step    40000 |     70 batches | lr 0 | ms/batch 31.39 | loss  3.41 | ppl    30.143
total_loss: 30060.237342834473, total_len: 7360
total_loss: 32830.12030029297, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 200 at step    40000 | time:  6.27s | valid loss  4.08 | valid ppl    59.399
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
End of training
total_loss: 32827.506088256836, total_len: 8224
====================================================================================================
| End of training | test loss  3.99 | test ppl    54.145
====================================================================================================
Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 51
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_51_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 51
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_51_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
total_loss: 71321.9536743164, total_len: 7744
total_loss: 75762.84469604492, total_len: 8224
total_loss: 67808.84530639648, total_len: 7360
| Start of training | test loss  9.21 | test bpc 10020.69926
| epoch   1 step      200 |    200 batches | lr 0.000125 | ms/batch 44.66 | loss  7.06 | ppl  1167.640
total_loss: 45608.06823730469, total_len: 7360
total_loss: 50566.88037109375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   1 at step      200 | time: 10.50s | valid loss  6.20 | valid ppl   491.149
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   2 step      400 |    158 batches | lr 0.000125 | ms/batch 42.37 | loss  6.08 | ppl   436.623
total_loss: 42824.913650512695, total_len: 7360
total_loss: 47442.427810668945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   2 at step      400 | time:  6.99s | valid loss  5.82 | valid ppl   336.501
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   3 step      600 |    116 batches | lr 0.000125 | ms/batch 40.04 | loss  5.81 | ppl   332.857
total_loss: 41502.940673828125, total_len: 7360
total_loss: 45978.763580322266, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   3 at step      600 | time:  6.91s | valid loss  5.64 | valid ppl   281.178
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   4 step      800 |     74 batches | lr 0.000125 | ms/batch 40.69 | loss  5.66 | ppl   286.457
total_loss: 40581.5871887207, total_len: 7360
total_loss: 44928.69842529297, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   4 at step      800 | time:  6.81s | valid loss  5.51 | valid ppl   248.093
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1000 |     32 batches | lr 0.000125 | ms/batch 40.79 | loss  5.52 | ppl   250.760
total_loss: 39995.1188659668, total_len: 7360
total_loss: 44256.232650756836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1000 | time:  6.75s | valid loss  5.43 | valid ppl   229.091
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1200 |    232 batches | lr 0.000125 | ms/batch 39.95 | loss  5.43 | ppl   227.013
total_loss: 39386.48208618164, total_len: 7360
total_loss: 43600.16889953613, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1200 | time:  6.70s | valid loss  5.35 | valid ppl   210.908
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   6 step     1400 |    190 batches | lr 0.000125 | ms/batch 38.15 | loss  5.35 | ppl   209.814
total_loss: 38937.00215148926, total_len: 7360
total_loss: 43089.246505737305, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1400 | time:  6.70s | valid loss  5.29 | valid ppl   198.414
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   7 step     1600 |    148 batches | lr 0.000125 | ms/batch 39.65 | loss  5.27 | ppl   195.380
total_loss: 38510.68978881836, total_len: 7360
total_loss: 42622.27407836914, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   8 at step     1600 | time:  6.70s | valid loss  5.23 | valid ppl   187.247
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   8 step     1800 |    106 batches | lr 0.000124 | ms/batch 40.03 | loss  5.22 | ppl   185.309
total_loss: 38229.48858642578, total_len: 7360
total_loss: 42282.38975524902, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   9 at step     1800 | time:  6.78s | valid loss  5.19 | valid ppl   180.228
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   9 step     2000 |     64 batches | lr 0.000124 | ms/batch 39.15 | loss  5.16 | ppl   175.014
total_loss: 37775.50358581543, total_len: 7360
total_loss: 41796.30874633789, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2000 | time:  6.69s | valid loss  5.13 | valid ppl   169.447
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2200 |     22 batches | lr 0.000124 | ms/batch 39.33 | loss  5.10 | ppl   163.327
total_loss: 37414.73944091797, total_len: 7360
total_loss: 41384.18211364746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2200 | time:  6.72s | valid loss  5.08 | valid ppl   161.342
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2400 |    222 batches | lr 0.000124 | ms/batch 39.57 | loss  5.05 | ppl   155.453
total_loss: 37118.657791137695, total_len: 7360
total_loss: 41066.8397064209, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  12 at step     2400 | time:  6.72s | valid loss  5.04 | valid ppl   154.980
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  11 step     2600 |    180 batches | lr 0.000124 | ms/batch 38.97 | loss  5.00 | ppl   147.759
total_loss: 36810.03276824951, total_len: 7360
total_loss: 40714.9391784668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  13 at step     2600 | time:  6.71s | valid loss  5.00 | valid ppl   148.616
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  12 step     2800 |    138 batches | lr 0.000123 | ms/batch 39.26 | loss  4.95 | ppl   140.935
total_loss: 36519.42435455322, total_len: 7360
total_loss: 40396.765716552734, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  14 at step     2800 | time:  6.69s | valid loss  4.96 | valid ppl   142.862
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  13 step     3000 |     96 batches | lr 0.000123 | ms/batch 39.12 | loss  4.91 | ppl   136.192
total_loss: 36200.78363800049, total_len: 7360
total_loss: 40032.734954833984, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3000 | time:  6.70s | valid loss  4.92 | valid ppl   136.809
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  14 step     3200 |     54 batches | lr 0.000123 | ms/batch 39.83 | loss  4.86 | ppl   128.413
total_loss: 35887.47841644287, total_len: 7360
total_loss: 39700.57014465332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  16 at step     3200 | time:  6.84s | valid loss  4.88 | valid ppl   131.107
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3400 |     12 batches | lr 0.000123 | ms/batch 39.61 | loss  4.80 | ppl   121.600
total_loss: 35608.55723571777, total_len: 7360
total_loss: 39393.89990234375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  17 at step     3400 | time:  6.83s | valid loss  4.84 | valid ppl   126.232
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3600 |    212 batches | lr 0.000123 | ms/batch 40.10 | loss  4.76 | ppl   116.622
total_loss: 35328.848777770996, total_len: 7360
total_loss: 39079.20622253418, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  18 at step     3600 | time:  6.86s | valid loss  4.80 | valid ppl   121.524
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  16 step     3800 |    170 batches | lr 0.000122 | ms/batch 40.64 | loss  4.72 | ppl   111.671
total_loss: 35122.15798950195, total_len: 7360
total_loss: 38842.87197113037, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  19 at step     3800 | time:  6.84s | valid loss  4.77 | valid ppl   118.159
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  17 step     4000 |    128 batches | lr 0.000122 | ms/batch 39.62 | loss  4.68 | ppl   107.466
total_loss: 34814.22416687012, total_len: 7360
total_loss: 38521.3295211792, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  20 at step     4000 | time:  6.83s | valid loss  4.73 | valid ppl   113.317
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  18 step     4200 |     86 batches | lr 0.000122 | ms/batch 40.36 | loss  4.65 | ppl   105.105
total_loss: 34624.170166015625, total_len: 7360
total_loss: 38269.524642944336, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  21 at step     4200 | time:  6.84s | valid loss  4.70 | valid ppl   110.429
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  19 step     4400 |     44 batches | lr 0.000121 | ms/batch 39.64 | loss  4.60 | ppl    99.304
total_loss: 34360.503005981445, total_len: 7360
total_loss: 37987.61028289795, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  22 at step     4400 | time:  6.83s | valid loss  4.67 | valid ppl   106.543
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4600 |      2 batches | lr 0.000121 | ms/batch 39.93 | loss  4.56 | ppl    95.450
total_loss: 34202.28260040283, total_len: 7360
total_loss: 37792.33727264404, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  23 at step     4600 | time:  6.82s | valid loss  4.65 | valid ppl   104.277
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4800 |    202 batches | lr 0.000121 | ms/batch 40.13 | loss  4.52 | ppl    92.281
total_loss: 33997.48408508301, total_len: 7360
total_loss: 37577.443603515625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  24 at step     4800 | time:  6.90s | valid loss  4.62 | valid ppl   101.415
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  21 step     5000 |    160 batches | lr 0.00012 | ms/batch 39.39 | loss  4.50 | ppl    89.605
total_loss: 33834.51494598389, total_len: 7360
total_loss: 37370.580001831055, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  25 at step     5000 | time:  6.72s | valid loss  4.60 | valid ppl    99.194
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  22 step     5200 |    118 batches | lr 0.00012 | ms/batch 38.96 | loss  4.47 | ppl    87.376
total_loss: 33675.02554321289, total_len: 7360
total_loss: 37200.742820739746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  26 at step     5200 | time:  6.94s | valid loss  4.58 | valid ppl    97.068
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  23 step     5400 |     76 batches | lr 0.000119 | ms/batch 39.47 | loss  4.46 | ppl    86.913
total_loss: 33523.20708465576, total_len: 7360
total_loss: 37012.037605285645, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  27 at step     5400 | time:  6.75s | valid loss  4.55 | valid ppl    95.086
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5600 |     34 batches | lr 0.000119 | ms/batch 39.59 | loss  4.41 | ppl    82.661
total_loss: 33392.05660247803, total_len: 7360
total_loss: 36867.45137786865, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  28 at step     5600 | time:  6.75s | valid loss  4.54 | valid ppl    93.407
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5800 |    234 batches | lr 0.000119 | ms/batch 39.29 | loss  4.38 | ppl    80.170
total_loss: 33261.22969818115, total_len: 7360
total_loss: 36718.36087036133, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  29 at step     5800 | time:  6.77s | valid loss  4.52 | valid ppl    91.761
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  25 step     6000 |    192 batches | lr 0.000118 | ms/batch 39.49 | loss  4.36 | ppl    78.245
total_loss: 33102.437507629395, total_len: 7360
total_loss: 36537.03240966797, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  30 at step     6000 | time:  6.77s | valid loss  4.50 | valid ppl    89.803
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  26 step     6200 |    150 batches | lr 0.000118 | ms/batch 40.37 | loss  4.33 | ppl    75.752
total_loss: 32893.72261810303, total_len: 7360
total_loss: 36298.009506225586, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  31 at step     6200 | time:  6.78s | valid loss  4.47 | valid ppl    87.292
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  27 step     6400 |    108 batches | lr 0.000117 | ms/batch 39.30 | loss  4.31 | ppl    74.670
total_loss: 32777.60019683838, total_len: 7360
total_loss: 36176.92923736572, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  32 at step     6400 | time:  6.76s | valid loss  4.45 | valid ppl    85.925
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  28 step     6600 |     66 batches | lr 0.000117 | ms/batch 39.36 | loss  4.29 | ppl    73.054
total_loss: 32567.69797515869, total_len: 7360
total_loss: 35949.04293060303, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  33 at step     6600 | time:  6.70s | valid loss  4.42 | valid ppl    83.509
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     6800 |     24 batches | lr 0.000116 | ms/batch 39.16 | loss  4.25 | ppl    70.173
total_loss: 32434.162452697754, total_len: 7360
total_loss: 35776.762519836426, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  34 at step     6800 | time:  6.69s | valid loss  4.41 | valid ppl    82.008
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     7000 |    224 batches | lr 0.000116 | ms/batch 39.26 | loss  4.23 | ppl    68.551
total_loss: 32322.178131103516, total_len: 7360
total_loss: 35667.690521240234, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  35 at step     7000 | time:  6.65s | valid loss  4.39 | valid ppl    80.770
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  30 step     7200 |    182 batches | lr 0.000115 | ms/batch 38.99 | loss  4.20 | ppl    66.758
total_loss: 32137.118743896484, total_len: 7360
total_loss: 35437.78104400635, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  36 at step     7200 | time:  6.70s | valid loss  4.37 | valid ppl    78.764
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  31 step     7400 |    140 batches | lr 0.000115 | ms/batch 39.21 | loss  4.18 | ppl    65.293
total_loss: 32043.580390930176, total_len: 7360
total_loss: 35343.57988739014, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  37 at step     7400 | time:  6.74s | valid loss  4.35 | valid ppl    77.769
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  32 step     7600 |     98 batches | lr 0.000114 | ms/batch 39.54 | loss  4.17 | ppl    64.851
total_loss: 31912.184425354004, total_len: 7360
total_loss: 35188.69382476807, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  38 at step     7600 | time:  6.85s | valid loss  4.34 | valid ppl    76.393
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  33 step     7800 |     56 batches | lr 0.000114 | ms/batch 39.38 | loss  4.14 | ppl    63.080
total_loss: 31819.92697906494, total_len: 7360
total_loss: 35065.02640533447, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  39 at step     7800 | time:  6.71s | valid loss  4.32 | valid ppl    75.442
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8000 |     14 batches | lr 0.000113 | ms/batch 39.16 | loss  4.11 | ppl    61.131
total_loss: 31772.320945739746, total_len: 7360
total_loss: 35009.51329040527, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  40 at step     8000 | time:  6.73s | valid loss  4.32 | valid ppl    74.955
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8200 |    214 batches | lr 0.000112 | ms/batch 39.17 | loss  4.10 | ppl    60.134
total_loss: 31676.135917663574, total_len: 7360
total_loss: 34895.77759552002, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  41 at step     8200 | time:  6.73s | valid loss  4.30 | valid ppl    73.982
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  35 step     8400 |    172 batches | lr 0.000112 | ms/batch 39.72 | loss  4.08 | ppl    58.985
total_loss: 31552.242073059082, total_len: 7360
total_loss: 34752.098205566406, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  42 at step     8400 | time:  6.87s | valid loss  4.29 | valid ppl    72.747
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  36 step     8600 |    130 batches | lr 0.000111 | ms/batch 39.02 | loss  4.06 | ppl    57.837
total_loss: 31493.52210998535, total_len: 7360
total_loss: 34679.64683532715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  43 at step     8600 | time:  6.70s | valid loss  4.28 | valid ppl    72.169
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  37 step     8800 |     88 batches | lr 0.000111 | ms/batch 39.20 | loss  4.06 | ppl    57.905
total_loss: 31407.637649536133, total_len: 7360
total_loss: 34578.30368804932, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  44 at step     8800 | time:  6.74s | valid loss  4.27 | valid ppl    71.332
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  38 step     9000 |     46 batches | lr 0.00011 | ms/batch 39.39 | loss  4.03 | ppl    56.178
total_loss: 31297.81613922119, total_len: 7360
total_loss: 34445.234313964844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  45 at step     9000 | time:  6.76s | valid loss  4.25 | valid ppl    70.275
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9200 |      4 batches | lr 0.000109 | ms/batch 39.51 | loss  4.01 | ppl    54.998
total_loss: 31299.53347015381, total_len: 7360
total_loss: 34439.68630218506, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  46 at step     9200 | time:  6.74s | valid loss  4.25 | valid ppl    70.292
----------------------------------------------------------------------------------------------------
| epoch  39 step     9400 |    204 batches | lr 0.000109 | ms/batch 34.08 | loss  4.00 | ppl    54.378
total_loss: 31176.566566467285, total_len: 7360
total_loss: 34317.89436340332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  47 at step     9400 | time:  6.82s | valid loss  4.24 | valid ppl    69.127
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  40 step     9600 |    162 batches | lr 0.000108 | ms/batch 39.06 | loss  3.98 | ppl    53.361
total_loss: 31098.151664733887, total_len: 7360
total_loss: 34219.613052368164, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  48 at step     9600 | time:  6.77s | valid loss  4.23 | valid ppl    68.394
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  41 step     9800 |    120 batches | lr 0.000107 | ms/batch 39.26 | loss  3.96 | ppl    52.550
total_loss: 31008.56842803955, total_len: 7360
total_loss: 34112.54093170166, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  49 at step     9800 | time:  6.75s | valid loss  4.21 | valid ppl    67.567
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  42 step    10000 |     78 batches | lr 0.000107 | ms/batch 39.27 | loss  3.97 | ppl    52.814
total_loss: 30955.41375732422, total_len: 7360
total_loss: 34049.51530456543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  50 at step    10000 | time:  6.78s | valid loss  4.21 | valid ppl    67.081
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10200 |     36 batches | lr 0.000106 | ms/batch 39.22 | loss  3.93 | ppl    50.865
total_loss: 30877.447151184082, total_len: 7360
total_loss: 33962.49255371094, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  51 at step    10200 | time:  6.73s | valid loss  4.20 | valid ppl    66.374
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10400 |    236 batches | lr 0.000105 | ms/batch 39.16 | loss  3.91 | ppl    49.846
total_loss: 30780.89691925049, total_len: 7360
total_loss: 33840.002296447754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  52 at step    10400 | time:  6.72s | valid loss  4.18 | valid ppl    65.509
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  44 step    10600 |    194 batches | lr 0.000105 | ms/batch 39.31 | loss  3.90 | ppl    49.526
total_loss: 30725.123962402344, total_len: 7360
total_loss: 33785.82197570801, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  53 at step    10600 | time:  6.72s | valid loss  4.17 | valid ppl    65.014
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  45 step    10800 |    152 batches | lr 0.000104 | ms/batch 39.51 | loss  3.88 | ppl    48.499
total_loss: 30639.7488861084, total_len: 7360
total_loss: 33681.54564666748, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  54 at step    10800 | time:  6.77s | valid loss  4.16 | valid ppl    64.265
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  46 step    11000 |    110 batches | lr 0.000103 | ms/batch 39.35 | loss  3.87 | ppl    47.900
total_loss: 30572.834838867188, total_len: 7360
total_loss: 33610.667152404785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  55 at step    11000 | time:  6.75s | valid loss  4.15 | valid ppl    63.683
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  47 step    11200 |     68 batches | lr 0.000102 | ms/batch 39.32 | loss  3.85 | ppl    47.094
total_loss: 30446.494804382324, total_len: 7360
total_loss: 33467.09967803955, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  56 at step    11200 | time:  6.72s | valid loss  4.14 | valid ppl    62.599
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11400 |     26 batches | lr 0.000102 | ms/batch 39.20 | loss  3.82 | ppl    45.519
total_loss: 30384.425987243652, total_len: 7360
total_loss: 33386.2600479126, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  57 at step    11400 | time:  9.06s | valid loss  4.13 | valid ppl    62.073
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11600 |    226 batches | lr 0.000101 | ms/batch 51.04 | loss  3.80 | ppl    44.665
total_loss: 30296.81509399414, total_len: 7360
total_loss: 33274.71276092529, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  58 at step    11600 | time:  6.78s | valid loss  4.12 | valid ppl    61.339
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  49 step    11800 |    184 batches | lr 0.0001 | ms/batch 39.80 | loss  3.78 | ppl    43.903
total_loss: 30182.292289733887, total_len: 7360
total_loss: 33161.23100280762, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  59 at step    11800 | time:  6.81s | valid loss  4.10 | valid ppl    60.392
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  50 step    12000 |    142 batches | lr 9.92e-05 | ms/batch 38.96 | loss  3.76 | ppl    43.115
total_loss: 30090.35336303711, total_len: 7360
total_loss: 33048.61240386963, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  60 at step    12000 | time:  7.10s | valid loss  4.09 | valid ppl    59.642
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  51 step    12200 |    100 batches | lr 9.84e-05 | ms/batch 39.56 | loss  3.76 | ppl    42.868
total_loss: 30025.03189086914, total_len: 7360
total_loss: 32986.62546539307, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  61 at step    12200 | time:  6.80s | valid loss  4.08 | valid ppl    59.115
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  52 step    12400 |     58 batches | lr 9.76e-05 | ms/batch 39.13 | loss  3.74 | ppl    42.225
total_loss: 29942.95742034912, total_len: 7360
total_loss: 32904.995834350586, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  62 at step    12400 | time:  6.73s | valid loss  4.07 | valid ppl    58.460
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12600 |     16 batches | lr 9.68e-05 | ms/batch 38.83 | loss  3.71 | ppl    40.882
total_loss: 29894.12289428711, total_len: 7360
total_loss: 32812.758071899414, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  63 at step    12600 | time:  6.69s | valid loss  4.06 | valid ppl    58.073
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12800 |    216 batches | lr 9.6e-05 | ms/batch 38.14 | loss  3.70 | ppl    40.485
total_loss: 29825.541007995605, total_len: 7360
total_loss: 32757.5281829834, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  64 at step    12800 | time:  6.69s | valid loss  4.05 | valid ppl    57.534
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  54 step    13000 |    174 batches | lr 9.52e-05 | ms/batch 39.20 | loss  3.69 | ppl    39.932
total_loss: 29730.866821289062, total_len: 7360
total_loss: 32647.306755065918, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  65 at step    13000 | time:  6.71s | valid loss  4.04 | valid ppl    56.799
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  55 step    13200 |    132 batches | lr 9.43e-05 | ms/batch 39.60 | loss  3.67 | ppl    39.321
total_loss: 29738.245346069336, total_len: 7360
total_loss: 32658.281272888184, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  66 at step    13200 | time:  6.71s | valid loss  4.04 | valid ppl    56.856
----------------------------------------------------------------------------------------------------
| epoch  56 step    13400 |     90 batches | lr 9.35e-05 | ms/batch 33.45 | loss  3.67 | ppl    39.423
total_loss: 29644.842735290527, total_len: 7360
total_loss: 32584.547569274902, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  67 at step    13400 | time:  6.69s | valid loss  4.03 | valid ppl    56.139
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  57 step    13600 |     48 batches | lr 9.26e-05 | ms/batch 38.70 | loss  3.64 | ppl    38.274
total_loss: 29571.07656097412, total_len: 7360
total_loss: 32482.03485107422, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  68 at step    13600 | time:  6.75s | valid loss  4.02 | valid ppl    55.579
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    13800 |      6 batches | lr 9.17e-05 | ms/batch 40.26 | loss  3.63 | ppl    37.593
total_loss: 29603.16431427002, total_len: 7360
total_loss: 32489.714294433594, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  69 at step    13800 | time:  6.92s | valid loss  4.02 | valid ppl    55.822
----------------------------------------------------------------------------------------------------
| epoch  58 step    14000 |    206 batches | lr 9.09e-05 | ms/batch 34.27 | loss  3.62 | ppl    37.319
total_loss: 29537.02370452881, total_len: 7360
total_loss: 32413.251556396484, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  70 at step    14000 | time:  6.84s | valid loss  4.01 | valid ppl    55.323
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  59 step    14200 |    164 batches | lr 9e-05 | ms/batch 38.92 | loss  3.61 | ppl    36.794
total_loss: 29458.509269714355, total_len: 7360
total_loss: 32349.732078552246, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  71 at step    14200 | time:  6.68s | valid loss  4.00 | valid ppl    54.736
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  60 step    14400 |    122 batches | lr 8.91e-05 | ms/batch 39.32 | loss  3.60 | ppl    36.425
total_loss: 29432.110275268555, total_len: 7360
total_loss: 32307.680740356445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  72 at step    14400 | time:  6.76s | valid loss  4.00 | valid ppl    54.540
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  61 step    14600 |     80 batches | lr 8.82e-05 | ms/batch 39.64 | loss  3.60 | ppl    36.669
total_loss: 29418.814903259277, total_len: 7360
total_loss: 32285.196617126465, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  73 at step    14600 | time:  6.84s | valid loss  4.00 | valid ppl    54.441
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    14800 |     38 batches | lr 8.73e-05 | ms/batch 38.17 | loss  3.57 | ppl    35.476
total_loss: 29379.029495239258, total_len: 7360
total_loss: 32239.39910888672, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  74 at step    14800 | time:  6.87s | valid loss  3.99 | valid ppl    54.148
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    15000 |    238 batches | lr 8.64e-05 | ms/batch 40.18 | loss  3.56 | ppl    35.011
total_loss: 29322.95990753174, total_len: 7360
total_loss: 32180.464225769043, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  75 at step    15000 | time:  6.89s | valid loss  3.98 | valid ppl    53.737
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  63 step    15200 |    196 batches | lr 8.55e-05 | ms/batch 40.48 | loss  3.55 | ppl    34.848
total_loss: 29330.5965423584, total_len: 7360
total_loss: 32214.89527130127, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  76 at step    15200 | time:  6.91s | valid loss  3.99 | valid ppl    53.793
----------------------------------------------------------------------------------------------------
| epoch  64 step    15400 |    154 batches | lr 8.46e-05 | ms/batch 34.37 | loss  3.54 | ppl    34.438
total_loss: 29263.768730163574, total_len: 7360
total_loss: 32121.23609161377, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  77 at step    15400 | time:  7.35s | valid loss  3.98 | valid ppl    53.306
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  65 step    15600 |    112 batches | lr 8.37e-05 | ms/batch 44.77 | loss  3.54 | ppl    34.332
total_loss: 29221.853927612305, total_len: 7360
total_loss: 32093.038932800293, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  78 at step    15600 | time:  6.88s | valid loss  3.97 | valid ppl    53.004
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  66 step    15800 |     70 batches | lr 8.27e-05 | ms/batch 40.07 | loss  3.53 | ppl    34.264
total_loss: 29181.619338989258, total_len: 7360
total_loss: 32059.69052886963, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  79 at step    15800 | time:  6.87s | valid loss  3.96 | valid ppl    52.715
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16000 |     28 batches | lr 8.18e-05 | ms/batch 40.10 | loss  3.51 | ppl    33.379
total_loss: 29198.082611083984, total_len: 7360
total_loss: 32062.305755615234, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  80 at step    16000 | time:  7.40s | valid loss  3.97 | valid ppl    52.833
----------------------------------------------------------------------------------------------------
| epoch  67 step    16200 |    228 batches | lr 8.09e-05 | ms/batch 36.61 | loss  3.50 | ppl    33.000
total_loss: 29187.96452331543, total_len: 7360
total_loss: 32041.27751159668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  81 at step    16200 | time:  6.74s | valid loss  3.97 | valid ppl    52.760
----------------------------------------------------------------------------------------------------
| epoch  68 step    16400 |    186 batches | lr 7.99e-05 | ms/batch 33.44 | loss  3.49 | ppl    32.806
total_loss: 29114.71043395996, total_len: 7360
total_loss: 31970.70002746582, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  82 at step    16400 | time:  6.69s | valid loss  3.96 | valid ppl    52.238
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  69 step    16600 |    144 batches | lr 7.9e-05 | ms/batch 39.66 | loss  3.48 | ppl    32.613
total_loss: 29076.202507019043, total_len: 7360
total_loss: 31901.33692932129, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  83 at step    16600 | time:  6.74s | valid loss  3.95 | valid ppl    51.965
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  70 step    16800 |    102 batches | lr 7.8e-05 | ms/batch 39.59 | loss  3.49 | ppl    32.669
total_loss: 29041.006034851074, total_len: 7360
total_loss: 31884.29615020752, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  84 at step    16800 | time:  6.74s | valid loss  3.95 | valid ppl    51.717
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  71 step    17000 |     60 batches | lr 7.71e-05 | ms/batch 39.49 | loss  3.48 | ppl    32.370
total_loss: 29011.96575164795, total_len: 7360
total_loss: 31834.743614196777, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  85 at step    17000 | time:  6.98s | valid loss  3.94 | valid ppl    51.513
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17200 |     18 batches | lr 7.61e-05 | ms/batch 39.96 | loss  3.46 | ppl    31.701
total_loss: 28998.69415283203, total_len: 7360
total_loss: 31816.535415649414, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  86 at step    17200 | time:  6.80s | valid loss  3.94 | valid ppl    51.421
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17400 |    218 batches | lr 7.52e-05 | ms/batch 40.43 | loss  3.45 | ppl    31.444
total_loss: 29020.736000061035, total_len: 7360
total_loss: 31851.858856201172, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  87 at step    17400 | time:  6.73s | valid loss  3.94 | valid ppl    51.575
----------------------------------------------------------------------------------------------------
| epoch  73 step    17600 |    176 batches | lr 7.42e-05 | ms/batch 33.52 | loss  3.44 | ppl    31.255
total_loss: 28974.95513153076, total_len: 7360
total_loss: 31802.137145996094, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  88 at step    17600 | time:  7.02s | valid loss  3.94 | valid ppl    51.255
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  74 step    17800 |    134 batches | lr 7.32e-05 | ms/batch 39.51 | loss  3.44 | ppl    31.056
total_loss: 28969.37326812744, total_len: 7360
total_loss: 31783.076972961426, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  89 at step    17800 | time:  6.74s | valid loss  3.94 | valid ppl    51.216
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  75 step    18000 |     92 batches | lr 7.23e-05 | ms/batch 39.53 | loss  3.44 | ppl    31.247
total_loss: 28872.39688873291, total_len: 7360
total_loss: 31695.99683380127, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  90 at step    18000 | time:  6.73s | valid loss  3.92 | valid ppl    50.546
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  76 step    18200 |     50 batches | lr 7.13e-05 | ms/batch 40.69 | loss  3.42 | ppl    30.609
total_loss: 28917.12680053711, total_len: 7360
total_loss: 31726.95834350586, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  91 at step    18200 | time:  7.17s | valid loss  3.93 | valid ppl    50.854
----------------------------------------------------------------------------------------------------
| epoch  77 step    18400 |      8 batches | lr 7.03e-05 | ms/batch 35.51 | loss  3.41 | ppl    30.189
total_loss: 28904.562088012695, total_len: 7360
total_loss: 31682.178283691406, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  92 at step    18400 | time:  6.86s | valid loss  3.93 | valid ppl    50.767
----------------------------------------------------------------------------------------------------
| epoch  77 step    18600 |    208 batches | lr 6.94e-05 | ms/batch 34.53 | loss  3.40 | ppl    30.004
total_loss: 28894.56484222412, total_len: 7360
total_loss: 31680.7013092041, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  93 at step    18600 | time:  6.89s | valid loss  3.93 | valid ppl    50.698
----------------------------------------------------------------------------------------------------
| epoch  78 step    18800 |    166 batches | lr 6.84e-05 | ms/batch 33.58 | loss  3.39 | ppl    29.801
total_loss: 28836.063247680664, total_len: 7360
total_loss: 31625.17699432373, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  94 at step    18800 | time:  7.08s | valid loss  3.92 | valid ppl    50.297
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  79 step    19000 |    124 batches | lr 6.74e-05 | ms/batch 43.07 | loss  3.39 | ppl    29.672
total_loss: 28850.02960205078, total_len: 7360
total_loss: 31641.79012298584, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  95 at step    19000 | time:  7.03s | valid loss  3.92 | valid ppl    50.392
----------------------------------------------------------------------------------------------------
| epoch  80 step    19200 |     82 batches | lr 6.64e-05 | ms/batch 34.51 | loss  3.40 | ppl    29.932
total_loss: 28818.530044555664, total_len: 7360
total_loss: 31592.59275817871, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  96 at step    19200 | time:  6.86s | valid loss  3.92 | valid ppl    50.177
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19400 |     40 batches | lr 6.54e-05 | ms/batch 39.90 | loss  3.37 | ppl    29.162
total_loss: 28815.921585083008, total_len: 7360
total_loss: 31604.356971740723, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  97 at step    19400 | time:  6.85s | valid loss  3.92 | valid ppl    50.159
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19600 |    240 batches | lr 6.45e-05 | ms/batch 39.91 | loss  3.37 | ppl    28.944
total_loss: 28793.49437713623, total_len: 7360
total_loss: 31575.789825439453, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  98 at step    19600 | time:  6.89s | valid loss  3.91 | valid ppl    50.007
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  82 step    19800 |    198 batches | lr 6.35e-05 | ms/batch 40.45 | loss  3.36 | ppl    28.910
total_loss: 28810.619583129883, total_len: 7360
total_loss: 31583.523178100586, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  99 at step    19800 | time:  6.96s | valid loss  3.91 | valid ppl    50.123
----------------------------------------------------------------------------------------------------
| epoch  83 step    20000 |    156 batches | lr 6.25e-05 | ms/batch 34.34 | loss  3.36 | ppl    28.725
total_loss: 28777.088905334473, total_len: 7360
total_loss: 31539.122116088867, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 100 at step    20000 | time:  6.84s | valid loss  3.91 | valid ppl    49.895
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  84 step    20200 |    114 batches | lr 6.15e-05 | ms/batch 40.14 | loss  3.35 | ppl    28.607
total_loss: 28765.915412902832, total_len: 7360
total_loss: 31529.962295532227, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 101 at step    20200 | time:  6.87s | valid loss  3.91 | valid ppl    49.820
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  85 step    20400 |     72 batches | lr 6.05e-05 | ms/batch 40.16 | loss  3.36 | ppl    28.863
total_loss: 28710.009162902832, total_len: 7360
total_loss: 31474.510284423828, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 102 at step    20400 | time:  7.53s | valid loss  3.90 | valid ppl    49.443
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  86 step    20600 |     30 batches | lr 5.96e-05 | ms/batch 42.44 | loss  3.33 | ppl    28.073
total_loss: 28776.50762939453, total_len: 7360
total_loss: 31540.01953125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 103 at step    20600 | time:  6.90s | valid loss  3.91 | valid ppl    49.892
----------------------------------------------------------------------------------------------------
| epoch  86 step    20800 |    230 batches | lr 5.86e-05 | ms/batch 34.24 | loss  3.33 | ppl    27.895
total_loss: 28745.546829223633, total_len: 7360
total_loss: 31490.29877471924, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 104 at step    20800 | time:  6.86s | valid loss  3.91 | valid ppl    49.682
----------------------------------------------------------------------------------------------------
| epoch  87 step    21000 |    188 batches | lr 5.76e-05 | ms/batch 34.27 | loss  3.32 | ppl    27.790
total_loss: 28728.066902160645, total_len: 7360
total_loss: 31482.48464202881, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 105 at step    21000 | time:  7.07s | valid loss  3.90 | valid ppl    49.564
----------------------------------------------------------------------------------------------------
| epoch  88 step    21200 |    146 batches | lr 5.66e-05 | ms/batch 35.41 | loss  3.32 | ppl    27.790
total_loss: 28690.917198181152, total_len: 7360
total_loss: 31431.571411132812, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 106 at step    21200 | time:  6.85s | valid loss  3.90 | valid ppl    49.315
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  89 step    21400 |    104 batches | lr 5.56e-05 | ms/batch 39.90 | loss  3.33 | ppl    27.850
total_loss: 28682.26560974121, total_len: 7360
total_loss: 31445.245651245117, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 107 at step    21400 | time:  6.86s | valid loss  3.90 | valid ppl    49.257
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  90 step    21600 |     62 batches | lr 5.47e-05 | ms/batch 40.16 | loss  3.32 | ppl    27.713
total_loss: 28638.41104888916, total_len: 7360
total_loss: 31381.889961242676, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 108 at step    21600 | time:  7.20s | valid loss  3.89 | valid ppl    48.964
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  91 step    21800 |     20 batches | lr 5.37e-05 | ms/batch 41.79 | loss  3.30 | ppl    27.145
total_loss: 28661.441246032715, total_len: 7360
total_loss: 31402.49030303955, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 109 at step    21800 | time:  6.86s | valid loss  3.89 | valid ppl    49.118
----------------------------------------------------------------------------------------------------
| epoch  91 step    22000 |    220 batches | lr 5.27e-05 | ms/batch 34.31 | loss  3.30 | ppl    27.078
total_loss: 28664.679916381836, total_len: 7360
total_loss: 31418.97573852539, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 110 at step    22000 | time:  6.86s | valid loss  3.89 | valid ppl    49.139
----------------------------------------------------------------------------------------------------
| epoch  92 step    22200 |    178 batches | lr 5.18e-05 | ms/batch 34.22 | loss  3.30 | ppl    27.051
total_loss: 28619.676567077637, total_len: 7360
total_loss: 31365.380378723145, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 111 at step    22200 | time:  6.84s | valid loss  3.89 | valid ppl    48.840
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  93 step    22400 |    136 batches | lr 5.08e-05 | ms/batch 44.91 | loss  3.29 | ppl    26.903
total_loss: 28643.602111816406, total_len: 7360
total_loss: 31379.599128723145, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 112 at step    22400 | time:  6.91s | valid loss  3.89 | valid ppl    48.999
----------------------------------------------------------------------------------------------------
| epoch  94 step    22600 |     94 batches | lr 4.98e-05 | ms/batch 34.29 | loss  3.30 | ppl    27.214
total_loss: 28585.914489746094, total_len: 7360
total_loss: 31337.35675048828, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 113 at step    22600 | time:  6.83s | valid loss  3.88 | valid ppl    48.616
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  95 step    22800 |     52 batches | lr 4.89e-05 | ms/batch 40.12 | loss  3.29 | ppl    26.740
total_loss: 28612.329696655273, total_len: 7360
total_loss: 31354.49909210205, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 114 at step    22800 | time:  6.88s | valid loss  3.89 | valid ppl    48.791
----------------------------------------------------------------------------------------------------
| epoch  96 step    23000 |     10 batches | lr 4.79e-05 | ms/batch 34.10 | loss  3.28 | ppl    26.469
total_loss: 28606.175636291504, total_len: 7360
total_loss: 31336.340538024902, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 115 at step    23000 | time:  6.82s | valid loss  3.89 | valid ppl    48.750
----------------------------------------------------------------------------------------------------
| epoch  96 step    23200 |    210 batches | lr 4.7e-05 | ms/batch 33.54 | loss  3.27 | ppl    26.388
total_loss: 28585.535720825195, total_len: 7360
total_loss: 31316.4009475708, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 116 at step    23200 | time:  6.82s | valid loss  3.88 | valid ppl    48.614
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  97 step    23400 |    168 batches | lr 4.6e-05 | ms/batch 40.51 | loss  3.27 | ppl    26.289
total_loss: 28567.665046691895, total_len: 7360
total_loss: 31284.306144714355, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 117 at step    23400 | time:  6.73s | valid loss  3.88 | valid ppl    48.496
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  98 step    23600 |    126 batches | lr 4.51e-05 | ms/batch 38.97 | loss  3.26 | ppl    26.161
total_loss: 28599.73931121826, total_len: 7360
total_loss: 31327.565147399902, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 118 at step    23600 | time:  6.71s | valid loss  3.89 | valid ppl    48.708
----------------------------------------------------------------------------------------------------
| epoch  99 step    23800 |     84 batches | lr 4.41e-05 | ms/batch 33.55 | loss  3.28 | ppl    26.582
total_loss: 28545.601455688477, total_len: 7360
total_loss: 31268.168029785156, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 119 at step    23800 | time:  6.71s | valid loss  3.88 | valid ppl    48.351
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 100 step    24000 |     42 batches | lr 4.32e-05 | ms/batch 40.31 | loss  3.26 | ppl    25.986
total_loss: 28563.041076660156, total_len: 7360
total_loss: 31281.660522460938, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 120 at step    24000 | time:  6.87s | valid loss  3.88 | valid ppl    48.465
----------------------------------------------------------------------------------------------------
| epoch 100 step    24200 |    242 batches | lr 4.23e-05 | ms/batch 34.33 | loss  3.25 | ppl    25.752
total_loss: 28548.206481933594, total_len: 7360
total_loss: 31274.81777191162, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 121 at step    24200 | time:  6.96s | valid loss  3.88 | valid ppl    48.368
----------------------------------------------------------------------------------------------------
| epoch 101 step    24400 |    200 batches | lr 4.13e-05 | ms/batch 33.87 | loss  3.25 | ppl    25.823
total_loss: 28557.54355621338, total_len: 7360
total_loss: 31276.93647003174, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 122 at step    24400 | time:  6.74s | valid loss  3.88 | valid ppl    48.429
----------------------------------------------------------------------------------------------------
| epoch 102 step    24600 |    158 batches | lr 4.04e-05 | ms/batch 34.01 | loss  3.24 | ppl    25.637
total_loss: 28548.307907104492, total_len: 7360
total_loss: 31262.670387268066, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 123 at step    24600 | time:  6.81s | valid loss  3.88 | valid ppl    48.368
----------------------------------------------------------------------------------------------------
| epoch 103 step    24800 |    116 batches | lr 3.95e-05 | ms/batch 33.64 | loss  3.25 | ppl    25.679
total_loss: 28545.791473388672, total_len: 7360
total_loss: 31259.230880737305, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 124 at step    24800 | time:  7.02s | valid loss  3.88 | valid ppl    48.352
----------------------------------------------------------------------------------------------------
| epoch 104 step    25000 |     74 batches | lr 3.86e-05 | ms/batch 35.54 | loss  3.26 | ppl    25.940
total_loss: 28519.999069213867, total_len: 7360
total_loss: 31224.309700012207, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 125 at step    25000 | time:  6.76s | valid loss  3.87 | valid ppl    48.183
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 105 step    25200 |     32 batches | lr 3.77e-05 | ms/batch 39.53 | loss  3.23 | ppl    25.405
total_loss: 28541.44525909424, total_len: 7360
total_loss: 31250.989143371582, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 126 at step    25200 | time:  6.71s | valid loss  3.88 | valid ppl    48.323
----------------------------------------------------------------------------------------------------
| epoch 105 step    25400 |    232 batches | lr 3.68e-05 | ms/batch 33.50 | loss  3.23 | ppl    25.237
total_loss: 28538.179656982422, total_len: 7360
total_loss: 31248.946815490723, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 127 at step    25400 | time:  6.70s | valid loss  3.88 | valid ppl    48.302
----------------------------------------------------------------------------------------------------
| epoch 106 step    25600 |    190 batches | lr 3.59e-05 | ms/batch 33.52 | loss  3.23 | ppl    25.263
total_loss: 28508.489265441895, total_len: 7360
total_loss: 31214.7315826416, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 128 at step    25600 | time:  6.71s | valid loss  3.87 | valid ppl    48.107
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 107 step    25800 |    148 batches | lr 3.5e-05 | ms/batch 39.44 | loss  3.23 | ppl    25.234
total_loss: 28518.692176818848, total_len: 7360
total_loss: 31224.478492736816, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 129 at step    25800 | time:  7.20s | valid loss  3.87 | valid ppl    48.174
----------------------------------------------------------------------------------------------------
| epoch 108 step    26000 |    106 batches | lr 3.41e-05 | ms/batch 36.23 | loss  3.23 | ppl    25.294
total_loss: 28489.012145996094, total_len: 7360
total_loss: 31201.11769104004, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 130 at step    26000 | time:  6.74s | valid loss  3.87 | valid ppl    47.980
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 109 step    26200 |     64 batches | lr 3.33e-05 | ms/batch 39.45 | loss  3.23 | ppl    25.363
total_loss: 28480.174545288086, total_len: 7360
total_loss: 31180.816078186035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 131 at step    26200 | time:  6.73s | valid loss  3.87 | valid ppl    47.923
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 110 step    26400 |     22 batches | lr 3.24e-05 | ms/batch 39.34 | loss  3.22 | ppl    24.964
total_loss: 28481.64064025879, total_len: 7360
total_loss: 31174.96511077881, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 132 at step    26400 | time:  6.73s | valid loss  3.87 | valid ppl    47.932
----------------------------------------------------------------------------------------------------
| epoch 110 step    26600 |    222 batches | lr 3.15e-05 | ms/batch 33.61 | loss  3.22 | ppl    24.910
total_loss: 28482.264686584473, total_len: 7360
total_loss: 31173.855751037598, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 133 at step    26600 | time:  6.71s | valid loss  3.87 | valid ppl    47.936
----------------------------------------------------------------------------------------------------
| epoch 111 step    26800 |    180 batches | lr 3.07e-05 | ms/batch 33.55 | loss  3.21 | ppl    24.855
total_loss: 28491.197311401367, total_len: 7360
total_loss: 31183.15773010254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 134 at step    26800 | time:  6.92s | valid loss  3.87 | valid ppl    47.995
----------------------------------------------------------------------------------------------------
| epoch 112 step    27000 |    138 batches | lr 2.98e-05 | ms/batch 34.64 | loss  3.21 | ppl    24.741
total_loss: 28477.022506713867, total_len: 7360
total_loss: 31171.232452392578, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 135 at step    27000 | time:  6.72s | valid loss  3.87 | valid ppl    47.902
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 113 step    27200 |     96 batches | lr 2.9e-05 | ms/batch 39.19 | loss  3.23 | ppl    25.156
total_loss: 28461.96026611328, total_len: 7360
total_loss: 31151.981269836426, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 136 at step    27200 | time:  6.72s | valid loss  3.87 | valid ppl    47.804
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 114 step    27400 |     54 batches | lr 2.82e-05 | ms/batch 39.46 | loss  3.21 | ppl    24.771
total_loss: 28474.774780273438, total_len: 7360
total_loss: 31168.113510131836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 137 at step    27400 | time:  7.15s | valid loss  3.87 | valid ppl    47.888
----------------------------------------------------------------------------------------------------
| epoch 115 step    27600 |     12 batches | lr 2.74e-05 | ms/batch 35.71 | loss  3.20 | ppl    24.483
total_loss: 28470.063842773438, total_len: 7360
total_loss: 31158.951416015625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 138 at step    27600 | time:  7.45s | valid loss  3.87 | valid ppl    47.857
----------------------------------------------------------------------------------------------------
| epoch 115 step    27800 |    212 batches | lr 2.66e-05 | ms/batch 33.64 | loss  3.20 | ppl    24.466
total_loss: 28474.418395996094, total_len: 7360
total_loss: 31164.148750305176, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 139 at step    27800 | time:  6.72s | valid loss  3.87 | valid ppl    47.885
----------------------------------------------------------------------------------------------------
| epoch 116 step    28000 |    170 batches | lr 2.58e-05 | ms/batch 33.50 | loss  3.20 | ppl    24.505
total_loss: 28444.42716217041, total_len: 7360
total_loss: 31132.830490112305, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 140 at step    28000 | time:  6.70s | valid loss  3.86 | valid ppl    47.690
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 117 step    28200 |    128 batches | lr 2.5e-05 | ms/batch 39.16 | loss  3.20 | ppl    24.432
total_loss: 28470.003746032715, total_len: 7360
total_loss: 31162.374130249023, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 141 at step    28200 | time:  6.71s | valid loss  3.87 | valid ppl    47.857
----------------------------------------------------------------------------------------------------
| epoch 118 step    28400 |     86 batches | lr 2.42e-05 | ms/batch 33.91 | loss  3.21 | ppl    24.726
total_loss: 28410.100090026855, total_len: 7360
total_loss: 31088.638389587402, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 142 at step    28400 | time:  6.78s | valid loss  3.86 | valid ppl    47.469
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 119 step    28600 |     44 batches | lr 2.34e-05 | ms/batch 40.14 | loss  3.19 | ppl    24.270
total_loss: 28466.205101013184, total_len: 7360
total_loss: 31151.413047790527, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 143 at step    28600 | time:  6.86s | valid loss  3.87 | valid ppl    47.832
----------------------------------------------------------------------------------------------------
| epoch 120 step    28800 |      2 batches | lr 2.27e-05 | ms/batch 34.14 | loss  3.19 | ppl    24.173
total_loss: 28448.28746032715, total_len: 7360
total_loss: 31123.70680999756, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 144 at step    28800 | time:  6.83s | valid loss  3.87 | valid ppl    47.716
----------------------------------------------------------------------------------------------------
| epoch 120 step    29000 |    202 batches | lr 2.19e-05 | ms/batch 33.66 | loss  3.19 | ppl    24.213
total_loss: 28452.342765808105, total_len: 7360
total_loss: 31142.05088043213, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 145 at step    29000 | time:  6.73s | valid loss  3.87 | valid ppl    47.742
----------------------------------------------------------------------------------------------------
| epoch 121 step    29200 |    160 batches | lr 2.12e-05 | ms/batch 33.61 | loss  3.18 | ppl    24.117
total_loss: 28447.0333404541, total_len: 7360
total_loss: 31137.338607788086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 146 at step    29200 | time:  6.72s | valid loss  3.87 | valid ppl    47.707
----------------------------------------------------------------------------------------------------
| epoch 122 step    29400 |    118 batches | lr 2.04e-05 | ms/batch 33.54 | loss  3.18 | ppl    24.131
total_loss: 28435.06935119629, total_len: 7360
total_loss: 31128.61636352539, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 147 at step    29400 | time:  6.70s | valid loss  3.86 | valid ppl    47.630
----------------------------------------------------------------------------------------------------
| epoch 123 step    29600 |     76 batches | lr 1.97e-05 | ms/batch 33.54 | loss  3.20 | ppl    24.550
total_loss: 28405.860549926758, total_len: 7360
total_loss: 31087.051460266113, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 148 at step    29600 | time:  7.00s | valid loss  3.86 | valid ppl    47.441
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 124 step    29800 |     34 batches | lr 1.9e-05 | ms/batch 42.76 | loss  3.18 | ppl    24.001
total_loss: 28454.84368133545, total_len: 7360
total_loss: 31145.00852203369, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 149 at step    29800 | time:  6.73s | valid loss  3.87 | valid ppl    47.758
----------------------------------------------------------------------------------------------------
| epoch 124 step    30000 |    234 batches | lr 1.83e-05 | ms/batch 33.53 | loss  3.17 | ppl    23.895
total_loss: 28436.026412963867, total_len: 7360
total_loss: 31119.640113830566, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 150 at step    30000 | time:  6.73s | valid loss  3.86 | valid ppl    47.636
----------------------------------------------------------------------------------------------------
| epoch 125 step    30200 |    192 batches | lr 1.76e-05 | ms/batch 33.68 | loss  3.18 | ppl    23.981
total_loss: 28415.64878845215, total_len: 7360
total_loss: 31096.427421569824, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 151 at step    30200 | time:  6.71s | valid loss  3.86 | valid ppl    47.504
----------------------------------------------------------------------------------------------------
| epoch 126 step    30400 |    150 batches | lr 1.69e-05 | ms/batch 33.51 | loss  3.17 | ppl    23.869
total_loss: 28407.603996276855, total_len: 7360
total_loss: 31088.537879943848, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 152 at step    30400 | time:  6.70s | valid loss  3.86 | valid ppl    47.452
----------------------------------------------------------------------------------------------------
| epoch 127 step    30600 |    108 batches | lr 1.63e-05 | ms/batch 33.57 | loss  3.18 | ppl    24.076
total_loss: 28401.776000976562, total_len: 7360
total_loss: 31088.166801452637, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 153 at step    30600 | time:  6.71s | valid loss  3.86 | valid ppl    47.415
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 128 step    30800 |     66 batches | lr 1.56e-05 | ms/batch 39.43 | loss  3.18 | ppl    24.124
total_loss: 28395.74382019043, total_len: 7360
total_loss: 31075.645462036133, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 154 at step    30800 | time:  6.73s | valid loss  3.86 | valid ppl    47.376
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 129 step    31000 |     24 batches | lr 1.5e-05 | ms/batch 40.15 | loss  3.17 | ppl    23.755
total_loss: 28394.224319458008, total_len: 7360
total_loss: 31066.706504821777, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 155 at step    31000 | time:  6.88s | valid loss  3.86 | valid ppl    47.366
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 129 step    31200 |    224 batches | lr 1.43e-05 | ms/batch 40.25 | loss  3.17 | ppl    23.733
total_loss: 28411.592933654785, total_len: 7360
total_loss: 31087.92310333252, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 156 at step    31200 | time:  6.87s | valid loss  3.86 | valid ppl    47.478
----------------------------------------------------------------------------------------------------
| epoch 130 step    31400 |    182 batches | lr 1.37e-05 | ms/batch 34.16 | loss  3.17 | ppl    23.752
total_loss: 28389.155570983887, total_len: 7360
total_loss: 31071.739921569824, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 157 at step    31400 | time:  6.96s | valid loss  3.86 | valid ppl    47.334
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 131 step    31600 |    140 batches | lr 1.31e-05 | ms/batch 39.66 | loss  3.17 | ppl    23.769
total_loss: 28399.27247619629, total_len: 7360
total_loss: 31076.148071289062, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 158 at step    31600 | time:  6.74s | valid loss  3.86 | valid ppl    47.399
----------------------------------------------------------------------------------------------------
| epoch 132 step    31800 |     98 batches | lr 1.25e-05 | ms/batch 33.60 | loss  3.18 | ppl    23.947
total_loss: 28385.83869934082, total_len: 7360
total_loss: 31059.99855041504, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 159 at step    31800 | time:  6.73s | valid loss  3.86 | valid ppl    47.312
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 133 step    32000 |     56 batches | lr 1.19e-05 | ms/batch 39.41 | loss  3.17 | ppl    23.772
total_loss: 28413.16645050049, total_len: 7360
total_loss: 31093.1436920166, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 160 at step    32000 | time:  6.74s | valid loss  3.86 | valid ppl    47.488
----------------------------------------------------------------------------------------------------
| epoch 134 step    32200 |     14 batches | lr 1.14e-05 | ms/batch 33.62 | loss  3.16 | ppl    23.566
total_loss: 28394.24568939209, total_len: 7360
total_loss: 31068.495864868164, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 161 at step    32200 | time:  6.71s | valid loss  3.86 | valid ppl    47.366
----------------------------------------------------------------------------------------------------
| epoch 134 step    32400 |    214 batches | lr 1.08e-05 | ms/batch 33.58 | loss  3.16 | ppl    23.565
total_loss: 28395.547157287598, total_len: 7360
total_loss: 31071.674530029297, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 162 at step    32400 | time:  6.73s | valid loss  3.86 | valid ppl    47.375
----------------------------------------------------------------------------------------------------
| epoch 135 step    32600 |    172 batches | lr 1.03e-05 | ms/batch 33.68 | loss  3.16 | ppl    23.505
total_loss: 28379.049766540527, total_len: 7360
total_loss: 31054.200035095215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 163 at step    32600 | time:  6.72s | valid loss  3.86 | valid ppl    47.269
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 136 step    32800 |    130 batches | lr 9.73e-06 | ms/batch 39.83 | loss  3.16 | ppl    23.520
total_loss: 28405.643356323242, total_len: 7360
total_loss: 31086.095420837402, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 164 at step    32800 | time:  6.78s | valid loss  3.86 | valid ppl    47.440
----------------------------------------------------------------------------------------------------
| epoch 137 step    33000 |     88 batches | lr 9.21e-06 | ms/batch 33.55 | loss  3.18 | ppl    23.944
total_loss: 28377.56430053711, total_len: 7360
total_loss: 31052.763397216797, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 165 at step    33000 | time:  6.71s | valid loss  3.86 | valid ppl    47.259
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 138 step    33200 |     46 batches | lr 8.7e-06 | ms/batch 39.23 | loss  3.16 | ppl    23.513
total_loss: 28419.05574798584, total_len: 7360
total_loss: 31095.80199432373, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 166 at step    33200 | time:  6.73s | valid loss  3.86 | valid ppl    47.526
----------------------------------------------------------------------------------------------------
| epoch 139 step    33400 |      4 batches | lr 8.21e-06 | ms/batch 33.52 | loss  3.15 | ppl    23.351
total_loss: 28392.560035705566, total_len: 7360
total_loss: 31067.443237304688, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 167 at step    33400 | time:  6.70s | valid loss  3.86 | valid ppl    47.356
----------------------------------------------------------------------------------------------------
| epoch 139 step    33600 |    204 batches | lr 7.73e-06 | ms/batch 33.56 | loss  3.16 | ppl    23.502
total_loss: 28399.29608154297, total_len: 7360
total_loss: 31077.641387939453, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 168 at step    33600 | time:  6.71s | valid loss  3.86 | valid ppl    47.399
----------------------------------------------------------------------------------------------------
| epoch 140 step    33800 |    162 batches | lr 7.26e-06 | ms/batch 33.62 | loss  3.15 | ppl    23.422
total_loss: 28392.943359375, total_len: 7360
total_loss: 31071.37710571289, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 169 at step    33800 | time:  6.72s | valid loss  3.86 | valid ppl    47.358
----------------------------------------------------------------------------------------------------
| epoch 141 step    34000 |    120 batches | lr 6.81e-06 | ms/batch 33.54 | loss  3.16 | ppl    23.475
total_loss: 28397.03263092041, total_len: 7360
total_loss: 31075.677795410156, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 170 at step    34000 | time:  6.71s | valid loss  3.86 | valid ppl    47.384
----------------------------------------------------------------------------------------------------
| epoch 142 step    34200 |     78 batches | lr 6.37e-06 | ms/batch 33.57 | loss  3.17 | ppl    23.780
total_loss: 28376.121627807617, total_len: 7360
total_loss: 31048.30793762207, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 171 at step    34200 | time:  6.72s | valid loss  3.86 | valid ppl    47.250
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 143 step    34400 |     36 batches | lr 5.95e-06 | ms/batch 39.47 | loss  3.15 | ppl    23.351
total_loss: 28387.603340148926, total_len: 7360
total_loss: 31057.47876739502, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 172 at step    34400 | time:  6.73s | valid loss  3.86 | valid ppl    47.324
----------------------------------------------------------------------------------------------------
| epoch 143 step    34600 |    236 batches | lr 5.54e-06 | ms/batch 33.58 | loss  3.15 | ppl    23.296
total_loss: 28385.860725402832, total_len: 7360
total_loss: 31056.210487365723, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 173 at step    34600 | time:  6.72s | valid loss  3.86 | valid ppl    47.313
----------------------------------------------------------------------------------------------------
| epoch 144 step    34800 |    194 batches | lr 5.14e-06 | ms/batch 33.55 | loss  3.15 | ppl    23.387
total_loss: 28372.596351623535, total_len: 7360
total_loss: 31045.01294708252, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 174 at step    34800 | time:  6.71s | valid loss  3.85 | valid ppl    47.227
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 145 step    35000 |    152 batches | lr 4.76e-06 | ms/batch 40.11 | loss  3.15 | ppl    23.315
total_loss: 28378.464569091797, total_len: 7360
total_loss: 31048.73447418213, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 175 at step    35000 | time:  6.74s | valid loss  3.86 | valid ppl    47.265
----------------------------------------------------------------------------------------------------
| epoch 146 step    35200 |    110 batches | lr 4.39e-06 | ms/batch 33.58 | loss  3.16 | ppl    23.528
total_loss: 28373.658348083496, total_len: 7360
total_loss: 31040.87397003174, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 176 at step    35200 | time:  6.74s | valid loss  3.86 | valid ppl    47.234
----------------------------------------------------------------------------------------------------
| epoch 147 step    35400 |     68 batches | lr 4.03e-06 | ms/batch 33.74 | loss  3.16 | ppl    23.641
total_loss: 28370.782028198242, total_len: 7360
total_loss: 31039.81330871582, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 177 at step    35400 | time:  6.74s | valid loss  3.85 | valid ppl    47.216
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 148 step    35600 |     26 batches | lr 3.69e-06 | ms/batch 40.08 | loss  3.15 | ppl    23.263
total_loss: 28368.74627685547, total_len: 7360
total_loss: 31035.605781555176, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 178 at step    35600 | time:  6.89s | valid loss  3.85 | valid ppl    47.203
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 148 step    35800 |    226 batches | lr 3.37e-06 | ms/batch 39.66 | loss  3.14 | ppl    23.194
total_loss: 28377.793449401855, total_len: 7360
total_loss: 31048.011924743652, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 179 at step    35800 | time:  6.84s | valid loss  3.86 | valid ppl    47.261
----------------------------------------------------------------------------------------------------
| epoch 149 step    36000 |    184 batches | lr 3.06e-06 | ms/batch 33.59 | loss  3.15 | ppl    23.221
total_loss: 28366.718238830566, total_len: 7360
total_loss: 31036.12538909912, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 180 at step    36000 | time:  6.71s | valid loss  3.85 | valid ppl    47.190
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 150 step    36200 |    142 batches | lr 2.76e-06 | ms/batch 39.38 | loss  3.15 | ppl    23.363
total_loss: 28381.16453552246, total_len: 7360
total_loss: 31051.296356201172, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 181 at step    36200 | time:  6.74s | valid loss  3.86 | valid ppl    47.282
----------------------------------------------------------------------------------------------------
| epoch 151 step    36400 |    100 batches | lr 2.48e-06 | ms/batch 33.63 | loss  3.16 | ppl    23.520
total_loss: 28373.094314575195, total_len: 7360
total_loss: 31040.66091156006, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 182 at step    36400 | time:  6.72s | valid loss  3.86 | valid ppl    47.231
----------------------------------------------------------------------------------------------------
| epoch 152 step    36600 |     58 batches | lr 2.22e-06 | ms/batch 33.60 | loss  3.16 | ppl    23.477
total_loss: 28381.162658691406, total_len: 7360
total_loss: 31048.881950378418, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 183 at step    36600 | time:  6.72s | valid loss  3.86 | valid ppl    47.282
----------------------------------------------------------------------------------------------------
| epoch 153 step    36800 |     16 batches | lr 1.96e-06 | ms/batch 33.59 | loss  3.14 | ppl    23.182
total_loss: 28376.45302581787, total_len: 7360
total_loss: 31045.74021911621, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 184 at step    36800 | time:  6.72s | valid loss  3.86 | valid ppl    47.252
----------------------------------------------------------------------------------------------------
| epoch 153 step    37000 |    216 batches | lr 1.73e-06 | ms/batch 33.63 | loss  3.15 | ppl    23.243
total_loss: 28374.36141204834, total_len: 7360
total_loss: 31043.996322631836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 185 at step    37000 | time:  6.73s | valid loss  3.86 | valid ppl    47.239
----------------------------------------------------------------------------------------------------
| epoch 154 step    37200 |    174 batches | lr 1.51e-06 | ms/batch 33.60 | loss  3.15 | ppl    23.234
total_loss: 28372.23853302002, total_len: 7360
total_loss: 31040.19142150879, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 186 at step    37200 | time:  6.71s | valid loss  3.85 | valid ppl    47.225
----------------------------------------------------------------------------------------------------
| epoch 155 step    37400 |    132 batches | lr 1.3e-06 | ms/batch 33.63 | loss  3.15 | ppl    23.238
total_loss: 28374.544952392578, total_len: 7360
total_loss: 31042.552795410156, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 187 at step    37400 | time:  6.74s | valid loss  3.86 | valid ppl    47.240
----------------------------------------------------------------------------------------------------
| epoch 156 step    37600 |     90 batches | lr 1.11e-06 | ms/batch 33.64 | loss  3.16 | ppl    23.580
total_loss: 28373.583938598633, total_len: 7360
total_loss: 31041.509574890137, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 188 at step    37600 | time:  6.72s | valid loss  3.86 | valid ppl    47.234
----------------------------------------------------------------------------------------------------
| epoch 157 step    37800 |     48 batches | lr 9.31e-07 | ms/batch 33.64 | loss  3.15 | ppl    23.313
total_loss: 28369.41724395752, total_len: 7360
total_loss: 31035.79497528076, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 189 at step    37800 | time:  6.72s | valid loss  3.85 | valid ppl    47.207
----------------------------------------------------------------------------------------------------
| epoch 158 step    38000 |      6 batches | lr 7.69e-07 | ms/batch 33.60 | loss  3.14 | ppl    23.108
total_loss: 28373.113975524902, total_len: 7360
total_loss: 31041.097770690918, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 190 at step    38000 | time:  6.71s | valid loss  3.86 | valid ppl    47.231
----------------------------------------------------------------------------------------------------
| epoch 158 step    38200 |    206 batches | lr 6.24e-07 | ms/batch 33.60 | loss  3.14 | ppl    23.196
total_loss: 28373.475700378418, total_len: 7360
total_loss: 31041.13010406494, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 191 at step    38200 | time:  6.72s | valid loss  3.86 | valid ppl    47.233
----------------------------------------------------------------------------------------------------
| epoch 159 step    38400 |    164 batches | lr 4.93e-07 | ms/batch 33.69 | loss  3.15 | ppl    23.271
total_loss: 28375.288093566895, total_len: 7360
total_loss: 31042.50478363037, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 192 at step    38400 | time:  6.73s | valid loss  3.86 | valid ppl    47.245
----------------------------------------------------------------------------------------------------
| epoch 160 step    38600 |    122 batches | lr 3.77e-07 | ms/batch 33.62 | loss  3.15 | ppl    23.253
total_loss: 28373.665008544922, total_len: 7360
total_loss: 31040.072105407715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 193 at step    38600 | time:  6.74s | valid loss  3.86 | valid ppl    47.234
----------------------------------------------------------------------------------------------------
| epoch 161 step    38800 |     80 batches | lr 2.77e-07 | ms/batch 33.72 | loss  3.16 | ppl    23.683
total_loss: 28373.692260742188, total_len: 7360
total_loss: 31040.734466552734, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 194 at step    38800 | time:  6.74s | valid loss  3.86 | valid ppl    47.234
----------------------------------------------------------------------------------------------------
| epoch 162 step    39000 |     38 batches | lr 1.93e-07 | ms/batch 33.72 | loss  3.14 | ppl    23.196
total_loss: 28373.551498413086, total_len: 7360
total_loss: 31040.62467956543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 195 at step    39000 | time:  6.75s | valid loss  3.86 | valid ppl    47.233
----------------------------------------------------------------------------------------------------
| epoch 162 step    39200 |    238 batches | lr 1.23e-07 | ms/batch 33.71 | loss  3.14 | ppl    23.064
total_loss: 28373.1314163208, total_len: 7360
total_loss: 31040.39835357666, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 196 at step    39200 | time:  6.73s | valid loss  3.86 | valid ppl    47.231
----------------------------------------------------------------------------------------------------
| epoch 163 step    39400 |    196 batches | lr 6.94e-08 | ms/batch 33.69 | loss  3.15 | ppl    23.238
total_loss: 28373.122093200684, total_len: 7360
total_loss: 31040.308708190918, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 197 at step    39400 | time:  6.74s | valid loss  3.86 | valid ppl    47.231
----------------------------------------------------------------------------------------------------
| epoch 164 step    39600 |    154 batches | lr 3.08e-08 | ms/batch 33.69 | loss  3.15 | ppl    23.238
total_loss: 28373.380599975586, total_len: 7360
total_loss: 31040.4931640625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 198 at step    39600 | time:  6.74s | valid loss  3.86 | valid ppl    47.232
----------------------------------------------------------------------------------------------------
| epoch 165 step    39800 |    112 batches | lr 7.71e-09 | ms/batch 33.79 | loss  3.15 | ppl    23.356
total_loss: 28373.255363464355, total_len: 7360
total_loss: 31040.36215209961, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 199 at step    39800 | time:  6.75s | valid loss  3.86 | valid ppl    47.232
----------------------------------------------------------------------------------------------------
| epoch 166 step    40000 |     70 batches | lr 0 | ms/batch 33.64 | loss  3.16 | ppl    23.568
total_loss: 28373.263870239258, total_len: 7360
total_loss: 31040.37802886963, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 200 at step    40000 | time:  6.72s | valid loss  3.86 | valid ppl    47.232
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
End of training
total_loss: 31036.12538909912, total_len: 8224
====================================================================================================
| End of training | test loss  3.77 | test ppl    43.547
====================================================================================================
