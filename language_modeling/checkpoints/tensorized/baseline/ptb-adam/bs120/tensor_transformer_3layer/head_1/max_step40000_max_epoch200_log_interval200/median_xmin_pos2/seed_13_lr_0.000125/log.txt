Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 13
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_13_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
total_loss: 71380.69039916992, total_len: 7744
total_loss: 75822.42971801758, total_len: 8224
total_loss: 67878.63623046875, total_len: 7360
| Start of training | test loss  9.22 | test bpc 10093.56548
| epoch   1 step      200 |    200 batches | lr 0.000125 | ms/batch 42.18 | loss  7.04 | ppl  1143.180
total_loss: 45341.308166503906, total_len: 7360
total_loss: 50265.64305114746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   1 at step      200 | time:  9.88s | valid loss  6.16 | valid ppl   473.667
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   2 step      400 |    158 batches | lr 0.000125 | ms/batch 38.90 | loss  6.05 | ppl   425.448
total_loss: 42655.53221130371, total_len: 7360
total_loss: 47254.481857299805, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   2 at step      400 | time:  6.56s | valid loss  5.80 | valid ppl   328.846
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   3 step      600 |    116 batches | lr 0.000125 | ms/batch 38.82 | loss  5.79 | ppl   326.458
total_loss: 41431.62951660156, total_len: 7360
total_loss: 45879.27574157715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   3 at step      600 | time:  6.60s | valid loss  5.63 | valid ppl   278.466
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   4 step      800 |     74 batches | lr 0.000125 | ms/batch 41.38 | loss  5.65 | ppl   283.513
total_loss: 40526.85287475586, total_len: 7360
total_loss: 44844.31866455078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   4 at step      800 | time:  7.19s | valid loss  5.51 | valid ppl   246.255
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1000 |     32 batches | lr 0.000125 | ms/batch 38.80 | loss  5.52 | ppl   250.240
total_loss: 39949.7033996582, total_len: 7360
total_loss: 44196.36589050293, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1000 | time:  6.62s | valid loss  5.43 | valid ppl   227.682
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1200 |    232 batches | lr 0.000125 | ms/batch 38.38 | loss  5.43 | ppl   228.795
total_loss: 39468.45811462402, total_len: 7360
total_loss: 43677.946212768555, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1200 | time:  6.63s | valid loss  5.36 | valid ppl   213.271
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   6 step     1400 |    190 batches | lr 0.000125 | ms/batch 37.17 | loss  5.36 | ppl   213.517
total_loss: 39063.0294342041, total_len: 7360
total_loss: 43189.96391296387, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1400 | time:  6.53s | valid loss  5.31 | valid ppl   201.840
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   7 step     1600 |    148 batches | lr 0.000125 | ms/batch 39.24 | loss  5.30 | ppl   200.388
total_loss: 38724.9366607666, total_len: 7360
total_loss: 42809.02781677246, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   8 at step     1600 | time:  6.67s | valid loss  5.26 | valid ppl   192.778
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   8 step     1800 |    106 batches | lr 0.000124 | ms/batch 38.86 | loss  5.25 | ppl   191.228
total_loss: 38354.5753326416, total_len: 7360
total_loss: 42408.67918395996, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   9 at step     1800 | time:  6.65s | valid loss  5.21 | valid ppl   183.317
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   9 step     2000 |     64 batches | lr 0.000124 | ms/batch 38.86 | loss  5.21 | ppl   182.204
total_loss: 38055.856689453125, total_len: 7360
total_loss: 42085.0602722168, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2000 | time:  6.66s | valid loss  5.17 | valid ppl   176.026
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2200 |     22 batches | lr 0.000124 | ms/batch 38.85 | loss  5.15 | ppl   171.663
total_loss: 37759.95571899414, total_len: 7360
total_loss: 41737.04414367676, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2200 | time:  6.65s | valid loss  5.13 | valid ppl   169.090
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2400 |    222 batches | lr 0.000124 | ms/batch 39.26 | loss  5.11 | ppl   164.941
total_loss: 37547.91015625, total_len: 7360
total_loss: 41510.26824951172, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  12 at step     2400 | time:  6.68s | valid loss  5.10 | valid ppl   164.288
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  11 step     2600 |    180 batches | lr 0.000124 | ms/batch 38.80 | loss  5.06 | ppl   158.138
total_loss: 37306.48287963867, total_len: 7360
total_loss: 41244.371520996094, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  13 at step     2600 | time:  6.67s | valid loss  5.07 | valid ppl   158.986
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  12 step     2800 |    138 batches | lr 0.000123 | ms/batch 39.27 | loss  5.03 | ppl   152.778
total_loss: 37135.18826293945, total_len: 7360
total_loss: 41040.396484375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  14 at step     2800 | time:  6.70s | valid loss  5.05 | valid ppl   155.328
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  13 step     3000 |     96 batches | lr 0.000123 | ms/batch 39.31 | loss  5.01 | ppl   149.388
total_loss: 36891.22105407715, total_len: 7360
total_loss: 40758.048828125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3000 | time:  6.70s | valid loss  5.01 | valid ppl   150.264
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  14 step     3200 |     54 batches | lr 0.000123 | ms/batch 39.14 | loss  4.96 | ppl   142.532
total_loss: 36668.3782119751, total_len: 7360
total_loss: 40531.051361083984, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  16 at step     3200 | time:  6.66s | valid loss  4.98 | valid ppl   145.783
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3400 |     12 batches | lr 0.000123 | ms/batch 39.12 | loss  4.91 | ppl   136.309
total_loss: 36437.77961730957, total_len: 7360
total_loss: 40260.11003112793, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  17 at step     3400 | time:  6.67s | valid loss  4.95 | valid ppl   141.286
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3600 |    212 batches | lr 0.000123 | ms/batch 39.00 | loss  4.88 | ppl   131.066
total_loss: 36215.861167907715, total_len: 7360
total_loss: 40008.40823364258, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  18 at step     3600 | time:  6.67s | valid loss  4.92 | valid ppl   137.089
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  16 step     3800 |    170 batches | lr 0.000122 | ms/batch 38.81 | loss  4.83 | ppl   125.352
total_loss: 35872.15566253662, total_len: 7360
total_loss: 39622.94827270508, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  19 at step     3800 | time:  6.73s | valid loss  4.87 | valid ppl   130.835
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  17 step     4000 |    128 batches | lr 0.000122 | ms/batch 39.20 | loss  4.78 | ppl   119.670
total_loss: 35557.83832550049, total_len: 7360
total_loss: 39279.601638793945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  20 at step     4000 | time:  6.67s | valid loss  4.83 | valid ppl   125.365
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  18 step     4200 |     86 batches | lr 0.000122 | ms/batch 39.14 | loss  4.75 | ppl   116.040
total_loss: 35184.48038482666, total_len: 7360
total_loss: 38872.381912231445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  21 at step     4200 | time:  6.67s | valid loss  4.78 | valid ppl   119.164
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  19 step     4400 |     44 batches | lr 0.000121 | ms/batch 38.95 | loss  4.69 | ppl   108.321
total_loss: 34831.17922210693, total_len: 7360
total_loss: 38480.08553314209, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  22 at step     4400 | time:  6.66s | valid loss  4.73 | valid ppl   113.579
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4600 |      2 batches | lr 0.000121 | ms/batch 38.83 | loss  4.63 | ppl   102.586
total_loss: 34533.100677490234, total_len: 7360
total_loss: 38162.932792663574, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  23 at step     4600 | time:  6.66s | valid loss  4.69 | valid ppl   109.071
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4800 |    202 batches | lr 0.000121 | ms/batch 38.07 | loss  4.58 | ppl    97.961
total_loss: 34225.04866027832, total_len: 7360
total_loss: 37800.65864562988, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  24 at step     4800 | time:  6.64s | valid loss  4.65 | valid ppl   104.600
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  21 step     5000 |    160 batches | lr 0.00012 | ms/batch 38.77 | loss  4.54 | ppl    93.451
total_loss: 33948.980964660645, total_len: 7360
total_loss: 37447.75743103027, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  25 at step     5000 | time:  6.66s | valid loss  4.61 | valid ppl   100.749
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  22 step     5200 |    118 batches | lr 0.00012 | ms/batch 38.32 | loss  4.49 | ppl    89.155
total_loss: 33646.21617889404, total_len: 7360
total_loss: 37120.771728515625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  26 at step     5200 | time:  6.78s | valid loss  4.57 | valid ppl    96.689
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  23 step     5400 |     76 batches | lr 0.000119 | ms/batch 40.37 | loss  4.46 | ppl    86.842
total_loss: 33379.16404724121, total_len: 7360
total_loss: 36808.688400268555, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  27 at step     5400 | time:  6.56s | valid loss  4.54 | valid ppl    93.243
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5600 |     34 batches | lr 0.000119 | ms/batch 38.09 | loss  4.40 | ppl    81.298
total_loss: 33126.67623901367, total_len: 7360
total_loss: 36520.03419494629, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  28 at step     5600 | time:  6.54s | valid loss  4.50 | valid ppl    90.099
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5800 |    234 batches | lr 0.000119 | ms/batch 39.64 | loss  4.35 | ppl    77.600
total_loss: 32879.41352081299, total_len: 7360
total_loss: 36233.808937072754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  29 at step     5800 | time:  6.73s | valid loss  4.47 | valid ppl    87.122
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  25 step     6000 |    192 batches | lr 0.000118 | ms/batch 37.97 | loss  4.32 | ppl    74.914
total_loss: 32608.854400634766, total_len: 7360
total_loss: 35920.04692077637, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  30 at step     6000 | time:  6.66s | valid loss  4.43 | valid ppl    83.978
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  26 step     6200 |    150 batches | lr 0.000118 | ms/batch 40.09 | loss  4.27 | ppl    71.807
total_loss: 32368.50075531006, total_len: 7360
total_loss: 35640.43714904785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  31 at step     6200 | time:  6.65s | valid loss  4.40 | valid ppl    81.280
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  27 step     6400 |    108 batches | lr 0.000117 | ms/batch 42.86 | loss  4.25 | ppl    69.868
total_loss: 32163.661087036133, total_len: 7360
total_loss: 35408.12309265137, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  32 at step     6400 | time:  7.42s | valid loss  4.37 | valid ppl    79.049
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  28 step     6600 |     66 batches | lr 0.000117 | ms/batch 38.42 | loss  4.21 | ppl    67.626
total_loss: 31943.155158996582, total_len: 7360
total_loss: 35171.36767578125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  33 at step     6600 | time:  6.55s | valid loss  4.34 | valid ppl    76.715
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     6800 |     24 batches | lr 0.000116 | ms/batch 38.53 | loss  4.16 | ppl    64.355
total_loss: 31754.130325317383, total_len: 7360
total_loss: 34979.266761779785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  34 at step     6800 | time:  6.57s | valid loss  4.31 | valid ppl    74.770
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     7000 |    224 batches | lr 0.000116 | ms/batch 38.68 | loss  4.13 | ppl    62.346
total_loss: 31657.830436706543, total_len: 7360
total_loss: 34842.03333282471, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  35 at step     7000 | time:  6.57s | valid loss  4.30 | valid ppl    73.798
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  30 step     7200 |    182 batches | lr 0.000115 | ms/batch 38.55 | loss  4.10 | ppl    60.430
total_loss: 31475.801963806152, total_len: 7360
total_loss: 34642.97777557373, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  36 at step     7200 | time:  6.56s | valid loss  4.28 | valid ppl    71.995
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  31 step     7400 |    140 batches | lr 0.000115 | ms/batch 38.42 | loss  4.08 | ppl    58.974
total_loss: 31334.264640808105, total_len: 7360
total_loss: 34486.15782165527, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  37 at step     7400 | time:  6.55s | valid loss  4.26 | valid ppl    70.624
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  32 step     7600 |     98 batches | lr 0.000114 | ms/batch 38.20 | loss  4.06 | ppl    58.013
total_loss: 31139.33469390869, total_len: 7360
total_loss: 34266.912254333496, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  38 at step     7600 | time:  6.55s | valid loss  4.23 | valid ppl    68.778
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  33 step     7800 |     56 batches | lr 0.000114 | ms/batch 38.22 | loss  4.03 | ppl    56.099
total_loss: 31047.67315673828, total_len: 7360
total_loss: 34160.41867828369, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  39 at step     7800 | time:  6.56s | valid loss  4.22 | valid ppl    67.927
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8000 |     14 batches | lr 0.000113 | ms/batch 38.62 | loss  3.99 | ppl    54.130
total_loss: 30930.72013092041, total_len: 7360
total_loss: 34054.88814544678, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  40 at step     8000 | time:  6.56s | valid loss  4.20 | valid ppl    66.856
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8200 |    214 batches | lr 0.000112 | ms/batch 38.70 | loss  3.97 | ppl    52.986
total_loss: 30797.976417541504, total_len: 7360
total_loss: 33885.60395050049, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  41 at step     8200 | time:  6.61s | valid loss  4.18 | valid ppl    65.661
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  35 step     8400 |    172 batches | lr 0.000112 | ms/batch 38.78 | loss  3.95 | ppl    51.765
total_loss: 30708.20750427246, total_len: 7360
total_loss: 33810.29061126709, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  42 at step     8400 | time:  6.62s | valid loss  4.17 | valid ppl    64.865
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  36 step     8600 |    130 batches | lr 0.000111 | ms/batch 38.83 | loss  3.93 | ppl    50.661
total_loss: 30674.910346984863, total_len: 7360
total_loss: 33751.827865600586, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  43 at step     8600 | time:  6.65s | valid loss  4.17 | valid ppl    64.572
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  37 step     8800 |     88 batches | lr 0.000111 | ms/batch 38.93 | loss  3.92 | ppl    50.463
total_loss: 30569.42160797119, total_len: 7360
total_loss: 33642.86248779297, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  44 at step     8800 | time:  6.63s | valid loss  4.15 | valid ppl    63.653
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  38 step     9000 |     46 batches | lr 0.00011 | ms/batch 38.73 | loss  3.89 | ppl    48.782
total_loss: 30448.318733215332, total_len: 7360
total_loss: 33519.77241516113, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  45 at step     9000 | time:  6.57s | valid loss  4.14 | valid ppl    62.615
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9200 |      4 batches | lr 0.000109 | ms/batch 37.66 | loss  3.86 | ppl    47.617
total_loss: 30389.785598754883, total_len: 7360
total_loss: 33451.37976074219, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  46 at step     9200 | time:  6.54s | valid loss  4.13 | valid ppl    62.119
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9400 |    204 batches | lr 0.000109 | ms/batch 38.58 | loss  3.85 | ppl    46.873
total_loss: 30324.66636657715, total_len: 7360
total_loss: 33398.44040679932, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  47 at step     9400 | time:  6.57s | valid loss  4.12 | valid ppl    61.572
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  40 step     9600 |    162 batches | lr 0.000108 | ms/batch 38.09 | loss  3.83 | ppl    46.004
total_loss: 30263.12329864502, total_len: 7360
total_loss: 33302.59652709961, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  48 at step     9600 | time:  6.54s | valid loss  4.11 | valid ppl    61.059
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  41 step     9800 |    120 batches | lr 0.000107 | ms/batch 38.96 | loss  3.81 | ppl    45.296
total_loss: 30200.260848999023, total_len: 7360
total_loss: 33231.880615234375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  49 at step     9800 | time:  6.67s | valid loss  4.10 | valid ppl    60.540
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  42 step    10000 |     78 batches | lr 0.000107 | ms/batch 39.21 | loss  3.82 | ppl    45.402
total_loss: 30090.973960876465, total_len: 7360
total_loss: 33102.27108001709, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  50 at step    10000 | time:  6.67s | valid loss  4.09 | valid ppl    59.647
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10200 |     36 batches | lr 0.000106 | ms/batch 39.03 | loss  3.78 | ppl    43.760
total_loss: 30077.71649169922, total_len: 7360
total_loss: 33080.49855804443, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  51 at step    10200 | time:  6.56s | valid loss  4.09 | valid ppl    59.540
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10400 |    236 batches | lr 0.000105 | ms/batch 38.30 | loss  3.76 | ppl    42.978
total_loss: 30027.51057434082, total_len: 7360
total_loss: 33032.34852600098, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  52 at step    10400 | time:  6.51s | valid loss  4.08 | valid ppl    59.135
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  44 step    10600 |    194 batches | lr 0.000105 | ms/batch 38.28 | loss  3.75 | ppl    42.587
total_loss: 29988.447982788086, total_len: 7360
total_loss: 32972.10280609131, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  53 at step    10600 | time:  6.52s | valid loss  4.07 | valid ppl    58.822
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  45 step    10800 |    152 batches | lr 0.000104 | ms/batch 38.12 | loss  3.74 | ppl    41.922
total_loss: 29950.262062072754, total_len: 7360
total_loss: 32915.27634429932, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  54 at step    10800 | time:  6.51s | valid loss  4.07 | valid ppl    58.518
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  46 step    11000 |    110 batches | lr 0.000103 | ms/batch 38.58 | loss  3.73 | ppl    41.592
total_loss: 29914.910705566406, total_len: 7360
total_loss: 32889.13722229004, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  55 at step    11000 | time:  6.54s | valid loss  4.06 | valid ppl    58.237
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  47 step    11200 |     68 batches | lr 0.000102 | ms/batch 38.67 | loss  3.72 | ppl    41.449
total_loss: 29831.764877319336, total_len: 7360
total_loss: 32813.73489379883, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  56 at step    11200 | time:  6.54s | valid loss  4.05 | valid ppl    57.583
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11400 |     26 batches | lr 0.000102 | ms/batch 38.32 | loss  3.70 | ppl    40.275
total_loss: 29841.126823425293, total_len: 7360
total_loss: 32806.31443023682, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  57 at step    11400 | time:  6.54s | valid loss  4.05 | valid ppl    57.656
----------------------------------------------------------------------------------------------------
| epoch  48 step    11600 |    226 batches | lr 0.000101 | ms/batch 32.64 | loss  3.68 | ppl    39.790
total_loss: 29790.69406890869, total_len: 7360
total_loss: 32737.161643981934, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  58 at step    11600 | time:  6.52s | valid loss  4.05 | valid ppl    57.263
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  49 step    11800 |    184 batches | lr 0.0001 | ms/batch 38.87 | loss  3.67 | ppl    39.253
total_loss: 29757.57942199707, total_len: 7360
total_loss: 32707.57592010498, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  59 at step    11800 | time:  6.57s | valid loss  4.04 | valid ppl    57.006
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  50 step    12000 |    142 batches | lr 9.92e-05 | ms/batch 38.74 | loss  3.66 | ppl    38.910
total_loss: 29682.22688293457, total_len: 7360
total_loss: 32612.583068847656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  60 at step    12000 | time:  6.55s | valid loss  4.03 | valid ppl    56.425
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  51 step    12200 |    100 batches | lr 9.84e-05 | ms/batch 39.56 | loss  3.66 | ppl    38.832
total_loss: 29641.060386657715, total_len: 7360
total_loss: 32567.17343902588, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  61 at step    12200 | time:  6.75s | valid loss  4.03 | valid ppl    56.110
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  52 step    12400 |     58 batches | lr 9.76e-05 | ms/batch 40.39 | loss  3.65 | ppl    38.340
total_loss: 29616.81494140625, total_len: 7360
total_loss: 32545.553024291992, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  62 at step    12400 | time:  7.01s | valid loss  4.02 | valid ppl    55.926
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12600 |     16 batches | lr 9.68e-05 | ms/batch 39.36 | loss  3.62 | ppl    37.503
total_loss: 29580.897102355957, total_len: 7360
total_loss: 32508.718589782715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  63 at step    12600 | time:  6.70s | valid loss  4.02 | valid ppl    55.653
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12800 |    216 batches | lr 9.6e-05 | ms/batch 39.36 | loss  3.61 | ppl    37.075
total_loss: 29544.8755569458, total_len: 7360
total_loss: 32474.147491455078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  64 at step    12800 | time:  6.70s | valid loss  4.01 | valid ppl    55.382
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  54 step    13000 |    174 batches | lr 9.52e-05 | ms/batch 38.93 | loss  3.60 | ppl    36.754
total_loss: 29544.232467651367, total_len: 7360
total_loss: 32447.558868408203, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  65 at step    13000 | time:  6.68s | valid loss  4.01 | valid ppl    55.377
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  55 step    13200 |    132 batches | lr 9.43e-05 | ms/batch 39.02 | loss  3.60 | ppl    36.481
total_loss: 29542.123413085938, total_len: 7360
total_loss: 32452.15267944336, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  66 at step    13200 | time:  6.67s | valid loss  4.01 | valid ppl    55.361
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  56 step    13400 |     90 batches | lr 9.35e-05 | ms/batch 39.10 | loss  3.60 | ppl    36.636
total_loss: 29480.01612854004, total_len: 7360
total_loss: 32389.17485809326, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  67 at step    13400 | time:  6.67s | valid loss  4.01 | valid ppl    54.896
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  57 step    13600 |     48 batches | lr 9.26e-05 | ms/batch 38.56 | loss  3.58 | ppl    35.913
total_loss: 29445.43549346924, total_len: 7360
total_loss: 32347.982330322266, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  68 at step    13600 | time:  6.55s | valid loss  4.00 | valid ppl    54.638
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    13800 |      6 batches | lr 9.17e-05 | ms/batch 38.37 | loss  3.57 | ppl    35.452
total_loss: 29431.859298706055, total_len: 7360
total_loss: 32339.811950683594, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  69 at step    13800 | time:  6.55s | valid loss  4.00 | valid ppl    54.538
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    14000 |    206 batches | lr 9.09e-05 | ms/batch 38.36 | loss  3.56 | ppl    35.063
total_loss: 29388.567497253418, total_len: 7360
total_loss: 32296.912452697754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  70 at step    14000 | time:  6.55s | valid loss  3.99 | valid ppl    54.218
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  59 step    14200 |    164 batches | lr 9e-05 | ms/batch 40.01 | loss  3.55 | ppl    34.820
total_loss: 29382.98907470703, total_len: 7360
total_loss: 32282.981895446777, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  71 at step    14200 | time:  6.89s | valid loss  3.99 | valid ppl    54.177
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  60 step    14400 |    122 batches | lr 8.91e-05 | ms/batch 41.19 | loss  3.54 | ppl    34.630
total_loss: 29419.240524291992, total_len: 7360
total_loss: 32312.00774383545, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  72 at step    14400 | time:  7.08s | valid loss  4.00 | valid ppl    54.444
----------------------------------------------------------------------------------------------------
| epoch  61 step    14600 |     80 batches | lr 8.82e-05 | ms/batch 33.32 | loss  3.55 | ppl    34.934
total_loss: 29363.00193786621, total_len: 7360
total_loss: 32259.673217773438, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  73 at step    14600 | time:  6.67s | valid loss  3.99 | valid ppl    54.030
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    14800 |     38 batches | lr 8.73e-05 | ms/batch 39.07 | loss  3.52 | ppl    33.935
total_loss: 29290.34506225586, total_len: 7360
total_loss: 32183.165519714355, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  74 at step    14800 | time:  6.62s | valid loss  3.98 | valid ppl    53.499
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    15000 |    238 batches | lr 8.64e-05 | ms/batch 38.30 | loss  3.51 | ppl    33.609
total_loss: 29341.92958831787, total_len: 7360
total_loss: 32220.12168121338, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  75 at step    15000 | time:  6.53s | valid loss  3.99 | valid ppl    53.875
----------------------------------------------------------------------------------------------------
| epoch  63 step    15200 |    196 batches | lr 8.55e-05 | ms/batch 32.64 | loss  3.51 | ppl    33.484
total_loss: 29287.40379333496, total_len: 7360
total_loss: 32156.806953430176, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  76 at step    15200 | time:  6.53s | valid loss  3.98 | valid ppl    53.478
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  64 step    15400 |    154 batches | lr 8.46e-05 | ms/batch 38.98 | loss  3.50 | ppl    33.205
total_loss: 29261.86491394043, total_len: 7360
total_loss: 32134.211280822754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  77 at step    15400 | time:  6.66s | valid loss  3.98 | valid ppl    53.293
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  65 step    15600 |    112 batches | lr 8.37e-05 | ms/batch 39.15 | loss  3.50 | ppl    33.186
total_loss: 29266.05210876465, total_len: 7360
total_loss: 32148.96378326416, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  78 at step    15600 | time:  6.67s | valid loss  3.98 | valid ppl    53.323
----------------------------------------------------------------------------------------------------
| epoch  66 step    15800 |     70 batches | lr 8.27e-05 | ms/batch 32.78 | loss  3.50 | ppl    33.201
total_loss: 29258.614181518555, total_len: 7360
total_loss: 32125.97759246826, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  79 at step    15800 | time:  6.56s | valid loss  3.98 | valid ppl    53.269
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16000 |     28 batches | lr 8.18e-05 | ms/batch 39.32 | loss  3.48 | ppl    32.494
total_loss: 29236.666831970215, total_len: 7360
total_loss: 32116.10767364502, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  80 at step    16000 | time:  6.67s | valid loss  3.97 | valid ppl    53.110
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16200 |    228 batches | lr 8.09e-05 | ms/batch 38.37 | loss  3.47 | ppl    32.172
total_loss: 29196.114250183105, total_len: 7360
total_loss: 32052.55567932129, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  81 at step    16200 | time:  6.35s | valid loss  3.97 | valid ppl    52.819
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  68 step    16400 |    186 batches | lr 7.99e-05 | ms/batch 38.05 | loss  3.47 | ppl    32.027
total_loss: 29165.403816223145, total_len: 7360
total_loss: 32022.853813171387, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  82 at step    16400 | time:  6.31s | valid loss  3.96 | valid ppl    52.599
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  69 step    16600 |    144 batches | lr 7.9e-05 | ms/batch 37.25 | loss  3.46 | ppl    31.883
total_loss: 29196.322723388672, total_len: 7360
total_loss: 32034.608489990234, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  83 at step    16600 | time:  6.33s | valid loss  3.97 | valid ppl    52.820
----------------------------------------------------------------------------------------------------
| epoch  70 step    16800 |    102 batches | lr 7.8e-05 | ms/batch 31.50 | loss  3.47 | ppl    32.008
total_loss: 29164.255798339844, total_len: 7360
total_loss: 32010.35073852539, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  84 at step    16800 | time:  6.30s | valid loss  3.96 | valid ppl    52.590
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  71 step    17000 |     60 batches | lr 7.71e-05 | ms/batch 37.33 | loss  3.46 | ppl    31.751
total_loss: 29127.369270324707, total_len: 7360
total_loss: 31989.01188659668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  85 at step    17000 | time:  6.33s | valid loss  3.96 | valid ppl    52.328
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17200 |     18 batches | lr 7.61e-05 | ms/batch 37.48 | loss  3.44 | ppl    31.201
total_loss: 29113.516830444336, total_len: 7360
total_loss: 31961.90803527832, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  86 at step    17200 | time:  7.28s | valid loss  3.96 | valid ppl    52.229
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17400 |    218 batches | lr 7.52e-05 | ms/batch 37.17 | loss  3.44 | ppl    31.091
total_loss: 29100.30940246582, total_len: 7360
total_loss: 31951.433448791504, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  87 at step    17400 | time:  6.34s | valid loss  3.95 | valid ppl    52.136
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  73 step    17600 |    176 batches | lr 7.42e-05 | ms/batch 37.73 | loss  3.43 | ppl    30.828
total_loss: 29130.417846679688, total_len: 7360
total_loss: 31978.965522766113, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  88 at step    17600 | time:  6.35s | valid loss  3.96 | valid ppl    52.349
----------------------------------------------------------------------------------------------------
| epoch  74 step    17800 |    134 batches | lr 7.32e-05 | ms/batch 31.62 | loss  3.43 | ppl    30.739
total_loss: 29135.94019317627, total_len: 7360
total_loss: 31989.185165405273, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  89 at step    17800 | time:  6.32s | valid loss  3.96 | valid ppl    52.389
----------------------------------------------------------------------------------------------------
| epoch  75 step    18000 |     92 batches | lr 7.23e-05 | ms/batch 31.64 | loss  3.43 | ppl    31.021
total_loss: 29096.685287475586, total_len: 7360
total_loss: 31942.621536254883, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  90 at step    18000 | time:  6.30s | valid loss  3.95 | valid ppl    52.110
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  76 step    18200 |     50 batches | lr 7.13e-05 | ms/batch 37.12 | loss  3.42 | ppl    30.572
total_loss: 29072.341621398926, total_len: 7360
total_loss: 31896.909072875977, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  91 at step    18200 | time:  6.34s | valid loss  3.95 | valid ppl    51.938
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  77 step    18400 |      8 batches | lr 7.03e-05 | ms/batch 36.71 | loss  3.41 | ppl    30.197
total_loss: 29090.26261138916, total_len: 7360
total_loss: 31909.16293334961, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  92 at step    18400 | time:  6.33s | valid loss  3.95 | valid ppl    52.064
----------------------------------------------------------------------------------------------------
| epoch  77 step    18600 |    208 batches | lr 6.94e-05 | ms/batch 31.53 | loss  3.40 | ppl    30.056
total_loss: 29048.01259613037, total_len: 7360
total_loss: 31873.77045440674, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  93 at step    18600 | time:  6.30s | valid loss  3.95 | valid ppl    51.766
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  78 step    18800 |    166 batches | lr 6.84e-05 | ms/batch 37.20 | loss  3.40 | ppl    29.937
total_loss: 29023.0731048584, total_len: 7360
total_loss: 31844.572395324707, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  94 at step    18800 | time:  6.34s | valid loss  3.94 | valid ppl    51.591
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  79 step    19000 |    124 batches | lr 6.74e-05 | ms/batch 37.37 | loss  3.40 | ppl    29.897
total_loss: 29130.5087890625, total_len: 7360
total_loss: 31959.95648956299, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  95 at step    19000 | time:  6.32s | valid loss  3.96 | valid ppl    52.350
----------------------------------------------------------------------------------------------------
| epoch  80 step    19200 |     82 batches | lr 6.64e-05 | ms/batch 31.77 | loss  3.41 | ppl    30.217
total_loss: 29038.546211242676, total_len: 7360
total_loss: 31849.139945983887, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  96 at step    19200 | time:  6.36s | valid loss  3.95 | valid ppl    51.700
----------------------------------------------------------------------------------------------------
| epoch  81 step    19400 |     40 batches | lr 6.54e-05 | ms/batch 31.74 | loss  3.39 | ppl    29.530
total_loss: 29016.0379486084, total_len: 7360
total_loss: 31826.205307006836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  97 at step    19400 | time:  6.36s | valid loss  3.94 | valid ppl    51.542
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19600 |    240 batches | lr 6.45e-05 | ms/batch 37.54 | loss  3.38 | ppl    29.294
total_loss: 29075.77574157715, total_len: 7360
total_loss: 31876.738403320312, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  98 at step    19600 | time:  6.36s | valid loss  3.95 | valid ppl    51.962
----------------------------------------------------------------------------------------------------
| epoch  82 step    19800 |    198 batches | lr 6.35e-05 | ms/batch 31.68 | loss  3.37 | ppl    29.193
total_loss: 29034.858268737793, total_len: 7360
total_loss: 31852.064346313477, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  99 at step    19800 | time:  6.33s | valid loss  3.94 | valid ppl    51.674
----------------------------------------------------------------------------------------------------
| epoch  83 step    20000 |    156 batches | lr 6.25e-05 | ms/batch 31.61 | loss  3.37 | ppl    29.118
total_loss: 29028.637245178223, total_len: 7360
total_loss: 31837.7056350708, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 100 at step    20000 | time:  6.32s | valid loss  3.94 | valid ppl    51.630
----------------------------------------------------------------------------------------------------
| epoch  84 step    20200 |    114 batches | lr 6.15e-05 | ms/batch 31.66 | loss  3.37 | ppl    29.138
total_loss: 29057.694480895996, total_len: 7360
total_loss: 31865.406372070312, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 101 at step    20200 | time:  6.32s | valid loss  3.95 | valid ppl    51.835
----------------------------------------------------------------------------------------------------
| epoch  85 step    20400 |     72 batches | lr 6.05e-05 | ms/batch 31.71 | loss  3.38 | ppl    29.345
total_loss: 29024.50506591797, total_len: 7360
total_loss: 31830.549682617188, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 102 at step    20400 | time:  6.34s | valid loss  3.94 | valid ppl    51.601
----------------------------------------------------------------------------------------------------
| epoch  86 step    20600 |     30 batches | lr 5.96e-05 | ms/batch 31.56 | loss  3.36 | ppl    28.699
total_loss: 28998.22834777832, total_len: 7360
total_loss: 31804.55989074707, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 103 at step    20600 | time:  6.32s | valid loss  3.94 | valid ppl    51.417
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  86 step    20800 |    230 batches | lr 5.86e-05 | ms/batch 37.06 | loss  3.35 | ppl    28.618
total_loss: 28977.09162902832, total_len: 7360
total_loss: 31776.825225830078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 104 at step    20800 | time:  6.37s | valid loss  3.94 | valid ppl    51.270
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  87 step    21000 |    188 batches | lr 5.76e-05 | ms/batch 37.76 | loss  3.35 | ppl    28.519
total_loss: 29005.377899169922, total_len: 7360
total_loss: 31818.06615447998, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 105 at step    21000 | time:  6.37s | valid loss  3.94 | valid ppl    51.467
----------------------------------------------------------------------------------------------------
| epoch  88 step    21200 |    146 batches | lr 5.66e-05 | ms/batch 31.57 | loss  3.35 | ppl    28.454
total_loss: 28990.600555419922, total_len: 7360
total_loss: 31778.797203063965, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 106 at step    21200 | time:  6.32s | valid loss  3.94 | valid ppl    51.364
----------------------------------------------------------------------------------------------------
| epoch  89 step    21400 |    104 batches | lr 5.56e-05 | ms/batch 31.58 | loss  3.35 | ppl    28.557
total_loss: 28939.47176361084, total_len: 7360
total_loss: 31742.600204467773, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 107 at step    21400 | time:  6.31s | valid loss  3.93 | valid ppl    51.009
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  90 step    21600 |     62 batches | lr 5.47e-05 | ms/batch 37.62 | loss  3.35 | ppl    28.508
total_loss: 28961.235748291016, total_len: 7360
total_loss: 31757.768241882324, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 108 at step    21600 | time:  6.36s | valid loss  3.93 | valid ppl    51.160
----------------------------------------------------------------------------------------------------
| epoch  91 step    21800 |     20 batches | lr 5.37e-05 | ms/batch 31.74 | loss  3.34 | ppl    28.102
total_loss: 28933.862747192383, total_len: 7360
total_loss: 31724.063354492188, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 109 at step    21800 | time:  6.35s | valid loss  3.93 | valid ppl    50.970
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  91 step    22000 |    220 batches | lr 5.27e-05 | ms/batch 37.08 | loss  3.33 | ppl    27.978
total_loss: 28919.231407165527, total_len: 7360
total_loss: 31707.427627563477, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 110 at step    22000 | time:  6.36s | valid loss  3.93 | valid ppl    50.868
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  92 step    22200 |    178 batches | lr 5.18e-05 | ms/batch 37.41 | loss  3.32 | ppl    27.787
total_loss: 28960.650413513184, total_len: 7360
total_loss: 31742.789154052734, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 111 at step    22200 | time:  6.35s | valid loss  3.93 | valid ppl    51.156
----------------------------------------------------------------------------------------------------
| epoch  93 step    22400 |    136 batches | lr 5.08e-05 | ms/batch 31.63 | loss  3.33 | ppl    27.811
total_loss: 29007.808616638184, total_len: 7360
total_loss: 31780.114868164062, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 112 at step    22400 | time:  6.33s | valid loss  3.94 | valid ppl    51.484
----------------------------------------------------------------------------------------------------
| epoch  94 step    22600 |     94 batches | lr 4.98e-05 | ms/batch 31.56 | loss  3.34 | ppl    28.133
total_loss: 28924.083839416504, total_len: 7360
total_loss: 31705.758262634277, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 113 at step    22600 | time:  6.30s | valid loss  3.93 | valid ppl    50.902
----------------------------------------------------------------------------------------------------
| epoch  95 step    22800 |     52 batches | lr 4.89e-05 | ms/batch 31.59 | loss  3.32 | ppl    27.700
total_loss: 28921.45053100586, total_len: 7360
total_loss: 31704.035011291504, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 114 at step    22800 | time:  6.33s | valid loss  3.93 | valid ppl    50.884
----------------------------------------------------------------------------------------------------
| epoch  96 step    23000 |     10 batches | lr 4.79e-05 | ms/batch 31.64 | loss  3.32 | ppl    27.529
total_loss: 28902.839958190918, total_len: 7360
total_loss: 31686.561836242676, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 115 at step    23000 | time:  6.33s | valid loss  3.93 | valid ppl    50.755
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  96 step    23200 |    210 batches | lr 4.7e-05 | ms/batch 37.39 | loss  3.31 | ppl    27.395
total_loss: 28924.37648010254, total_len: 7360
total_loss: 31719.272972106934, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 116 at step    23200 | time:  6.35s | valid loss  3.93 | valid ppl    50.904
----------------------------------------------------------------------------------------------------
| epoch  97 step    23400 |    168 batches | lr 4.6e-05 | ms/batch 31.64 | loss  3.30 | ppl    27.244
total_loss: 28869.57176208496, total_len: 7360
total_loss: 31645.769203186035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 117 at step    23400 | time:  6.33s | valid loss  3.92 | valid ppl    50.526
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  98 step    23600 |    126 batches | lr 4.51e-05 | ms/batch 36.92 | loss  3.31 | ppl    27.274
total_loss: 28911.288513183594, total_len: 7360
total_loss: 31686.83758544922, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 118 at step    23600 | time:  6.36s | valid loss  3.93 | valid ppl    50.814
----------------------------------------------------------------------------------------------------
| epoch  99 step    23800 |     84 batches | lr 4.41e-05 | ms/batch 31.67 | loss  3.32 | ppl    27.658
total_loss: 28853.139808654785, total_len: 7360
total_loss: 31629.77175140381, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 119 at step    23800 | time:  6.34s | valid loss  3.92 | valid ppl    50.414
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 100 step    24000 |     42 batches | lr 4.32e-05 | ms/batch 37.49 | loss  3.30 | ppl    27.199
total_loss: 28885.469985961914, total_len: 7360
total_loss: 31651.35391998291, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 120 at step    24000 | time:  6.37s | valid loss  3.92 | valid ppl    50.636
----------------------------------------------------------------------------------------------------
| epoch 100 step    24200 |    242 batches | lr 4.23e-05 | ms/batch 31.67 | loss  3.30 | ppl    26.999
total_loss: 28912.412910461426, total_len: 7360
total_loss: 31684.117057800293, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 121 at step    24200 | time:  6.34s | valid loss  3.93 | valid ppl    50.821
----------------------------------------------------------------------------------------------------
| epoch 101 step    24400 |    200 batches | lr 4.13e-05 | ms/batch 31.67 | loss  3.29 | ppl    26.877
total_loss: 28879.450653076172, total_len: 7360
total_loss: 31654.90554046631, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 122 at step    24400 | time:  6.32s | valid loss  3.92 | valid ppl    50.594
----------------------------------------------------------------------------------------------------
| epoch 102 step    24600 |    158 batches | lr 4.04e-05 | ms/batch 31.77 | loss  3.29 | ppl    26.848
total_loss: 28884.802505493164, total_len: 7360
total_loss: 31659.79866027832, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 123 at step    24600 | time:  6.35s | valid loss  3.92 | valid ppl    50.631
----------------------------------------------------------------------------------------------------
| epoch 103 step    24800 |    116 batches | lr 3.95e-05 | ms/batch 31.01 | loss  3.29 | ppl    26.961
total_loss: 28919.85772705078, total_len: 7360
total_loss: 31690.943420410156, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 124 at step    24800 | time:  6.18s | valid loss  3.93 | valid ppl    50.873
----------------------------------------------------------------------------------------------------
| epoch 104 step    25000 |     74 batches | lr 3.86e-05 | ms/batch 31.04 | loss  3.30 | ppl    27.132
total_loss: 28863.985542297363, total_len: 7360
total_loss: 31639.52614593506, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 125 at step    25000 | time:  6.29s | valid loss  3.92 | valid ppl    50.488
----------------------------------------------------------------------------------------------------
| epoch 105 step    25200 |     32 batches | lr 3.77e-05 | ms/batch 32.08 | loss  3.28 | ppl    26.672
total_loss: 28851.333084106445, total_len: 7360
total_loss: 31625.100326538086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 126 at step    25200 | time:  6.69s | valid loss  3.92 | valid ppl    50.401
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 105 step    25400 |    232 batches | lr 3.68e-05 | ms/batch 40.41 | loss  3.28 | ppl    26.472
total_loss: 28867.059700012207, total_len: 7360
total_loss: 31641.54554748535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 127 at step    25400 | time:  6.58s | valid loss  3.92 | valid ppl    50.509
----------------------------------------------------------------------------------------------------
| epoch 106 step    25600 |    190 batches | lr 3.59e-05 | ms/batch 31.64 | loss  3.28 | ppl    26.469
total_loss: 28880.863708496094, total_len: 7360
total_loss: 31649.456100463867, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 128 at step    25600 | time:  6.33s | valid loss  3.92 | valid ppl    50.604
----------------------------------------------------------------------------------------------------
| epoch 107 step    25800 |    148 batches | lr 3.5e-05 | ms/batch 31.61 | loss  3.28 | ppl    26.451
total_loss: 28851.686683654785, total_len: 7360
total_loss: 31608.52635192871, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 129 at step    25800 | time:  6.29s | valid loss  3.92 | valid ppl    50.404
----------------------------------------------------------------------------------------------------
| epoch 108 step    26000 |    106 batches | lr 3.41e-05 | ms/batch 31.38 | loss  3.29 | ppl    26.727
total_loss: 28848.734214782715, total_len: 7360
total_loss: 31618.125549316406, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 130 at step    26000 | time:  6.27s | valid loss  3.92 | valid ppl    50.384
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 109 step    26200 |     64 batches | lr 3.33e-05 | ms/batch 37.08 | loss  3.28 | ppl    26.600
total_loss: 28831.451126098633, total_len: 7360
total_loss: 31591.033798217773, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 131 at step    26200 | time:  7.67s | valid loss  3.92 | valid ppl    50.265
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 110 step    26400 |     22 batches | lr 3.24e-05 | ms/batch 43.66 | loss  3.27 | ppl    26.242
total_loss: 28861.679931640625, total_len: 7360
total_loss: 31620.434600830078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 132 at step    26400 | time:  6.22s | valid loss  3.92 | valid ppl    50.472
----------------------------------------------------------------------------------------------------
| epoch 110 step    26600 |    222 batches | lr 3.15e-05 | ms/batch 30.62 | loss  3.27 | ppl    26.214
total_loss: 28853.40224456787, total_len: 7360
total_loss: 31622.93116760254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 133 at step    26600 | time:  6.11s | valid loss  3.92 | valid ppl    50.416
----------------------------------------------------------------------------------------------------
| epoch 111 step    26800 |    180 batches | lr 3.07e-05 | ms/batch 30.41 | loss  3.26 | ppl    26.070
total_loss: 28853.861045837402, total_len: 7360
total_loss: 31613.648651123047, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 134 at step    26800 | time:  6.07s | valid loss  3.92 | valid ppl    50.419
----------------------------------------------------------------------------------------------------
| epoch 112 step    27000 |    138 batches | lr 2.98e-05 | ms/batch 30.44 | loss  3.27 | ppl    26.230
total_loss: 28859.189361572266, total_len: 7360
total_loss: 31615.058708190918, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 135 at step    27000 | time:  6.08s | valid loss  3.92 | valid ppl    50.455
----------------------------------------------------------------------------------------------------
| epoch 113 step    27200 |     96 batches | lr 2.9e-05 | ms/batch 30.38 | loss  3.28 | ppl    26.490
total_loss: 28834.828186035156, total_len: 7360
total_loss: 31594.513473510742, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 136 at step    27200 | time:  6.08s | valid loss  3.92 | valid ppl    50.288
----------------------------------------------------------------------------------------------------
| epoch 114 step    27400 |     54 batches | lr 2.82e-05 | ms/batch 30.43 | loss  3.26 | ppl    26.106
total_loss: 28851.56169128418, total_len: 7360
total_loss: 31627.01052093506, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 137 at step    27400 | time:  6.09s | valid loss  3.92 | valid ppl    50.403
----------------------------------------------------------------------------------------------------
| epoch 115 step    27600 |     12 batches | lr 2.74e-05 | ms/batch 30.49 | loss  3.26 | ppl    25.940
total_loss: 28817.844635009766, total_len: 7360
total_loss: 31573.158279418945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 138 at step    27600 | time:  6.10s | valid loss  3.92 | valid ppl    50.173
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 115 step    27800 |    212 batches | lr 2.66e-05 | ms/batch 36.27 | loss  3.26 | ppl    25.953
total_loss: 28799.944702148438, total_len: 7360
total_loss: 31558.014755249023, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 139 at step    27800 | time:  6.13s | valid loss  3.91 | valid ppl    50.051
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 116 step    28000 |    170 batches | lr 2.58e-05 | ms/batch 36.51 | loss  3.25 | ppl    25.786
total_loss: 28811.100105285645, total_len: 7360
total_loss: 31581.83041381836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 140 at step    28000 | time:  6.12s | valid loss  3.91 | valid ppl    50.127
----------------------------------------------------------------------------------------------------
| epoch 117 step    28200 |    128 batches | lr 2.5e-05 | ms/batch 30.52 | loss  3.25 | ppl    25.869
total_loss: 28854.05958557129, total_len: 7360
total_loss: 31618.861694335938, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 141 at step    28200 | time:  6.10s | valid loss  3.92 | valid ppl    50.420
----------------------------------------------------------------------------------------------------
| epoch 118 step    28400 |     86 batches | lr 2.42e-05 | ms/batch 30.49 | loss  3.27 | ppl    26.197
total_loss: 28807.54574584961, total_len: 7360
total_loss: 31562.681602478027, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 142 at step    28400 | time:  6.10s | valid loss  3.91 | valid ppl    50.102
----------------------------------------------------------------------------------------------------
| epoch 119 step    28600 |     44 batches | lr 2.34e-05 | ms/batch 30.43 | loss  3.25 | ppl    25.756
total_loss: 28841.44416809082, total_len: 7360
total_loss: 31607.728469848633, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 143 at step    28600 | time:  6.08s | valid loss  3.92 | valid ppl    50.334
----------------------------------------------------------------------------------------------------
| epoch 120 step    28800 |      2 batches | lr 2.27e-05 | ms/batch 30.52 | loss  3.25 | ppl    25.664
total_loss: 28818.832885742188, total_len: 7360
total_loss: 31572.604888916016, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 144 at step    28800 | time:  6.09s | valid loss  3.92 | valid ppl    50.179
----------------------------------------------------------------------------------------------------
| epoch 120 step    29000 |    202 batches | lr 2.19e-05 | ms/batch 30.48 | loss  3.24 | ppl    25.642
total_loss: 28827.3565826416, total_len: 7360
total_loss: 31571.920806884766, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 145 at step    29000 | time:  6.10s | valid loss  3.92 | valid ppl    50.237
----------------------------------------------------------------------------------------------------
| epoch 121 step    29200 |    160 batches | lr 2.12e-05 | ms/batch 30.48 | loss  3.24 | ppl    25.627
total_loss: 28840.636726379395, total_len: 7360
total_loss: 31588.10799407959, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 146 at step    29200 | time:  6.09s | valid loss  3.92 | valid ppl    50.328
----------------------------------------------------------------------------------------------------
| epoch 122 step    29400 |    118 batches | lr 2.04e-05 | ms/batch 30.46 | loss  3.25 | ppl    25.712
total_loss: 28845.27484893799, total_len: 7360
total_loss: 31600.333137512207, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 147 at step    29400 | time:  6.09s | valid loss  3.92 | valid ppl    50.360
----------------------------------------------------------------------------------------------------
| epoch 123 step    29600 |     76 batches | lr 1.97e-05 | ms/batch 30.40 | loss  3.26 | ppl    26.030
total_loss: 28832.461097717285, total_len: 7360
total_loss: 31591.549102783203, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 148 at step    29600 | time:  6.09s | valid loss  3.92 | valid ppl    50.272
----------------------------------------------------------------------------------------------------
| epoch 124 step    29800 |     34 batches | lr 1.9e-05 | ms/batch 30.58 | loss  3.24 | ppl    25.511
total_loss: 28816.124229431152, total_len: 7360
total_loss: 31561.83851623535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 149 at step    29800 | time:  6.12s | valid loss  3.92 | valid ppl    50.161
----------------------------------------------------------------------------------------------------
| epoch 124 step    30000 |    234 batches | lr 1.83e-05 | ms/batch 30.56 | loss  3.23 | ppl    25.396
total_loss: 28798.890434265137, total_len: 7360
total_loss: 31553.15668487549, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 150 at step    30000 | time:  6.12s | valid loss  3.91 | valid ppl    50.044
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 125 step    30200 |    192 batches | lr 1.76e-05 | ms/batch 36.68 | loss  3.24 | ppl    25.468
total_loss: 28789.132873535156, total_len: 7360
total_loss: 31547.07598876953, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 151 at step    30200 | time:  6.14s | valid loss  3.91 | valid ppl    49.977
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 126 step    30400 |    150 batches | lr 1.69e-05 | ms/batch 38.03 | loss  3.24 | ppl    25.420
total_loss: 28817.305633544922, total_len: 7360
total_loss: 31573.19309234619, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 152 at step    30400 | time:  6.39s | valid loss  3.92 | valid ppl    50.169
----------------------------------------------------------------------------------------------------
| epoch 127 step    30600 |    108 batches | lr 1.63e-05 | ms/batch 31.64 | loss  3.24 | ppl    25.617
total_loss: 28810.4594039917, total_len: 7360
total_loss: 31563.815879821777, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 153 at step    30600 | time:  6.34s | valid loss  3.91 | valid ppl    50.122
----------------------------------------------------------------------------------------------------
| epoch 128 step    30800 |     66 batches | lr 1.56e-05 | ms/batch 31.75 | loss  3.24 | ppl    25.621
total_loss: 28801.447814941406, total_len: 7360
total_loss: 31549.970901489258, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 154 at step    30800 | time:  6.34s | valid loss  3.91 | valid ppl    50.061
----------------------------------------------------------------------------------------------------
| epoch 129 step    31000 |     24 batches | lr 1.5e-05 | ms/batch 31.70 | loss  3.23 | ppl    25.276
total_loss: 28792.136810302734, total_len: 7360
total_loss: 31541.920722961426, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 155 at step    31000 | time:  6.33s | valid loss  3.91 | valid ppl    49.998
----------------------------------------------------------------------------------------------------
| epoch 129 step    31200 |    224 batches | lr 1.43e-05 | ms/batch 31.57 | loss  3.23 | ppl    25.255
total_loss: 28820.292182922363, total_len: 7360
total_loss: 31570.81036376953, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 156 at step    31200 | time:  6.32s | valid loss  3.92 | valid ppl    50.189
----------------------------------------------------------------------------------------------------
| epoch 130 step    31400 |    182 batches | lr 1.37e-05 | ms/batch 31.58 | loss  3.22 | ppl    25.123
total_loss: 28796.935928344727, total_len: 7360
total_loss: 31549.42852783203, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 157 at step    31400 | time:  6.30s | valid loss  3.91 | valid ppl    50.030
----------------------------------------------------------------------------------------------------
| epoch 131 step    31600 |    140 batches | lr 1.31e-05 | ms/batch 31.65 | loss  3.23 | ppl    25.292
total_loss: 28812.845260620117, total_len: 7360
total_loss: 31567.58790588379, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 158 at step    31600 | time:  6.34s | valid loss  3.91 | valid ppl    50.138
----------------------------------------------------------------------------------------------------
| epoch 132 step    31800 |     98 batches | lr 1.25e-05 | ms/batch 31.74 | loss  3.24 | ppl    25.497
total_loss: 28812.80672454834, total_len: 7360
total_loss: 31570.317558288574, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 159 at step    31800 | time:  6.34s | valid loss  3.91 | valid ppl    50.138
----------------------------------------------------------------------------------------------------
| epoch 133 step    32000 |     56 batches | lr 1.19e-05 | ms/batch 31.66 | loss  3.23 | ppl    25.394
total_loss: 28783.611305236816, total_len: 7360
total_loss: 31533.247230529785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 160 at step    32000 | time:  6.33s | valid loss  3.91 | valid ppl    49.940
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 134 step    32200 |     14 batches | lr 1.14e-05 | ms/batch 37.18 | loss  3.22 | ppl    25.111
total_loss: 28794.063766479492, total_len: 7360
total_loss: 31541.976524353027, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 161 at step    32200 | time:  6.32s | valid loss  3.91 | valid ppl    50.011
----------------------------------------------------------------------------------------------------
| epoch 134 step    32400 |    214 batches | lr 1.08e-05 | ms/batch 31.47 | loss  3.22 | ppl    25.112
total_loss: 28781.561836242676, total_len: 7360
total_loss: 31527.88759613037, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 162 at step    32400 | time:  6.30s | valid loss  3.91 | valid ppl    49.926
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 135 step    32600 |    172 batches | lr 1.03e-05 | ms/batch 36.91 | loss  3.22 | ppl    25.023
total_loss: 28782.2491607666, total_len: 7360
total_loss: 31525.254753112793, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 163 at step    32600 | time:  6.33s | valid loss  3.91 | valid ppl    49.930
----------------------------------------------------------------------------------------------------
| epoch 136 step    32800 |    130 batches | lr 9.73e-06 | ms/batch 31.57 | loss  3.22 | ppl    25.105
total_loss: 28823.41216278076, total_len: 7360
total_loss: 31571.64525604248, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 164 at step    32800 | time:  6.31s | valid loss  3.92 | valid ppl    50.211
----------------------------------------------------------------------------------------------------
| epoch 137 step    33000 |     88 batches | lr 9.21e-06 | ms/batch 31.45 | loss  3.24 | ppl    25.489
total_loss: 28796.51821899414, total_len: 7360
total_loss: 31539.098823547363, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 165 at step    33000 | time:  6.27s | valid loss  3.91 | valid ppl    50.027
----------------------------------------------------------------------------------------------------
| epoch 138 step    33200 |     46 batches | lr 8.7e-06 | ms/batch 30.54 | loss  3.23 | ppl    25.158
total_loss: 28797.83829498291, total_len: 7360
total_loss: 31539.742385864258, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 166 at step    33200 | time:  6.09s | valid loss  3.91 | valid ppl    50.036
----------------------------------------------------------------------------------------------------
| epoch 139 step    33400 |      4 batches | lr 8.21e-06 | ms/batch 30.45 | loss  3.22 | ppl    24.963
total_loss: 28791.002197265625, total_len: 7360
total_loss: 31536.766090393066, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 167 at step    33400 | time:  6.10s | valid loss  3.91 | valid ppl    49.990
----------------------------------------------------------------------------------------------------
| epoch 139 step    33600 |    204 batches | lr 7.73e-06 | ms/batch 30.51 | loss  3.22 | ppl    24.948
total_loss: 28797.01580810547, total_len: 7360
total_loss: 31543.71262359619, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 168 at step    33600 | time:  6.09s | valid loss  3.91 | valid ppl    50.031
----------------------------------------------------------------------------------------------------
| epoch 140 step    33800 |    162 batches | lr 7.26e-06 | ms/batch 30.54 | loss  3.22 | ppl    24.985
total_loss: 28806.83967590332, total_len: 7360
total_loss: 31549.312545776367, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 169 at step    33800 | time:  6.11s | valid loss  3.91 | valid ppl    50.098
----------------------------------------------------------------------------------------------------
| epoch 141 step    34000 |    120 batches | lr 6.81e-06 | ms/batch 30.56 | loss  3.22 | ppl    24.995
total_loss: 28781.78077697754, total_len: 7360
total_loss: 31523.93172454834, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 170 at step    34000 | time:  6.11s | valid loss  3.91 | valid ppl    49.927
----------------------------------------------------------------------------------------------------
| epoch 142 step    34200 |     78 batches | lr 6.37e-06 | ms/batch 30.45 | loss  3.24 | ppl    25.493
total_loss: 28785.82624053955, total_len: 7360
total_loss: 31528.469108581543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 171 at step    34200 | time:  6.09s | valid loss  3.91 | valid ppl    49.955
----------------------------------------------------------------------------------------------------
| epoch 143 step    34400 |     36 batches | lr 5.95e-06 | ms/batch 30.51 | loss  3.22 | ppl    24.945
total_loss: 28781.591873168945, total_len: 7360
total_loss: 31520.46050262451, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 172 at step    34400 | time:  6.10s | valid loss  3.91 | valid ppl    49.926
----------------------------------------------------------------------------------------------------
| epoch 143 step    34600 |    236 batches | lr 5.54e-06 | ms/batch 30.48 | loss  3.21 | ppl    24.856
total_loss: 28797.156730651855, total_len: 7360
total_loss: 31538.308837890625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 173 at step    34600 | time:  6.10s | valid loss  3.91 | valid ppl    50.032
----------------------------------------------------------------------------------------------------
| epoch 144 step    34800 |    194 batches | lr 5.14e-06 | ms/batch 30.57 | loss  3.22 | ppl    24.937
total_loss: 28776.249740600586, total_len: 7360
total_loss: 31516.314346313477, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 174 at step    34800 | time:  6.11s | valid loss  3.91 | valid ppl    49.890
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 145 step    35000 |    152 batches | lr 4.76e-06 | ms/batch 36.39 | loss  3.21 | ppl    24.870
total_loss: 28787.67845916748, total_len: 7360
total_loss: 31526.905448913574, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 175 at step    35000 | time:  6.14s | valid loss  3.91 | valid ppl    49.967
----------------------------------------------------------------------------------------------------
| epoch 146 step    35200 |    110 batches | lr 4.39e-06 | ms/batch 30.52 | loss  3.22 | ppl    25.115
total_loss: 28776.312545776367, total_len: 7360
total_loss: 31517.024978637695, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 176 at step    35200 | time:  6.09s | valid loss  3.91 | valid ppl    49.890
----------------------------------------------------------------------------------------------------
| epoch 147 step    35400 |     68 batches | lr 4.03e-06 | ms/batch 30.46 | loss  3.23 | ppl    25.294
total_loss: 28778.018600463867, total_len: 7360
total_loss: 31517.627502441406, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 177 at step    35400 | time:  6.09s | valid loss  3.91 | valid ppl    49.902
----------------------------------------------------------------------------------------------------
| epoch 148 step    35600 |     26 batches | lr 3.69e-06 | ms/batch 30.50 | loss  3.21 | ppl    24.883
total_loss: 28780.8023147583, total_len: 7360
total_loss: 31522.272583007812, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 178 at step    35600 | time:  6.10s | valid loss  3.91 | valid ppl    49.921
----------------------------------------------------------------------------------------------------
| epoch 148 step    35800 |    226 batches | lr 3.37e-06 | ms/batch 30.55 | loss  3.21 | ppl    24.818
total_loss: 28780.33982849121, total_len: 7360
total_loss: 31519.091484069824, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 179 at step    35800 | time:  7.47s | valid loss  3.91 | valid ppl    49.918
----------------------------------------------------------------------------------------------------
| epoch 149 step    36000 |    184 batches | lr 3.06e-06 | ms/batch 37.33 | loss  3.21 | ppl    24.703
total_loss: 28779.939819335938, total_len: 7360
total_loss: 31520.508819580078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 180 at step    36000 | time:  6.09s | valid loss  3.91 | valid ppl    49.915
----------------------------------------------------------------------------------------------------
| epoch 150 step    36200 |    142 batches | lr 2.76e-06 | ms/batch 30.39 | loss  3.21 | ppl    24.882
total_loss: 28780.791107177734, total_len: 7360
total_loss: 31522.72841644287, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 181 at step    36200 | time:  6.07s | valid loss  3.91 | valid ppl    49.921
----------------------------------------------------------------------------------------------------
| epoch 151 step    36400 |    100 batches | lr 2.48e-06 | ms/batch 30.43 | loss  3.23 | ppl    25.162
total_loss: 28780.477081298828, total_len: 7360
total_loss: 31520.51434326172, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 182 at step    36400 | time:  6.10s | valid loss  3.91 | valid ppl    49.918
----------------------------------------------------------------------------------------------------
| epoch 152 step    36600 |     58 batches | lr 2.22e-06 | ms/batch 30.54 | loss  3.22 | ppl    25.046
total_loss: 28776.438446044922, total_len: 7360
total_loss: 31516.60590362549, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 183 at step    36600 | time:  6.09s | valid loss  3.91 | valid ppl    49.891
----------------------------------------------------------------------------------------------------
| epoch 153 step    36800 |     16 batches | lr 1.96e-06 | ms/batch 30.49 | loss  3.21 | ppl    24.807
total_loss: 28777.491554260254, total_len: 7360
total_loss: 31518.337882995605, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 184 at step    36800 | time:  6.11s | valid loss  3.91 | valid ppl    49.898
----------------------------------------------------------------------------------------------------
| epoch 153 step    37000 |    216 batches | lr 1.73e-06 | ms/batch 30.52 | loss  3.21 | ppl    24.809
total_loss: 28779.00873565674, total_len: 7360
total_loss: 31522.013694763184, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 185 at step    37000 | time:  6.10s | valid loss  3.91 | valid ppl    49.909
----------------------------------------------------------------------------------------------------
| epoch 154 step    37200 |    174 batches | lr 1.51e-06 | ms/batch 30.47 | loss  3.21 | ppl    24.742
total_loss: 28780.561408996582, total_len: 7360
total_loss: 31523.094619750977, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 186 at step    37200 | time:  6.09s | valid loss  3.91 | valid ppl    49.919
----------------------------------------------------------------------------------------------------
| epoch 155 step    37400 |    132 batches | lr 1.3e-06 | ms/batch 30.50 | loss  3.21 | ppl    24.871
total_loss: 28781.086837768555, total_len: 7360
total_loss: 31524.29119873047, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 187 at step    37400 | time:  6.10s | valid loss  3.91 | valid ppl    49.923
----------------------------------------------------------------------------------------------------
| epoch 156 step    37600 |     90 batches | lr 1.11e-06 | ms/batch 30.55 | loss  3.23 | ppl    25.217
total_loss: 28772.73052215576, total_len: 7360
total_loss: 31512.329864501953, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 188 at step    37600 | time:  6.10s | valid loss  3.91 | valid ppl    49.866
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 157 step    37800 |     48 batches | lr 9.31e-07 | ms/batch 37.77 | loss  3.22 | ppl    24.950
total_loss: 28775.982315063477, total_len: 7360
total_loss: 31517.18647003174, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 189 at step    37800 | time:  6.38s | valid loss  3.91 | valid ppl    49.888
----------------------------------------------------------------------------------------------------
| epoch 158 step    38000 |      6 batches | lr 7.69e-07 | ms/batch 31.06 | loss  3.21 | ppl    24.742
total_loss: 28778.09780883789, total_len: 7360
total_loss: 31518.902053833008, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 190 at step    38000 | time:  6.18s | valid loss  3.91 | valid ppl    49.902
----------------------------------------------------------------------------------------------------
| epoch 158 step    38200 |    206 batches | lr 6.24e-07 | ms/batch 30.54 | loss  3.21 | ppl    24.734
total_loss: 28775.93601989746, total_len: 7360
total_loss: 31516.380531311035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 191 at step    38200 | time:  6.11s | valid loss  3.91 | valid ppl    49.888
----------------------------------------------------------------------------------------------------
| epoch 159 step    38400 |    164 batches | lr 4.93e-07 | ms/batch 30.56 | loss  3.21 | ppl    24.781
total_loss: 28778.014350891113, total_len: 7360
total_loss: 31519.00961303711, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 192 at step    38400 | time:  6.13s | valid loss  3.91 | valid ppl    49.902
----------------------------------------------------------------------------------------------------
| epoch 160 step    38600 |    122 batches | lr 3.77e-07 | ms/batch 30.71 | loss  3.21 | ppl    24.863
total_loss: 28779.595993041992, total_len: 7360
total_loss: 31519.784698486328, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 193 at step    38600 | time:  6.11s | valid loss  3.91 | valid ppl    49.912
----------------------------------------------------------------------------------------------------
| epoch 161 step    38800 |     80 batches | lr 2.77e-07 | ms/batch 30.49 | loss  3.23 | ppl    25.238
total_loss: 28777.447441101074, total_len: 7360
total_loss: 31518.097869873047, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 194 at step    38800 | time:  6.10s | valid loss  3.91 | valid ppl    49.898
----------------------------------------------------------------------------------------------------
| epoch 162 step    39000 |     38 batches | lr 1.93e-07 | ms/batch 30.56 | loss  3.21 | ppl    24.767
total_loss: 28776.601684570312, total_len: 7360
total_loss: 31517.186164855957, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 195 at step    39000 | time:  6.11s | valid loss  3.91 | valid ppl    49.892
----------------------------------------------------------------------------------------------------
| epoch 162 step    39200 |    238 batches | lr 1.23e-07 | ms/batch 30.54 | loss  3.21 | ppl    24.725
total_loss: 28776.492874145508, total_len: 7360
total_loss: 31517.180145263672, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 196 at step    39200 | time:  6.11s | valid loss  3.91 | valid ppl    49.891
----------------------------------------------------------------------------------------------------
| epoch 163 step    39400 |    196 batches | lr 6.94e-08 | ms/batch 30.54 | loss  3.21 | ppl    24.771
total_loss: 28777.193489074707, total_len: 7360
total_loss: 31517.687171936035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 197 at step    39400 | time:  6.10s | valid loss  3.91 | valid ppl    49.896
----------------------------------------------------------------------------------------------------
| epoch 164 step    39600 |    154 batches | lr 3.08e-08 | ms/batch 30.62 | loss  3.21 | ppl    24.733
total_loss: 28777.324363708496, total_len: 7360
total_loss: 31517.739082336426, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 198 at step    39600 | time:  6.12s | valid loss  3.91 | valid ppl    49.897
----------------------------------------------------------------------------------------------------
| epoch 165 step    39800 |    112 batches | lr 7.71e-09 | ms/batch 30.62 | loss  3.22 | ppl    24.964
total_loss: 28777.029327392578, total_len: 7360
total_loss: 31517.459060668945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 199 at step    39800 | time:  6.13s | valid loss  3.91 | valid ppl    49.895
----------------------------------------------------------------------------------------------------
| epoch 166 step    40000 |     70 batches | lr 0 | ms/batch 30.58 | loss  3.22 | ppl    25.105
total_loss: 28776.989265441895, total_len: 7360
total_loss: 31517.419998168945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 200 at step    40000 | time:  6.11s | valid loss  3.91 | valid ppl    49.895
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
End of training
total_loss: 31512.329864501953, total_len: 8224
====================================================================================================
| End of training | test loss  3.83 | test ppl    46.143
====================================================================================================
Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 13
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_13_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
total_loss: 71380.69039916992, total_len: 7744
total_loss: 75822.42971801758, total_len: 8224
total_loss: 67878.63623046875, total_len: 7360
| Start of training | test loss  9.22 | test bpc 10093.56548
| epoch   1 step      200 |    200 batches | lr 0.000125 | ms/batch 38.68 | loss  7.04 | ppl  1143.180
total_loss: 45341.308166503906, total_len: 7360
total_loss: 50265.64305114746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   1 at step      200 | time:  9.06s | valid loss  6.16 | valid ppl   473.667
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   2 step      400 |    158 batches | lr 0.000125 | ms/batch 37.79 | loss  6.05 | ppl   425.448
total_loss: 42655.53221130371, total_len: 7360
total_loss: 47254.481857299805, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   2 at step      400 | time:  6.38s | valid loss  5.80 | valid ppl   328.846
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   3 step      600 |    116 batches | lr 0.000125 | ms/batch 37.24 | loss  5.79 | ppl   326.458
total_loss: 41431.62951660156, total_len: 7360
total_loss: 45879.27574157715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   3 at step      600 | time:  6.35s | valid loss  5.63 | valid ppl   278.466
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   4 step      800 |     74 batches | lr 0.000125 | ms/batch 37.75 | loss  5.65 | ppl   283.513
total_loss: 40526.85287475586, total_len: 7360
total_loss: 44844.31866455078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   4 at step      800 | time:  6.39s | valid loss  5.51 | valid ppl   246.255
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1000 |     32 batches | lr 0.000125 | ms/batch 37.44 | loss  5.52 | ppl   250.240
total_loss: 39949.7033996582, total_len: 7360
total_loss: 44196.36589050293, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1000 | time:  6.42s | valid loss  5.43 | valid ppl   227.682
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1200 |    232 batches | lr 0.000125 | ms/batch 38.01 | loss  5.43 | ppl   228.795
total_loss: 39468.45811462402, total_len: 7360
total_loss: 43677.946212768555, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1200 | time:  6.37s | valid loss  5.36 | valid ppl   213.271
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   6 step     1400 |    190 batches | lr 0.000125 | ms/batch 37.10 | loss  5.36 | ppl   213.517
total_loss: 39063.0294342041, total_len: 7360
total_loss: 43189.96391296387, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1400 | time:  6.33s | valid loss  5.31 | valid ppl   201.840
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   7 step     1600 |    148 batches | lr 0.000125 | ms/batch 37.99 | loss  5.30 | ppl   200.388
total_loss: 38724.9366607666, total_len: 7360
total_loss: 42809.02781677246, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   8 at step     1600 | time:  6.37s | valid loss  5.26 | valid ppl   192.778
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   8 step     1800 |    106 batches | lr 0.000124 | ms/batch 37.40 | loss  5.25 | ppl   191.228
total_loss: 38354.5753326416, total_len: 7360
total_loss: 42408.67918395996, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   9 at step     1800 | time:  6.33s | valid loss  5.21 | valid ppl   183.317
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   9 step     2000 |     64 batches | lr 0.000124 | ms/batch 37.13 | loss  5.21 | ppl   182.204
total_loss: 38055.856689453125, total_len: 7360
total_loss: 42085.0602722168, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2000 | time:  6.33s | valid loss  5.17 | valid ppl   176.026
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2200 |     22 batches | lr 0.000124 | ms/batch 37.32 | loss  5.15 | ppl   171.663
total_loss: 37759.95571899414, total_len: 7360
total_loss: 41737.04414367676, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2200 | time:  6.31s | valid loss  5.13 | valid ppl   169.090
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2400 |    222 batches | lr 0.000124 | ms/batch 38.10 | loss  5.11 | ppl   164.941
total_loss: 37547.91015625, total_len: 7360
total_loss: 41510.26824951172, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  12 at step     2400 | time:  6.40s | valid loss  5.10 | valid ppl   164.288
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  11 step     2600 |    180 batches | lr 0.000124 | ms/batch 38.18 | loss  5.06 | ppl   158.138
total_loss: 37306.48287963867, total_len: 7360
total_loss: 41244.371520996094, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  13 at step     2600 | time:  6.44s | valid loss  5.07 | valid ppl   158.986
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  12 step     2800 |    138 batches | lr 0.000123 | ms/batch 37.40 | loss  5.03 | ppl   152.778
total_loss: 37135.18826293945, total_len: 7360
total_loss: 41040.396484375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  14 at step     2800 | time:  6.35s | valid loss  5.05 | valid ppl   155.328
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  13 step     3000 |     96 batches | lr 0.000123 | ms/batch 37.96 | loss  5.01 | ppl   149.388
total_loss: 36891.22105407715, total_len: 7360
total_loss: 40758.048828125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3000 | time:  6.39s | valid loss  5.01 | valid ppl   150.264
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  14 step     3200 |     54 batches | lr 0.000123 | ms/batch 37.30 | loss  4.96 | ppl   142.532
total_loss: 36668.3782119751, total_len: 7360
total_loss: 40531.051361083984, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  16 at step     3200 | time:  6.35s | valid loss  4.98 | valid ppl   145.783
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3400 |     12 batches | lr 0.000123 | ms/batch 37.79 | loss  4.91 | ppl   136.309
total_loss: 36437.77961730957, total_len: 7360
total_loss: 40260.11003112793, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  17 at step     3400 | time:  6.37s | valid loss  4.95 | valid ppl   141.286
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3600 |    212 batches | lr 0.000123 | ms/batch 36.95 | loss  4.88 | ppl   131.066
total_loss: 36215.861167907715, total_len: 7360
total_loss: 40008.40823364258, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  18 at step     3600 | time:  6.28s | valid loss  4.92 | valid ppl   137.089
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  16 step     3800 |    170 batches | lr 0.000122 | ms/batch 37.90 | loss  4.83 | ppl   125.352
total_loss: 35872.15566253662, total_len: 7360
total_loss: 39622.94827270508, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  19 at step     3800 | time:  6.36s | valid loss  4.87 | valid ppl   130.835
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  17 step     4000 |    128 batches | lr 0.000122 | ms/batch 38.22 | loss  4.78 | ppl   119.670
total_loss: 35557.83832550049, total_len: 7360
total_loss: 39279.601638793945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  20 at step     4000 | time:  6.37s | valid loss  4.83 | valid ppl   125.365
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  18 step     4200 |     86 batches | lr 0.000122 | ms/batch 37.34 | loss  4.75 | ppl   116.040
total_loss: 35184.48038482666, total_len: 7360
total_loss: 38872.381912231445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  21 at step     4200 | time:  6.33s | valid loss  4.78 | valid ppl   119.164
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  19 step     4400 |     44 batches | lr 0.000121 | ms/batch 37.35 | loss  4.69 | ppl   108.321
total_loss: 34831.17922210693, total_len: 7360
total_loss: 38480.08553314209, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  22 at step     4400 | time:  6.36s | valid loss  4.73 | valid ppl   113.579
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4600 |      2 batches | lr 0.000121 | ms/batch 47.04 | loss  4.63 | ppl   102.586
total_loss: 34533.100677490234, total_len: 7360
total_loss: 38162.932792663574, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  23 at step     4600 | time:  6.32s | valid loss  4.69 | valid ppl   109.071
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4800 |    202 batches | lr 0.000121 | ms/batch 37.32 | loss  4.58 | ppl    97.961
total_loss: 34225.04866027832, total_len: 7360
total_loss: 37800.65864562988, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  24 at step     4800 | time:  6.32s | valid loss  4.65 | valid ppl   104.600
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  21 step     5000 |    160 batches | lr 0.00012 | ms/batch 36.64 | loss  4.54 | ppl    93.451
total_loss: 33948.980964660645, total_len: 7360
total_loss: 37447.75743103027, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  25 at step     5000 | time:  6.10s | valid loss  4.61 | valid ppl   100.749
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  22 step     5200 |    118 batches | lr 0.00012 | ms/batch 36.15 | loss  4.49 | ppl    89.155
total_loss: 33646.21617889404, total_len: 7360
total_loss: 37120.771728515625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  26 at step     5200 | time:  6.10s | valid loss  4.57 | valid ppl    96.689
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  23 step     5400 |     76 batches | lr 0.000119 | ms/batch 35.64 | loss  4.46 | ppl    86.842
total_loss: 33379.16404724121, total_len: 7360
total_loss: 36808.688400268555, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  27 at step     5400 | time:  6.07s | valid loss  4.54 | valid ppl    93.243
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5600 |     34 batches | lr 0.000119 | ms/batch 36.89 | loss  4.40 | ppl    81.298
total_loss: 33126.67623901367, total_len: 7360
total_loss: 36520.03419494629, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  28 at step     5600 | time:  6.17s | valid loss  4.50 | valid ppl    90.099
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5800 |    234 batches | lr 0.000119 | ms/batch 37.23 | loss  4.35 | ppl    77.600
total_loss: 32879.41352081299, total_len: 7360
total_loss: 36233.808937072754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  29 at step     5800 | time:  6.13s | valid loss  4.47 | valid ppl    87.122
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  25 step     6000 |    192 batches | lr 0.000118 | ms/batch 36.12 | loss  4.32 | ppl    74.914
total_loss: 32608.854400634766, total_len: 7360
total_loss: 35920.04692077637, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  30 at step     6000 | time:  6.10s | valid loss  4.43 | valid ppl    83.978
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  26 step     6200 |    150 batches | lr 0.000118 | ms/batch 36.64 | loss  4.27 | ppl    71.807
total_loss: 32368.50075531006, total_len: 7360
total_loss: 35640.43714904785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  31 at step     6200 | time:  6.13s | valid loss  4.40 | valid ppl    81.280
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  27 step     6400 |    108 batches | lr 0.000117 | ms/batch 36.01 | loss  4.25 | ppl    69.868
total_loss: 32163.661087036133, total_len: 7360
total_loss: 35408.12309265137, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  32 at step     6400 | time:  6.11s | valid loss  4.37 | valid ppl    79.049
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  28 step     6600 |     66 batches | lr 0.000117 | ms/batch 36.64 | loss  4.21 | ppl    67.626
total_loss: 31943.155158996582, total_len: 7360
total_loss: 35171.36767578125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  33 at step     6600 | time:  6.13s | valid loss  4.34 | valid ppl    76.715
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     6800 |     24 batches | lr 0.000116 | ms/batch 36.26 | loss  4.16 | ppl    64.355
total_loss: 31754.130325317383, total_len: 7360
total_loss: 34979.266761779785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  34 at step     6800 | time:  6.11s | valid loss  4.31 | valid ppl    74.770
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     7000 |    224 batches | lr 0.000116 | ms/batch 36.10 | loss  4.13 | ppl    62.346
total_loss: 31657.830436706543, total_len: 7360
total_loss: 34842.03333282471, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  35 at step     7000 | time:  6.08s | valid loss  4.30 | valid ppl    73.798
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  30 step     7200 |    182 batches | lr 0.000115 | ms/batch 36.85 | loss  4.10 | ppl    60.430
total_loss: 31475.801963806152, total_len: 7360
total_loss: 34642.97777557373, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  36 at step     7200 | time:  6.15s | valid loss  4.28 | valid ppl    71.995
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  31 step     7400 |    140 batches | lr 0.000115 | ms/batch 36.72 | loss  4.08 | ppl    58.974
total_loss: 31334.264640808105, total_len: 7360
total_loss: 34486.15782165527, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  37 at step     7400 | time:  6.16s | valid loss  4.26 | valid ppl    70.624
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  32 step     7600 |     98 batches | lr 0.000114 | ms/batch 36.36 | loss  4.06 | ppl    58.013
total_loss: 31139.33469390869, total_len: 7360
total_loss: 34266.912254333496, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  38 at step     7600 | time:  6.11s | valid loss  4.23 | valid ppl    68.778
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  33 step     7800 |     56 batches | lr 0.000114 | ms/batch 38.05 | loss  4.03 | ppl    56.099
total_loss: 31047.67315673828, total_len: 7360
total_loss: 34160.41867828369, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  39 at step     7800 | time:  6.40s | valid loss  4.22 | valid ppl    67.927
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8000 |     14 batches | lr 0.000113 | ms/batch 37.09 | loss  3.99 | ppl    54.130
total_loss: 30930.72013092041, total_len: 7360
total_loss: 34054.88814544678, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  40 at step     8000 | time:  6.32s | valid loss  4.20 | valid ppl    66.856
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8200 |    214 batches | lr 0.000112 | ms/batch 37.40 | loss  3.97 | ppl    52.986
total_loss: 30797.976417541504, total_len: 7360
total_loss: 33885.60395050049, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  41 at step     8200 | time:  6.32s | valid loss  4.18 | valid ppl    65.661
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  35 step     8400 |    172 batches | lr 0.000112 | ms/batch 36.92 | loss  3.95 | ppl    51.765
total_loss: 30708.20750427246, total_len: 7360
total_loss: 33810.29061126709, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  42 at step     8400 | time:  6.36s | valid loss  4.17 | valid ppl    64.865
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  36 step     8600 |    130 batches | lr 0.000111 | ms/batch 37.66 | loss  3.93 | ppl    50.661
total_loss: 30674.910346984863, total_len: 7360
total_loss: 33751.827865600586, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  43 at step     8600 | time:  6.42s | valid loss  4.17 | valid ppl    64.572
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  37 step     8800 |     88 batches | lr 0.000111 | ms/batch 37.39 | loss  3.92 | ppl    50.463
total_loss: 30569.42160797119, total_len: 7360
total_loss: 33642.86248779297, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  44 at step     8800 | time:  6.47s | valid loss  4.15 | valid ppl    63.653
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  38 step     9000 |     46 batches | lr 0.00011 | ms/batch 38.14 | loss  3.89 | ppl    48.782
total_loss: 30448.318733215332, total_len: 7360
total_loss: 33519.77241516113, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  45 at step     9000 | time:  6.46s | valid loss  4.14 | valid ppl    62.615
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9200 |      4 batches | lr 0.000109 | ms/batch 37.46 | loss  3.86 | ppl    47.617
total_loss: 30389.785598754883, total_len: 7360
total_loss: 33451.37976074219, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  46 at step     9200 | time:  6.52s | valid loss  4.13 | valid ppl    62.119
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9400 |    204 batches | lr 0.000109 | ms/batch 38.19 | loss  3.85 | ppl    46.873
total_loss: 30324.66636657715, total_len: 7360
total_loss: 33398.44040679932, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  47 at step     9400 | time:  6.42s | valid loss  4.12 | valid ppl    61.572
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  40 step     9600 |    162 batches | lr 0.000108 | ms/batch 37.66 | loss  3.83 | ppl    46.004
total_loss: 30263.12329864502, total_len: 7360
total_loss: 33302.59652709961, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  48 at step     9600 | time:  6.53s | valid loss  4.11 | valid ppl    61.059
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  41 step     9800 |    120 batches | lr 0.000107 | ms/batch 37.77 | loss  3.81 | ppl    45.296
total_loss: 30200.260848999023, total_len: 7360
total_loss: 33231.880615234375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  49 at step     9800 | time:  6.47s | valid loss  4.10 | valid ppl    60.540
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  42 step    10000 |     78 batches | lr 0.000107 | ms/batch 38.84 | loss  3.82 | ppl    45.402
total_loss: 30090.973960876465, total_len: 7360
total_loss: 33102.27108001709, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  50 at step    10000 | time:  6.53s | valid loss  4.09 | valid ppl    59.647
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10200 |     36 batches | lr 0.000106 | ms/batch 38.21 | loss  3.78 | ppl    43.760
total_loss: 30077.71649169922, total_len: 7360
total_loss: 33080.49855804443, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  51 at step    10200 | time:  6.44s | valid loss  4.09 | valid ppl    59.540
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10400 |    236 batches | lr 0.000105 | ms/batch 37.72 | loss  3.76 | ppl    42.978
total_loss: 30027.51057434082, total_len: 7360
total_loss: 33032.34852600098, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  52 at step    10400 | time:  6.40s | valid loss  4.08 | valid ppl    59.135
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  44 step    10600 |    194 batches | lr 0.000105 | ms/batch 37.48 | loss  3.75 | ppl    42.587
total_loss: 29988.447982788086, total_len: 7360
total_loss: 32972.10280609131, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  53 at step    10600 | time:  6.32s | valid loss  4.07 | valid ppl    58.822
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  45 step    10800 |    152 batches | lr 0.000104 | ms/batch 37.22 | loss  3.74 | ppl    41.922
total_loss: 29950.262062072754, total_len: 7360
total_loss: 32915.27634429932, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  54 at step    10800 | time:  6.32s | valid loss  4.07 | valid ppl    58.518
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  46 step    11000 |    110 batches | lr 0.000103 | ms/batch 36.88 | loss  3.73 | ppl    41.592
total_loss: 29914.910705566406, total_len: 7360
total_loss: 32889.13722229004, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  55 at step    11000 | time:  6.27s | valid loss  4.06 | valid ppl    58.237
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  47 step    11200 |     68 batches | lr 0.000102 | ms/batch 37.00 | loss  3.72 | ppl    41.449
total_loss: 29831.764877319336, total_len: 7360
total_loss: 32813.73489379883, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  56 at step    11200 | time:  6.31s | valid loss  4.05 | valid ppl    57.583
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11400 |     26 batches | lr 0.000102 | ms/batch 37.91 | loss  3.70 | ppl    40.275
total_loss: 29841.126823425293, total_len: 7360
total_loss: 32806.31443023682, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  57 at step    11400 | time:  6.36s | valid loss  4.05 | valid ppl    57.656
----------------------------------------------------------------------------------------------------
| epoch  48 step    11600 |    226 batches | lr 0.000101 | ms/batch 31.42 | loss  3.68 | ppl    39.790
total_loss: 29790.69406890869, total_len: 7360
total_loss: 32737.161643981934, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  58 at step    11600 | time:  6.28s | valid loss  4.05 | valid ppl    57.263
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  49 step    11800 |    184 batches | lr 0.0001 | ms/batch 37.26 | loss  3.67 | ppl    39.253
total_loss: 29757.57942199707, total_len: 7360
total_loss: 32707.57592010498, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  59 at step    11800 | time:  6.33s | valid loss  4.04 | valid ppl    57.006
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  50 step    12000 |    142 batches | lr 9.92e-05 | ms/batch 37.63 | loss  3.66 | ppl    38.910
total_loss: 29682.22688293457, total_len: 7360
total_loss: 32612.583068847656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  60 at step    12000 | time:  6.35s | valid loss  4.03 | valid ppl    56.425
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  51 step    12200 |    100 batches | lr 9.84e-05 | ms/batch 36.97 | loss  3.66 | ppl    38.832
total_loss: 29641.060386657715, total_len: 7360
total_loss: 32567.17343902588, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  61 at step    12200 | time:  6.27s | valid loss  4.03 | valid ppl    56.110
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  52 step    12400 |     58 batches | lr 9.76e-05 | ms/batch 37.45 | loss  3.65 | ppl    38.340
total_loss: 29616.81494140625, total_len: 7360
total_loss: 32545.553024291992, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  62 at step    12400 | time:  6.29s | valid loss  4.02 | valid ppl    55.926
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12600 |     16 batches | lr 9.68e-05 | ms/batch 37.53 | loss  3.62 | ppl    37.503
total_loss: 29580.897102355957, total_len: 7360
total_loss: 32508.718589782715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  63 at step    12600 | time:  6.33s | valid loss  4.02 | valid ppl    55.653
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12800 |    216 batches | lr 9.6e-05 | ms/batch 36.91 | loss  3.61 | ppl    37.075
total_loss: 29544.8755569458, total_len: 7360
total_loss: 32474.147491455078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  64 at step    12800 | time:  6.35s | valid loss  4.01 | valid ppl    55.382
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  54 step    13000 |    174 batches | lr 9.52e-05 | ms/batch 37.13 | loss  3.60 | ppl    36.754
total_loss: 29544.232467651367, total_len: 7360
total_loss: 32447.558868408203, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  65 at step    13000 | time:  6.35s | valid loss  4.01 | valid ppl    55.377
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  55 step    13200 |    132 batches | lr 9.43e-05 | ms/batch 37.47 | loss  3.60 | ppl    36.481
total_loss: 29542.123413085938, total_len: 7360
total_loss: 32452.15267944336, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  66 at step    13200 | time:  6.35s | valid loss  4.01 | valid ppl    55.361
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  56 step    13400 |     90 batches | lr 9.35e-05 | ms/batch 37.60 | loss  3.60 | ppl    36.636
total_loss: 29480.01612854004, total_len: 7360
total_loss: 32389.17485809326, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  67 at step    13400 | time:  6.40s | valid loss  4.01 | valid ppl    54.896
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  57 step    13600 |     48 batches | lr 9.26e-05 | ms/batch 38.24 | loss  3.58 | ppl    35.913
total_loss: 29445.43549346924, total_len: 7360
total_loss: 32347.982330322266, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  68 at step    13600 | time:  6.43s | valid loss  4.00 | valid ppl    54.638
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    13800 |      6 batches | lr 9.17e-05 | ms/batch 37.50 | loss  3.57 | ppl    35.452
total_loss: 29431.859298706055, total_len: 7360
total_loss: 32339.811950683594, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  69 at step    13800 | time:  6.32s | valid loss  4.00 | valid ppl    54.538
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    14000 |    206 batches | lr 9.09e-05 | ms/batch 37.00 | loss  3.56 | ppl    35.063
total_loss: 29388.567497253418, total_len: 7360
total_loss: 32296.912452697754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  70 at step    14000 | time:  6.29s | valid loss  3.99 | valid ppl    54.218
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  59 step    14200 |    164 batches | lr 9e-05 | ms/batch 37.44 | loss  3.55 | ppl    34.820
total_loss: 29382.98907470703, total_len: 7360
total_loss: 32282.981895446777, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  71 at step    14200 | time:  6.31s | valid loss  3.99 | valid ppl    54.177
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  60 step    14400 |    122 batches | lr 8.91e-05 | ms/batch 37.53 | loss  3.54 | ppl    34.630
total_loss: 29419.240524291992, total_len: 7360
total_loss: 32312.00774383545, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  72 at step    14400 | time:  6.33s | valid loss  4.00 | valid ppl    54.444
----------------------------------------------------------------------------------------------------
| epoch  61 step    14600 |     80 batches | lr 8.82e-05 | ms/batch 31.46 | loss  3.55 | ppl    34.934
total_loss: 29363.00193786621, total_len: 7360
total_loss: 32259.673217773438, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  73 at step    14600 | time:  6.31s | valid loss  3.99 | valid ppl    54.030
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    14800 |     38 batches | lr 8.73e-05 | ms/batch 37.47 | loss  3.52 | ppl    33.935
total_loss: 29290.34506225586, total_len: 7360
total_loss: 32183.165519714355, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  74 at step    14800 | time:  6.34s | valid loss  3.98 | valid ppl    53.499
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    15000 |    238 batches | lr 8.64e-05 | ms/batch 36.55 | loss  3.51 | ppl    33.609
total_loss: 29341.92958831787, total_len: 7360
total_loss: 32220.12168121338, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  75 at step    15000 | time:  6.29s | valid loss  3.99 | valid ppl    53.875
----------------------------------------------------------------------------------------------------
| epoch  63 step    15200 |    196 batches | lr 8.55e-05 | ms/batch 31.90 | loss  3.51 | ppl    33.484
total_loss: 29287.40379333496, total_len: 7360
total_loss: 32156.806953430176, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  76 at step    15200 | time:  6.40s | valid loss  3.98 | valid ppl    53.478
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  64 step    15400 |    154 batches | lr 8.46e-05 | ms/batch 37.76 | loss  3.50 | ppl    33.205
total_loss: 29261.86491394043, total_len: 7360
total_loss: 32134.211280822754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  77 at step    15400 | time:  6.40s | valid loss  3.98 | valid ppl    53.293
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  65 step    15600 |    112 batches | lr 8.37e-05 | ms/batch 38.14 | loss  3.50 | ppl    33.186
total_loss: 29266.05210876465, total_len: 7360
total_loss: 32148.96378326416, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  78 at step    15600 | time:  6.47s | valid loss  3.98 | valid ppl    53.323
----------------------------------------------------------------------------------------------------
| epoch  66 step    15800 |     70 batches | lr 8.27e-05 | ms/batch 31.57 | loss  3.50 | ppl    33.201
total_loss: 29258.614181518555, total_len: 7360
total_loss: 32125.97759246826, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  79 at step    15800 | time:  6.28s | valid loss  3.98 | valid ppl    53.269
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16000 |     28 batches | lr 8.18e-05 | ms/batch 36.94 | loss  3.48 | ppl    32.494
total_loss: 29236.666831970215, total_len: 7360
total_loss: 32116.10767364502, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  80 at step    16000 | time:  6.34s | valid loss  3.97 | valid ppl    53.110
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16200 |    228 batches | lr 8.09e-05 | ms/batch 37.20 | loss  3.47 | ppl    32.172
total_loss: 29196.114250183105, total_len: 7360
total_loss: 32052.55567932129, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  81 at step    16200 | time:  6.34s | valid loss  3.97 | valid ppl    52.819
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  68 step    16400 |    186 batches | lr 7.99e-05 | ms/batch 37.91 | loss  3.47 | ppl    32.027
total_loss: 29165.403816223145, total_len: 7360
total_loss: 32022.853813171387, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  82 at step    16400 | time:  6.44s | valid loss  3.96 | valid ppl    52.599
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  69 step    16600 |    144 batches | lr 7.9e-05 | ms/batch 37.83 | loss  3.46 | ppl    31.883
total_loss: 29196.322723388672, total_len: 7360
total_loss: 32034.608489990234, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  83 at step    16600 | time:  6.39s | valid loss  3.97 | valid ppl    52.820
----------------------------------------------------------------------------------------------------
| epoch  70 step    16800 |    102 batches | lr 7.8e-05 | ms/batch 31.51 | loss  3.47 | ppl    32.008
total_loss: 29164.255798339844, total_len: 7360
total_loss: 32010.35073852539, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  84 at step    16800 | time:  6.30s | valid loss  3.96 | valid ppl    52.590
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  71 step    17000 |     60 batches | lr 7.71e-05 | ms/batch 37.68 | loss  3.46 | ppl    31.751
total_loss: 29127.369270324707, total_len: 7360
total_loss: 31989.01188659668, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  85 at step    17000 | time:  6.34s | valid loss  3.96 | valid ppl    52.328
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17200 |     18 batches | lr 7.61e-05 | ms/batch 38.09 | loss  3.44 | ppl    31.201
total_loss: 29113.516830444336, total_len: 7360
total_loss: 31961.90803527832, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  86 at step    17200 | time:  6.49s | valid loss  3.96 | valid ppl    52.229
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17400 |    218 batches | lr 7.52e-05 | ms/batch 39.76 | loss  3.44 | ppl    31.091
total_loss: 29100.30940246582, total_len: 7360
total_loss: 31951.433448791504, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  87 at step    17400 | time:  6.40s | valid loss  3.95 | valid ppl    52.136
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  73 step    17600 |    176 batches | lr 7.42e-05 | ms/batch 37.70 | loss  3.43 | ppl    30.828
total_loss: 29130.417846679688, total_len: 7360
total_loss: 31978.965522766113, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  88 at step    17600 | time:  6.38s | valid loss  3.96 | valid ppl    52.349
----------------------------------------------------------------------------------------------------
| epoch  74 step    17800 |    134 batches | lr 7.32e-05 | ms/batch 31.80 | loss  3.43 | ppl    30.739
total_loss: 29135.94019317627, total_len: 7360
total_loss: 31989.185165405273, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  89 at step    17800 | time:  6.39s | valid loss  3.96 | valid ppl    52.389
----------------------------------------------------------------------------------------------------
| epoch  75 step    18000 |     92 batches | lr 7.23e-05 | ms/batch 32.20 | loss  3.43 | ppl    31.021
total_loss: 29096.685287475586, total_len: 7360
total_loss: 31942.621536254883, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  90 at step    18000 | time:  6.43s | valid loss  3.95 | valid ppl    52.110
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  76 step    18200 |     50 batches | lr 7.13e-05 | ms/batch 37.64 | loss  3.42 | ppl    30.572
total_loss: 29072.341621398926, total_len: 7360
total_loss: 31896.909072875977, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  91 at step    18200 | time:  6.40s | valid loss  3.95 | valid ppl    51.938
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  77 step    18400 |      8 batches | lr 7.03e-05 | ms/batch 37.99 | loss  3.41 | ppl    30.197
total_loss: 29090.26261138916, total_len: 7360
total_loss: 31909.16293334961, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  92 at step    18400 | time:  6.50s | valid loss  3.95 | valid ppl    52.064
----------------------------------------------------------------------------------------------------
| epoch  77 step    18600 |    208 batches | lr 6.94e-05 | ms/batch 32.34 | loss  3.40 | ppl    30.056
total_loss: 29048.01259613037, total_len: 7360
total_loss: 31873.77045440674, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  93 at step    18600 | time:  6.44s | valid loss  3.95 | valid ppl    51.766
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  78 step    18800 |    166 batches | lr 6.84e-05 | ms/batch 38.09 | loss  3.40 | ppl    29.937
total_loss: 29023.0731048584, total_len: 7360
total_loss: 31844.572395324707, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  94 at step    18800 | time:  6.49s | valid loss  3.94 | valid ppl    51.591
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  79 step    19000 |    124 batches | lr 6.74e-05 | ms/batch 37.39 | loss  3.40 | ppl    29.897
total_loss: 29130.5087890625, total_len: 7360
total_loss: 31959.95648956299, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  95 at step    19000 | time:  6.32s | valid loss  3.96 | valid ppl    52.350
----------------------------------------------------------------------------------------------------
| epoch  80 step    19200 |     82 batches | lr 6.64e-05 | ms/batch 31.50 | loss  3.41 | ppl    30.217
total_loss: 29038.546211242676, total_len: 7360
total_loss: 31849.139945983887, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  96 at step    19200 | time:  6.30s | valid loss  3.95 | valid ppl    51.700
----------------------------------------------------------------------------------------------------
| epoch  81 step    19400 |     40 batches | lr 6.54e-05 | ms/batch 31.68 | loss  3.39 | ppl    29.530
total_loss: 29016.0379486084, total_len: 7360
total_loss: 31826.205307006836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  97 at step    19400 | time:  6.36s | valid loss  3.94 | valid ppl    51.542
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19600 |    240 batches | lr 6.45e-05 | ms/batch 37.22 | loss  3.38 | ppl    29.294
total_loss: 29075.77574157715, total_len: 7360
total_loss: 31876.738403320312, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  98 at step    19600 | time:  6.33s | valid loss  3.95 | valid ppl    51.962
----------------------------------------------------------------------------------------------------
| epoch  82 step    19800 |    198 batches | lr 6.35e-05 | ms/batch 31.86 | loss  3.37 | ppl    29.193
total_loss: 29034.858268737793, total_len: 7360
total_loss: 31852.064346313477, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  99 at step    19800 | time:  6.36s | valid loss  3.94 | valid ppl    51.674
----------------------------------------------------------------------------------------------------
| epoch  83 step    20000 |    156 batches | lr 6.25e-05 | ms/batch 32.27 | loss  3.37 | ppl    29.118
total_loss: 29028.637245178223, total_len: 7360
total_loss: 31837.7056350708, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 100 at step    20000 | time:  6.49s | valid loss  3.94 | valid ppl    51.630
----------------------------------------------------------------------------------------------------
| epoch  84 step    20200 |    114 batches | lr 6.15e-05 | ms/batch 31.68 | loss  3.37 | ppl    29.138
total_loss: 29057.694480895996, total_len: 7360
total_loss: 31865.406372070312, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 101 at step    20200 | time:  6.30s | valid loss  3.95 | valid ppl    51.835
----------------------------------------------------------------------------------------------------
| epoch  85 step    20400 |     72 batches | lr 6.05e-05 | ms/batch 32.26 | loss  3.38 | ppl    29.345
total_loss: 29024.50506591797, total_len: 7360
total_loss: 31830.549682617188, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 102 at step    20400 | time:  6.45s | valid loss  3.94 | valid ppl    51.601
----------------------------------------------------------------------------------------------------
| epoch  86 step    20600 |     30 batches | lr 5.96e-05 | ms/batch 31.85 | loss  3.36 | ppl    28.699
total_loss: 28998.22834777832, total_len: 7360
total_loss: 31804.55989074707, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 103 at step    20600 | time:  6.42s | valid loss  3.94 | valid ppl    51.417
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  86 step    20800 |    230 batches | lr 5.86e-05 | ms/batch 38.01 | loss  3.35 | ppl    28.618
total_loss: 28977.09162902832, total_len: 7360
total_loss: 31776.825225830078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 104 at step    20800 | time:  6.38s | valid loss  3.94 | valid ppl    51.270
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  87 step    21000 |    188 batches | lr 5.76e-05 | ms/batch 37.46 | loss  3.35 | ppl    28.519
total_loss: 29005.377899169922, total_len: 7360
total_loss: 31818.06615447998, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 105 at step    21000 | time:  6.35s | valid loss  3.94 | valid ppl    51.467
----------------------------------------------------------------------------------------------------
| epoch  88 step    21200 |    146 batches | lr 5.66e-05 | ms/batch 31.64 | loss  3.35 | ppl    28.454
total_loss: 28990.600555419922, total_len: 7360
total_loss: 31778.797203063965, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 106 at step    21200 | time:  6.33s | valid loss  3.94 | valid ppl    51.364
----------------------------------------------------------------------------------------------------
| epoch  89 step    21400 |    104 batches | lr 5.56e-05 | ms/batch 31.39 | loss  3.35 | ppl    28.557
total_loss: 28939.47176361084, total_len: 7360
total_loss: 31742.600204467773, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 107 at step    21400 | time:  6.26s | valid loss  3.93 | valid ppl    51.009
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  90 step    21600 |     62 batches | lr 5.47e-05 | ms/batch 37.78 | loss  3.35 | ppl    28.508
total_loss: 28961.235748291016, total_len: 7360
total_loss: 31757.768241882324, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 108 at step    21600 | time:  6.43s | valid loss  3.93 | valid ppl    51.160
----------------------------------------------------------------------------------------------------
| epoch  91 step    21800 |     20 batches | lr 5.37e-05 | ms/batch 32.02 | loss  3.34 | ppl    28.102
total_loss: 28933.862747192383, total_len: 7360
total_loss: 31724.063354492188, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 109 at step    21800 | time:  6.42s | valid loss  3.93 | valid ppl    50.970
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  91 step    22000 |    220 batches | lr 5.27e-05 | ms/batch 37.62 | loss  3.33 | ppl    27.978
total_loss: 28919.231407165527, total_len: 7360
total_loss: 31707.427627563477, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 110 at step    22000 | time:  6.39s | valid loss  3.93 | valid ppl    50.868
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  92 step    22200 |    178 batches | lr 5.18e-05 | ms/batch 37.82 | loss  3.32 | ppl    27.787
total_loss: 28960.650413513184, total_len: 7360
total_loss: 31742.789154052734, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 111 at step    22200 | time:  6.31s | valid loss  3.93 | valid ppl    51.156
----------------------------------------------------------------------------------------------------
| epoch  93 step    22400 |    136 batches | lr 5.08e-05 | ms/batch 31.36 | loss  3.33 | ppl    27.811
total_loss: 29007.808616638184, total_len: 7360
total_loss: 31780.114868164062, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 112 at step    22400 | time:  6.26s | valid loss  3.94 | valid ppl    51.484
----------------------------------------------------------------------------------------------------
| epoch  94 step    22600 |     94 batches | lr 4.98e-05 | ms/batch 31.29 | loss  3.34 | ppl    28.133
total_loss: 28924.083839416504, total_len: 7360
total_loss: 31705.758262634277, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 113 at step    22600 | time:  6.32s | valid loss  3.93 | valid ppl    50.902
----------------------------------------------------------------------------------------------------
| epoch  95 step    22800 |     52 batches | lr 4.89e-05 | ms/batch 32.07 | loss  3.32 | ppl    27.700
total_loss: 28921.45053100586, total_len: 7360
total_loss: 31704.035011291504, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 114 at step    22800 | time:  6.37s | valid loss  3.93 | valid ppl    50.884
----------------------------------------------------------------------------------------------------
| epoch  96 step    23000 |     10 batches | lr 4.79e-05 | ms/batch 31.69 | loss  3.32 | ppl    27.529
total_loss: 28902.839958190918, total_len: 7360
total_loss: 31686.561836242676, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 115 at step    23000 | time:  6.34s | valid loss  3.93 | valid ppl    50.755
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  96 step    23200 |    210 batches | lr 4.7e-05 | ms/batch 37.39 | loss  3.31 | ppl    27.395
total_loss: 28924.37648010254, total_len: 7360
total_loss: 31719.272972106934, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 116 at step    23200 | time:  6.41s | valid loss  3.93 | valid ppl    50.904
----------------------------------------------------------------------------------------------------
| epoch  97 step    23400 |    168 batches | lr 4.6e-05 | ms/batch 32.48 | loss  3.30 | ppl    27.244
total_loss: 28869.57176208496, total_len: 7360
total_loss: 31645.769203186035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 117 at step    23400 | time:  6.43s | valid loss  3.92 | valid ppl    50.526
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  98 step    23600 |    126 batches | lr 4.51e-05 | ms/batch 44.37 | loss  3.31 | ppl    27.274
total_loss: 28911.288513183594, total_len: 7360
total_loss: 31686.83758544922, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 118 at step    23600 | time:  6.48s | valid loss  3.93 | valid ppl    50.814
----------------------------------------------------------------------------------------------------
| epoch  99 step    23800 |     84 batches | lr 4.41e-05 | ms/batch 31.92 | loss  3.32 | ppl    27.658
total_loss: 28853.139808654785, total_len: 7360
total_loss: 31629.77175140381, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 119 at step    23800 | time:  6.39s | valid loss  3.92 | valid ppl    50.414
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 100 step    24000 |     42 batches | lr 4.32e-05 | ms/batch 37.71 | loss  3.30 | ppl    27.199
total_loss: 28885.469985961914, total_len: 7360
total_loss: 31651.35391998291, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 120 at step    24000 | time:  6.39s | valid loss  3.92 | valid ppl    50.636
----------------------------------------------------------------------------------------------------
| epoch 100 step    24200 |    242 batches | lr 4.23e-05 | ms/batch 31.90 | loss  3.30 | ppl    26.999
total_loss: 28912.412910461426, total_len: 7360
total_loss: 31684.117057800293, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 121 at step    24200 | time:  6.45s | valid loss  3.93 | valid ppl    50.821
----------------------------------------------------------------------------------------------------
| epoch 101 step    24400 |    200 batches | lr 4.13e-05 | ms/batch 32.24 | loss  3.29 | ppl    26.877
total_loss: 28879.450653076172, total_len: 7360
total_loss: 31654.90554046631, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 122 at step    24400 | time:  6.44s | valid loss  3.92 | valid ppl    50.594
----------------------------------------------------------------------------------------------------
| epoch 102 step    24600 |    158 batches | lr 4.04e-05 | ms/batch 32.16 | loss  3.29 | ppl    26.848
total_loss: 28884.802505493164, total_len: 7360
total_loss: 31659.79866027832, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 123 at step    24600 | time:  6.41s | valid loss  3.92 | valid ppl    50.631
----------------------------------------------------------------------------------------------------
| epoch 103 step    24800 |    116 batches | lr 3.95e-05 | ms/batch 31.92 | loss  3.29 | ppl    26.961
total_loss: 28919.85772705078, total_len: 7360
total_loss: 31690.943420410156, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 124 at step    24800 | time:  6.39s | valid loss  3.93 | valid ppl    50.873
----------------------------------------------------------------------------------------------------
| epoch 104 step    25000 |     74 batches | lr 3.86e-05 | ms/batch 31.65 | loss  3.30 | ppl    27.132
total_loss: 28863.985542297363, total_len: 7360
total_loss: 31639.52614593506, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 125 at step    25000 | time:  6.30s | valid loss  3.92 | valid ppl    50.488
----------------------------------------------------------------------------------------------------
| epoch 105 step    25200 |     32 batches | lr 3.77e-05 | ms/batch 31.57 | loss  3.28 | ppl    26.672
total_loss: 28851.333084106445, total_len: 7360
total_loss: 31625.100326538086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 126 at step    25200 | time:  6.33s | valid loss  3.92 | valid ppl    50.401
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 105 step    25400 |    232 batches | lr 3.68e-05 | ms/batch 38.07 | loss  3.28 | ppl    26.472
total_loss: 28867.059700012207, total_len: 7360
total_loss: 31641.54554748535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 127 at step    25400 | time:  6.93s | valid loss  3.92 | valid ppl    50.509
----------------------------------------------------------------------------------------------------
| epoch 106 step    25600 |    190 batches | lr 3.59e-05 | ms/batch 34.35 | loss  3.28 | ppl    26.469
total_loss: 28880.863708496094, total_len: 7360
total_loss: 31649.456100463867, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 128 at step    25600 | time:  6.41s | valid loss  3.92 | valid ppl    50.604
----------------------------------------------------------------------------------------------------
| epoch 107 step    25800 |    148 batches | lr 3.5e-05 | ms/batch 32.23 | loss  3.28 | ppl    26.451
total_loss: 28851.686683654785, total_len: 7360
total_loss: 31608.52635192871, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 129 at step    25800 | time:  6.42s | valid loss  3.92 | valid ppl    50.404
----------------------------------------------------------------------------------------------------
| epoch 108 step    26000 |    106 batches | lr 3.41e-05 | ms/batch 32.19 | loss  3.29 | ppl    26.727
total_loss: 28848.734214782715, total_len: 7360
total_loss: 31618.125549316406, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 130 at step    26000 | time:  6.49s | valid loss  3.92 | valid ppl    50.384
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 109 step    26200 |     64 batches | lr 3.33e-05 | ms/batch 41.22 | loss  3.28 | ppl    26.600
total_loss: 28831.451126098633, total_len: 7360
total_loss: 31591.033798217773, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 131 at step    26200 | time:  6.50s | valid loss  3.92 | valid ppl    50.265
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 110 step    26400 |     22 batches | lr 3.24e-05 | ms/batch 39.89 | loss  3.27 | ppl    26.242
total_loss: 28861.679931640625, total_len: 7360
total_loss: 31620.434600830078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 132 at step    26400 | time:  6.39s | valid loss  3.92 | valid ppl    50.472
----------------------------------------------------------------------------------------------------
| epoch 110 step    26600 |    222 batches | lr 3.15e-05 | ms/batch 31.63 | loss  3.27 | ppl    26.214
total_loss: 28853.40224456787, total_len: 7360
total_loss: 31622.93116760254, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 133 at step    26600 | time:  6.31s | valid loss  3.92 | valid ppl    50.416
----------------------------------------------------------------------------------------------------
| epoch 111 step    26800 |    180 batches | lr 3.07e-05 | ms/batch 31.55 | loss  3.26 | ppl    26.070
total_loss: 28853.861045837402, total_len: 7360
total_loss: 31613.648651123047, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 134 at step    26800 | time:  6.31s | valid loss  3.92 | valid ppl    50.419
----------------------------------------------------------------------------------------------------
| epoch 112 step    27000 |    138 batches | lr 2.98e-05 | ms/batch 31.62 | loss  3.27 | ppl    26.230
total_loss: 28859.189361572266, total_len: 7360
total_loss: 31615.058708190918, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 135 at step    27000 | time:  6.37s | valid loss  3.92 | valid ppl    50.455
----------------------------------------------------------------------------------------------------
| epoch 113 step    27200 |     96 batches | lr 2.9e-05 | ms/batch 32.27 | loss  3.28 | ppl    26.490
total_loss: 28834.828186035156, total_len: 7360
total_loss: 31594.513473510742, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 136 at step    27200 | time:  6.38s | valid loss  3.92 | valid ppl    50.288
----------------------------------------------------------------------------------------------------
| epoch 114 step    27400 |     54 batches | lr 2.82e-05 | ms/batch 31.50 | loss  3.26 | ppl    26.106
total_loss: 28851.56169128418, total_len: 7360
total_loss: 31627.01052093506, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 137 at step    27400 | time:  6.35s | valid loss  3.92 | valid ppl    50.403
----------------------------------------------------------------------------------------------------
| epoch 115 step    27600 |     12 batches | lr 2.74e-05 | ms/batch 31.96 | loss  3.26 | ppl    25.940
total_loss: 28817.844635009766, total_len: 7360
total_loss: 31573.158279418945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 138 at step    27600 | time:  6.42s | valid loss  3.92 | valid ppl    50.173
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 115 step    27800 |    212 batches | lr 2.66e-05 | ms/batch 39.18 | loss  3.26 | ppl    25.953
total_loss: 28799.944702148438, total_len: 7360
total_loss: 31558.014755249023, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 139 at step    27800 | time:  6.69s | valid loss  3.91 | valid ppl    50.051
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 116 step    28000 |    170 batches | lr 2.58e-05 | ms/batch 39.44 | loss  3.25 | ppl    25.786
total_loss: 28811.100105285645, total_len: 7360
total_loss: 31581.83041381836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 140 at step    28000 | time:  6.66s | valid loss  3.91 | valid ppl    50.127
----------------------------------------------------------------------------------------------------
| epoch 117 step    28200 |    128 batches | lr 2.5e-05 | ms/batch 33.17 | loss  3.25 | ppl    25.869
total_loss: 28854.05958557129, total_len: 7360
total_loss: 31618.861694335938, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 141 at step    28200 | time:  6.63s | valid loss  3.92 | valid ppl    50.420
----------------------------------------------------------------------------------------------------
| epoch 118 step    28400 |     86 batches | lr 2.42e-05 | ms/batch 33.16 | loss  3.27 | ppl    26.197
total_loss: 28807.54574584961, total_len: 7360
total_loss: 31562.681602478027, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 142 at step    28400 | time:  6.64s | valid loss  3.91 | valid ppl    50.102
----------------------------------------------------------------------------------------------------
| epoch 119 step    28600 |     44 batches | lr 2.34e-05 | ms/batch 33.28 | loss  3.25 | ppl    25.756
total_loss: 28841.44416809082, total_len: 7360
total_loss: 31607.728469848633, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 143 at step    28600 | time:  6.65s | valid loss  3.92 | valid ppl    50.334
----------------------------------------------------------------------------------------------------
| epoch 120 step    28800 |      2 batches | lr 2.27e-05 | ms/batch 33.24 | loss  3.25 | ppl    25.664
total_loss: 28818.832885742188, total_len: 7360
total_loss: 31572.604888916016, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 144 at step    28800 | time:  7.01s | valid loss  3.92 | valid ppl    50.179
----------------------------------------------------------------------------------------------------
| epoch 120 step    29000 |    202 batches | lr 2.19e-05 | ms/batch 35.20 | loss  3.24 | ppl    25.642
total_loss: 28827.3565826416, total_len: 7360
total_loss: 31571.920806884766, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 145 at step    29000 | time:  6.60s | valid loss  3.92 | valid ppl    50.237
----------------------------------------------------------------------------------------------------
| epoch 121 step    29200 |    160 batches | lr 2.12e-05 | ms/batch 32.98 | loss  3.24 | ppl    25.627
total_loss: 28840.636726379395, total_len: 7360
total_loss: 31588.10799407959, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 146 at step    29200 | time:  7.04s | valid loss  3.92 | valid ppl    50.328
----------------------------------------------------------------------------------------------------
| epoch 122 step    29400 |    118 batches | lr 2.04e-05 | ms/batch 34.96 | loss  3.25 | ppl    25.712
total_loss: 28845.27484893799, total_len: 7360
total_loss: 31600.333137512207, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 147 at step    29400 | time:  6.60s | valid loss  3.92 | valid ppl    50.360
----------------------------------------------------------------------------------------------------
| epoch 123 step    29600 |     76 batches | lr 1.97e-05 | ms/batch 33.06 | loss  3.26 | ppl    26.030
total_loss: 28832.461097717285, total_len: 7360
total_loss: 31591.549102783203, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 148 at step    29600 | time:  6.57s | valid loss  3.92 | valid ppl    50.272
----------------------------------------------------------------------------------------------------
| epoch 124 step    29800 |     34 batches | lr 1.9e-05 | ms/batch 32.79 | loss  3.24 | ppl    25.511
total_loss: 28816.124229431152, total_len: 7360
total_loss: 31561.83851623535, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 149 at step    29800 | time:  6.56s | valid loss  3.92 | valid ppl    50.161
----------------------------------------------------------------------------------------------------
| epoch 124 step    30000 |    234 batches | lr 1.83e-05 | ms/batch 32.97 | loss  3.23 | ppl    25.396
total_loss: 28798.890434265137, total_len: 7360
total_loss: 31553.15668487549, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 150 at step    30000 | time:  7.06s | valid loss  3.91 | valid ppl    50.044
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 125 step    30200 |    192 batches | lr 1.76e-05 | ms/batch 42.34 | loss  3.24 | ppl    25.468
total_loss: 28789.132873535156, total_len: 7360
total_loss: 31547.07598876953, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 151 at step    30200 | time:  6.68s | valid loss  3.91 | valid ppl    49.977
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 126 step    30400 |    150 batches | lr 1.69e-05 | ms/batch 47.22 | loss  3.24 | ppl    25.420
total_loss: 28817.305633544922, total_len: 7360
total_loss: 31573.19309234619, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 152 at step    30400 | time:  8.87s | valid loss  3.92 | valid ppl    50.169
----------------------------------------------------------------------------------------------------
| epoch 127 step    30600 |    108 batches | lr 1.63e-05 | ms/batch 44.65 | loss  3.24 | ppl    25.617
total_loss: 28810.4594039917, total_len: 7360
total_loss: 31563.815879821777, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 153 at step    30600 | time:  6.73s | valid loss  3.91 | valid ppl    50.122
----------------------------------------------------------------------------------------------------
| epoch 128 step    30800 |     66 batches | lr 1.56e-05 | ms/batch 33.40 | loss  3.24 | ppl    25.621
total_loss: 28801.447814941406, total_len: 7360
total_loss: 31549.970901489258, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 154 at step    30800 | time:  6.59s | valid loss  3.91 | valid ppl    50.061
----------------------------------------------------------------------------------------------------
| epoch 129 step    31000 |     24 batches | lr 1.5e-05 | ms/batch 33.17 | loss  3.23 | ppl    25.276
total_loss: 28792.136810302734, total_len: 7360
total_loss: 31541.920722961426, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 155 at step    31000 | time:  6.72s | valid loss  3.91 | valid ppl    49.998
----------------------------------------------------------------------------------------------------
| epoch 129 step    31200 |    224 batches | lr 1.43e-05 | ms/batch 33.71 | loss  3.23 | ppl    25.255
total_loss: 28820.292182922363, total_len: 7360
total_loss: 31570.81036376953, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 156 at step    31200 | time:  6.84s | valid loss  3.92 | valid ppl    50.189
----------------------------------------------------------------------------------------------------
| epoch 130 step    31400 |    182 batches | lr 1.37e-05 | ms/batch 34.31 | loss  3.22 | ppl    25.123
total_loss: 28796.935928344727, total_len: 7360
total_loss: 31549.42852783203, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 157 at step    31400 | time:  6.98s | valid loss  3.91 | valid ppl    50.030
----------------------------------------------------------------------------------------------------
| epoch 131 step    31600 |    140 batches | lr 1.31e-05 | ms/batch 35.01 | loss  3.23 | ppl    25.292
total_loss: 28812.845260620117, total_len: 7360
total_loss: 31567.58790588379, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 158 at step    31600 | time:  6.68s | valid loss  3.91 | valid ppl    50.138
----------------------------------------------------------------------------------------------------
| epoch 132 step    31800 |     98 batches | lr 1.25e-05 | ms/batch 33.33 | loss  3.24 | ppl    25.497
total_loss: 28812.80672454834, total_len: 7360
total_loss: 31570.317558288574, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 159 at step    31800 | time:  6.66s | valid loss  3.91 | valid ppl    50.138
----------------------------------------------------------------------------------------------------
| epoch 133 step    32000 |     56 batches | lr 1.19e-05 | ms/batch 33.30 | loss  3.23 | ppl    25.394
total_loss: 28783.611305236816, total_len: 7360
total_loss: 31533.247230529785, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 160 at step    32000 | time:  6.99s | valid loss  3.91 | valid ppl    49.940
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 134 step    32200 |     14 batches | lr 1.14e-05 | ms/batch 41.06 | loss  3.22 | ppl    25.111
total_loss: 28794.063766479492, total_len: 7360
total_loss: 31541.976524353027, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 161 at step    32200 | time:  6.91s | valid loss  3.91 | valid ppl    50.011
----------------------------------------------------------------------------------------------------
| epoch 134 step    32400 |    214 batches | lr 1.08e-05 | ms/batch 34.34 | loss  3.22 | ppl    25.112
total_loss: 28781.561836242676, total_len: 7360
total_loss: 31527.88759613037, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 162 at step    32400 | time:  7.17s | valid loss  3.91 | valid ppl    49.926
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 135 step    32600 |    172 batches | lr 1.03e-05 | ms/batch 47.34 | loss  3.22 | ppl    25.023
total_loss: 28782.2491607666, total_len: 7360
total_loss: 31525.254753112793, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 163 at step    32600 | time:  7.07s | valid loss  3.91 | valid ppl    49.930
----------------------------------------------------------------------------------------------------
| epoch 136 step    32800 |    130 batches | lr 9.73e-06 | ms/batch 34.08 | loss  3.22 | ppl    25.105
total_loss: 28823.41216278076, total_len: 7360
total_loss: 31571.64525604248, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 164 at step    32800 | time:  6.74s | valid loss  3.92 | valid ppl    50.211
----------------------------------------------------------------------------------------------------
| epoch 137 step    33000 |     88 batches | lr 9.21e-06 | ms/batch 33.75 | loss  3.24 | ppl    25.489
total_loss: 28796.51821899414, total_len: 7360
total_loss: 31539.098823547363, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 165 at step    33000 | time:  6.72s | valid loss  3.91 | valid ppl    50.027
----------------------------------------------------------------------------------------------------
| epoch 138 step    33200 |     46 batches | lr 8.7e-06 | ms/batch 33.68 | loss  3.23 | ppl    25.158
total_loss: 28797.83829498291, total_len: 7360
total_loss: 31539.742385864258, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 166 at step    33200 | time:  6.55s | valid loss  3.91 | valid ppl    50.036
----------------------------------------------------------------------------------------------------
| epoch 139 step    33400 |      4 batches | lr 8.21e-06 | ms/batch 32.55 | loss  3.22 | ppl    24.963
total_loss: 28791.002197265625, total_len: 7360
total_loss: 31536.766090393066, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 167 at step    33400 | time:  6.50s | valid loss  3.91 | valid ppl    49.990
----------------------------------------------------------------------------------------------------
| epoch 139 step    33600 |    204 batches | lr 7.73e-06 | ms/batch 32.38 | loss  3.22 | ppl    24.948
total_loss: 28797.01580810547, total_len: 7360
total_loss: 31543.71262359619, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 168 at step    33600 | time:  6.79s | valid loss  3.91 | valid ppl    50.031
----------------------------------------------------------------------------------------------------
| epoch 140 step    33800 |    162 batches | lr 7.26e-06 | ms/batch 34.15 | loss  3.22 | ppl    24.985
total_loss: 28806.83967590332, total_len: 7360
total_loss: 31549.312545776367, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 169 at step    33800 | time:  6.64s | valid loss  3.91 | valid ppl    50.098
----------------------------------------------------------------------------------------------------
| epoch 141 step    34000 |    120 batches | lr 6.81e-06 | ms/batch 33.49 | loss  3.22 | ppl    24.995
total_loss: 28781.78077697754, total_len: 7360
total_loss: 31523.93172454834, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 170 at step    34000 | time:  8.10s | valid loss  3.91 | valid ppl    49.927
----------------------------------------------------------------------------------------------------
| epoch 142 step    34200 |     78 batches | lr 6.37e-06 | ms/batch 41.66 | loss  3.24 | ppl    25.493
total_loss: 28785.82624053955, total_len: 7360
total_loss: 31528.469108581543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 171 at step    34200 | time:  6.84s | valid loss  3.91 | valid ppl    49.955
----------------------------------------------------------------------------------------------------
| epoch 143 step    34400 |     36 batches | lr 5.95e-06 | ms/batch 33.94 | loss  3.22 | ppl    24.945
total_loss: 28781.591873168945, total_len: 7360
total_loss: 31520.46050262451, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 172 at step    34400 | time:  6.90s | valid loss  3.91 | valid ppl    49.926
----------------------------------------------------------------------------------------------------
| epoch 143 step    34600 |    236 batches | lr 5.54e-06 | ms/batch 34.65 | loss  3.21 | ppl    24.856
total_loss: 28797.156730651855, total_len: 7360
total_loss: 31538.308837890625, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 173 at step    34600 | time:  6.96s | valid loss  3.91 | valid ppl    50.032
----------------------------------------------------------------------------------------------------
| epoch 144 step    34800 |    194 batches | lr 5.14e-06 | ms/batch 34.83 | loss  3.22 | ppl    24.937
total_loss: 28776.249740600586, total_len: 7360
total_loss: 31516.314346313477, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 174 at step    34800 | time:  7.03s | valid loss  3.91 | valid ppl    49.890
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 145 step    35000 |    152 batches | lr 4.76e-06 | ms/batch 43.11 | loss  3.21 | ppl    24.870
total_loss: 28787.67845916748, total_len: 7360
total_loss: 31526.905448913574, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 175 at step    35000 | time:  6.77s | valid loss  3.91 | valid ppl    49.967
----------------------------------------------------------------------------------------------------
| epoch 146 step    35200 |    110 batches | lr 4.39e-06 | ms/batch 33.68 | loss  3.22 | ppl    25.115
total_loss: 28776.312545776367, total_len: 7360
total_loss: 31517.024978637695, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 176 at step    35200 | time:  7.31s | valid loss  3.91 | valid ppl    49.890
----------------------------------------------------------------------------------------------------
| epoch 147 step    35400 |     68 batches | lr 4.03e-06 | ms/batch 35.89 | loss  3.23 | ppl    25.294
total_loss: 28778.018600463867, total_len: 7360
total_loss: 31517.627502441406, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 177 at step    35400 | time:  7.16s | valid loss  3.91 | valid ppl    49.902
----------------------------------------------------------------------------------------------------
| epoch 148 step    35600 |     26 batches | lr 3.69e-06 | ms/batch 33.44 | loss  3.21 | ppl    24.883
total_loss: 28780.8023147583, total_len: 7360
total_loss: 31522.272583007812, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 178 at step    35600 | time:  6.99s | valid loss  3.91 | valid ppl    49.921
----------------------------------------------------------------------------------------------------
| epoch 148 step    35800 |    226 batches | lr 3.37e-06 | ms/batch 34.98 | loss  3.21 | ppl    24.818
total_loss: 28780.33982849121, total_len: 7360
total_loss: 31519.091484069824, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 179 at step    35800 | time:  7.01s | valid loss  3.91 | valid ppl    49.918
----------------------------------------------------------------------------------------------------
| epoch 149 step    36000 |    184 batches | lr 3.06e-06 | ms/batch 32.76 | loss  3.21 | ppl    24.703
total_loss: 28779.939819335938, total_len: 7360
total_loss: 31520.508819580078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 180 at step    36000 | time:  6.80s | valid loss  3.91 | valid ppl    49.915
----------------------------------------------------------------------------------------------------
| epoch 150 step    36200 |    142 batches | lr 2.76e-06 | ms/batch 33.57 | loss  3.21 | ppl    24.882
total_loss: 28780.791107177734, total_len: 7360
total_loss: 31522.72841644287, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 181 at step    36200 | time:  6.56s | valid loss  3.91 | valid ppl    49.921
----------------------------------------------------------------------------------------------------
| epoch 151 step    36400 |    100 batches | lr 2.48e-06 | ms/batch 32.70 | loss  3.23 | ppl    25.162
total_loss: 28780.477081298828, total_len: 7360
total_loss: 31520.51434326172, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 182 at step    36400 | time:  6.56s | valid loss  3.91 | valid ppl    49.918
----------------------------------------------------------------------------------------------------
| epoch 152 step    36600 |     58 batches | lr 2.22e-06 | ms/batch 32.87 | loss  3.22 | ppl    25.046
total_loss: 28776.438446044922, total_len: 7360
total_loss: 31516.60590362549, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 183 at step    36600 | time:  7.32s | valid loss  3.91 | valid ppl    49.891
----------------------------------------------------------------------------------------------------
| epoch 153 step    36800 |     16 batches | lr 1.96e-06 | ms/batch 36.74 | loss  3.21 | ppl    24.807
total_loss: 28777.491554260254, total_len: 7360
total_loss: 31518.337882995605, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 184 at step    36800 | time:  6.62s | valid loss  3.91 | valid ppl    49.898
----------------------------------------------------------------------------------------------------
| epoch 153 step    37000 |    216 batches | lr 1.73e-06 | ms/batch 33.04 | loss  3.21 | ppl    24.809
total_loss: 28779.00873565674, total_len: 7360
total_loss: 31522.013694763184, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 185 at step    37000 | time:  6.53s | valid loss  3.91 | valid ppl    49.909
----------------------------------------------------------------------------------------------------
| epoch 154 step    37200 |    174 batches | lr 1.51e-06 | ms/batch 32.62 | loss  3.21 | ppl    24.742
total_loss: 28780.561408996582, total_len: 7360
total_loss: 31523.094619750977, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 186 at step    37200 | time:  6.52s | valid loss  3.91 | valid ppl    49.919
----------------------------------------------------------------------------------------------------
| epoch 155 step    37400 |    132 batches | lr 1.3e-06 | ms/batch 32.65 | loss  3.21 | ppl    24.871
total_loss: 28781.086837768555, total_len: 7360
total_loss: 31524.29119873047, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 187 at step    37400 | time:  6.53s | valid loss  3.91 | valid ppl    49.923
----------------------------------------------------------------------------------------------------
| epoch 156 step    37600 |     90 batches | lr 1.11e-06 | ms/batch 32.53 | loss  3.23 | ppl    25.217
total_loss: 28772.73052215576, total_len: 7360
total_loss: 31512.329864501953, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 188 at step    37600 | time:  6.74s | valid loss  3.91 | valid ppl    49.866
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 157 step    37800 |     48 batches | lr 9.31e-07 | ms/batch 44.65 | loss  3.22 | ppl    24.950
total_loss: 28775.982315063477, total_len: 7360
total_loss: 31517.18647003174, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 189 at step    37800 | time:  6.68s | valid loss  3.91 | valid ppl    49.888
----------------------------------------------------------------------------------------------------
| epoch 158 step    38000 |      6 batches | lr 7.69e-07 | ms/batch 34.15 | loss  3.21 | ppl    24.742
total_loss: 28778.09780883789, total_len: 7360
total_loss: 31518.902053833008, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 190 at step    38000 | time:  6.80s | valid loss  3.91 | valid ppl    49.902
----------------------------------------------------------------------------------------------------
| epoch 158 step    38200 |    206 batches | lr 6.24e-07 | ms/batch 33.78 | loss  3.21 | ppl    24.734
total_loss: 28775.93601989746, total_len: 7360
total_loss: 31516.380531311035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 191 at step    38200 | time:  6.78s | valid loss  3.91 | valid ppl    49.888
----------------------------------------------------------------------------------------------------
| epoch 159 step    38400 |    164 batches | lr 4.93e-07 | ms/batch 33.78 | loss  3.21 | ppl    24.781
total_loss: 28778.014350891113, total_len: 7360
total_loss: 31519.00961303711, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 192 at step    38400 | time:  6.81s | valid loss  3.91 | valid ppl    49.902
----------------------------------------------------------------------------------------------------
| epoch 160 step    38600 |    122 batches | lr 3.77e-07 | ms/batch 34.18 | loss  3.21 | ppl    24.863
total_loss: 28779.595993041992, total_len: 7360
total_loss: 31519.784698486328, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 193 at step    38600 | time:  6.74s | valid loss  3.91 | valid ppl    49.912
----------------------------------------------------------------------------------------------------
| epoch 161 step    38800 |     80 batches | lr 2.77e-07 | ms/batch 33.50 | loss  3.23 | ppl    25.238
total_loss: 28777.447441101074, total_len: 7360
total_loss: 31518.097869873047, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 194 at step    38800 | time:  6.70s | valid loss  3.91 | valid ppl    49.898
----------------------------------------------------------------------------------------------------
| epoch 162 step    39000 |     38 batches | lr 1.93e-07 | ms/batch 33.03 | loss  3.21 | ppl    24.767
total_loss: 28776.601684570312, total_len: 7360
total_loss: 31517.186164855957, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 195 at step    39000 | time:  6.60s | valid loss  3.91 | valid ppl    49.892
----------------------------------------------------------------------------------------------------
| epoch 162 step    39200 |    238 batches | lr 1.23e-07 | ms/batch 33.39 | loss  3.21 | ppl    24.725
total_loss: 28776.492874145508, total_len: 7360
total_loss: 31517.180145263672, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 196 at step    39200 | time:  6.67s | valid loss  3.91 | valid ppl    49.891
----------------------------------------------------------------------------------------------------
| epoch 163 step    39400 |    196 batches | lr 6.94e-08 | ms/batch 33.36 | loss  3.21 | ppl    24.771
total_loss: 28777.193489074707, total_len: 7360
total_loss: 31517.687171936035, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 197 at step    39400 | time:  6.63s | valid loss  3.91 | valid ppl    49.896
----------------------------------------------------------------------------------------------------
| epoch 164 step    39600 |    154 batches | lr 3.08e-08 | ms/batch 33.03 | loss  3.21 | ppl    24.733
total_loss: 28777.324363708496, total_len: 7360
total_loss: 31517.739082336426, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 198 at step    39600 | time:  6.64s | valid loss  3.91 | valid ppl    49.897
----------------------------------------------------------------------------------------------------
| epoch 165 step    39800 |    112 batches | lr 7.71e-09 | ms/batch 33.18 | loss  3.22 | ppl    24.964
total_loss: 28777.029327392578, total_len: 7360
total_loss: 31517.459060668945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 199 at step    39800 | time:  6.65s | valid loss  3.91 | valid ppl    49.895
----------------------------------------------------------------------------------------------------
| epoch 166 step    40000 |     70 batches | lr 0 | ms/batch 33.21 | loss  3.22 | ppl    25.105
total_loss: 28776.989265441895, total_len: 7360
total_loss: 31517.419998168945, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 200 at step    40000 | time:  6.98s | valid loss  3.91 | valid ppl    49.895
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
End of training
total_loss: 31512.329864501953, total_len: 8224
====================================================================================================
| End of training | test loss  3.83 | test ppl    46.143
====================================================================================================
Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 13
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_13_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
Training on Single GPU......
====================================================================================================
    - data : ../penn/
    - dataset : ptb
    - model : tensorized
    - n_layer : 3
    - n_head : 1
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 2100
    - dropout : 0.3
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.000125
    - mom : 0.0
    - scheduler : cosine
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 40000
    - max_epoch : 200
    - batch_size : 120
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 13
    - cuda : True
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - esd_interval : 200
    - eval_interval : 1000
    - work_dir : /jumbo/yaoqingyang/ewongchassine/Projects/TempBalance/language_modeling/checkpoints/tensorized/baseline/ptb-adam/bs120/tensor_transformer_3layer/head_1/max_step40000_max_epoch200_log_interval200/median_xmin_pos2/seed_13_lr_0.000125
    - restart : False
    - restart_dir : 
    - debug : True
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : 1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - xmin_pos : 2
    - pl_fitting : median
    - filter_zeros : False
    - wdecay : 1.2e-06
    - eps : 0.0001
    - beta1 : 0.9
    - beta2 : 0.999
    - block_length : 4
    - tied : True
    - n_token : 10000
    - n_all_param : 6715252
    - n_nonemb_param : 4145172
    - self_attention_param : 910968
====================================================================================================
#params = 6715252
#non emb params = 4145172
#self attention params = 910968
total_loss: 71380.69039916992, total_len: 7744
total_loss: 75822.42971801758, total_len: 8224
total_loss: 67878.63623046875, total_len: 7360
| Start of training | test loss  9.22 | test bpc 10093.56548
| epoch   1 step      200 |    200 batches | lr 0.000125 | ms/batch 40.74 | loss  7.04 | ppl  1146.523
total_loss: 45486.224533081055, total_len: 7360
total_loss: 50434.29530334473, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   1 at step      200 | time:  9.66s | valid loss  6.18 | valid ppl   483.085
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   2 step      400 |    158 batches | lr 0.000125 | ms/batch 42.26 | loss  6.06 | ppl   429.852
total_loss: 42743.76385498047, total_len: 7360
total_loss: 47335.511657714844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   2 at step      400 | time:  7.21s | valid loss  5.81 | valid ppl   332.812
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   3 step      600 |    116 batches | lr 0.000125 | ms/batch 40.41 | loss  5.79 | ppl   325.809
total_loss: 41372.989654541016, total_len: 7360
total_loss: 45801.89958190918, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   3 at step      600 | time:  6.85s | valid loss  5.62 | valid ppl   276.257
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   4 step      800 |     74 batches | lr 0.000125 | ms/batch 40.35 | loss  5.64 | ppl   281.700
total_loss: 40523.430114746094, total_len: 7360
total_loss: 44844.548767089844, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   4 at step      800 | time:  6.94s | valid loss  5.51 | valid ppl   246.140
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1000 |     32 batches | lr 0.000125 | ms/batch 40.30 | loss  5.51 | ppl   248.178
total_loss: 39916.62031555176, total_len: 7360
total_loss: 44182.13514709473, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1000 | time:  6.87s | valid loss  5.42 | valid ppl   226.661
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   5 step     1200 |    232 batches | lr 0.000125 | ms/batch 40.23 | loss  5.42 | ppl   226.188
total_loss: 39416.49494934082, total_len: 7360
total_loss: 43641.74835205078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1200 | time:  6.89s | valid loss  5.36 | valid ppl   211.770
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   6 step     1400 |    190 batches | lr 0.000125 | ms/batch 40.32 | loss  5.35 | ppl   210.029
total_loss: 39000.8758392334, total_len: 7360
total_loss: 43152.80471801758, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1400 | time:  6.87s | valid loss  5.30 | valid ppl   200.143
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   7 step     1600 |    148 batches | lr 0.000125 | ms/batch 40.56 | loss  5.28 | ppl   196.902
total_loss: 38627.42266845703, total_len: 7360
total_loss: 42744.37504577637, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   8 at step     1600 | time:  6.91s | valid loss  5.25 | valid ppl   190.241
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   8 step     1800 |    106 batches | lr 0.000124 | ms/batch 40.13 | loss  5.23 | ppl   186.609
total_loss: 38246.50840759277, total_len: 7360
total_loss: 42310.51560974121, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval   9 at step     1800 | time:  6.85s | valid loss  5.20 | valid ppl   180.645
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch   9 step     2000 |     64 batches | lr 0.000124 | ms/batch 40.14 | loss  5.18 | ppl   176.925
total_loss: 37895.848083496094, total_len: 7360
total_loss: 41917.08822631836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2000 | time:  6.87s | valid loss  5.15 | valid ppl   172.241
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2200 |     22 batches | lr 0.000124 | ms/batch 39.91 | loss  5.11 | ppl   166.224
total_loss: 37619.18664550781, total_len: 7360
total_loss: 41580.37814331055, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2200 | time:  6.89s | valid loss  5.11 | valid ppl   165.886
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  10 step     2400 |    222 batches | lr 0.000124 | ms/batch 40.53 | loss  5.07 | ppl   159.340
total_loss: 37332.68566894531, total_len: 7360
total_loss: 41262.81141662598, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  12 at step     2400 | time:  6.87s | valid loss  5.07 | valid ppl   159.553
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  11 step     2600 |    180 batches | lr 0.000124 | ms/batch 40.11 | loss  5.03 | ppl   152.769
total_loss: 37107.26092529297, total_len: 7360
total_loss: 41005.58738708496, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  13 at step     2600 | time:  6.89s | valid loss  5.04 | valid ppl   154.740
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  12 step     2800 |    138 batches | lr 0.000123 | ms/batch 40.23 | loss  4.99 | ppl   146.485
total_loss: 36839.79393005371, total_len: 7360
total_loss: 40700.85369873047, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  14 at step     2800 | time:  6.88s | valid loss  5.01 | valid ppl   149.218
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  13 step     3000 |     96 batches | lr 0.000123 | ms/batch 40.36 | loss  4.95 | ppl   140.940
total_loss: 36448.30587005615, total_len: 7360
total_loss: 40225.713943481445, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3000 | time:  6.87s | valid loss  4.95 | valid ppl   141.488
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  14 step     3200 |     54 batches | lr 0.000123 | ms/batch 40.08 | loss  4.88 | ppl   132.167
total_loss: 35994.59889984131, total_len: 7360
total_loss: 39754.938064575195, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  16 at step     3200 | time:  6.88s | valid loss  4.89 | valid ppl   133.029
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3400 |     12 batches | lr 0.000123 | ms/batch 40.30 | loss  4.82 | ppl   124.299
total_loss: 35678.58288574219, total_len: 7360
total_loss: 39412.699768066406, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  17 at step     3400 | time:  6.88s | valid loss  4.85 | valid ppl   127.438
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  15 step     3600 |    212 batches | lr 0.000123 | ms/batch 39.47 | loss  4.77 | ppl   118.270
total_loss: 35368.27072906494, total_len: 7360
total_loss: 39049.944747924805, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  18 at step     3600 | time:  6.86s | valid loss  4.81 | valid ppl   122.177
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  16 step     3800 |    170 batches | lr 0.000122 | ms/batch 40.10 | loss  4.72 | ppl   112.211
total_loss: 35049.906829833984, total_len: 7360
total_loss: 38715.97462463379, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  19 at step     3800 | time:  6.88s | valid loss  4.76 | valid ppl   117.005
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  17 step     4000 |    128 batches | lr 0.000122 | ms/batch 40.15 | loss  4.68 | ppl   107.600
total_loss: 34834.21410369873, total_len: 7360
total_loss: 38455.519218444824, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  20 at step     4000 | time:  6.87s | valid loss  4.73 | valid ppl   113.626
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  18 step     4200 |     86 batches | lr 0.000122 | ms/batch 40.34 | loss  4.66 | ppl   105.305
total_loss: 34653.6901550293, total_len: 7360
total_loss: 38234.800354003906, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  21 at step     4200 | time:  6.92s | valid loss  4.71 | valid ppl   110.873
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  19 step     4400 |     44 batches | lr 0.000121 | ms/batch 39.26 | loss  4.60 | ppl    99.894
total_loss: 34402.223876953125, total_len: 7360
total_loss: 37978.07994842529, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  22 at step     4400 | time:  6.84s | valid loss  4.67 | valid ppl   107.148
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4600 |      2 batches | lr 0.000121 | ms/batch 42.95 | loss  4.57 | ppl    96.508
total_loss: 34222.39897155762, total_len: 7360
total_loss: 37794.34644317627, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  23 at step     4600 | time:  6.89s | valid loss  4.65 | valid ppl   104.562
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  20 step     4800 |    202 batches | lr 0.000121 | ms/batch 40.20 | loss  4.54 | ppl    93.646
total_loss: 34083.44649505615, total_len: 7360
total_loss: 37608.301612854004, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  24 at step     4800 | time:  6.86s | valid loss  4.63 | valid ppl   102.607
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  21 step     5000 |    160 batches | lr 0.00012 | ms/batch 40.18 | loss  4.51 | ppl    91.111
total_loss: 33917.54721069336, total_len: 7360
total_loss: 37429.96236419678, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  25 at step     5000 | time:  6.87s | valid loss  4.61 | valid ppl   100.320
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  22 step     5200 |    118 batches | lr 0.00012 | ms/batch 40.00 | loss  4.49 | ppl    89.323
total_loss: 33826.55766296387, total_len: 7360
total_loss: 37318.84288024902, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  26 at step     5200 | time:  6.80s | valid loss  4.60 | valid ppl    99.087
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  23 step     5400 |     76 batches | lr 0.000119 | ms/batch 39.34 | loss  4.49 | ppl    88.895
total_loss: 33630.70566558838, total_len: 7360
total_loss: 37103.82782745361, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  27 at step     5400 | time:  6.75s | valid loss  4.57 | valid ppl    96.485
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5600 |     34 batches | lr 0.000119 | ms/batch 39.89 | loss  4.44 | ppl    84.964
total_loss: 33554.18416595459, total_len: 7360
total_loss: 37035.93228149414, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  28 at step     5600 | time:  6.76s | valid loss  4.56 | valid ppl    95.487
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  24 step     5800 |    234 batches | lr 0.000119 | ms/batch 39.35 | loss  4.42 | ppl    83.265
total_loss: 33411.83367919922, total_len: 7360
total_loss: 36878.060859680176, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  29 at step     5800 | time:  6.72s | valid loss  4.54 | valid ppl    93.658
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  25 step     6000 |    192 batches | lr 0.000118 | ms/batch 39.41 | loss  4.41 | ppl    82.273
total_loss: 33278.974029541016, total_len: 7360
total_loss: 36727.43549346924, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  30 at step     6000 | time:  6.74s | valid loss  4.52 | valid ppl    91.983
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  26 step     6200 |    150 batches | lr 0.000118 | ms/batch 39.13 | loss  4.38 | ppl    79.502
total_loss: 33133.801765441895, total_len: 7360
total_loss: 36552.25882720947, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  31 at step     6200 | time:  6.71s | valid loss  4.50 | valid ppl    90.186
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  27 step     6400 |    108 batches | lr 0.000117 | ms/batch 39.57 | loss  4.36 | ppl    78.299
total_loss: 33083.04490661621, total_len: 7360
total_loss: 36503.4063873291, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  32 at step     6400 | time:  6.73s | valid loss  4.49 | valid ppl    89.566
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  28 step     6600 |     66 batches | lr 0.000117 | ms/batch 39.24 | loss  4.34 | ppl    76.461
total_loss: 32886.514404296875, total_len: 7360
total_loss: 36290.43322753906, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  33 at step     6600 | time:  6.72s | valid loss  4.47 | valid ppl    87.206
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     6800 |     24 batches | lr 0.000116 | ms/batch 39.47 | loss  4.29 | ppl    73.208
total_loss: 32819.32731628418, total_len: 7360
total_loss: 36213.16192626953, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  34 at step     6800 | time:  6.73s | valid loss  4.46 | valid ppl    86.414
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  29 step     7000 |    224 batches | lr 0.000116 | ms/batch 39.60 | loss  4.27 | ppl    71.365
total_loss: 32611.801933288574, total_len: 7360
total_loss: 35987.84519195557, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  35 at step     7000 | time:  6.73s | valid loss  4.43 | valid ppl    84.011
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  30 step     7200 |    182 batches | lr 0.000115 | ms/batch 39.73 | loss  4.24 | ppl    69.431
total_loss: 32487.938064575195, total_len: 7360
total_loss: 35857.0715713501, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  36 at step     7200 | time:  6.74s | valid loss  4.41 | valid ppl    82.609
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  31 step     7400 |    140 batches | lr 0.000115 | ms/batch 39.60 | loss  4.22 | ppl    67.838
total_loss: 32398.589767456055, total_len: 7360
total_loss: 35750.57182312012, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  37 at step     7400 | time:  6.73s | valid loss  4.40 | valid ppl    81.612
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  32 step     7600 |     98 batches | lr 0.000114 | ms/batch 39.38 | loss  4.21 | ppl    67.066
total_loss: 32242.96312713623, total_len: 7360
total_loss: 35565.1215133667, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  38 at step     7600 | time:  6.86s | valid loss  4.38 | valid ppl    79.905
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  33 step     7800 |     56 batches | lr 0.000114 | ms/batch 40.58 | loss  4.18 | ppl    65.258
total_loss: 32188.828239440918, total_len: 7360
total_loss: 35500.37105560303, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  39 at step     7800 | time:  6.84s | valid loss  4.37 | valid ppl    79.319
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8000 |     14 batches | lr 0.000113 | ms/batch 39.96 | loss  4.14 | ppl    63.001
total_loss: 32103.704078674316, total_len: 7360
total_loss: 35400.64264678955, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  40 at step     8000 | time:  6.87s | valid loss  4.36 | valid ppl    78.407
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  34 step     8200 |    214 batches | lr 0.000112 | ms/batch 40.17 | loss  4.13 | ppl    62.074
total_loss: 32023.273956298828, total_len: 7360
total_loss: 35283.679695129395, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  41 at step     8200 | time:  6.86s | valid loss  4.35 | valid ppl    77.555
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  35 step     8400 |    172 batches | lr 0.000112 | ms/batch 39.54 | loss  4.11 | ppl    60.658
total_loss: 31914.36772918701, total_len: 7360
total_loss: 35186.99131011963, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  42 at step     8400 | time:  6.73s | valid loss  4.34 | valid ppl    76.416
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  36 step     8600 |    130 batches | lr 0.000111 | ms/batch 38.95 | loss  4.09 | ppl    59.635
total_loss: 31869.873901367188, total_len: 7360
total_loss: 35126.88974761963, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  43 at step     8600 | time:  6.71s | valid loss  4.33 | valid ppl    75.955
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  37 step     8800 |     88 batches | lr 0.000111 | ms/batch 39.33 | loss  4.09 | ppl    59.506
total_loss: 31781.280158996582, total_len: 7360
total_loss: 35032.38634490967, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  44 at step     8800 | time:  6.72s | valid loss  4.32 | valid ppl    75.047
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  38 step     9000 |     46 batches | lr 0.00011 | ms/batch 37.52 | loss  4.05 | ppl    57.525
total_loss: 31672.061965942383, total_len: 7360
total_loss: 34911.353355407715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  45 at step     9000 | time:  6.70s | valid loss  4.30 | valid ppl    73.941
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9200 |      4 batches | lr 0.000109 | ms/batch 39.48 | loss  4.03 | ppl    56.149
total_loss: 31654.896324157715, total_len: 7360
total_loss: 34896.408432006836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  46 at step     9200 | time:  6.73s | valid loss  4.30 | valid ppl    73.769
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  39 step     9400 |    204 batches | lr 0.000109 | ms/batch 37.88 | loss  4.01 | ppl    55.333
total_loss: 31542.618423461914, total_len: 7360
total_loss: 34761.70043182373, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  47 at step     9400 | time:  6.71s | valid loss  4.29 | valid ppl    72.652
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  40 step     9600 |    162 batches | lr 0.000108 | ms/batch 39.48 | loss  3.99 | ppl    54.324
total_loss: 31507.106231689453, total_len: 7360
total_loss: 34719.03276062012, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  48 at step     9600 | time:  6.72s | valid loss  4.28 | valid ppl    72.302
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  41 step     9800 |    120 batches | lr 0.000107 | ms/batch 39.15 | loss  3.98 | ppl    53.670
total_loss: 31447.586769104004, total_len: 7360
total_loss: 34650.98229980469, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  49 at step     9800 | time:  6.73s | valid loss  4.27 | valid ppl    71.720
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  42 step    10000 |     78 batches | lr 0.000107 | ms/batch 39.36 | loss  3.99 | ppl    53.893
total_loss: 31421.66275024414, total_len: 7360
total_loss: 34611.63538360596, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  50 at step    10000 | time:  6.72s | valid loss  4.27 | valid ppl    71.468
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10200 |     36 batches | lr 0.000106 | ms/batch 39.42 | loss  3.95 | ppl    51.854
total_loss: 31313.106086730957, total_len: 7360
total_loss: 34493.4889831543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  51 at step    10200 | time:  6.73s | valid loss  4.25 | valid ppl    70.421
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  43 step    10400 |    236 batches | lr 0.000105 | ms/batch 39.38 | loss  3.93 | ppl    51.008
total_loss: 31332.61541748047, total_len: 7360
total_loss: 34502.65280151367, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  52 at step    10400 | time:  6.77s | valid loss  4.26 | valid ppl    70.608
----------------------------------------------------------------------------------------------------
| epoch  44 step    10600 |    194 batches | lr 0.000105 | ms/batch 33.62 | loss  3.92 | ppl    50.482
total_loss: 31246.698120117188, total_len: 7360
total_loss: 34425.54141998291, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  53 at step    10600 | time:  6.73s | valid loss  4.25 | valid ppl    69.789
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  45 step    10800 |    152 batches | lr 0.000104 | ms/batch 39.17 | loss  3.90 | ppl    49.621
total_loss: 31201.613609313965, total_len: 7360
total_loss: 34354.87936401367, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  54 at step    10800 | time:  6.72s | valid loss  4.24 | valid ppl    69.363
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  46 step    11000 |    110 batches | lr 0.000103 | ms/batch 39.36 | loss  3.90 | ppl    49.500
total_loss: 31152.22679901123, total_len: 7360
total_loss: 34316.88774108887, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  55 at step    11000 | time:  6.74s | valid loss  4.23 | valid ppl    68.899
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  47 step    11200 |     68 batches | lr 0.000102 | ms/batch 39.34 | loss  3.90 | ppl    49.196
total_loss: 31123.036979675293, total_len: 7360
total_loss: 34268.616607666016, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  56 at step    11200 | time:  6.73s | valid loss  4.23 | valid ppl    68.626
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11400 |     26 batches | lr 0.000102 | ms/batch 39.31 | loss  3.87 | ppl    47.852
total_loss: 31076.994140625, total_len: 7360
total_loss: 34212.23607635498, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  57 at step    11400 | time:  6.74s | valid loss  4.22 | valid ppl    68.198
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  48 step    11600 |    226 batches | lr 0.000101 | ms/batch 39.41 | loss  3.86 | ppl    47.236
total_loss: 31076.261421203613, total_len: 7360
total_loss: 34215.48645019531, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  58 at step    11600 | time:  6.74s | valid loss  4.22 | valid ppl    68.191
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  49 step    11800 |    184 batches | lr 0.0001 | ms/batch 39.27 | loss  3.84 | ppl    46.656
total_loss: 30995.173469543457, total_len: 7360
total_loss: 34129.52934265137, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  59 at step    11800 | time:  6.73s | valid loss  4.21 | valid ppl    67.444
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  50 step    12000 |    142 batches | lr 9.92e-05 | ms/batch 48.88 | loss  3.84 | ppl    46.324
total_loss: 30985.676040649414, total_len: 7360
total_loss: 34104.22430419922, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  60 at step    12000 | time:  6.80s | valid loss  4.21 | valid ppl    67.357
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  51 step    12200 |    100 batches | lr 9.84e-05 | ms/batch 39.84 | loss  3.83 | ppl    46.238
total_loss: 30936.760940551758, total_len: 7360
total_loss: 34042.52568817139, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  61 at step    12200 | time:  6.86s | valid loss  4.20 | valid ppl    66.911
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  52 step    12400 |     58 batches | lr 9.76e-05 | ms/batch 39.21 | loss  3.82 | ppl    45.565
total_loss: 30898.39186859131, total_len: 7360
total_loss: 34008.71928405762, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  62 at step    12400 | time:  6.84s | valid loss  4.20 | valid ppl    66.563
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12600 |     16 batches | lr 9.68e-05 | ms/batch 39.81 | loss  3.79 | ppl    44.434
total_loss: 30842.173225402832, total_len: 7360
total_loss: 33958.731033325195, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  63 at step    12600 | time:  6.85s | valid loss  4.19 | valid ppl    66.057
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  53 step    12800 |    216 batches | lr 9.6e-05 | ms/batch 40.05 | loss  3.78 | ppl    44.004
total_loss: 30800.547721862793, total_len: 7360
total_loss: 33913.64759063721, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  64 at step    12800 | time:  6.78s | valid loss  4.18 | valid ppl    65.684
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  54 step    13000 |    174 batches | lr 9.52e-05 | ms/batch 40.82 | loss  3.77 | ppl    43.444
total_loss: 30804.575744628906, total_len: 7360
total_loss: 33889.94342803955, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  65 at step    13000 | time:  6.98s | valid loss  4.19 | valid ppl    65.720
----------------------------------------------------------------------------------------------------
| epoch  55 step    13200 |    132 batches | lr 9.43e-05 | ms/batch 34.32 | loss  3.76 | ppl    43.161
total_loss: 30758.58331298828, total_len: 7360
total_loss: 33843.640075683594, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  66 at step    13200 | time:  6.85s | valid loss  4.18 | valid ppl    65.311
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  56 step    13400 |     90 batches | lr 9.35e-05 | ms/batch 40.12 | loss  3.77 | ppl    43.472
total_loss: 30735.129890441895, total_len: 7360
total_loss: 33831.41938018799, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  67 at step    13400 | time:  6.88s | valid loss  4.18 | valid ppl    65.103
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  57 step    13600 |     48 batches | lr 9.26e-05 | ms/batch 40.05 | loss  3.75 | ppl    42.362
total_loss: 30691.57984161377, total_len: 7360
total_loss: 33770.6909866333, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  68 at step    13600 | time:  6.86s | valid loss  4.17 | valid ppl    64.719
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    13800 |      6 batches | lr 9.17e-05 | ms/batch 40.19 | loss  3.73 | ppl    41.660
total_loss: 30627.68620300293, total_len: 7360
total_loss: 33712.67094421387, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  69 at step    13800 | time:  6.85s | valid loss  4.16 | valid ppl    64.159
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  58 step    14000 |    206 batches | lr 9.09e-05 | ms/batch 39.49 | loss  3.72 | ppl    41.390
total_loss: 30607.808799743652, total_len: 7360
total_loss: 33673.03145599365, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  70 at step    14000 | time:  6.72s | valid loss  4.16 | valid ppl    63.986
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  59 step    14200 |    164 batches | lr 9e-05 | ms/batch 39.53 | loss  3.71 | ppl    40.863
total_loss: 30559.859245300293, total_len: 7360
total_loss: 33630.572845458984, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  71 at step    14200 | time:  6.73s | valid loss  4.15 | valid ppl    63.571
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  60 step    14400 |    122 batches | lr 8.91e-05 | ms/batch 39.22 | loss  3.70 | ppl    40.517
total_loss: 30553.33920288086, total_len: 7360
total_loss: 33619.31904602051, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  72 at step    14400 | time:  6.72s | valid loss  4.15 | valid ppl    63.515
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  61 step    14600 |     80 batches | lr 8.82e-05 | ms/batch 39.54 | loss  3.71 | ppl    40.870
total_loss: 30467.86395263672, total_len: 7360
total_loss: 33510.54296875, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  73 at step    14600 | time:  6.74s | valid loss  4.14 | valid ppl    62.781
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  62 step    14800 |     38 batches | lr 8.73e-05 | ms/batch 39.45 | loss  3.68 | ppl    39.528
total_loss: 30476.13568878174, total_len: 7360
total_loss: 33518.964935302734, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  74 at step    14800 | time:  6.73s | valid loss  4.14 | valid ppl    62.852
----------------------------------------------------------------------------------------------------
| epoch  62 step    15000 |    238 batches | lr 8.64e-05 | ms/batch 33.77 | loss  3.67 | ppl    39.081
total_loss: 30417.609657287598, total_len: 7360
total_loss: 33473.108726501465, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  75 at step    15000 | time:  6.75s | valid loss  4.13 | valid ppl    62.354
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  63 step    15200 |    196 batches | lr 8.55e-05 | ms/batch 40.13 | loss  3.66 | ppl    38.934
total_loss: 30379.033782958984, total_len: 7360
total_loss: 33423.670082092285, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  76 at step    15200 | time:  6.86s | valid loss  4.13 | valid ppl    62.028
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  64 step    15400 |    154 batches | lr 8.46e-05 | ms/batch 40.47 | loss  3.65 | ppl    38.538
total_loss: 30376.718826293945, total_len: 7360
total_loss: 33409.0453414917, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  77 at step    15400 | time:  6.97s | valid loss  4.13 | valid ppl    62.009
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  65 step    15600 |    112 batches | lr 8.37e-05 | ms/batch 39.66 | loss  3.65 | ppl    38.496
total_loss: 30292.892517089844, total_len: 7360
total_loss: 33326.42182159424, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  78 at step    15600 | time:  6.75s | valid loss  4.12 | valid ppl    61.306
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  66 step    15800 |     70 batches | lr 8.27e-05 | ms/batch 40.52 | loss  3.65 | ppl    38.364
total_loss: 30129.968757629395, total_len: 7360
total_loss: 33133.68386077881, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  79 at step    15800 | time:  6.96s | valid loss  4.09 | valid ppl    59.964
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16000 |     28 batches | lr 8.18e-05 | ms/batch 40.09 | loss  3.61 | ppl    37.122
total_loss: 30109.30930328369, total_len: 7360
total_loss: 33112.64415740967, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  80 at step    16000 | time:  6.91s | valid loss  4.09 | valid ppl    59.796
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  67 step    16200 |    228 batches | lr 8.09e-05 | ms/batch 40.11 | loss  3.61 | ppl    36.872
total_loss: 30146.34571838379, total_len: 7360
total_loss: 33145.92562866211, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  81 at step    16200 | time:  6.90s | valid loss  4.10 | valid ppl    60.098
----------------------------------------------------------------------------------------------------
| epoch  68 step    16400 |    186 batches | lr 7.99e-05 | ms/batch 34.36 | loss  3.60 | ppl    36.632
total_loss: 30044.273971557617, total_len: 7360
total_loss: 33039.66530609131, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  82 at step    16400 | time:  6.86s | valid loss  4.08 | valid ppl    59.270
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  69 step    16600 |    144 batches | lr 7.9e-05 | ms/batch 40.09 | loss  3.59 | ppl    36.295
total_loss: 30000.822792053223, total_len: 7360
total_loss: 32983.50804901123, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  83 at step    16600 | time:  6.86s | valid loss  4.08 | valid ppl    58.921
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  70 step    16800 |    102 batches | lr 7.8e-05 | ms/batch 41.99 | loss  3.59 | ppl    36.303
total_loss: 30043.703910827637, total_len: 7360
total_loss: 33005.5984954834, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  84 at step    16800 | time:  7.25s | valid loss  4.08 | valid ppl    59.265
----------------------------------------------------------------------------------------------------
| epoch  71 step    17000 |     60 batches | lr 7.71e-05 | ms/batch 34.72 | loss  3.58 | ppl    35.917
total_loss: 29893.53858947754, total_len: 7360
total_loss: 32865.12935638428, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  85 at step    17000 | time:  6.94s | valid loss  4.06 | valid ppl    58.068
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17200 |     18 batches | lr 7.61e-05 | ms/batch 40.25 | loss  3.56 | ppl    35.021
total_loss: 29839.11361694336, total_len: 7360
total_loss: 32816.34819793701, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  86 at step    17200 | time:  6.90s | valid loss  4.05 | valid ppl    57.641
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  72 step    17400 |    218 batches | lr 7.52e-05 | ms/batch 39.07 | loss  3.56 | ppl    35.054
total_loss: 29821.91431427002, total_len: 7360
total_loss: 32796.795349121094, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  87 at step    17400 | time:  6.88s | valid loss  4.05 | valid ppl    57.506
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  73 step    17600 |    176 batches | lr 7.42e-05 | ms/batch 40.11 | loss  3.54 | ppl    34.519
total_loss: 29778.53187561035, total_len: 7360
total_loss: 32760.796325683594, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  88 at step    17600 | time:  6.84s | valid loss  4.05 | valid ppl    57.168
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  74 step    17800 |    134 batches | lr 7.32e-05 | ms/batch 40.01 | loss  3.53 | ppl    34.264
total_loss: 29763.443031311035, total_len: 7360
total_loss: 32719.877891540527, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  89 at step    17800 | time:  6.85s | valid loss  4.04 | valid ppl    57.051
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  75 step    18000 |     92 batches | lr 7.23e-05 | ms/batch 40.02 | loss  3.54 | ppl    34.486
total_loss: 29729.422958374023, total_len: 7360
total_loss: 32675.282585144043, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  90 at step    18000 | time:  6.84s | valid loss  4.04 | valid ppl    56.788
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  76 step    18200 |     50 batches | lr 7.13e-05 | ms/batch 39.91 | loss  3.52 | ppl    33.814
total_loss: 29645.504913330078, total_len: 7360
total_loss: 32594.43482208252, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  91 at step    18200 | time:  6.85s | valid loss  4.03 | valid ppl    56.144
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  77 step    18400 |      8 batches | lr 7.03e-05 | ms/batch 40.29 | loss  3.50 | ppl    33.176
total_loss: 29620.7427444458, total_len: 7360
total_loss: 32571.39337158203, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  92 at step    18400 | time:  6.91s | valid loss  4.02 | valid ppl    55.956
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  77 step    18600 |    208 batches | lr 6.94e-05 | ms/batch 39.99 | loss  3.50 | ppl    32.994
total_loss: 29582.781761169434, total_len: 7360
total_loss: 32512.806159973145, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  93 at step    18600 | time:  6.86s | valid loss  4.02 | valid ppl    55.668
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  78 step    18800 |    166 batches | lr 6.84e-05 | ms/batch 39.84 | loss  3.49 | ppl    32.699
total_loss: 29569.677223205566, total_len: 7360
total_loss: 32495.62604522705, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  94 at step    18800 | time:  6.78s | valid loss  4.02 | valid ppl    55.569
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  79 step    19000 |    124 batches | lr 6.74e-05 | ms/batch 39.15 | loss  3.48 | ppl    32.476
total_loss: 29548.20108795166, total_len: 7360
total_loss: 32456.47071838379, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  95 at step    19000 | time:  6.74s | valid loss  4.01 | valid ppl    55.407
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  80 step    19200 |     82 batches | lr 6.64e-05 | ms/batch 39.40 | loss  3.49 | ppl    32.882
total_loss: 29519.618286132812, total_len: 7360
total_loss: 32407.79507446289, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  96 at step    19200 | time:  6.71s | valid loss  4.01 | valid ppl    55.192
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19400 |     40 batches | lr 6.54e-05 | ms/batch 39.13 | loss  3.46 | ppl    31.926
total_loss: 29436.27886199951, total_len: 7360
total_loss: 32330.918449401855, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  97 at step    19400 | time:  6.77s | valid loss  4.00 | valid ppl    54.571
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  81 step    19600 |    240 batches | lr 6.45e-05 | ms/batch 40.18 | loss  3.45 | ppl    31.580
total_loss: 29423.887001037598, total_len: 7360
total_loss: 32319.480308532715, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  98 at step    19600 | time:  9.04s | valid loss  4.00 | valid ppl    54.479
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  82 step    19800 |    198 batches | lr 6.35e-05 | ms/batch 51.66 | loss  3.45 | ppl    31.508
total_loss: 29400.13764190674, total_len: 7360
total_loss: 32289.127960205078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval  99 at step    19800 | time:  7.02s | valid loss  3.99 | valid ppl    54.303
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  83 step    20000 |    156 batches | lr 6.25e-05 | ms/batch 39.75 | loss  3.44 | ppl    31.114
total_loss: 29427.13494873047, total_len: 7360
total_loss: 32320.343574523926, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 100 at step    20000 | time:  6.84s | valid loss  4.00 | valid ppl    54.503
----------------------------------------------------------------------------------------------------
| epoch  84 step    20200 |    114 batches | lr 6.15e-05 | ms/batch 34.26 | loss  3.44 | ppl    31.148
total_loss: 29388.52914428711, total_len: 7360
total_loss: 32282.286163330078, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 101 at step    20200 | time:  6.85s | valid loss  3.99 | valid ppl    54.218
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  85 step    20400 |     72 batches | lr 6.05e-05 | ms/batch 39.08 | loss  3.45 | ppl    31.373
total_loss: 29282.01530456543, total_len: 7360
total_loss: 32154.88706970215, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 102 at step    20400 | time:  6.85s | valid loss  3.98 | valid ppl    53.439
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  86 step    20600 |     30 batches | lr 5.96e-05 | ms/batch 40.16 | loss  3.41 | ppl    30.408
total_loss: 29274.741760253906, total_len: 7360
total_loss: 32142.664108276367, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 103 at step    20600 | time:  6.86s | valid loss  3.98 | valid ppl    53.386
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  86 step    20800 |    230 batches | lr 5.86e-05 | ms/batch 39.70 | loss  3.41 | ppl    30.288
total_loss: 29306.336708068848, total_len: 7360
total_loss: 32190.45930480957, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 104 at step    20800 | time:  6.85s | valid loss  3.98 | valid ppl    53.616
----------------------------------------------------------------------------------------------------
| epoch  87 step    21000 |    188 batches | lr 5.76e-05 | ms/batch 34.14 | loss  3.41 | ppl    30.216
total_loss: 29229.73081970215, total_len: 7360
total_loss: 32102.397010803223, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 105 at step    21000 | time:  6.83s | valid loss  3.97 | valid ppl    53.060
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  88 step    21200 |    146 batches | lr 5.66e-05 | ms/batch 40.25 | loss  3.40 | ppl    30.020
total_loss: 29243.32667541504, total_len: 7360
total_loss: 32096.375885009766, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 106 at step    21200 | time:  6.86s | valid loss  3.97 | valid ppl    53.159
----------------------------------------------------------------------------------------------------
| epoch  89 step    21400 |    104 batches | lr 5.56e-05 | ms/batch 34.40 | loss  3.41 | ppl    30.143
total_loss: 29225.54923248291, total_len: 7360
total_loss: 32091.830055236816, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 107 at step    21400 | time:  6.87s | valid loss  3.97 | valid ppl    53.030
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  90 step    21600 |     62 batches | lr 5.47e-05 | ms/batch 39.49 | loss  3.40 | ppl    30.069
total_loss: 29186.682121276855, total_len: 7360
total_loss: 32055.080688476562, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 108 at step    21600 | time:  6.82s | valid loss  3.97 | valid ppl    52.751
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  91 step    21800 |     20 batches | lr 5.37e-05 | ms/batch 40.01 | loss  3.38 | ppl    29.396
total_loss: 29222.65877532959, total_len: 7360
total_loss: 32105.070846557617, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 109 at step    21800 | time:  6.83s | valid loss  3.97 | valid ppl    53.009
----------------------------------------------------------------------------------------------------
| epoch  91 step    22000 |    220 batches | lr 5.27e-05 | ms/batch 34.01 | loss  3.38 | ppl    29.304
total_loss: 29157.545524597168, total_len: 7360
total_loss: 32027.39323425293, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 110 at step    22000 | time:  6.80s | valid loss  3.96 | valid ppl    52.543
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  92 step    22200 |    178 batches | lr 5.18e-05 | ms/batch 39.60 | loss  3.37 | ppl    29.179
total_loss: 29202.174446105957, total_len: 7360
total_loss: 32062.31233215332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 111 at step    22200 | time:  6.80s | valid loss  3.97 | valid ppl    52.862
----------------------------------------------------------------------------------------------------
| epoch  93 step    22400 |    136 batches | lr 5.08e-05 | ms/batch 34.04 | loss  3.37 | ppl    29.023
total_loss: 29131.908531188965, total_len: 7360
total_loss: 31993.480644226074, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 112 at step    22400 | time:  6.80s | valid loss  3.96 | valid ppl    52.360
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  94 step    22600 |     94 batches | lr 4.98e-05 | ms/batch 39.81 | loss  3.38 | ppl    29.372
total_loss: 29124.231994628906, total_len: 7360
total_loss: 31994.101181030273, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 113 at step    22600 | time:  6.84s | valid loss  3.96 | valid ppl    52.305
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  95 step    22800 |     52 batches | lr 4.89e-05 | ms/batch 39.96 | loss  3.37 | ppl    28.964
total_loss: 29108.080078125, total_len: 7360
total_loss: 31948.369369506836, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 114 at step    22800 | time:  6.84s | valid loss  3.95 | valid ppl    52.191
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  96 step    23000 |     10 batches | lr 4.79e-05 | ms/batch 39.02 | loss  3.35 | ppl    28.549
total_loss: 29106.320587158203, total_len: 7360
total_loss: 31962.526428222656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 115 at step    23000 | time:  6.74s | valid loss  3.95 | valid ppl    52.178
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  96 step    23200 |    210 batches | lr 4.7e-05 | ms/batch 39.19 | loss  3.35 | ppl    28.560
total_loss: 29094.819511413574, total_len: 7360
total_loss: 31936.334396362305, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 116 at step    23200 | time:  6.71s | valid loss  3.95 | valid ppl    52.097
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  97 step    23400 |    168 batches | lr 4.6e-05 | ms/batch 39.72 | loss  3.35 | ppl    28.425
total_loss: 29049.90074157715, total_len: 7360
total_loss: 31892.461723327637, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 117 at step    23400 | time:  6.86s | valid loss  3.95 | valid ppl    51.780
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch  98 step    23600 |    126 batches | lr 4.51e-05 | ms/batch 39.71 | loss  3.35 | ppl    28.402
total_loss: 29067.986389160156, total_len: 7360
total_loss: 31917.43364715576, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 118 at step    23600 | time:  6.86s | valid loss  3.95 | valid ppl    51.907
----------------------------------------------------------------------------------------------------
| epoch  99 step    23800 |     84 batches | lr 4.41e-05 | ms/batch 33.89 | loss  3.36 | ppl    28.716
total_loss: 29048.046516418457, total_len: 7360
total_loss: 31885.63966369629, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 119 at step    23800 | time:  6.78s | valid loss  3.95 | valid ppl    51.767
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 100 step    24000 |     42 batches | lr 4.32e-05 | ms/batch 39.08 | loss  3.33 | ppl    28.049
total_loss: 29021.155715942383, total_len: 7360
total_loss: 31851.98365020752, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 120 at step    24000 | time:  6.72s | valid loss  3.94 | valid ppl    51.578
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 100 step    24200 |    242 batches | lr 4.23e-05 | ms/batch 39.14 | loss  3.33 | ppl    27.828
total_loss: 29024.183799743652, total_len: 7360
total_loss: 31852.958526611328, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 121 at step    24200 | time:  6.75s | valid loss  3.94 | valid ppl    51.599
----------------------------------------------------------------------------------------------------
| epoch 101 step    24400 |    200 batches | lr 4.13e-05 | ms/batch 33.67 | loss  3.33 | ppl    27.837
total_loss: 29025.099479675293, total_len: 7360
total_loss: 31852.724647521973, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 122 at step    24400 | time:  6.73s | valid loss  3.94 | valid ppl    51.605
----------------------------------------------------------------------------------------------------
| epoch 102 step    24600 |    158 batches | lr 4.04e-05 | ms/batch 33.71 | loss  3.32 | ppl    27.707
total_loss: 29015.019317626953, total_len: 7360
total_loss: 31839.726387023926, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 123 at step    24600 | time:  6.73s | valid loss  3.94 | valid ppl    51.535
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 103 step    24800 |    116 batches | lr 3.95e-05 | ms/batch 39.08 | loss  3.32 | ppl    27.724
total_loss: 28999.374717712402, total_len: 7360
total_loss: 31815.770599365234, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 124 at step    24800 | time:  6.73s | valid loss  3.94 | valid ppl    51.425
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 104 step    25000 |     74 batches | lr 3.86e-05 | ms/batch 39.23 | loss  3.33 | ppl    28.042
total_loss: 28988.152252197266, total_len: 7360
total_loss: 31808.19874572754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 125 at step    25000 | time:  6.74s | valid loss  3.94 | valid ppl    51.347
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 105 step    25200 |     32 batches | lr 3.77e-05 | ms/batch 39.27 | loss  3.31 | ppl    27.349
total_loss: 28962.25343322754, total_len: 7360
total_loss: 31772.465377807617, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 126 at step    25200 | time:  6.74s | valid loss  3.94 | valid ppl    51.167
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 105 step    25400 |    232 batches | lr 3.68e-05 | ms/batch 39.32 | loss  3.30 | ppl    27.112
total_loss: 28990.39331817627, total_len: 7360
total_loss: 31811.00514984131, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 127 at step    25400 | time:  6.75s | valid loss  3.94 | valid ppl    51.363
----------------------------------------------------------------------------------------------------
| epoch 106 step    25600 |    190 batches | lr 3.59e-05 | ms/batch 33.68 | loss  3.30 | ppl    27.244
total_loss: 28960.474601745605, total_len: 7360
total_loss: 31778.23040008545, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 128 at step    25600 | time:  6.73s | valid loss  3.93 | valid ppl    51.154
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 107 step    25800 |    148 batches | lr 3.5e-05 | ms/batch 39.22 | loss  3.30 | ppl    27.108
total_loss: 28963.99464416504, total_len: 7360
total_loss: 31774.744903564453, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 129 at step    25800 | time:  6.73s | valid loss  3.94 | valid ppl    51.179
----------------------------------------------------------------------------------------------------
| epoch 108 step    26000 |    106 batches | lr 3.41e-05 | ms/batch 33.65 | loss  3.31 | ppl    27.277
total_loss: 28937.954460144043, total_len: 7360
total_loss: 31746.9609375, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 130 at step    26000 | time:  6.70s | valid loss  3.93 | valid ppl    50.998
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 109 step    26200 |     64 batches | lr 3.33e-05 | ms/batch 38.90 | loss  3.31 | ppl    27.275
total_loss: 28904.38242340088, total_len: 7360
total_loss: 31714.014556884766, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 131 at step    26200 | time:  6.69s | valid loss  3.93 | valid ppl    50.766
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 110 step    26400 |     22 batches | lr 3.24e-05 | ms/batch 39.41 | loss  3.29 | ppl    26.742
total_loss: 28936.086555480957, total_len: 7360
total_loss: 31759.106163024902, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 132 at step    26400 | time:  6.71s | valid loss  3.93 | valid ppl    50.985
----------------------------------------------------------------------------------------------------
| epoch 110 step    26600 |    222 batches | lr 3.15e-05 | ms/batch 33.39 | loss  3.29 | ppl    26.802
total_loss: 28908.869400024414, total_len: 7360
total_loss: 31718.92244720459, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 133 at step    26600 | time:  6.73s | valid loss  3.93 | valid ppl    50.797
----------------------------------------------------------------------------------------------------
| epoch 111 step    26800 |    180 batches | lr 3.07e-05 | ms/batch 33.71 | loss  3.29 | ppl    26.737
total_loss: 28906.197929382324, total_len: 7360
total_loss: 31705.05088043213, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 134 at step    26800 | time:  6.72s | valid loss  3.93 | valid ppl    50.778
----------------------------------------------------------------------------------------------------
| epoch 112 step    27000 |    138 batches | lr 2.98e-05 | ms/batch 33.61 | loss  3.28 | ppl    26.695
total_loss: 28903.170707702637, total_len: 7360
total_loss: 31698.703521728516, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 135 at step    27000 | time:  6.73s | valid loss  3.93 | valid ppl    50.758
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 113 step    27200 |     96 batches | lr 2.9e-05 | ms/batch 39.55 | loss  3.29 | ppl    26.912
total_loss: 28921.4810256958, total_len: 7360
total_loss: 31735.47226715088, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 136 at step    27200 | time:  6.77s | valid loss  3.93 | valid ppl    50.884
----------------------------------------------------------------------------------------------------
| epoch 114 step    27400 |     54 batches | lr 2.82e-05 | ms/batch 33.70 | loss  3.28 | ppl    26.626
total_loss: 28913.727020263672, total_len: 7360
total_loss: 31716.825576782227, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 137 at step    27400 | time:  6.74s | valid loss  3.93 | valid ppl    50.830
----------------------------------------------------------------------------------------------------
| epoch 115 step    27600 |     12 batches | lr 2.74e-05 | ms/batch 33.66 | loss  3.27 | ppl    26.364
total_loss: 28871.4974899292, total_len: 7360
total_loss: 31681.761543273926, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 138 at step    27600 | time:  6.73s | valid loss  3.92 | valid ppl    50.540
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 115 step    27800 |    212 batches | lr 2.66e-05 | ms/batch 39.79 | loss  3.27 | ppl    26.395
total_loss: 28867.655838012695, total_len: 7360
total_loss: 31671.60415649414, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 139 at step    27800 | time:  7.12s | valid loss  3.92 | valid ppl    50.513
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 116 step    28000 |    170 batches | lr 2.58e-05 | ms/batch 39.21 | loss  3.27 | ppl    26.295
total_loss: 28870.23616027832, total_len: 7360
total_loss: 31676.283950805664, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 140 at step    28000 | time:  6.73s | valid loss  3.92 | valid ppl    50.531
----------------------------------------------------------------------------------------------------
| epoch 117 step    28200 |    128 batches | lr 2.5e-05 | ms/batch 33.73 | loss  3.27 | ppl    26.214
total_loss: 28914.369598388672, total_len: 7360
total_loss: 31726.766159057617, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 141 at step    28200 | time:  6.75s | valid loss  3.93 | valid ppl    50.835
----------------------------------------------------------------------------------------------------
| epoch 118 step    28400 |     86 batches | lr 2.42e-05 | ms/batch 33.79 | loss  3.28 | ppl    26.657
total_loss: 28866.160362243652, total_len: 7360
total_loss: 31667.73406982422, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 142 at step    28400 | time:  6.76s | valid loss  3.92 | valid ppl    50.503
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 119 step    28600 |     44 batches | lr 2.34e-05 | ms/batch 39.32 | loss  3.26 | ppl    26.149
total_loss: 28813.650909423828, total_len: 7360
total_loss: 31612.591506958008, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 143 at step    28600 | time:  6.75s | valid loss  3.91 | valid ppl    50.144
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 120 step    28800 |      2 batches | lr 2.27e-05 | ms/batch 39.42 | loss  3.26 | ppl    25.932
total_loss: 28867.275665283203, total_len: 7360
total_loss: 31673.01498413086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 144 at step    28800 | time:  6.74s | valid loss  3.92 | valid ppl    50.511
----------------------------------------------------------------------------------------------------
| epoch 120 step    29000 |    202 batches | lr 2.19e-05 | ms/batch 33.68 | loss  3.26 | ppl    26.030
total_loss: 28848.948043823242, total_len: 7360
total_loss: 31653.29106903076, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 145 at step    29000 | time:  6.74s | valid loss  3.92 | valid ppl    50.385
----------------------------------------------------------------------------------------------------
| epoch 121 step    29200 |    160 batches | lr 2.12e-05 | ms/batch 33.71 | loss  3.26 | ppl    25.979
total_loss: 28841.073959350586, total_len: 7360
total_loss: 31641.298530578613, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 146 at step    29200 | time:  6.73s | valid loss  3.92 | valid ppl    50.331
----------------------------------------------------------------------------------------------------
| epoch 122 step    29400 |    118 batches | lr 2.04e-05 | ms/batch 33.67 | loss  3.26 | ppl    26.015
total_loss: 28845.14311981201, total_len: 7360
total_loss: 31650.51741027832, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 147 at step    29400 | time:  6.73s | valid loss  3.92 | valid ppl    50.359
----------------------------------------------------------------------------------------------------
| epoch 123 step    29600 |     76 batches | lr 1.97e-05 | ms/batch 33.72 | loss  3.27 | ppl    26.330
total_loss: 28841.00252532959, total_len: 7360
total_loss: 31640.0532913208, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 148 at step    29600 | time:  6.73s | valid loss  3.92 | valid ppl    50.331
----------------------------------------------------------------------------------------------------
| epoch 124 step    29800 |     34 batches | lr 1.9e-05 | ms/batch 33.68 | loss  3.25 | ppl    25.793
total_loss: 28827.5707321167, total_len: 7360
total_loss: 31622.522033691406, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 149 at step    29800 | time:  6.74s | valid loss  3.92 | valid ppl    50.239
----------------------------------------------------------------------------------------------------
| epoch 124 step    30000 |    234 batches | lr 1.83e-05 | ms/batch 33.72 | loss  3.24 | ppl    25.644
total_loss: 28833.348083496094, total_len: 7360
total_loss: 31634.82122039795, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 150 at step    30000 | time:  6.74s | valid loss  3.92 | valid ppl    50.278
----------------------------------------------------------------------------------------------------
| epoch 125 step    30200 |    192 batches | lr 1.76e-05 | ms/batch 33.75 | loss  3.25 | ppl    25.789
total_loss: 28829.817779541016, total_len: 7360
total_loss: 31635.276824951172, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 151 at step    30200 | time:  6.76s | valid loss  3.92 | valid ppl    50.254
----------------------------------------------------------------------------------------------------
| epoch 126 step    30400 |    150 batches | lr 1.69e-05 | ms/batch 33.79 | loss  3.25 | ppl    25.691
total_loss: 28821.517616271973, total_len: 7360
total_loss: 31621.091369628906, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 152 at step    30400 | time:  6.76s | valid loss  3.92 | valid ppl    50.198
----------------------------------------------------------------------------------------------------
| epoch 127 step    30600 |    108 batches | lr 1.63e-05 | ms/batch 33.69 | loss  3.25 | ppl    25.900
total_loss: 28828.193817138672, total_len: 7360
total_loss: 31622.539810180664, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 153 at step    30600 | time:  6.73s | valid loss  3.92 | valid ppl    50.243
----------------------------------------------------------------------------------------------------
| epoch 128 step    30800 |     66 batches | lr 1.56e-05 | ms/batch 33.74 | loss  3.26 | ppl    25.957
total_loss: 28805.428024291992, total_len: 7360
total_loss: 31596.10871887207, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 154 at step    30800 | time:  6.75s | valid loss  3.91 | valid ppl    50.088
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 129 step    31000 |     24 batches | lr 1.5e-05 | ms/batch 39.62 | loss  3.24 | ppl    25.471
total_loss: 28803.45076751709, total_len: 7360
total_loss: 31603.63665008545, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 155 at step    31000 | time:  6.77s | valid loss  3.91 | valid ppl    50.075
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 129 step    31200 |    224 batches | lr 1.43e-05 | ms/batch 39.19 | loss  3.24 | ppl    25.425
total_loss: 28810.28768157959, total_len: 7360
total_loss: 31616.15951538086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 156 at step    31200 | time:  6.73s | valid loss  3.91 | valid ppl    50.121
----------------------------------------------------------------------------------------------------
| epoch 130 step    31400 |    182 batches | lr 1.37e-05 | ms/batch 33.68 | loss  3.24 | ppl    25.487
total_loss: 28810.784019470215, total_len: 7360
total_loss: 31610.78303527832, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 157 at step    31400 | time:  6.74s | valid loss  3.91 | valid ppl    50.124
----------------------------------------------------------------------------------------------------
| epoch 131 step    31600 |    140 batches | lr 1.31e-05 | ms/batch 33.67 | loss  3.24 | ppl    25.496
total_loss: 28818.500373840332, total_len: 7360
total_loss: 31618.344108581543, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 158 at step    31600 | time:  6.72s | valid loss  3.92 | valid ppl    50.177
----------------------------------------------------------------------------------------------------
| epoch 132 step    31800 |     98 batches | lr 1.25e-05 | ms/batch 33.67 | loss  3.25 | ppl    25.749
total_loss: 28797.869422912598, total_len: 7360
total_loss: 31590.376678466797, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 159 at step    31800 | time:  6.74s | valid loss  3.91 | valid ppl    50.037
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 133 step    32000 |     56 batches | lr 1.19e-05 | ms/batch 39.14 | loss  3.24 | ppl    25.607
total_loss: 28794.936599731445, total_len: 7360
total_loss: 31576.153678894043, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 160 at step    32000 | time:  6.74s | valid loss  3.91 | valid ppl    50.017
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 134 step    32200 |     14 batches | lr 1.14e-05 | ms/batch 38.62 | loss  3.23 | ppl    25.310
total_loss: 28817.703453063965, total_len: 7360
total_loss: 31608.68775177002, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 161 at step    32200 | time:  6.73s | valid loss  3.92 | valid ppl    50.172
----------------------------------------------------------------------------------------------------
| epoch 134 step    32400 |    214 batches | lr 1.08e-05 | ms/batch 33.64 | loss  3.23 | ppl    25.354
total_loss: 28795.683921813965, total_len: 7360
total_loss: 31586.698371887207, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 162 at step    32400 | time:  6.72s | valid loss  3.91 | valid ppl    50.022
----------------------------------------------------------------------------------------------------
| epoch 135 step    32600 |    172 batches | lr 1.03e-05 | ms/batch 33.63 | loss  3.23 | ppl    25.288
total_loss: 28796.007194519043, total_len: 7360
total_loss: 31589.366439819336, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 163 at step    32600 | time:  6.71s | valid loss  3.91 | valid ppl    50.024
----------------------------------------------------------------------------------------------------
| epoch 136 step    32800 |    130 batches | lr 9.73e-06 | ms/batch 33.64 | loss  3.23 | ppl    25.328
total_loss: 28826.279891967773, total_len: 7360
total_loss: 31621.767738342285, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 164 at step    32800 | time:  6.73s | valid loss  3.92 | valid ppl    50.230
----------------------------------------------------------------------------------------------------
| epoch 137 step    33000 |     88 batches | lr 9.21e-06 | ms/batch 33.65 | loss  3.25 | ppl    25.677
total_loss: 28796.716186523438, total_len: 7360
total_loss: 31583.9189453125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 165 at step    33000 | time:  6.73s | valid loss  3.91 | valid ppl    50.029
----------------------------------------------------------------------------------------------------
| epoch 138 step    33200 |     46 batches | lr 8.7e-06 | ms/batch 33.57 | loss  3.23 | ppl    25.328
total_loss: 28775.113998413086, total_len: 7360
total_loss: 31560.930061340332, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 166 at step    33200 | time:  6.72s | valid loss  3.91 | valid ppl    49.882
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 139 step    33400 |      4 batches | lr 8.21e-06 | ms/batch 39.38 | loss  3.23 | ppl    25.171
total_loss: 28804.709114074707, total_len: 7360
total_loss: 31596.7818069458, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 167 at step    33400 | time:  6.73s | valid loss  3.91 | valid ppl    50.083
----------------------------------------------------------------------------------------------------
| epoch 139 step    33600 |    204 batches | lr 7.73e-06 | ms/batch 33.69 | loss  3.23 | ppl    25.226
total_loss: 28782.14737701416, total_len: 7360
total_loss: 31570.850730895996, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 168 at step    33600 | time:  6.75s | valid loss  3.91 | valid ppl    49.930
----------------------------------------------------------------------------------------------------
| epoch 140 step    33800 |    162 batches | lr 7.26e-06 | ms/batch 33.68 | loss  3.23 | ppl    25.201
total_loss: 28801.24626159668, total_len: 7360
total_loss: 31591.965370178223, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 169 at step    33800 | time:  6.73s | valid loss  3.91 | valid ppl    50.060
----------------------------------------------------------------------------------------------------
| epoch 141 step    34000 |    120 batches | lr 6.81e-06 | ms/batch 33.63 | loss  3.23 | ppl    25.223
total_loss: 28788.796005249023, total_len: 7360
total_loss: 31583.922187805176, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 170 at step    34000 | time:  6.73s | valid loss  3.91 | valid ppl    49.975
----------------------------------------------------------------------------------------------------
| epoch 142 step    34200 |     78 batches | lr 6.37e-06 | ms/batch 33.66 | loss  3.24 | ppl    25.656
total_loss: 28766.111167907715, total_len: 7360
total_loss: 31557.547592163086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 171 at step    34200 | time:  6.72s | valid loss  3.91 | valid ppl    49.821
----------------------------------------------------------------------------------------------------
Best model and ESD saved.
| epoch 143 step    34400 |     36 batches | lr 5.95e-06 | ms/batch 39.31 | loss  3.22 | ppl    25.115
total_loss: 28771.66823577881, total_len: 7360
total_loss: 31561.587409973145, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 172 at step    34400 | time:  6.71s | valid loss  3.91 | valid ppl    49.859
----------------------------------------------------------------------------------------------------
| epoch 143 step    34600 |    236 batches | lr 5.54e-06 | ms/batch 33.44 | loss  3.22 | ppl    25.052
total_loss: 28772.122497558594, total_len: 7360
total_loss: 31565.823570251465, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 173 at step    34600 | time:  6.73s | valid loss  3.91 | valid ppl    49.862
----------------------------------------------------------------------------------------------------
| epoch 144 step    34800 |    194 batches | lr 5.14e-06 | ms/batch 33.71 | loss  3.23 | ppl    25.195
total_loss: 28775.36692047119, total_len: 7360
total_loss: 31569.375061035156, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 174 at step    34800 | time:  6.75s | valid loss  3.91 | valid ppl    49.884
----------------------------------------------------------------------------------------------------
| epoch 145 step    35000 |    152 batches | lr 4.76e-06 | ms/batch 33.78 | loss  3.22 | ppl    25.039
total_loss: 28773.03269958496, total_len: 7360
total_loss: 31562.19602203369, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 175 at step    35000 | time:  6.75s | valid loss  3.91 | valid ppl    49.868
----------------------------------------------------------------------------------------------------
| epoch 146 step    35200 |    110 batches | lr 4.39e-06 | ms/batch 33.72 | loss  3.23 | ppl    25.262
total_loss: 28784.940559387207, total_len: 7360
total_loss: 31568.803199768066, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 176 at step    35200 | time:  6.74s | valid loss  3.91 | valid ppl    49.949
----------------------------------------------------------------------------------------------------
| epoch 147 step    35400 |     68 batches | lr 4.03e-06 | ms/batch 33.67 | loss  3.24 | ppl    25.415
total_loss: 28768.477615356445, total_len: 7360
total_loss: 31552.340133666992, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 177 at step    35400 | time:  6.72s | valid loss  3.91 | valid ppl    49.837
----------------------------------------------------------------------------------------------------
| epoch 148 step    35600 |     26 batches | lr 3.69e-06 | ms/batch 33.65 | loss  3.22 | ppl    25.010
total_loss: 28789.953002929688, total_len: 7360
total_loss: 31580.666229248047, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 178 at step    35600 | time:  6.74s | valid loss  3.91 | valid ppl    49.983
----------------------------------------------------------------------------------------------------
| epoch 148 step    35800 |    226 batches | lr 3.37e-06 | ms/batch 33.70 | loss  3.22 | ppl    25.044
total_loss: 28766.84390258789, total_len: 7360
total_loss: 31556.29037475586, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 179 at step    35800 | time:  6.73s | valid loss  3.91 | valid ppl    49.826
----------------------------------------------------------------------------------------------------
| epoch 149 step    36000 |    184 batches | lr 3.06e-06 | ms/batch 33.63 | loss  3.22 | ppl    25.019
total_loss: 28778.018463134766, total_len: 7360
total_loss: 31565.481407165527, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 180 at step    36000 | time:  6.73s | valid loss  3.91 | valid ppl    49.902
----------------------------------------------------------------------------------------------------
| epoch 150 step    36200 |    142 batches | lr 2.76e-06 | ms/batch 33.62 | loss  3.22 | ppl    25.105
total_loss: 28769.80283355713, total_len: 7360
total_loss: 31558.764190673828, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 181 at step    36200 | time:  6.67s | valid loss  3.91 | valid ppl    49.846
----------------------------------------------------------------------------------------------------
| epoch 151 step    36400 |    100 batches | lr 2.48e-06 | ms/batch 32.81 | loss  3.23 | ppl    25.277
total_loss: 28767.173789978027, total_len: 7360
total_loss: 31554.40399169922, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 182 at step    36400 | time:  6.58s | valid loss  3.91 | valid ppl    49.828
----------------------------------------------------------------------------------------------------
| epoch 152 step    36600 |     58 batches | lr 2.22e-06 | ms/batch 33.33 | loss  3.23 | ppl    25.278
total_loss: 28768.785278320312, total_len: 7360
total_loss: 31553.78955078125, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 183 at step    36600 | time:  6.76s | valid loss  3.91 | valid ppl    49.839
----------------------------------------------------------------------------------------------------
| epoch 153 step    36800 |     16 batches | lr 1.96e-06 | ms/batch 33.51 | loss  3.22 | ppl    24.912
total_loss: 28774.888870239258, total_len: 7360
total_loss: 31564.246688842773, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 184 at step    36800 | time:  6.71s | valid loss  3.91 | valid ppl    49.881
----------------------------------------------------------------------------------------------------
| epoch 153 step    37000 |    216 batches | lr 1.73e-06 | ms/batch 33.16 | loss  3.22 | ppl    25.062
total_loss: 28770.399574279785, total_len: 7360
total_loss: 31557.96738433838, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 185 at step    37000 | time:  6.60s | valid loss  3.91 | valid ppl    49.850
----------------------------------------------------------------------------------------------------
| epoch 154 step    37200 |    174 batches | lr 1.51e-06 | ms/batch 33.53 | loss  3.22 | ppl    25.036
total_loss: 28770.4793548584, total_len: 7360
total_loss: 31558.799545288086, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 186 at step    37200 | time:  6.73s | valid loss  3.91 | valid ppl    49.851
----------------------------------------------------------------------------------------------------
| epoch 155 step    37400 |    132 batches | lr 1.3e-06 | ms/batch 33.69 | loss  3.22 | ppl    25.077
total_loss: 28772.93194580078, total_len: 7360
total_loss: 31560.731735229492, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 187 at step    37400 | time:  6.75s | valid loss  3.91 | valid ppl    49.867
----------------------------------------------------------------------------------------------------
| epoch 156 step    37600 |     90 batches | lr 1.11e-06 | ms/batch 33.76 | loss  3.23 | ppl    25.333
total_loss: 28770.515579223633, total_len: 7360
total_loss: 31556.472480773926, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 188 at step    37600 | time:  6.74s | valid loss  3.91 | valid ppl    49.851
----------------------------------------------------------------------------------------------------
| epoch 157 step    37800 |     48 batches | lr 9.31e-07 | ms/batch 33.73 | loss  3.22 | ppl    25.105
total_loss: 28768.866065979004, total_len: 7360
total_loss: 31556.931114196777, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 189 at step    37800 | time:  6.73s | valid loss  3.91 | valid ppl    49.840
----------------------------------------------------------------------------------------------------
| epoch 158 step    38000 |      6 batches | lr 7.69e-07 | ms/batch 33.70 | loss  3.21 | ppl    24.892
total_loss: 28769.95783996582, total_len: 7360
total_loss: 31558.187843322754, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 190 at step    38000 | time:  6.74s | valid loss  3.91 | valid ppl    49.847
----------------------------------------------------------------------------------------------------
| epoch 158 step    38200 |    206 batches | lr 6.24e-07 | ms/batch 33.68 | loss  3.22 | ppl    24.940
total_loss: 28768.872749328613, total_len: 7360
total_loss: 31556.849601745605, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 191 at step    38200 | time:  6.73s | valid loss  3.91 | valid ppl    49.840
----------------------------------------------------------------------------------------------------
| epoch 159 step    38400 |    164 batches | lr 4.93e-07 | ms/batch 33.76 | loss  3.22 | ppl    25.024
total_loss: 28769.663902282715, total_len: 7360
total_loss: 31557.664321899414, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 192 at step    38400 | time:  6.77s | valid loss  3.91 | valid ppl    49.845
----------------------------------------------------------------------------------------------------
| epoch 160 step    38600 |    122 batches | lr 3.77e-07 | ms/batch 33.73 | loss  3.22 | ppl    25.068
total_loss: 28769.06517791748, total_len: 7360
total_loss: 31556.18920135498, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 193 at step    38600 | time:  6.73s | valid loss  3.91 | valid ppl    49.841
----------------------------------------------------------------------------------------------------
| epoch 161 step    38800 |     80 batches | lr 2.77e-07 | ms/batch 33.68 | loss  3.23 | ppl    25.404
total_loss: 28766.711906433105, total_len: 7360
total_loss: 31553.996726989746, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 194 at step    38800 | time:  6.73s | valid loss  3.91 | valid ppl    49.825
----------------------------------------------------------------------------------------------------
| epoch 162 step    39000 |     38 batches | lr 1.93e-07 | ms/batch 33.64 | loss  3.22 | ppl    24.962
total_loss: 28768.778648376465, total_len: 7360
total_loss: 31556.274475097656, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 195 at step    39000 | time:  6.73s | valid loss  3.91 | valid ppl    49.839
----------------------------------------------------------------------------------------------------
| epoch 162 step    39200 |    238 batches | lr 1.23e-07 | ms/batch 33.63 | loss  3.21 | ppl    24.860
total_loss: 28767.034210205078, total_len: 7360
total_loss: 31554.5984954834, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 196 at step    39200 | time:  6.73s | valid loss  3.91 | valid ppl    49.827
----------------------------------------------------------------------------------------------------
| epoch 163 step    39400 |    196 batches | lr 6.94e-08 | ms/batch 33.81 | loss  3.22 | ppl    25.028
total_loss: 28767.024124145508, total_len: 7360
total_loss: 31554.612174987793, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 197 at step    39400 | time:  6.77s | valid loss  3.91 | valid ppl    49.827
----------------------------------------------------------------------------------------------------
| epoch 164 step    39600 |    154 batches | lr 3.08e-08 | ms/batch 33.70 | loss  3.22 | ppl    24.929
total_loss: 28766.885818481445, total_len: 7360
total_loss: 31554.471366882324, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 198 at step    39600 | time:  6.72s | valid loss  3.91 | valid ppl    49.826
----------------------------------------------------------------------------------------------------
| epoch 165 step    39800 |    112 batches | lr 7.71e-09 | ms/batch 33.63 | loss  3.22 | ppl    25.129
total_loss: 28766.68320465088, total_len: 7360
total_loss: 31554.233604431152, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 199 at step    39800 | time:  6.73s | valid loss  3.91 | valid ppl    49.825
----------------------------------------------------------------------------------------------------
| epoch 166 step    40000 |     70 batches | lr 0 | ms/batch 34.66 | loss  3.23 | ppl    25.330
total_loss: 28766.693367004395, total_len: 7360
total_loss: 31554.252784729004, total_len: 8224
----------------------------------------------------------------------------------------------------
| Eval 200 at step    40000 | time:  6.91s | valid loss  3.91 | valid ppl    49.825
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
End of training
total_loss: 31557.547592163086, total_len: 8224
====================================================================================================
| End of training | test loss  3.84 | test ppl    46.398
====================================================================================================
